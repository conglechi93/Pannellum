{"ast":null,"code":"\"use strict\"; // Object.defineProperty(exports, \"__esModule\", { value: true });\n\n\nvar React = require(\"react\");\n\nvar PropTypes = require(\"prop-types\");\n\nfunction _interopDefaultLegacy(e) {\n  return e && typeof e === \"object\" && \"default\" in e ? e : {\n    default: e\n  };\n}\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\n_c = React__default;\n\nvar PropTypes__default = /*#__PURE__*/_interopDefaultLegacy(PropTypes);\n\n_c2 = PropTypes__default;\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n/*eslint-disable*/\n\n\nvar libpannellum = function (window, document, undefined$1) {\n  if (!window || !document) return;\n\n  function Renderer(container) {\n    var _s = $RefreshSig$();\n\n    var canvas = document.createElement(\"canvas\");\n    canvas.style.width = canvas.style.height = \"100%\";\n    container.appendChild(canvas);\n    var program, gl, vs, fs;\n    var fallbackImgSize;\n    var world;\n    var vtmps;\n    var pose;\n    var image, imageType, dynamic;\n    var texCoordBuffer, cubeVertBuf, cubeVertTexCoordBuf, cubeVertIndBuf;\n    var globalParams;\n    /**\r\n     * Initialize renderer.\r\n     * @memberof Renderer\r\n     * @instance\r\n     * @param {Image|Array|Object} image - Input image; format varies based on\r\n     *      `imageType`. For `equirectangular`, this is an image; for\r\n     *      `cubemap`, this is an array of images for the cube faces in the\r\n     *      order [+z, +x, -z, -x, +y, -y]; for `multires`, this is a\r\n     *      configuration object.\r\n     * @param {string} imageType - The type of the image: `equirectangular`,\r\n     *      `cubemap`, or `multires`.\r\n     * @param {boolean} dynamic - Whether or not the image is dynamic (e.g. video).\r\n     * @param {number} haov - Initial horizontal angle of view.\r\n     * @param {number} vaov - Initial vertical angle of view.\r\n     * @param {number} voffset - Initial vertical offset angle.\r\n     * @param {function} callback - Load callback function.\r\n     * @param {Object} [params] - Other configuration parameters (`horizonPitch`, `horizonRoll`, `backgroundColor`).\r\n     */\n\n    this.init = _s(function (_image, _imageType, _dynamic, haov, vaov, voffset, callback, params) {\n      _s();\n\n      // Default argument for image type\n      if (_imageType === undefined$1) _imageType = \"equirectangular\";\n\n      if (_imageType != \"equirectangular\" && _imageType != \"cubemap\" && _imageType != \"multires\") {\n        console.log(\"Error: invalid image type specified!\");\n        throw {\n          type: \"config error\"\n        };\n      }\n\n      imageType = _imageType;\n      image = _image;\n      dynamic = _dynamic;\n      globalParams = params || {}; // Clear old data\n\n      if (program) {\n        if (vs) {\n          gl.detachShader(program, vs);\n          gl.deleteShader(vs);\n        }\n\n        if (fs) {\n          gl.detachShader(program, fs);\n          gl.deleteShader(fs);\n        }\n\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n        if (program.texture) gl.deleteTexture(program.texture);\n        if (program.nodeCache) for (var i = 0; i < program.nodeCache.length; i++) {\n          gl.deleteTexture(program.nodeCache[i].texture);\n        }\n        gl.deleteProgram(program);\n        program = undefined$1;\n      }\n\n      pose = undefined$1;\n      var s;\n      var faceMissing = false;\n      var cubeImgWidth;\n\n      if (imageType == \"cubemap\") {\n        for (s = 0; s < 6; s++) {\n          if (image[s].width > 0) {\n            if (cubeImgWidth === undefined$1) cubeImgWidth = image[s].width;\n            if (cubeImgWidth != image[s].width) console.log(\"Cube faces have inconsistent widths: \" + cubeImgWidth + \" vs. \" + image[s].width);\n          } else faceMissing = true;\n        }\n      }\n\n      function fillMissingFaces(imgSize) {\n        if (faceMissing) {\n          // Fill any missing fallback/cubemap faces with background\n          var nbytes = imgSize * imgSize * 4; // RGB, plus non-functional alpha\n\n          var imageArray = new Uint8ClampedArray(nbytes);\n          var rgb = params.backgroundColor ? params.backgroundColor : [0, 0, 0];\n          rgb[0] *= 255;\n          rgb[1] *= 255;\n          rgb[2] *= 255; // Maybe filling could be done faster, see e.g. https://stackoverflow.com/questions/1295584/most-efficient-way-to-create-a-zero-filled-javascript-array\n\n          for (var i = 0; i < nbytes; i++) {\n            imageArray[i++] = rgb[0];\n            imageArray[i++] = rgb[1];\n            imageArray[i++] = rgb[2];\n          }\n\n          var backgroundSquare = new ImageData(imageArray, imgSize, imgSize);\n\n          for (s = 0; s < 6; s++) {\n            if (image[s].width == 0) image[s] = backgroundSquare;\n          }\n        }\n      } // This awful browser specific test exists because iOS 8/9 and IE 11\n      // don't display non-power-of-two cubemap textures but also don't\n      // throw an error (tested on an iPhone 5c / iOS 8.1.3 / iOS 9.2 /\n      // iOS 10.3.1).\n      // Therefore, the WebGL context is never created for these browsers for\n      // NPOT cubemaps, and the CSS 3D transform fallback renderer is used\n      // instead.\n\n\n      if (!(imageType == \"cubemap\" && (cubeImgWidth & cubeImgWidth - 1) !== 0 && (navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/) || navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 9_/) || navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 10_/) || navigator.userAgent.match(/Trident.*rv[ :]*11\\./)))) {\n        // Enable WebGL on canvas\n        if (!gl) gl = canvas.getContext(\"experimental-webgl\", {\n          alpha: false,\n          depth: false\n        });\n        if (gl && gl.getError() == 1286) handleWebGLError1286();\n      } // If there is no WebGL, fall back to CSS 3D transform renderer.\n      // This will discard the image loaded so far and load the fallback image.\n      // While browser specific tests are usually frowned upon, the\n      // fallback viewer only really works with WebKit/Blink and IE 10/11\n      // (it doesn't work properly in Firefox).\n\n\n      if (!gl && (imageType == \"multires\" && image.hasOwnProperty(\"fallbackPath\") || imageType == \"cubemap\") && (\"WebkitAppearance\" in document.documentElement.style || navigator.userAgent.match(/Trident.*rv[ :]*11\\./) || navigator.appVersion.indexOf(\"MSIE 10\") !== -1)) {\n        // Remove old world if it exists\n        if (world) {\n          container.removeChild(world);\n        } // Initialize renderer\n\n\n        world = document.createElement(\"div\");\n        world.className = \"pnlm-world\"; // Add images\n\n        var path;\n\n        if (image.basePath) {\n          path = image.basePath + image.fallbackPath;\n        } else {\n          path = image.fallbackPath;\n        }\n\n        var sides = [\"f\", \"r\", \"b\", \"l\", \"u\", \"d\"];\n        var loaded = 0;\n\n        var onLoad = function onLoad() {\n          // Draw image on canvas\n          var faceCanvas = document.createElement(\"canvas\");\n          faceCanvas.className = \"pnlm-face pnlm-\" + sides[this.side] + \"face\";\n          world.appendChild(faceCanvas);\n          var faceContext = faceCanvas.getContext(\"2d\");\n          faceCanvas.style.width = this.width + 4 + \"px\";\n          faceCanvas.style.height = this.height + 4 + \"px\";\n          faceCanvas.width = this.width + 4;\n          faceCanvas.height = this.height + 4;\n          faceContext.drawImage(this, 2, 2);\n          var imgData = faceContext.getImageData(0, 0, faceCanvas.width, faceCanvas.height);\n          var data = imgData.data; // Duplicate edge pixels\n\n          var i;\n          var j;\n\n          for (i = 2; i < faceCanvas.width - 2; i++) {\n            for (j = 0; j < 4; j++) {\n              data[(i + faceCanvas.width) * 4 + j] = data[(i + faceCanvas.width * 2) * 4 + j];\n              data[(i + faceCanvas.width * (faceCanvas.height - 2)) * 4 + j] = data[(i + faceCanvas.width * (faceCanvas.height - 3)) * 4 + j];\n            }\n          }\n\n          for (i = 2; i < faceCanvas.height - 2; i++) {\n            for (j = 0; j < 4; j++) {\n              data[(i * faceCanvas.width + 1) * 4 + j] = data[(i * faceCanvas.width + 2) * 4 + j];\n              data[((i + 1) * faceCanvas.width - 2) * 4 + j] = data[((i + 1) * faceCanvas.width - 3) * 4 + j];\n            }\n          }\n\n          for (j = 0; j < 4; j++) {\n            data[(faceCanvas.width + 1) * 4 + j] = data[(faceCanvas.width * 2 + 2) * 4 + j];\n            data[(faceCanvas.width * 2 - 2) * 4 + j] = data[(faceCanvas.width * 3 - 3) * 4 + j];\n            data[(faceCanvas.width * (faceCanvas.height - 2) + 1) * 4 + j] = data[(faceCanvas.width * (faceCanvas.height - 3) + 2) * 4 + j];\n            data[(faceCanvas.width * (faceCanvas.height - 1) - 2) * 4 + j] = data[(faceCanvas.width * (faceCanvas.height - 2) - 3) * 4 + j];\n          }\n\n          for (i = 1; i < faceCanvas.width - 1; i++) {\n            for (j = 0; j < 4; j++) {\n              data[i * 4 + j] = data[(i + faceCanvas.width) * 4 + j];\n              data[(i + faceCanvas.width * (faceCanvas.height - 1)) * 4 + j] = data[(i + faceCanvas.width * (faceCanvas.height - 2)) * 4 + j];\n            }\n          }\n\n          for (i = 1; i < faceCanvas.height - 1; i++) {\n            for (j = 0; j < 4; j++) {\n              data[i * faceCanvas.width * 4 + j] = data[(i * faceCanvas.width + 1) * 4 + j];\n              data[((i + 1) * faceCanvas.width - 1) * 4 + j] = data[((i + 1) * faceCanvas.width - 2) * 4 + j];\n            }\n          }\n\n          for (j = 0; j < 4; j++) {\n            data[j] = data[(faceCanvas.width + 1) * 4 + j];\n            data[(faceCanvas.width - 1) * 4 + j] = data[(faceCanvas.width * 2 - 2) * 4 + j];\n            data[faceCanvas.width * (faceCanvas.height - 1) * 4 + j] = data[(faceCanvas.width * (faceCanvas.height - 2) + 1) * 4 + j];\n            data[(faceCanvas.width * faceCanvas.height - 1) * 4 + j] = data[(faceCanvas.width * (faceCanvas.height - 1) - 2) * 4 + j];\n          } // Draw image width duplicated edge pixels on canvas\n\n\n          faceContext.putImageData(imgData, 0, 0);\n          incLoaded.call(this);\n        };\n\n        var incLoaded = function incLoaded() {\n          if (this.width > 0) {\n            if (fallbackImgSize === undefined$1) fallbackImgSize = this.width;\n            if (fallbackImgSize != this.width) console.log(\"Fallback faces have inconsistent widths: \" + fallbackImgSize + \" vs. \" + this.width);\n          } else faceMissing = true;\n\n          loaded++;\n\n          if (loaded == 6) {\n            fallbackImgSize = this.width;\n            container.appendChild(world);\n            callback();\n          }\n        };\n\n        faceMissing = false;\n\n        for (s = 0; s < 6; s++) {\n          var faceImg = new Image();\n          faceImg.crossOrigin = globalParams.crossOrigin ? globalParams.crossOrigin : \"anonymous\";\n          faceImg.side = s;\n          faceImg.onload = onLoad;\n          faceImg.onerror = incLoaded; // ignore missing face to support partial fallback image\n\n          if (imageType == \"multires\") {\n            faceImg.src = path.replace(\"%s\", sides[s]) + \".\" + image.extension;\n          } else {\n            faceImg.src = image[s].src;\n          }\n        }\n\n        fillMissingFaces(fallbackImgSize);\n        return;\n      } else if (!gl) {\n        console.log(\"Error: no WebGL support detected!\");\n        throw {\n          type: \"no webgl\"\n        };\n      }\n\n      if (imageType == \"cubemap\") fillMissingFaces(cubeImgWidth);\n\n      if (image.basePath) {\n        image.fullpath = image.basePath + image.path;\n      } else {\n        image.fullpath = image.path;\n      }\n\n      image.invTileResolution = 1 / image.tileResolution;\n      var vertices = createCube();\n      vtmps = [];\n\n      for (s = 0; s < 6; s++) {\n        vtmps[s] = vertices.slice(s * 12, s * 12 + 12);\n        vertices = createCube();\n      } // Make sure image isn't too big\n\n\n      var maxWidth = 0;\n\n      if (imageType == \"equirectangular\") {\n        maxWidth = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n\n        if (Math.max(image.width / 2, image.height) > maxWidth) {\n          console.log(\"Error: The image is too big; it's \" + image.width + \"px wide, \" + \"but this device's maximum supported size is \" + maxWidth * 2 + \"px.\");\n          throw {\n            type: \"webgl size error\",\n            width: image.width,\n            maxWidth: maxWidth * 2\n          };\n        }\n      } else if (imageType == \"cubemap\") {\n        if (cubeImgWidth > gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE)) {\n          console.log(\"Error: The image is too big; it's \" + cubeImgWidth + \"px wide, \" + \"but this device's maximum supported size is \" + maxWidth + \"px.\");\n          throw {\n            type: \"webgl size error\",\n            width: cubeImgWidth,\n            maxWidth: maxWidth\n          };\n        }\n      } // Store horizon pitch and roll if applicable\n\n\n      if (params !== undefined$1 && (params.horizonPitch !== undefined$1 || params.horizonRoll !== undefined$1)) pose = [params.horizonPitch == undefined$1 ? 0 : params.horizonPitch, params.horizonRoll == undefined$1 ? 0 : params.horizonRoll]; // Set 2d texture binding\n\n      var glBindType = gl.TEXTURE_2D; // Create viewport for entire canvas\n\n      gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight); // Check precision support\n\n      if (gl.getShaderPrecisionFormat) {\n        var precision = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);\n\n        if (precision && precision.precision < 1) {\n          // `highp` precision not supported; https://stackoverflow.com/a/33308927\n          fragEquiCubeBase = fragEquiCubeBase.replace(\"highp\", \"mediump\");\n        }\n      } // Create vertex shader\n\n\n      vs = gl.createShader(gl.VERTEX_SHADER);\n      var vertexSrc = v;\n\n      if (imageType == \"multires\") {\n        vertexSrc = vMulti;\n      }\n\n      gl.shaderSource(vs, vertexSrc);\n      gl.compileShader(vs); // Create fragment shader\n\n      fs = gl.createShader(gl.FRAGMENT_SHADER);\n      var fragmentSrc = fragEquirectangular;\n\n      if (imageType == \"cubemap\") {\n        glBindType = gl.TEXTURE_CUBE_MAP;\n        fragmentSrc = fragCube;\n      } else if (imageType == \"multires\") {\n        fragmentSrc = fragMulti;\n      }\n\n      gl.shaderSource(fs, fragmentSrc);\n      gl.compileShader(fs); // Link WebGL program\n\n      program = gl.createProgram();\n      gl.attachShader(program, vs);\n      gl.attachShader(program, fs);\n      gl.linkProgram(program); // Log errors\n\n      if (!gl.getShaderParameter(vs, gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(vs));\n      if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS)) console.log(gl.getShaderInfoLog(fs));\n      if (!gl.getProgramParameter(program, gl.LINK_STATUS)) console.log(gl.getProgramInfoLog(program)); // Use WebGL program\n\n      gl.useProgram(program);\n      program.drawInProgress = false; // Set background clear color (does not apply to cubemap/fallback image)\n\n      var color = params.backgroundColor ? params.backgroundColor : [0, 0, 0];\n      gl.clearColor(color[0], color[1], color[2], 1.0);\n      gl.clear(gl.COLOR_BUFFER_BIT); // Look up texture coordinates location\n\n      program.texCoordLocation = gl.getAttribLocation(program, \"a_texCoord\");\n      gl.enableVertexAttribArray(program.texCoordLocation);\n\n      if (imageType != \"multires\") {\n        // Provide texture coordinates for rectangle\n        if (!texCoordBuffer) texCoordBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, texCoordBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1, 1, 1, 1, 1, -1, -1, 1, 1, -1, -1, -1]), gl.STATIC_DRAW);\n        gl.vertexAttribPointer(program.texCoordLocation, 2, gl.FLOAT, false, 0, 0); // Pass aspect ratio\n\n        program.aspectRatio = gl.getUniformLocation(program, \"u_aspectRatio\");\n        gl.uniform1f(program.aspectRatio, gl.drawingBufferWidth / gl.drawingBufferHeight); // Locate psi, theta, focal length, horizontal extent, vertical extent, and vertical offset\n\n        program.psi = gl.getUniformLocation(program, \"u_psi\");\n        program.theta = gl.getUniformLocation(program, \"u_theta\");\n        program.f = gl.getUniformLocation(program, \"u_f\");\n        program.h = gl.getUniformLocation(program, \"u_h\");\n        program.v = gl.getUniformLocation(program, \"u_v\");\n        program.vo = gl.getUniformLocation(program, \"u_vo\");\n        program.rot = gl.getUniformLocation(program, \"u_rot\"); // Pass horizontal extent, vertical extent, and vertical offset\n\n        gl.uniform1f(program.h, haov / (Math.PI * 2.0));\n        gl.uniform1f(program.v, vaov / Math.PI);\n        gl.uniform1f(program.vo, voffset / Math.PI * 2); // Set background color\n\n        if (imageType == \"equirectangular\") {\n          program.backgroundColor = gl.getUniformLocation(program, \"u_backgroundColor\");\n          gl.uniform4fv(program.backgroundColor, color.concat([1]));\n        } // Create texture\n\n\n        program.texture = gl.createTexture();\n        gl.bindTexture(glBindType, program.texture); // Upload images to texture depending on type\n\n        if (imageType == \"cubemap\") {\n          // Load all six sides of the cube map\n          gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[1]);\n          gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_X, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[3]);\n          gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Y, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[4]);\n          gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Y, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[5]);\n          gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Z, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[0]);\n          gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Z, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[2]);\n        } else {\n          if (image.width <= maxWidth) {\n            gl.uniform1i(gl.getUniformLocation(program, \"u_splitImage\"), 0); // Upload image to the texture\n\n            gl.texImage2D(glBindType, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image);\n          } else {\n            // Image needs to be split into two parts due to texture size limits\n            gl.uniform1i(gl.getUniformLocation(program, \"u_splitImage\"), 1); // Draw image on canvas\n\n            var cropCanvas = document.createElement(\"canvas\");\n            cropCanvas.width = image.width / 2;\n            cropCanvas.height = image.height;\n            var cropContext = cropCanvas.getContext(\"2d\");\n            cropContext.drawImage(image, 0, 0); // Upload first half of image to the texture\n\n            var cropImage = cropContext.getImageData(0, 0, image.width / 2, image.height);\n            gl.texImage2D(glBindType, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, cropImage); // Create and bind texture for second half of image\n\n            program.texture2 = gl.createTexture();\n            gl.activeTexture(gl.TEXTURE1);\n            gl.bindTexture(glBindType, program.texture2);\n            gl.uniform1i(gl.getUniformLocation(program, \"u_image1\"), 1); // Upload second half of image to the texture\n\n            cropContext.drawImage(image, -image.width / 2, 0);\n            cropImage = cropContext.getImageData(0, 0, image.width / 2, image.height);\n            gl.texImage2D(glBindType, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, cropImage); // Set parameters for rendering any size\n\n            gl.texParameteri(glBindType, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n            gl.texParameteri(glBindType, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n            gl.texParameteri(glBindType, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n            gl.texParameteri(glBindType, gl.TEXTURE_MAG_FILTER, gl.LINEAR); // Reactivate first texture unit\n\n            gl.activeTexture(gl.TEXTURE0);\n          }\n        } // Set parameters for rendering any size\n\n\n        gl.texParameteri(glBindType, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(glBindType, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(glBindType, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(glBindType, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      } else {\n        // Look up vertex coordinates location\n        program.vertPosLocation = gl.getAttribLocation(program, \"a_vertCoord\");\n        gl.enableVertexAttribArray(program.vertPosLocation); // Create buffers\n\n        if (!cubeVertBuf) cubeVertBuf = gl.createBuffer();\n        if (!cubeVertTexCoordBuf) cubeVertTexCoordBuf = gl.createBuffer();\n        if (!cubeVertIndBuf) cubeVertIndBuf = gl.createBuffer(); // Bind texture coordinate buffer and pass coordinates to WebGL\n\n        gl.bindBuffer(gl.ARRAY_BUFFER, cubeVertTexCoordBuf);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]), gl.STATIC_DRAW); // Bind square index buffer and pass indicies to WebGL\n\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, cubeVertIndBuf);\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array([0, 1, 2, 0, 2, 3]), gl.STATIC_DRAW); // Find uniforms\n\n        program.perspUniform = gl.getUniformLocation(program, \"u_perspMatrix\");\n        program.cubeUniform = gl.getUniformLocation(program, \"u_cubeMatrix\"); //program.colorUniform = gl.getUniformLocation(program, 'u_color');\n\n        program.level = -1;\n        program.currentNodes = [];\n        program.nodeCache = [];\n        program.nodeCacheTimestamp = 0;\n      } // Check if there was an error\n\n\n      var err = gl.getError();\n\n      if (err !== 0) {\n        console.log(\"Error: Something went wrong with WebGL!\", err);\n        throw {\n          type: \"webgl error\"\n        };\n      }\n\n      callback();\n    }, \"ZdQBZ3rq7bWAAMQq6hlVCmYF0jM=\", false, function () {\n      return [gl.useProgram];\n    });\n    /**\r\n     * Destroy renderer.\r\n     * @memberof Renderer\r\n     * @instance\r\n     */\n\n    this.destroy = function () {\n      if (container !== undefined$1) {\n        if (canvas !== undefined$1 && container.contains(canvas)) {\n          container.removeChild(canvas);\n        }\n\n        if (world !== undefined$1 && container.contains(world)) {\n          container.removeChild(world);\n        }\n      }\n\n      if (gl) {\n        // The spec says this is only supposed to simulate losing the WebGL\n        // context, but in practice it tends to actually free the memory.\n        var extension = gl.getExtension(\"WEBGL_lose_context\");\n        if (extension) extension.loseContext();\n      }\n    };\n    /**\r\n     * Resize renderer (call after resizing container).\r\n     * @memberof Renderer\r\n     * @instance\r\n     */\n\n\n    this.resize = function () {\n      var pixelRatio = window.devicePixelRatio || 1;\n      canvas.width = canvas.clientWidth * pixelRatio;\n      canvas.height = canvas.clientHeight * pixelRatio;\n\n      if (gl) {\n        if (gl.getError() == 1286) handleWebGLError1286();\n        gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n        if (imageType != \"multires\") {\n          gl.uniform1f(program.aspectRatio, canvas.clientWidth / canvas.clientHeight);\n        }\n      }\n    }; // Initialize canvas size\n\n\n    this.resize();\n    /**\r\n     * Set renderer horizon pitch and roll.\r\n     * @memberof Renderer\r\n     * @instance\r\n     */\n\n    this.setPose = function (horizonPitch, horizonRoll) {\n      pose = [horizonPitch, horizonRoll];\n    };\n    /**\r\n     * Render new view of panorama.\r\n     * @memberof Renderer\r\n     * @instance\r\n     * @param {number} pitch - Pitch to render at (in radians).\r\n     * @param {number} yaw - Yaw to render at (in radians).\r\n     * @param {number} hfov - Horizontal field of view to render with (in radians).\r\n     * @param {Object} [params] - Extra configuration parameters.\r\n     * @param {number} [params.roll] - Camera roll (in radians).\r\n     * @param {boolean} [params.returnImage] - Return rendered image?\r\n     */\n\n\n    this.render = function (pitch, yaw, hfov, params) {\n      var focal,\n          i,\n          s,\n          roll = 0;\n      if (params === undefined$1) params = {};\n      if (params.roll) roll = params.roll; // Apply pitch and roll transformation if applicable\n\n      if (pose !== undefined$1) {\n        var horizonPitch = pose[0],\n            horizonRoll = pose[1]; // Calculate new pitch and yaw\n\n        var orig_pitch = pitch,\n            orig_yaw = yaw,\n            x = Math.cos(horizonRoll) * Math.sin(pitch) * Math.sin(horizonPitch) + Math.cos(pitch) * (Math.cos(horizonPitch) * Math.cos(yaw) + Math.sin(horizonRoll) * Math.sin(horizonPitch) * Math.sin(yaw)),\n            y = -Math.sin(pitch) * Math.sin(horizonRoll) + Math.cos(pitch) * Math.cos(horizonRoll) * Math.sin(yaw),\n            z = Math.cos(horizonRoll) * Math.cos(horizonPitch) * Math.sin(pitch) + Math.cos(pitch) * (-Math.cos(yaw) * Math.sin(horizonPitch) + Math.cos(horizonPitch) * Math.sin(horizonRoll) * Math.sin(yaw));\n        pitch = Math.asin(Math.max(Math.min(z, 1), -1));\n        yaw = Math.atan2(y, x); // Calculate roll\n\n        var v = [Math.cos(orig_pitch) * (Math.sin(horizonRoll) * Math.sin(horizonPitch) * Math.cos(orig_yaw) - Math.cos(horizonPitch) * Math.sin(orig_yaw)), Math.cos(orig_pitch) * Math.cos(horizonRoll) * Math.cos(orig_yaw), Math.cos(orig_pitch) * (Math.cos(horizonPitch) * Math.sin(horizonRoll) * Math.cos(orig_yaw) + Math.sin(orig_yaw) * Math.sin(horizonPitch))],\n            w = [-Math.cos(pitch) * Math.sin(yaw), Math.cos(pitch) * Math.cos(yaw)];\n        var roll_adj = Math.acos(Math.max(Math.min((v[0] * w[0] + v[1] * w[1]) / (Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]) * Math.sqrt(w[0] * w[0] + w[1] * w[1])), 1), -1));\n        if (v[2] < 0) roll_adj = 2 * Math.PI - roll_adj;\n        roll += roll_adj;\n      } // If no WebGL\n\n\n      if (!gl && (imageType == \"multires\" || imageType == \"cubemap\")) {\n        // Determine face transforms\n        s = fallbackImgSize / 2;\n        var transforms = {\n          f: \"translate3d(-\" + (s + 2) + \"px, -\" + (s + 2) + \"px, -\" + s + \"px)\",\n          b: \"translate3d(\" + (s + 2) + \"px, -\" + (s + 2) + \"px, \" + s + \"px) rotateX(180deg) rotateZ(180deg)\",\n          u: \"translate3d(-\" + (s + 2) + \"px, -\" + s + \"px, \" + (s + 2) + \"px) rotateX(270deg)\",\n          d: \"translate3d(-\" + (s + 2) + \"px, \" + s + \"px, -\" + (s + 2) + \"px) rotateX(90deg)\",\n          l: \"translate3d(-\" + s + \"px, -\" + (s + 2) + \"px, \" + (s + 2) + \"px) rotateX(180deg) rotateY(90deg) rotateZ(180deg)\",\n          r: \"translate3d(\" + s + \"px, -\" + (s + 2) + \"px, -\" + (s + 2) + \"px) rotateY(270deg)\"\n        };\n        focal = 1 / Math.tan(hfov / 2);\n        var zoom = focal * canvas.clientWidth / 2 + \"px\";\n        var transform = \"perspective(\" + zoom + \") translateZ(\" + zoom + \") rotateX(\" + pitch + \"rad) rotateY(\" + yaw + \"rad) \"; // Apply face transforms\n\n        var faces = Object.keys(transforms);\n\n        for (i = 0; i < 6; i++) {\n          var face = world.querySelector(\".pnlm-\" + faces[i] + \"face\");\n          if (!face) continue; // ignore missing face to support partial cubemap/fallback image\n\n          face.style.webkitTransform = transform + transforms[faces[i]];\n          face.style.transform = transform + transforms[faces[i]];\n        }\n\n        return;\n      }\n\n      if (imageType != \"multires\") {\n        // Calculate focal length from vertical field of view\n        var vfov = 2 * Math.atan(Math.tan(hfov * 0.5) / (gl.drawingBufferWidth / gl.drawingBufferHeight));\n        focal = 1 / Math.tan(vfov * 0.5); // Pass psi, theta, roll, and focal length\n\n        gl.uniform1f(program.psi, yaw);\n        gl.uniform1f(program.theta, pitch);\n        gl.uniform1f(program.rot, roll);\n        gl.uniform1f(program.f, focal);\n\n        if (dynamic === true) {\n          // Update texture if dynamic\n          if (imageType == \"equirectangular\") {\n            gl.bindTexture(gl.TEXTURE_2D, program.texture);\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image);\n          }\n        } // Draw using current buffer\n\n\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\n      } else {\n        // Create perspective matrix\n        var perspMatrix = makePersp(hfov, gl.drawingBufferWidth / gl.drawingBufferHeight, 0.1, 100.0); // Find correct zoom level\n\n        checkZoom(hfov); // Create rotation matrix\n\n        var matrix = identityMatrix3();\n        matrix = rotateMatrix(matrix, -roll, \"z\");\n        matrix = rotateMatrix(matrix, -pitch, \"x\");\n        matrix = rotateMatrix(matrix, yaw, \"y\");\n        matrix = makeMatrix4(matrix); // Set matrix uniforms\n\n        gl.uniformMatrix4fv(program.perspUniform, false, new Float32Array(transposeMatrix4(perspMatrix)));\n        gl.uniformMatrix4fv(program.cubeUniform, false, new Float32Array(transposeMatrix4(matrix))); // Find current nodes\n\n        var rotPersp = rotatePersp(perspMatrix, matrix);\n        program.nodeCache.sort(multiresNodeSort);\n\n        if (program.nodeCache.length > 200 && program.nodeCache.length > program.currentNodes.length + 50) {\n          // Remove older nodes from cache\n          var removed = program.nodeCache.splice(200, program.nodeCache.length - 200);\n\n          for (var j = 0; j < removed.length; j++) {\n            // Explicitly delete textures\n            gl.deleteTexture(removed[j].texture);\n          }\n        }\n\n        program.currentNodes = [];\n        var sides = [\"f\", \"b\", \"u\", \"d\", \"l\", \"r\"];\n\n        for (s = 0; s < 6; s++) {\n          var ntmp = new MultiresNode(vtmps[s], sides[s], 1, 0, 0, image.fullpath);\n          testMultiresNode(rotPersp, ntmp, pitch, yaw);\n        }\n\n        program.currentNodes.sort(multiresNodeRenderSort); // Unqueue any pending requests for nodes that are no longer visible\n\n        for (i = pendingTextureRequests.length - 1; i >= 0; i--) {\n          if (program.currentNodes.indexOf(pendingTextureRequests[i].node) === -1) {\n            pendingTextureRequests[i].node.textureLoad = false;\n            pendingTextureRequests.splice(i, 1);\n          }\n        } // Allow one request to be pending, so that we can create a texture buffer for that in advance of loading actually beginning\n\n\n        if (pendingTextureRequests.length === 0) {\n          for (i = 0; i < program.currentNodes.length; i++) {\n            var node = program.currentNodes[i];\n\n            if (!node.texture && !node.textureLoad) {\n              node.textureLoad = true;\n              setTimeout(processNextTile, 0, node); // Only process one tile per frame to improve responsiveness\n\n              break;\n            }\n          }\n        } // Draw tiles\n\n\n        multiresDraw();\n      }\n\n      if (params.returnImage !== undefined$1) {\n        return canvas.toDataURL(\"image/png\");\n      }\n    };\n    /**\r\n     * Check if images are loading.\r\n     * @memberof Renderer\r\n     * @instance\r\n     * @returns {boolean} Whether or not images are loading.\r\n     */\n\n\n    this.isLoading = function () {\n      if (gl && imageType == \"multires\") {\n        for (var i = 0; i < program.currentNodes.length; i++) {\n          if (!program.currentNodes[i].textureLoaded) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    };\n    /**\r\n     * Retrieve renderer's canvas.\r\n     * @memberof Renderer\r\n     * @instance\r\n     * @returns {HTMLElement} Renderer's canvas.\r\n     */\n\n\n    this.getCanvas = function () {\n      return canvas;\n    };\n    /**\r\n     * Sorting method for multires nodes.\r\n     * @private\r\n     * @param {MultiresNode} a - First node.\r\n     * @param {MultiresNode} b - Second node.\r\n     * @returns {number} Base tiles first, then higher timestamp first.\r\n     */\n\n\n    function multiresNodeSort(a, b) {\n      // Base tiles are always first\n      if (a.level == 1 && b.level != 1) {\n        return -1;\n      }\n\n      if (b.level == 1 && a.level != 1) {\n        return 1;\n      } // Higher timestamp first\n\n\n      return b.timestamp - a.timestamp;\n    }\n    /**\r\n     * Sorting method for multires node rendering.\r\n     * @private\r\n     * @param {MultiresNode} a - First node.\r\n     * @param {MultiresNode} b - Second node.\r\n     * @returns {number} Lower zoom levels first, then closest to center first.\r\n     */\n\n\n    function multiresNodeRenderSort(a, b) {\n      // Lower zoom levels first\n      if (a.level != b.level) {\n        return a.level - b.level;\n      } // Lower distance from center first\n\n\n      return a.diff - b.diff;\n    }\n    /**\r\n     * Draws multires nodes.\r\n     * @private\r\n     */\n\n\n    function multiresDraw() {\n      if (!program.drawInProgress) {\n        program.drawInProgress = true;\n        gl.clear(gl.COLOR_BUFFER_BIT);\n\n        for (var i = 0; i < program.currentNodes.length; i++) {\n          if (program.currentNodes[i].textureLoaded > 1) {\n            //var color = program.currentNodes[i].color;\n            //gl.uniform4f(program.colorUniform, color[0], color[1], color[2], 1.0);\n            // Bind vertex buffer and pass vertices to WebGL\n            gl.bindBuffer(gl.ARRAY_BUFFER, cubeVertBuf);\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(program.currentNodes[i].vertices), gl.STATIC_DRAW);\n            gl.vertexAttribPointer(program.vertPosLocation, 3, gl.FLOAT, false, 0, 0); // Prep for texture\n\n            gl.bindBuffer(gl.ARRAY_BUFFER, cubeVertTexCoordBuf);\n            gl.vertexAttribPointer(program.texCoordLocation, 2, gl.FLOAT, false, 0, 0); // Bind texture and draw tile\n\n            gl.bindTexture(gl.TEXTURE_2D, program.currentNodes[i].texture); // Bind program.currentNodes[i].texture to TEXTURE0\n\n            gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\n          }\n        }\n\n        program.drawInProgress = false;\n      }\n    }\n    /**\r\n     * Creates new multires node.\r\n     * @constructor\r\n     * @private\r\n     * @param {number[]} vertices - Node's verticies.\r\n     * @param {string} side - Node's cube face.\r\n     * @param {number} level - Node's zoom level.\r\n     * @param {number} x - Node's x position.\r\n     * @param {number} y - Node's y position.\r\n     * @param {string} path - Node's path.\r\n     */\n\n\n    function MultiresNode(vertices, side, level, x, y, path) {\n      this.vertices = vertices;\n      this.side = side;\n      this.level = level;\n      this.x = x;\n      this.y = y;\n      this.path = path.replace(\"%s\", side).replace(\"%l\", level).replace(\"%x\", x).replace(\"%y\", y);\n    }\n    /**\r\n     * Test if multires node is visible. If it is, add it to current nodes,\r\n     * load its texture, and load appropriate child nodes.\r\n     * @private\r\n     * @param {number[]} rotPersp - Rotated perspective matrix.\r\n     * @param {MultiresNode} node - Multires node to check.\r\n     * @param {number} pitch - Pitch to check at.\r\n     * @param {number} yaw - Yaw to check at.\r\n     * @param {number} hfov - Horizontal field of view to check at.\r\n     */\n\n\n    function testMultiresNode(rotPersp, node, pitch, yaw, hfov) {\n      if (checkSquareInView(rotPersp, node.vertices)) {\n        // Calculate central angle between center of view and center of tile\n        var v = node.vertices;\n        var x = v[0] + v[3] + v[6] + v[9];\n        var y = v[1] + v[4] + v[7] + v[10];\n        var z = v[2] + v[5] + v[8] + v[11];\n        var r = Math.sqrt(x * x + y * y + z * z);\n        var theta = Math.asin(z / r);\n        var phi = Math.atan2(y, x);\n        var ydiff = phi - yaw;\n        ydiff += ydiff > Math.PI ? -2 * Math.PI : ydiff < -Math.PI ? 2 * Math.PI : 0;\n        ydiff = Math.abs(ydiff);\n        node.diff = Math.acos(Math.sin(pitch) * Math.sin(theta) + Math.cos(pitch) * Math.cos(theta) * Math.cos(ydiff)); // Add node to current nodes and load texture if needed\n\n        var inCurrent = false;\n\n        for (var k = 0; k < program.nodeCache.length; k++) {\n          if (program.nodeCache[k].path == node.path) {\n            inCurrent = true;\n            program.nodeCache[k].timestamp = program.nodeCacheTimestamp++;\n            program.nodeCache[k].diff = node.diff;\n            program.currentNodes.push(program.nodeCache[k]);\n            break;\n          }\n        }\n\n        if (!inCurrent) {\n          //node.color = [Math.random(), Math.random(), Math.random()];\n          node.timestamp = program.nodeCacheTimestamp++;\n          program.currentNodes.push(node);\n          program.nodeCache.push(node);\n        } // TODO: Test error\n        // Create child nodes\n\n\n        if (node.level < program.level) {\n          var cubeSize = image.cubeResolution * Math.pow(2, node.level - image.maxLevel);\n          var numTiles = Math.ceil(cubeSize * image.invTileResolution) - 1;\n          var doubleTileSize = cubeSize % image.tileResolution * 2;\n          var lastTileSize = cubeSize * 2 % image.tileResolution;\n\n          if (lastTileSize === 0) {\n            lastTileSize = image.tileResolution;\n          }\n\n          if (doubleTileSize === 0) {\n            doubleTileSize = image.tileResolution * 2;\n          }\n\n          var f = 0.5;\n\n          if (node.x == numTiles || node.y == numTiles) {\n            f = 1.0 - image.tileResolution / (image.tileResolution + lastTileSize);\n          }\n\n          var i = 1.0 - f;\n          var children = [];\n          var vtmp, ntmp;\n          var f1 = f,\n              f2 = f,\n              f3 = f,\n              i1 = i,\n              i2 = i,\n              i3 = i; // Handle non-symmetric tiles\n\n          if (lastTileSize < image.tileResolution) {\n            if (node.x == numTiles && node.y != numTiles) {\n              f2 = 0.5;\n              i2 = 0.5;\n\n              if (node.side == \"d\" || node.side == \"u\") {\n                f3 = 0.5;\n                i3 = 0.5;\n              }\n            } else if (node.x != numTiles && node.y == numTiles) {\n              f1 = 0.5;\n              i1 = 0.5;\n\n              if (node.side == \"l\" || node.side == \"r\") {\n                f3 = 0.5;\n                i3 = 0.5;\n              }\n            }\n          } // Handle small tiles that have fewer than four children\n\n\n          if (doubleTileSize <= image.tileResolution) {\n            if (node.x == numTiles) {\n              f1 = 0;\n              i1 = 1;\n\n              if (node.side == \"l\" || node.side == \"r\") {\n                f3 = 0;\n                i3 = 1;\n              }\n            }\n\n            if (node.y == numTiles) {\n              f2 = 0;\n              i2 = 1;\n\n              if (node.side == \"d\" || node.side == \"u\") {\n                f3 = 0;\n                i3 = 1;\n              }\n            }\n          }\n\n          vtmp = [v[0], v[1], v[2], v[0] * f1 + v[3] * i1, v[1] * f + v[4] * i, v[2] * f3 + v[5] * i3, v[0] * f1 + v[6] * i1, v[1] * f2 + v[7] * i2, v[2] * f3 + v[8] * i3, v[0] * f + v[9] * i, v[1] * f2 + v[10] * i2, v[2] * f3 + v[11] * i3];\n          ntmp = new MultiresNode(vtmp, node.side, node.level + 1, node.x * 2, node.y * 2, image.fullpath);\n          children.push(ntmp);\n\n          if (!(node.x == numTiles && doubleTileSize <= image.tileResolution)) {\n            vtmp = [v[0] * f1 + v[3] * i1, v[1] * f + v[4] * i, v[2] * f3 + v[5] * i3, v[3], v[4], v[5], v[3] * f + v[6] * i, v[4] * f2 + v[7] * i2, v[5] * f3 + v[8] * i3, v[0] * f1 + v[6] * i1, v[1] * f2 + v[7] * i2, v[2] * f3 + v[8] * i3];\n            ntmp = new MultiresNode(vtmp, node.side, node.level + 1, node.x * 2 + 1, node.y * 2, image.fullpath);\n            children.push(ntmp);\n          }\n\n          if (!(node.x == numTiles && doubleTileSize <= image.tileResolution) && !(node.y == numTiles && doubleTileSize <= image.tileResolution)) {\n            vtmp = [v[0] * f1 + v[6] * i1, v[1] * f2 + v[7] * i2, v[2] * f3 + v[8] * i3, v[3] * f + v[6] * i, v[4] * f2 + v[7] * i2, v[5] * f3 + v[8] * i3, v[6], v[7], v[8], v[9] * f1 + v[6] * i1, v[10] * f + v[7] * i, v[11] * f3 + v[8] * i3];\n            ntmp = new MultiresNode(vtmp, node.side, node.level + 1, node.x * 2 + 1, node.y * 2 + 1, image.fullpath);\n            children.push(ntmp);\n          }\n\n          if (!(node.y == numTiles && doubleTileSize <= image.tileResolution)) {\n            vtmp = [v[0] * f + v[9] * i, v[1] * f2 + v[10] * i2, v[2] * f3 + v[11] * i3, v[0] * f1 + v[6] * i1, v[1] * f2 + v[7] * i2, v[2] * f3 + v[8] * i3, v[9] * f1 + v[6] * i1, v[10] * f + v[7] * i, v[11] * f3 + v[8] * i3, v[9], v[10], v[11]];\n            ntmp = new MultiresNode(vtmp, node.side, node.level + 1, node.x * 2, node.y * 2 + 1, image.fullpath);\n            children.push(ntmp);\n          }\n\n          for (var j = 0; j < children.length; j++) {\n            testMultiresNode(rotPersp, children[j], pitch, yaw);\n          }\n        }\n      }\n    }\n    /**\r\n     * Creates cube vertex array.\r\n     * @private\r\n     * @returns {number[]} Cube vertex array.\r\n     */\n\n\n    function createCube() {\n      return [-1, 1, -1, 1, 1, -1, 1, -1, -1, -1, -1, -1, // Front face\n      1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, // Back face\n      -1, 1, 1, 1, 1, 1, 1, 1, -1, -1, 1, -1, // Up face\n      -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, -1, 1, // Down face\n      -1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, 1, // Left face\n      1, 1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1 // Right face\n      ];\n    }\n    /**\r\n     * Creates 3x3 identity matrix.\r\n     * @private\r\n     * @returns {number[]} Identity matrix.\r\n     */\n\n\n    function identityMatrix3() {\n      return [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    }\n    /**\r\n     * Rotates a 3x3 matrix.\r\n     * @private\r\n     * @param {number[]} m - Matrix to rotate.\r\n     * @param {number[]} angle - Angle to rotate by in radians.\r\n     * @param {string} axis - Axis to rotate about (`x`, `y`, or `z`).\r\n     * @returns {number[]} Rotated matrix.\r\n     */\n\n\n    function rotateMatrix(m, angle, axis) {\n      var s = Math.sin(angle);\n      var c = Math.cos(angle);\n\n      if (axis == \"x\") {\n        return [m[0], c * m[1] + s * m[2], c * m[2] - s * m[1], m[3], c * m[4] + s * m[5], c * m[5] - s * m[4], m[6], c * m[7] + s * m[8], c * m[8] - s * m[7]];\n      }\n\n      if (axis == \"y\") {\n        return [c * m[0] - s * m[2], m[1], c * m[2] + s * m[0], c * m[3] - s * m[5], m[4], c * m[5] + s * m[3], c * m[6] - s * m[8], m[7], c * m[8] + s * m[6]];\n      }\n\n      if (axis == \"z\") {\n        return [c * m[0] + s * m[1], c * m[1] - s * m[0], m[2], c * m[3] + s * m[4], c * m[4] - s * m[3], m[5], c * m[6] + s * m[7], c * m[7] - s * m[6], m[8]];\n      }\n    }\n    /**\r\n     * Turns a 3x3 matrix into a 4x4 matrix.\r\n     * @private\r\n     * @param {number[]} m - Input matrix.\r\n     * @returns {number[]} Expanded matrix.\r\n     */\n\n\n    function makeMatrix4(m) {\n      return [m[0], m[1], m[2], 0, m[3], m[4], m[5], 0, m[6], m[7], m[8], 0, 0, 0, 0, 1];\n    }\n    /**\r\n     * Transposes a 4x4 matrix.\r\n     * @private\r\n     * @param {number[]} m - Input matrix.\r\n     * @returns {number[]} Transposed matrix.\r\n     */\n\n\n    function transposeMatrix4(m) {\n      return [m[0], m[4], m[8], m[12], m[1], m[5], m[9], m[13], m[2], m[6], m[10], m[14], m[3], m[7], m[11], m[15]];\n    }\n    /**\r\n     * Creates a perspective matrix.\r\n     * @private\r\n     * @param {number} hfov - Desired horizontal field of view.\r\n     * @param {number} aspect - Desired aspect ratio.\r\n     * @param {number} znear - Near distance.\r\n     * @param {number} zfar - Far distance.\r\n     * @returns {number[]} Generated perspective matrix.\r\n     */\n\n\n    function makePersp(hfov, aspect, znear, zfar) {\n      var fovy = 2 * Math.atan(Math.tan(hfov / 2) * gl.drawingBufferHeight / gl.drawingBufferWidth);\n      var f = 1 / Math.tan(fovy / 2);\n      return [f / aspect, 0, 0, 0, 0, f, 0, 0, 0, 0, (zfar + znear) / (znear - zfar), 2 * zfar * znear / (znear - zfar), 0, 0, -1, 0];\n    }\n    /**\r\n     * Processes a loaded texture image into a WebGL texture.\r\n     * @private\r\n     * @param {Image} img - Input image.\r\n     * @param {WebGLTexture} tex - Texture to bind image to.\r\n     */\n\n\n    function processLoadedTexture(img, tex) {\n      gl.bindTexture(gl.TEXTURE_2D, tex);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, img);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n    }\n\n    var pendingTextureRequests = []; // Based on http://blog.tojicode.com/2012/03/javascript-memory-optimization-and.html\n\n    var loadTexture = function () {\n      var cacheTop = 4; // Maximum number of concurrents loads\n\n      var textureImageCache = {};\n      var crossOrigin;\n\n      function TextureImageLoader() {\n        var self = this;\n        this.texture = this.callback = null;\n        this.image = new Image();\n        this.image.crossOrigin = crossOrigin ? crossOrigin : \"anonymous\";\n\n        var loadFn = function loadFn() {\n          if (self.image.width > 0 && self.image.height > 0) {\n            // ignore missing tile to supporting partial image\n            processLoadedTexture(self.image, self.texture);\n            self.callback(self.texture, true);\n          } else {\n            self.callback(self.texture, false);\n          }\n\n          releaseTextureImageLoader(self);\n        };\n\n        this.image.addEventListener(\"load\", loadFn);\n        this.image.addEventListener(\"error\", loadFn); // ignore missing tile file to support partial image, otherwise retry loop causes high CPU load\n      }\n\n      TextureImageLoader.prototype.loadTexture = function (src, texture, callback) {\n        this.texture = texture;\n        this.callback = callback;\n        this.image.src = src;\n      };\n\n      function PendingTextureRequest(node, src, texture, callback) {\n        this.node = node;\n        this.src = src;\n        this.texture = texture;\n        this.callback = callback;\n      }\n\n      function releaseTextureImageLoader(til) {\n        if (pendingTextureRequests.length) {\n          var req = pendingTextureRequests.shift();\n          til.loadTexture(req.src, req.texture, req.callback);\n        } else textureImageCache[cacheTop++] = til;\n      }\n\n      for (var i = 0; i < cacheTop; i++) {\n        textureImageCache[i] = new TextureImageLoader();\n      }\n\n      return function (node, src, callback, _crossOrigin) {\n        crossOrigin = _crossOrigin;\n        var texture = gl.createTexture();\n        if (cacheTop) textureImageCache[--cacheTop].loadTexture(src, texture, callback);else pendingTextureRequests.push(new PendingTextureRequest(node, src, texture, callback));\n        return texture;\n      };\n    }();\n    /**\r\n     * Loads image and creates texture for a multires node / tile.\r\n     * @private\r\n     * @param {MultiresNode} node - Input node.\r\n     */\n\n\n    function processNextTile(node) {\n      loadTexture(node, node.path + \".\" + image.extension, function (texture, loaded) {\n        node.texture = texture;\n        node.textureLoaded = loaded ? 2 : 1;\n      }, globalParams.crossOrigin);\n    }\n    /**\r\n     * Finds and applies optimal multires zoom level.\r\n     * @private\r\n     * @param {number} hfov - Horizontal field of view to check at.\r\n     */\n\n\n    function checkZoom(hfov) {\n      // Find optimal level\n      var newLevel = 1;\n\n      while (newLevel < image.maxLevel && gl.drawingBufferWidth > image.tileResolution * Math.pow(2, newLevel - 1) * Math.tan(hfov / 2) * 0.707) {\n        newLevel++;\n      } // Apply change\n\n\n      program.level = newLevel;\n    }\n    /**\r\n     * Rotates perspective matrix.\r\n     * @private\r\n     * @param {number[]} p - Perspective matrix.\r\n     * @param {number[]} r - Rotation matrix.\r\n     * @returns {number[]} Rotated matrix.\r\n     */\n\n\n    function rotatePersp(p, r) {\n      return [p[0] * r[0], p[0] * r[1], p[0] * r[2], 0, p[5] * r[4], p[5] * r[5], p[5] * r[6], 0, p[10] * r[8], p[10] * r[9], p[10] * r[10], p[11], -r[8], -r[9], -r[10], 0];\n    }\n    /**\r\n     * Applies rotated perspective matrix to a 3-vector\r\n     * (last element is inverted).\r\n     * @private\r\n     * @param {number[]} m - Rotated perspective matrix.\r\n     * @param {number[]} v - Input 3-vector.\r\n     * @returns {number[]} Resulting 4-vector.\r\n     */\n\n\n    function applyRotPerspToVec(m, v) {\n      return [m[0] * v[0] + m[1] * v[1] + m[2] * v[2], m[4] * v[0] + m[5] * v[1] + m[6] * v[2], m[11] + m[8] * v[0] + m[9] * v[1] + m[10] * v[2], 1 / (m[12] * v[0] + m[13] * v[1] + m[14] * v[2])];\n    }\n    /**\r\n     * Checks if a vertex is visible.\r\n     * @private\r\n     * @param {number[]} m - Rotated perspective matrix.\r\n     * @param {number[]} v - Input vertex.\r\n     * @returns {number} 1 or -1 if the vertex is or is not visible,\r\n     *      respectively.\r\n     */\n\n\n    function checkInView(m, v) {\n      var vpp = applyRotPerspToVec(m, v);\n      var winX = vpp[0] * vpp[3];\n      var winY = vpp[1] * vpp[3];\n      var winZ = vpp[2] * vpp[3];\n      var ret = [0, 0, 0];\n      if (winX < -1) ret[0] = -1;\n      if (winX > 1) ret[0] = 1;\n      if (winY < -1) ret[1] = -1;\n      if (winY > 1) ret[1] = 1;\n      if (winZ < -1 || winZ > 1) ret[2] = 1;\n      return ret;\n    }\n    /**\r\n     * Checks if a square (tile) is visible.\r\n     * @private\r\n     * @param {number[]} m - Rotated perspective matrix.\r\n     * @param {number[]} v - Square's vertex array.\r\n     * @returns {boolean} Whether or not the square is visible.\r\n     */\n\n\n    function checkSquareInView(m, v) {\n      var check1 = checkInView(m, v.slice(0, 3));\n      var check2 = checkInView(m, v.slice(3, 6));\n      var check3 = checkInView(m, v.slice(6, 9));\n      var check4 = checkInView(m, v.slice(9, 12));\n      var testX = check1[0] + check2[0] + check3[0] + check4[0];\n      if (testX == -4 || testX == 4) return false;\n      var testY = check1[1] + check2[1] + check3[1] + check4[1];\n      if (testY == -4 || testY == 4) return false;\n      var testZ = check1[2] + check2[2] + check3[2] + check4[2];\n      return testZ != 4;\n    }\n    /**\r\n     * On iOS (iPhone 5c, iOS 10.3), this WebGL error occurs when the canvas is\r\n     * too big. Unfortuately, there's no way to test for this beforehand, so we\r\n     * reduce the canvas size if this error is thrown.\r\n     * @private\r\n     */\n\n\n    function handleWebGLError1286() {\n      console.log(\"Reducing canvas size due to error 1286!\");\n      canvas.width = Math.round(canvas.width / 2);\n      canvas.height = Math.round(canvas.height / 2);\n    }\n  } // Vertex shader for equirectangular and cube\n\n\n  var v = [\"attribute vec2 a_texCoord;\", \"varying vec2 v_texCoord;\", \"void main() {\", // Set position\n  \"gl_Position = vec4(a_texCoord, 0.0, 1.0);\", // Pass the coordinates to the fragment shader\n  \"v_texCoord = a_texCoord;\", \"}\"].join(\"\"); // Vertex shader for multires\n\n  var vMulti = [\"attribute vec3 a_vertCoord;\", \"attribute vec2 a_texCoord;\", \"uniform mat4 u_cubeMatrix;\", \"uniform mat4 u_perspMatrix;\", \"varying mediump vec2 v_texCoord;\", \"void main(void) {\", // Set position\n  \"gl_Position = u_perspMatrix * u_cubeMatrix * vec4(a_vertCoord, 1.0);\", // Pass the coordinates to the fragment shader\n  \"v_texCoord = a_texCoord;\", \"}\"].join(\"\"); // Fragment shader\n\n  var fragEquiCubeBase = [\"precision highp float;\", // mediump looks bad on some mobile devices\n  \"uniform float u_aspectRatio;\", \"uniform float u_psi;\", \"uniform float u_theta;\", \"uniform float u_f;\", \"uniform float u_h;\", \"uniform float u_v;\", \"uniform float u_vo;\", \"uniform float u_rot;\", \"const float PI = 3.14159265358979323846264;\", // Texture\n  \"uniform sampler2D u_image0;\", \"uniform sampler2D u_image1;\", \"uniform bool u_splitImage;\", \"uniform samplerCube u_imageCube;\", // Coordinates passed in from vertex shader\n  \"varying vec2 v_texCoord;\", // Background color (display for partial panoramas)\n  \"uniform vec4 u_backgroundColor;\", \"void main() {\", // Map canvas/camera to sphere\n  \"float x = v_texCoord.x * u_aspectRatio;\", \"float y = v_texCoord.y;\", \"float sinrot = sin(u_rot);\", \"float cosrot = cos(u_rot);\", \"float rot_x = x * cosrot - y * sinrot;\", \"float rot_y = x * sinrot + y * cosrot;\", \"float sintheta = sin(u_theta);\", \"float costheta = cos(u_theta);\", \"float a = u_f * costheta - rot_y * sintheta;\", \"float root = sqrt(rot_x * rot_x + a * a);\", \"float lambda = atan(rot_x / root, a / root) + u_psi;\", \"float phi = atan((rot_y * costheta + u_f * sintheta) / root);\"].join(\"\\n\"); // Fragment shader\n\n  var fragCube = fragEquiCubeBase + [// Look up color from texture\n  \"float cosphi = cos(phi);\", \"gl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));\", \"}\"].join(\"\\n\"); // Fragment shader\n\n  var fragEquirectangular = fragEquiCubeBase + [// Wrap image\n  \"lambda = mod(lambda + PI, PI * 2.0) - PI;\", // Map texture to sphere\n  \"vec2 coord = vec2(lambda / PI, phi / (PI / 2.0));\", // Look up color from texture\n  // Map from [-1,1] to [0,1] and flip y-axis\n  \"if(coord.x < -u_h || coord.x > u_h || coord.y < -u_v + u_vo || coord.y > u_v + u_vo)\", \"gl_FragColor = u_backgroundColor;\", \"else {\", \"if(u_splitImage) {\", // Image was split into two textures to work around texture size limits\n  \"if(coord.x < 0.0)\", \"gl_FragColor = texture2D(u_image0, vec2((coord.x + u_h) / u_h, (-coord.y + u_v + u_vo) / (u_v * 2.0)));\", \"else\", \"gl_FragColor = texture2D(u_image1, vec2((coord.x + u_h) / u_h - 1.0, (-coord.y + u_v + u_vo) / (u_v * 2.0)));\", \"} else {\", \"gl_FragColor = texture2D(u_image0, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));\", \"}\", \"}\", \"}\"].join(\"\\n\"); // Fragment shader\n\n  var fragMulti = [\"varying mediump vec2 v_texCoord;\", \"uniform sampler2D u_sampler;\", //'uniform mediump vec4 u_color;',\n  \"void main(void) {\", // Look up color from texture\n  \"gl_FragColor = texture2D(u_sampler, v_texCoord);\", //    'gl_FragColor = u_color;',\n  \"}\"].join(\"\");\n  return {\n    renderer: function renderer(container, image, imagetype, dynamic) {\n      return new Renderer(container, image, imagetype, dynamic);\n    }\n  };\n}(typeof window === \"undefined\" ? null : window, typeof document === \"undefined\" ? null : document);\n\nvar pannellum = function (window, document, undefined$1) {\n  function Viewer(container, initialConfig) {\n    var _this = this; // Declare variables\n\n\n    let config,\n        renderer,\n        dLastPitch,\n        dLastYaw,\n        dLastHfov,\n        preview,\n        isAdd = {},\n        dTimeLookAtHotSpot = 600,\n        dTimeZoomInHotSpot = 1500,\n        dTimeZoomInAfterLoad = 500,\n        dTimeToLoad = 1500,\n        isUserInteracting = false,\n        latestInteraction = Date.now(),\n        onPointerDownPointerX = 0,\n        onPointerDownPointerY = 0,\n        onPointerDownPointerDist = -1,\n        onPointerDownYaw = 0,\n        onPointerDownPitch = 0,\n        keysDown = new Array(10),\n        fullscreenActive = false,\n        loaded,\n        error = false,\n        listenersAdded = false,\n        panoImage,\n        prevTime,\n        speed = {\n      yaw: 0,\n      pitch: 0,\n      hfov: 0\n    },\n        animating = false,\n        orientation = false,\n        orientationYawOffset = 0,\n        autoRotateStart,\n        autoRotateSpeed = 0,\n        origHfov,\n        origPitch,\n        animatedMove = {},\n        externalEventListeners = {},\n        specifiedPhotoSphereExcludes = [],\n        update = false,\n        // Should we update when still to render dynamic content\n    eps = 1e-6,\n        hotspotsCreated = false,\n        destroyed = false;\n    var defaultConfig = {\n      hfov: 100,\n      minHfov: 50,\n      multiResMinHfov: false,\n      maxHfov: 120,\n      pitch: 0,\n      minPitch: -90,\n      maxPitch: 90,\n      yaw: 0,\n      minYaw: -180,\n      maxYaw: 180,\n      roll: 0,\n      haov: 360,\n      vaov: 180,\n      vOffset: 0,\n      autoRotate: false,\n      autoRotateInactivityDelay: -1,\n      autoRotateStopDelay: 0,\n      type: \"equirectangular\",\n      northOffset: 0,\n      showFullscreenCtrl: true,\n      dynamic: false,\n      dynamicUpdate: false,\n      doubleClickZoom: true,\n      keyboardZoom: true,\n      mouseZoom: true,\n      showZoomCtrl: true,\n      autoLoad: false,\n      showControls: true,\n      orientationOnByDefault: false,\n      hotSpotDebug: false,\n      backgroundColor: [0, 0, 0],\n      avoidShowingBackground: false,\n      animationTimingFunction: timingFunction,\n      draggable: true,\n      disableKeyboardCtrl: false,\n      crossOrigin: \"anonymous\",\n      touchPanSpeedCoeffFactor: 1,\n      capturedKeyNumbers: [16, 17, 27, 37, 38, 39, 40, 61, 65, 68, 83, 87, 107, 109, 173, 187, 189],\n      friction: 0.15\n    }; // Translatable / configurable strings\n    // Some strings contain '%s', which is a placeholder for inserted values\n    // When setting strings in external configuration, `\\n` should be used instead of `<br>` to insert line breaks\n\n    defaultConfig.uiText = {\n      // Labels\n      loadButtonLabel: \"Click to<br>Load<br>Panorama\",\n      loadingLabel: \"Loading...\",\n      bylineLabel: \"by %s\",\n      // One substitution: author\n      // Errors\n      noPanoramaError: \"No panorama image was specified.\",\n      fileAccessError: \"The file %s could not be accessed.\",\n      // One substitution: file URL\n      malformedURLError: \"There is something wrong with the panorama URL.\",\n      iOS8WebGLError: \"Due to iOS 8's broken WebGL implementation, only \" + \"progressive encoded JPEGs work for your device (this \" + \"panorama uses standard encoding).\",\n      genericWebGLError: \"Your browser does not have the necessary WebGL support to display this panorama.\",\n      textureSizeError: \"This panorama is too big for your device! It's \" + \"%spx wide, but your device only supports images up to \" + \"%spx wide. Try another device.\" + \" (If you're the author, try scaling down the image.)\",\n      // Two substitutions: image width, max image width\n      unknownError: \"Unknown error. Check developer console.\"\n    }; // Initialize container\n\n    container = typeof container === \"string\" ? document.getElementById(container) : container;\n    container.classList.add(\"pnlm-container\");\n    container.tabIndex = 0; // Create container for ui\n\n    var uiContainer = document.createElement(\"div\");\n    uiContainer.className = \"pnlm-ui\";\n    container.appendChild(uiContainer); // Create container for renderer\n\n    var renderContainer = document.createElement(\"div\");\n    renderContainer.className = \"pnlm-render-container\";\n    container.appendChild(renderContainer);\n    var dragFix = document.createElement(\"div\");\n    dragFix.className = \"pnlm-dragfix\";\n    uiContainer.appendChild(dragFix); // Display about information on right click\n\n    var aboutMsg = document.createElement(\"span\");\n    aboutMsg.className = \"pnlm-about-msg\";\n    aboutMsg.innerHTML = '<a href=\"https://solutions.viettel.vn/vi\" target=\"_blank\">Viettel Solution</a>';\n    uiContainer.appendChild(aboutMsg);\n    dragFix.addEventListener(\"contextmenu\", aboutMessage); // Create info display\n\n    var infoDisplay = {}; // Hot spot debug indicator\n\n    var hotSpotDebugIndicator = document.createElement(\"div\");\n    hotSpotDebugIndicator.className = \"pnlm-sprite pnlm-hot-spot-debug-indicator\";\n    uiContainer.appendChild(hotSpotDebugIndicator); // Panorama info\n\n    infoDisplay.container = document.createElement(\"div\");\n    infoDisplay.container.className = \"pnlm-panorama-info\";\n    infoDisplay.title = document.createElement(\"div\");\n    infoDisplay.title.className = \"pnlm-title-box\";\n    infoDisplay.container.appendChild(infoDisplay.title);\n    infoDisplay.description = document.createElement(\"div\");\n    infoDisplay.description.className = \"pnlm-description-box\";\n    infoDisplay.container.appendChild(infoDisplay.description);\n    infoDisplay.author = document.createElement(\"div\");\n    infoDisplay.author.className = \"pnlm-author-box\";\n    infoDisplay.container.appendChild(infoDisplay.author);\n    uiContainer.appendChild(infoDisplay.container); // Load box\n\n    infoDisplay.load = {};\n    infoDisplay.load.box = document.createElement(\"div\");\n    infoDisplay.load.box.className = \"pnlm-load-box\";\n    infoDisplay.load.boxp = document.createElement(\"p\");\n    infoDisplay.load.box.appendChild(infoDisplay.load.boxp);\n    infoDisplay.load.lbox = document.createElement(\"div\");\n    infoDisplay.load.lbox.className = \"pnlm-lbox\";\n    infoDisplay.load.lbox.innerHTML = '<div class=\"pnlm-loading\"></div>';\n    infoDisplay.load.box.appendChild(infoDisplay.load.lbox);\n    infoDisplay.load.lbar = document.createElement(\"div\");\n    infoDisplay.load.lbar.className = \"pnlm-lbar\";\n    infoDisplay.load.lbarFill = document.createElement(\"div\");\n    infoDisplay.load.lbarFill.className = \"pnlm-lbar-fill\";\n    infoDisplay.load.lbar.appendChild(infoDisplay.load.lbarFill);\n    infoDisplay.load.box.appendChild(infoDisplay.load.lbar);\n    infoDisplay.load.msg = document.createElement(\"p\");\n    infoDisplay.load.msg.className = \"pnlm-lmsg\";\n    infoDisplay.load.box.appendChild(infoDisplay.load.msg);\n    uiContainer.appendChild(infoDisplay.load.box); // Error message\n\n    infoDisplay.errorMsg = document.createElement(\"div\");\n    infoDisplay.errorMsg.className = \"pnlm-error-msg pnlm-info-box\";\n    uiContainer.appendChild(infoDisplay.errorMsg); // Create controls\n\n    var controls = {};\n    controls.container = document.createElement(\"div\");\n    controls.container.className = \"pnlm-controls-container\";\n    uiContainer.appendChild(controls.container); // Load button\n\n    controls.load = document.createElement(\"div\");\n    controls.load.className = \"pnlm-load-button\";\n    controls.load.addEventListener(\"click\", function () {\n      processOptions();\n      load();\n    });\n    uiContainer.appendChild(controls.load); // Zoom controls\n\n    controls.zoom = document.createElement(\"div\");\n    controls.zoom.className = \"pnlm-zoom-controls pnlm-controls\";\n    controls.zoomIn = document.createElement(\"div\");\n    controls.zoomIn.className = \"pnlm-zoom-in pnlm-sprite pnlm-control\";\n    controls.zoomIn.addEventListener(\"click\", zoomIn);\n    controls.zoom.appendChild(controls.zoomIn);\n    controls.zoomOut = document.createElement(\"div\");\n    controls.zoomOut.className = \"pnlm-zoom-out pnlm-sprite pnlm-control\";\n    controls.zoomOut.addEventListener(\"click\", zoomOut);\n    controls.zoom.appendChild(controls.zoomOut);\n    controls.container.appendChild(controls.zoom); // Fullscreen toggle\n\n    controls.fullscreen = document.createElement(\"div\");\n    controls.fullscreen.addEventListener(\"click\", toggleFullscreen);\n    controls.fullscreen.className = \"pnlm-fullscreen-toggle-button pnlm-sprite pnlm-fullscreen-toggle-button-inactive pnlm-controls pnlm-control\";\n    if (document.fullscreenEnabled || document.mozFullScreenEnabled || document.webkitFullscreenEnabled || document.msFullscreenEnabled) controls.container.appendChild(controls.fullscreen); // Device orientation toggle\n\n    controls.orientation = document.createElement(\"div\");\n    controls.orientation.addEventListener(\"click\", function (e) {\n      if (orientation) stopOrientation();else startOrientation();\n    });\n    controls.orientation.addEventListener(\"mousedown\", function (e) {\n      e.stopPropagation();\n    });\n    controls.orientation.addEventListener(\"touchstart\", function (e) {\n      e.stopPropagation();\n    });\n    controls.orientation.addEventListener(\"pointerdown\", function (e) {\n      e.stopPropagation();\n    });\n    controls.orientation.className = \"pnlm-orientation-button pnlm-orientation-button-inactive pnlm-sprite pnlm-controls pnlm-control\";\n    var orientationSupport = false;\n\n    if (window.DeviceOrientationEvent && location.protocol === \"https:\" && navigator.userAgent.toLowerCase().indexOf(\"mobi\") >= 0) {\n      // This user agent check is here because there's no way to check if a\n      // device has an inertia measurement unit. We used to be able to check if a\n      // DeviceOrientationEvent had non-null values, but with iOS 13 requiring a\n      // permission prompt to access such events, this is no longer possible.\n      controls.container.appendChild(controls.orientation);\n      orientationSupport = true;\n    } // Compass\n\n\n    var compass = document.createElement(\"div\");\n    compass.className = \"pnlm-compass pnlm-controls pnlm-control\";\n    uiContainer.appendChild(compass); // Load and process configuration\n\n    if (initialConfig.firstScene) {\n      // Activate first scene if specified in URL\n      mergeConfig(initialConfig.firstScene);\n    } else if (initialConfig[\"default\"] && initialConfig[\"default\"].firstScene) {\n      // Activate first scene if specified in file\n      mergeConfig(initialConfig[\"default\"].firstScene);\n    } else {\n      mergeConfig(null);\n    }\n\n    processOptions(true);\n    /**\r\n     * Initializes viewer.\r\n     * @private\r\n     */\n\n    function init() {\n      // Display an error for IE 9 as it doesn't work but also doesn't otherwise\n      // show an error (older versions don't work at all)\n      // Based on: http://stackoverflow.com/a/10965203\n      var div = document.createElement(\"div\");\n      div.innerHTML = \"<!--[if lte IE 9]><i></i><![endif]-->\";\n\n      if (div.getElementsByTagName(\"i\").length === 1) {\n        anError();\n        return;\n      }\n\n      origHfov = config.hfov;\n      origPitch = config.pitch;\n      var i, p;\n\n      if (config.type === \"cubemap\") {\n        panoImage = [];\n\n        for (i = 0; i < 6; i++) {\n          panoImage.push(new Image());\n          panoImage[i].crossOrigin = config.crossOrigin;\n        }\n\n        infoDisplay.load.lbox.style.display = \"block\";\n        infoDisplay.load.lbar.style.display = \"none\";\n      } else if (config.type === \"multires\") {\n        var c = JSON.parse(JSON.stringify(config.multiRes)); // Deep copy\n        // Avoid \"undefined\" in path, check (optional) multiRes.basePath, too\n        // Use only multiRes.basePath if it's an absolute URL\n\n        if (config.basePath && config.multiRes.basePath && !/^(?:[a-z]+:)?\\/\\//i.test(config.multiRes.basePath)) {\n          c.basePath = config.basePath + config.multiRes.basePath;\n        } else if (config.multiRes.basePath) {\n          c.basePath = config.multiRes.basePath;\n        } else if (config.basePath) {\n          c.basePath = config.basePath;\n        }\n\n        panoImage = c;\n      } else {\n        if (config.dynamic === true) {\n          panoImage = config.imageSource;\n        } else {\n          if (config.imageSource === undefined$1) {\n            anError(config.uiText.noPanoramaError);\n            return;\n          }\n\n          panoImage = new Image();\n        }\n      } // Configure image loading\n\n\n      if (config.type === \"cubemap\") {\n        // Quick loading counter for synchronous loading\n        var itemsToLoad = 6;\n\n        var onLoad = function onLoad() {\n          itemsToLoad--;\n\n          if (itemsToLoad === 0) {\n            onImageLoad();\n          }\n        };\n\n        var onError = function onError(e) {\n          var a = document.createElement(\"a\");\n          a.href = e.target.src;\n          a.innerHTML = a.href;\n          anError(config.uiText.fileAccessError.replace(\"%s\", a.outerHTML));\n        };\n\n        for (i = 0; i < panoImage.length; i++) {\n          panoImage[i].onload = onLoad;\n          panoImage[i].onerror = onError;\n          p = config.cubeMap[i];\n\n          if (p === \"null\") {\n            // support partial cubemap image with explicitly empty faces\n            console.log(\"Will use background instead of missing cubemap face \" + i);\n            onLoad();\n          } else {\n            if (config.basePath && !absoluteURL(p)) {\n              p = config.basePath + p;\n            }\n\n            panoImage[i].onload = onLoad;\n            panoImage[i].onerror = onError;\n            panoImage[i].src = sanitizeURL(p); //panoImage[i].src = encodeURI(p);\n          }\n        }\n      } else if (config.type === \"multires\") {\n        onImageLoad();\n      } else {\n        p = \"\";\n\n        if (config.basePath) {\n          p = config.basePath;\n        }\n\n        if (config.dynamic !== true) {\n          // Still image\n          p = absoluteURL(config.imageSource) ? config.imageSource : p + config.imageSource;\n\n          panoImage.onload = function () {\n            window.URL.revokeObjectURL(this.src); // Clean up\n\n            onImageLoad();\n          };\n\n          var xhr = new XMLHttpRequest();\n\n          xhr.onloadend = function () {\n            if (xhr.status != 200) {\n              // Display error if image can't be loaded\n              var a = document.createElement(\"a\");\n              a.href = p;\n              a.textContent = a.href;\n              anError(config.uiText.fileAccessError.replace(\"%s\", a.outerHTML));\n            }\n\n            var img = this.response;\n            parseGPanoXMP(img);\n            infoDisplay.load.msg.innerHTML = \"\";\n          };\n\n          xhr.onprogress = function (e) {\n            if (e.lengthComputable) {\n              // Display progress\n              var percent = e.loaded / e.total * 100;\n              infoDisplay.load.lbarFill.style.width = percent + \"%\";\n              var unit, numerator, denominator;\n\n              if (e.total > 1e6) {\n                unit = \"MB\";\n                numerator = (e.loaded / 1e6).toFixed(2);\n                denominator = (e.total / 1e6).toFixed(2);\n              } else if (e.total > 1e3) {\n                unit = \"kB\";\n                numerator = (e.loaded / 1e3).toFixed(1);\n                denominator = (e.total / 1e3).toFixed(1);\n              } else {\n                unit = \"B\";\n                numerator = e.loaded;\n                denominator = e.total;\n              }\n\n              infoDisplay.load.msg.innerHTML = numerator + \" / \" + denominator + \" \" + unit;\n            } else {\n              // Display loading spinner\n              infoDisplay.load.lbox.style.display = \"block\";\n              infoDisplay.load.lbar.style.display = \"none\";\n            }\n          };\n\n          try {\n            xhr.open(\"GET\", p, true);\n          } catch (e) {\n            // Malformed URL\n            anError(config.uiText.malformedURLError);\n          }\n\n          xhr.responseType = \"blob\";\n          xhr.setRequestHeader(\"Accept\", \"image/*,*/*;q=0.9\");\n          xhr.withCredentials = config.crossOrigin === \"use-credentials\";\n          xhr.send();\n        }\n      }\n\n      if (config.draggable) uiContainer.classList.add(\"pnlm-grab\");\n      uiContainer.classList.remove(\"pnlm-grabbing\"); // Properly handle switching to dynamic scenes\n\n      update = config.dynamicUpdate === true;\n\n      if (config.dynamic && update) {\n        panoImage = config.panorama;\n        onImageLoad();\n      }\n    }\n    /**\r\n     * Test if URL is absolute or relative.\r\n     * @private\r\n     * @param {string} url - URL to test\r\n     * @returns {boolean} True if absolute, else false\r\n     */\n\n\n    function absoluteURL(url) {\n      // From http://stackoverflow.com/a/19709846\n      return new RegExp(\"^(?:[a-z]+:)?//\", \"i\").test(url) || url[0] === \"/\" || url.slice(0, 5) === \"blob:\";\n    }\n    /**\r\n     * Create renderer and initialize event listeners once image is loaded.\r\n     * @private\r\n     */\n\n\n    function onImageLoad() {\n      if (!renderer) renderer = new libpannellum.renderer(renderContainer); // Only add event listeners once\n\n      if (!listenersAdded) {\n        listenersAdded = true;\n        dragFix.addEventListener(\"mousedown\", onDocumentMouseDown, false);\n        document.addEventListener(\"mousemove\", onDocumentMouseMove, false);\n        document.addEventListener(\"mouseup\", onDocumentMouseUp, false);\n\n        if (config.mouseZoom) {\n          uiContainer.addEventListener(\"mousewheel\", onDocumentMouseWheel, false);\n          uiContainer.addEventListener(\"DOMMouseScroll\", onDocumentMouseWheel, false);\n        }\n\n        if (config.doubleClickZoom) {\n          dragFix.addEventListener(\"dblclick\", onDocumentDoubleClick, false);\n        }\n\n        container.addEventListener(\"mozfullscreenchange\", onFullScreenChange, false);\n        container.addEventListener(\"webkitfullscreenchange\", onFullScreenChange, false);\n        container.addEventListener(\"msfullscreenchange\", onFullScreenChange, false);\n        container.addEventListener(\"fullscreenchange\", onFullScreenChange, false);\n        window.addEventListener(\"resize\", onDocumentResize, false);\n        window.addEventListener(\"orientationchange\", onDocumentResize, false);\n\n        if (!config.disableKeyboardCtrl) {\n          container.addEventListener(\"keydown\", onDocumentKeyPress, false);\n          container.addEventListener(\"keyup\", onDocumentKeyUp, false);\n          container.addEventListener(\"blur\", clearKeys, false);\n        }\n\n        document.addEventListener(\"mouseleave\", onDocumentMouseUp, false);\n\n        if (document.documentElement.style.pointerAction === \"\" && document.documentElement.style.touchAction === \"\") {\n          dragFix.addEventListener(\"pointerdown\", onDocumentPointerDown, false);\n          dragFix.addEventListener(\"pointermove\", onDocumentPointerMove, false);\n          dragFix.addEventListener(\"pointerup\", onDocumentPointerUp, false);\n          dragFix.addEventListener(\"pointerleave\", onDocumentPointerUp, false);\n        } else {\n          dragFix.addEventListener(\"touchstart\", onDocumentTouchStart, false);\n          dragFix.addEventListener(\"touchmove\", onDocumentTouchMove, false);\n          dragFix.addEventListener(\"touchend\", onDocumentTouchEnd, false);\n        } // Deal with MS pointer events\n\n\n        if (window.navigator.pointerEnabled) container.style.touchAction = \"none\";\n      }\n\n      renderInit();\n      setHfov(config.hfov); // possibly adapt hfov after configuration and canvas is complete; prevents empty space on top or bottom by zomming out too much\n\n      setTimeout(function () {}, 500);\n    }\n    /**\r\n     * Parses Google Photo Sphere XMP Metadata.\r\n     * https://developers.google.com/photo-sphere/metadata/\r\n     * @private\r\n     * @param {Image} image - Image to read XMP metadata from.\r\n     */\n\n\n    function parseGPanoXMP(image) {\n      var reader = new FileReader();\n      reader.addEventListener(\"loadend\", function () {\n        var img = reader.result; // This awful browser specific test exists because iOS 8 does not work\n        // with non-progressive encoded JPEGs.\n\n        if (navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)) {\n          var flagIndex = img.indexOf(\"\\xff\\xc2\");\n          if (flagIndex < 0 || flagIndex > 65536) anError(config.uiText.iOS8WebGLError);\n        }\n\n        var start = img.indexOf(\"<x:xmpmeta\");\n\n        if (start > -1 && config.ignoreGPanoXMP !== true) {\n          var xmpData = img.substring(start, img.indexOf(\"</x:xmpmeta>\") + 12); // Extract the requested tag from the XMP data\n\n          var getTag = function getTag(tag) {\n            var result;\n\n            if (xmpData.indexOf(tag + '=\"') >= 0) {\n              result = xmpData.substring(xmpData.indexOf(tag + '=\"') + tag.length + 2);\n              result = result.substring(0, result.indexOf('\"'));\n            } else if (xmpData.indexOf(tag + \">\") >= 0) {\n              result = xmpData.substring(xmpData.indexOf(tag + \">\") + tag.length + 1);\n              result = result.substring(0, result.indexOf(\"<\"));\n            }\n\n            if (result !== undefined$1) {\n              return Number(result);\n            }\n\n            return null;\n          }; // Relevant XMP data\n\n\n          var xmp = {\n            fullWidth: getTag(\"GPano:FullPanoWidthPixels\"),\n            croppedWidth: getTag(\"GPano:CroppedAreaImageWidthPixels\"),\n            fullHeight: getTag(\"GPano:FullPanoHeightPixels\"),\n            croppedHeight: getTag(\"GPano:CroppedAreaImageHeightPixels\"),\n            topPixels: getTag(\"GPano:CroppedAreaTopPixels\"),\n            heading: getTag(\"GPano:PoseHeadingDegrees\"),\n            horizonPitch: getTag(\"GPano:PosePitchDegrees\"),\n            horizonRoll: getTag(\"GPano:PoseRollDegrees\")\n          };\n\n          if (xmp.fullWidth !== null && xmp.croppedWidth !== null && xmp.fullHeight !== null && xmp.croppedHeight !== null && xmp.topPixels !== null) {\n            // Set up viewer using GPano XMP data\n            if (specifiedPhotoSphereExcludes.indexOf(\"haov\") < 0) config.haov = xmp.croppedWidth / xmp.fullWidth * 360;\n            if (specifiedPhotoSphereExcludes.indexOf(\"vaov\") < 0) config.vaov = xmp.croppedHeight / xmp.fullHeight * 180;\n            if (specifiedPhotoSphereExcludes.indexOf(\"vOffset\") < 0) config.vOffset = ((xmp.topPixels + xmp.croppedHeight / 2) / xmp.fullHeight - 0.5) * -180;\n\n            if (xmp.heading !== null && specifiedPhotoSphereExcludes.indexOf(\"northOffset\") < 0) {\n              // TODO: make sure this works correctly for partial panoramas\n              config.northOffset = xmp.heading;\n\n              if (config.compass !== false) {\n                config.compass = true;\n              }\n            }\n\n            if (xmp.horizonPitch !== null && xmp.horizonRoll !== null) {\n              if (specifiedPhotoSphereExcludes.indexOf(\"horizonPitch\") < 0) config.horizonPitch = xmp.horizonPitch;\n              if (specifiedPhotoSphereExcludes.indexOf(\"horizonRoll\") < 0) config.horizonRoll = xmp.horizonRoll;\n            } // TODO: add support for initial view settings\n\n          }\n        } // Load panorama\n\n\n        panoImage.src = window.URL.createObjectURL(image);\n      });\n      if (reader.readAsBinaryString !== undefined$1) reader.readAsBinaryString(image);else reader.readAsText(image);\n    }\n    /**\r\n     * Displays an error message.\r\n     * @private\r\n     * @param {string} errorMsg - Error message to display. If not specified, a\r\n     *      generic WebGL error is displayed.\r\n     */\n\n\n    function anError(errorMsg) {\n      if (errorMsg === undefined$1) errorMsg = config.uiText.genericWebGLError;\n      infoDisplay.errorMsg.innerHTML = \"<p>\" + errorMsg + \"</p>\";\n      controls.load.style.display = \"none\";\n      infoDisplay.load.box.style.display = \"none\";\n      infoDisplay.errorMsg.style.display = \"table\";\n      error = true;\n      loaded = undefined$1;\n      renderContainer.style.display = \"none\";\n      fireEvent(\"error\", errorMsg);\n    }\n    /**\r\n     * Hides error message display.\r\n     * @private\r\n     */\n\n\n    function clearError() {\n      if (error) {\n        infoDisplay.load.box.style.display = \"none\";\n        infoDisplay.errorMsg.style.display = \"none\";\n        error = false;\n        renderContainer.style.display = \"block\";\n        fireEvent(\"errorcleared\");\n      }\n    }\n    /**\r\n     * Displays about message.\r\n     * @private\r\n     * @param {MouseEvent} event - Right click location\r\n     */\n\n\n    function aboutMessage(event) {\n      var pos = mousePosition(event);\n      aboutMsg.style.left = pos.x + \"px\";\n      aboutMsg.style.top = pos.y + \"px\";\n      clearTimeout(aboutMessage.t1);\n      clearTimeout(aboutMessage.t2);\n      aboutMsg.style.display = \"block\";\n      aboutMsg.style.opacity = 1;\n      aboutMessage.t1 = setTimeout(function () {\n        aboutMsg.style.opacity = 0;\n      }, 2000);\n      aboutMessage.t2 = setTimeout(function () {\n        aboutMsg.style.display = \"none\";\n      }, 2500);\n      event.preventDefault();\n    }\n    /**\r\n     * Calculate mouse position relative to top left of viewer container.\r\n     * @private\r\n     * @param {MouseEvent} event - Mouse event to use in calculation\r\n     * @returns {Object} Calculated X and Y coordinates\r\n     */\n\n\n    function mousePosition(event) {\n      var bounds = container.getBoundingClientRect();\n      var pos = {}; // pageX / pageY needed for iOS\n\n      pos.x = (event.clientX || event.pageX) - bounds.left;\n      pos.y = (event.clientY || event.pageY) - bounds.top;\n      return pos;\n    }\n    /**\r\n     * Event handler for mouse clicks. Initializes panning. Prints center and click\r\n     * location coordinates when hot spot debugging is enabled.\r\n     * @private\r\n     * @param {MouseEvent} event - Document mouse down event.\r\n     */\n\n\n    function onDocumentMouseDown(event) {\n      // Override default action\n      event.preventDefault(); // But not all of it\n\n      container.focus(); // Only do something if the panorama is loaded\n\n      if (!loaded || !config.draggable) {\n        fireEvent(\"mousedown\", event);\n        return;\n      } // Calculate mouse position relative to top left of viewer container\n\n\n      var pos = mousePosition(event); // Log pitch / yaw of mouse click when debugging / placing hot spots\n\n      if (config.hotSpotDebug) {\n        var coords = mouseEventToCoords(event);\n        console.log(\"Pitch: \" + coords[0] + \", Yaw: \" + coords[1] + \", Center Pitch: \" + config.pitch + \", Center Yaw: \" + config.yaw + \", HFOV: \" + config.hfov);\n      } // Turn off auto-rotation if enabled\n\n\n      stopAnimation();\n      stopOrientation();\n      config.roll = 0;\n      speed.hfov = 0;\n      isUserInteracting = true;\n      latestInteraction = Date.now();\n      onPointerDownPointerX = pos.x;\n      onPointerDownPointerY = pos.y;\n      onPointerDownYaw = config.yaw;\n      onPointerDownPitch = config.pitch;\n      uiContainer.classList.add(\"pnlm-grabbing\");\n      uiContainer.classList.remove(\"pnlm-grab\");\n      fireEvent(\"mousedown\", event);\n      animateInit();\n    }\n    /**\r\n     * Event handler for double clicks. Zooms in at clicked location\r\n     * @private\r\n     * @param {MouseEvent} event - Document mouse down event.\r\n     */\n\n\n    function onDocumentDoubleClick(event) {\n      if (config.minHfov === config.hfov) {\n        _this.setHfov(origHfov, 1000);\n      } else {\n        var coords = mouseEventToCoords(event);\n\n        _this.lookAt(coords[0], coords[1], config.minHfov, 1000);\n      }\n    }\n\n    function changeMouseCursor(event) {\n      isAdd = { ...event\n      };\n\n      if (isAdd.isAddInfo === true || isAdd.isAddScene === true) {\n        config.draggable = false;\n        uiContainer.classList.remove(\"pnlm-grab\");\n        uiContainer.classList.add(\"pnlm-custom\");\n      } else {\n        config.draggable = true;\n        uiContainer.classList.add(\"pnlm-grab\");\n        uiContainer.classList.remove(\"pnlm-custom\");\n      }\n    }\n    /**\r\n     * Calculate panorama pitch and yaw from location of mouse event.\r\n     * @private\r\n     * @param {MouseEvent} event - Document mouse down event.\r\n     * @returns {number[]} [pitch, yaw]\r\n     */\n\n\n    function mouseEventToCoords(event) {\n      var pos = mousePosition(event);\n      var canvas = renderer.getCanvas();\n      var canvasWidth = canvas.clientWidth,\n          canvasHeight = canvas.clientHeight;\n      var x = pos.x / canvasWidth * 2 - 1;\n      var y = (1 - pos.y / canvasHeight * 2) * canvasHeight / canvasWidth;\n      var focal = 1 / Math.tan(config.hfov * Math.PI / 360);\n      var s = Math.sin(config.pitch * Math.PI / 180);\n      var c = Math.cos(config.pitch * Math.PI / 180);\n      var a = focal * c - y * s;\n      var root = Math.sqrt(x * x + a * a);\n      var pitch = Math.atan((y * c + focal * s) / root) * 180 / Math.PI;\n      var yaw = Math.atan2(x / root, a / root) * 180 / Math.PI + config.yaw;\n      if (yaw < -180) yaw += 360;\n      if (yaw > 180) yaw -= 360;\n      return [pitch, yaw];\n    }\n    /**\r\n     * Event handler for mouse moves. Pans center of view.\r\n     * @private\r\n     * @param {MouseEvent} event - Document mouse move event.\r\n     */\n\n\n    function onDocumentMouseMove(event) {\n      if (isUserInteracting && loaded) {\n        latestInteraction = Date.now();\n        var canvas = renderer.getCanvas();\n        var canvasWidth = canvas.clientWidth,\n            canvasHeight = canvas.clientHeight;\n        var pos = mousePosition(event); //TODO: This still isn't quite right\n\n        var yaw = (Math.atan(onPointerDownPointerX / canvasWidth * 2 - 1) - Math.atan(pos.x / canvasWidth * 2 - 1)) * 180 / Math.PI * config.hfov / 90 + onPointerDownYaw;\n        speed.yaw = (yaw - config.yaw) % 360 * 0.2;\n        config.yaw = yaw;\n        var vfov = 2 * Math.atan(Math.tan(config.hfov / 360 * Math.PI) * canvasHeight / canvasWidth) * 180 / Math.PI;\n        var pitch = (Math.atan(pos.y / canvasHeight * 2 - 1) - Math.atan(onPointerDownPointerY / canvasHeight * 2 - 1)) * 180 / Math.PI * vfov / 90 + onPointerDownPitch;\n        speed.pitch = (pitch - config.pitch) * 0.2;\n        config.pitch = pitch;\n      }\n    }\n    /**\r\n     * Event handler for mouse up events. Stops panning.\r\n     * @private\r\n     */\n\n\n    function onDocumentMouseUp(event) {\n      if (!isUserInteracting) {\n        return;\n      }\n\n      isUserInteracting = false;\n\n      if (Date.now() - latestInteraction > 15) {\n        // Prevents jump when user rapidly moves mouse, stops, and then\n        // releases the mouse button\n        speed.pitch = speed.yaw = 0;\n      }\n\n      uiContainer.classList.add(\"pnlm-grab\");\n      uiContainer.classList.remove(\"pnlm-grabbing\");\n      latestInteraction = Date.now();\n      fireEvent(\"mouseup\", event);\n    }\n    /**\r\n     * Event handler for touches. Initializes panning if one touch or zooming if\r\n     * two touches.\r\n     * @private\r\n     * @param {TouchEvent} event - Document touch start event.\r\n     */\n\n\n    function onDocumentTouchStart(event) {\n      // Only do something if the panorama is loaded\n      if (!loaded || !config.draggable) {\n        return;\n      } // Turn off auto-rotation if enabled\n\n\n      stopAnimation();\n      stopOrientation();\n      config.roll = 0;\n      speed.hfov = 0; // Calculate touch position relative to top left of viewer container\n\n      var pos0 = mousePosition(event.targetTouches[0]);\n      onPointerDownPointerX = pos0.x;\n      onPointerDownPointerY = pos0.y;\n\n      if (event.targetTouches.length === 2) {\n        // Down pointer is the center of the two fingers\n        var pos1 = mousePosition(event.targetTouches[1]);\n        onPointerDownPointerX += (pos1.x - pos0.x) * 0.5;\n        onPointerDownPointerY += (pos1.y - pos0.y) * 0.5;\n        onPointerDownPointerDist = Math.sqrt((pos0.x - pos1.x) * (pos0.x - pos1.x) + (pos0.y - pos1.y) * (pos0.y - pos1.y));\n      }\n\n      isUserInteracting = true;\n      latestInteraction = Date.now();\n      onPointerDownYaw = config.yaw;\n      onPointerDownPitch = config.pitch;\n      fireEvent(\"touchstart\", event);\n      animateInit();\n    }\n    /**\r\n     * Event handler for touch movements. Pans center of view if one touch or\r\n     * adjusts zoom if two touches.\r\n     * @private\r\n     * @param {TouchEvent} event - Document touch move event.\r\n     */\n\n\n    function onDocumentTouchMove(event) {\n      if (!config.draggable) {\n        return;\n      } // Override default action\n\n\n      event.preventDefault();\n\n      if (loaded) {\n        latestInteraction = Date.now();\n      }\n\n      if (isUserInteracting && loaded) {\n        var pos0 = mousePosition(event.targetTouches[0]);\n        var clientX = pos0.x;\n        var clientY = pos0.y;\n\n        if (event.targetTouches.length === 2 && onPointerDownPointerDist != -1) {\n          var pos1 = mousePosition(event.targetTouches[1]);\n          clientX += (pos1.x - pos0.x) * 0.5;\n          clientY += (pos1.y - pos0.y) * 0.5;\n          var clientDist = Math.sqrt((pos0.x - pos1.x) * (pos0.x - pos1.x) + (pos0.y - pos1.y) * (pos0.y - pos1.y));\n          setHfov(config.hfov + (onPointerDownPointerDist - clientDist) * 0.1);\n          onPointerDownPointerDist = clientDist;\n        } // The smaller the config.hfov value (the more zoomed-in the user is), the faster\n        // yaw/pitch are perceived to change on one-finger touchmove (panning) events and vice versa.\n        // To improve usability at both small and large zoom levels (config.hfov values)\n        // we introduce a dynamic pan speed coefficient.\n        //\n        // Currently this seems to *roughly* keep initial drag/pan start position close to\n        // the user's finger while panning regardless of zoom level / config.hfov value.\n\n\n        var touchmovePanSpeedCoeff = config.hfov / 360 * config.touchPanSpeedCoeffFactor;\n        var yaw = (onPointerDownPointerX - clientX) * touchmovePanSpeedCoeff + onPointerDownYaw;\n        speed.yaw = (yaw - config.yaw) % 360 * 0.2;\n        config.yaw = yaw;\n        var pitch = (clientY - onPointerDownPointerY) * touchmovePanSpeedCoeff + onPointerDownPitch;\n        speed.pitch = (pitch - config.pitch) * 0.2;\n        config.pitch = pitch;\n      }\n    }\n    /**\r\n     * Event handler for end of touches. Stops panning and/or zooming.\r\n     * @private\r\n     */\n\n\n    function onDocumentTouchEnd() {\n      isUserInteracting = false;\n\n      if (Date.now() - latestInteraction > 150) {\n        speed.pitch = speed.yaw = 0;\n      }\n\n      onPointerDownPointerDist = -1;\n      latestInteraction = Date.now();\n      fireEvent(\"touchend\", event);\n    }\n\n    var pointerIDs = [],\n        pointerCoordinates = [];\n    /**\r\n     * Event handler for touch starts in IE / Edge.\r\n     * @private\r\n     * @param {PointerEvent} event - Document pointer down event.\r\n     */\n\n    function onDocumentPointerDown(event) {\n      if (event.pointerType === \"touch\") {\n        // Only do something if the panorama is loaded\n        if (!loaded || !config.draggable) return;\n        pointerIDs.push(event.pointerId);\n        pointerCoordinates.push({\n          clientX: event.clientX,\n          clientY: event.clientY\n        });\n        event.targetTouches = pointerCoordinates;\n        onDocumentTouchStart(event);\n        event.preventDefault();\n      }\n    }\n    /**\r\n     * Event handler for touch moves in IE / Edge.\r\n     * @private\r\n     * @param {PointerEvent} event - Document pointer move event.\r\n     */\n\n\n    function onDocumentPointerMove(event) {\n      if (event.pointerType === \"touch\") {\n        if (!config.draggable) return;\n\n        for (var i = 0; i < pointerIDs.length; i++) {\n          if (event.pointerId === pointerIDs[i]) {\n            pointerCoordinates[i].clientX = event.clientX;\n            pointerCoordinates[i].clientY = event.clientY;\n            event.targetTouches = pointerCoordinates;\n            onDocumentTouchMove(event);\n            event.preventDefault();\n            return;\n          }\n        }\n      }\n    }\n    /**\r\n     * Event handler for touch ends in IE / Edge.\r\n     * @private\r\n     * @param {PointerEvent} event - Document pointer up event.\r\n     */\n\n\n    function onDocumentPointerUp(event) {\n      if (event.pointerType === \"touch\") {\n        var defined = false;\n\n        for (var i = 0; i < pointerIDs.length; i++) {\n          if (event.pointerId === pointerIDs[i]) pointerIDs[i] = undefined$1;\n          if (pointerIDs[i]) defined = true;\n        }\n\n        if (!defined) {\n          pointerIDs = [];\n          pointerCoordinates = [];\n          onDocumentTouchEnd();\n        }\n\n        event.preventDefault();\n      }\n    }\n    /**\r\n     * Event handler for mouse wheel. Changes zoom.\r\n     * @private\r\n     * @param {WheelEvent} event - Document mouse wheel event.\r\n     */\n\n\n    function onDocumentMouseWheel(event) {\n      // Only do something if the panorama is loaded and mouse wheel zoom is enabled\n      if (!loaded || config.mouseZoom === \"fullscreenonly\" && !fullscreenActive) {\n        return;\n      }\n\n      event.preventDefault(); // Turn off auto-rotation if enabled\n\n      stopAnimation();\n      latestInteraction = Date.now();\n\n      if (event.wheelDeltaY) {\n        // WebKit\n        setHfov(config.hfov - event.wheelDeltaY * 0.05);\n        speed.hfov = event.wheelDelta < 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        // Opera / Explorer 9\n        setHfov(config.hfov - event.wheelDelta * 0.05);\n        speed.hfov = event.wheelDelta < 0 ? 1 : -1;\n      } else if (event.detail) {\n        // Firefox\n        setHfov(config.hfov + event.detail * 1.5);\n        speed.hfov = event.detail > 0 ? 1 : -1;\n      }\n\n      animateInit();\n    }\n    /**\r\n     * Event handler for key presses. Updates list of currently pressed keys.\r\n     * @private\r\n     * @param {KeyboardEvent} event - Document key press event.\r\n     */\n\n\n    function onDocumentKeyPress(event) {\n      // Turn off auto-rotation if enabled\n      stopAnimation();\n      latestInteraction = Date.now();\n      stopOrientation();\n      config.roll = 0; // Record key pressed\n\n      var keynumber = event.which || event.keycode; // Override default action for keys that are used\n\n      if (config.capturedKeyNumbers.indexOf(keynumber) < 0) return;\n      event.preventDefault(); // If escape key is pressed\n\n      if (keynumber === 27) {\n        // If in fullscreen mode\n        if (fullscreenActive) {\n          toggleFullscreen();\n        }\n      } else {\n        // Change key\n        changeKey(keynumber, true);\n      }\n    }\n    /**\r\n     * Clears list of currently pressed keys.\r\n     * @private\r\n     */\n\n\n    function clearKeys() {\n      for (var i = 0; i < 10; i++) {\n        keysDown[i] = false;\n      }\n    }\n    /**\r\n     * Event handler for key releases. Updates list of currently pressed keys.\r\n     * @private\r\n     * @param {KeyboardEvent} event - Document key up event.\r\n     */\n\n\n    function onDocumentKeyUp(event) {\n      // Record key pressed\n      var keynumber = event.which || event.keycode; // Override default action for keys that are used\n\n      if (config.capturedKeyNumbers.indexOf(keynumber) < 0) return;\n      event.preventDefault(); // Change key\n\n      changeKey(keynumber, false);\n    }\n    /**\r\n     * Updates list of currently pressed keys.\r\n     * @private\r\n     * @param {number} keynumber - Key number.\r\n     * @param {boolean} value - Whether or not key is pressed.\r\n     */\n\n\n    function changeKey(keynumber, value) {\n      var keyChanged = false;\n\n      switch (keynumber) {\n        // If minus key is released\n        case 109:\n        case 189:\n        case 17:\n        case 173:\n          if (keysDown[0] != value) {\n            keyChanged = true;\n          }\n\n          keysDown[0] = value;\n          break;\n        // If plus key is released\n\n        case 107:\n        case 187:\n        case 16:\n        case 61:\n          if (keysDown[1] != value) {\n            keyChanged = true;\n          }\n\n          keysDown[1] = value;\n          break;\n        // If up arrow is released\n\n        case 38:\n          if (keysDown[2] != value) {\n            keyChanged = true;\n          }\n\n          keysDown[2] = value;\n          break;\n        // If \"w\" is released\n\n        case 87:\n          if (keysDown[6] != value) {\n            keyChanged = true;\n          }\n\n          keysDown[6] = value;\n          break;\n        // If down arrow is released\n\n        case 40:\n          if (keysDown[3] != value) {\n            keyChanged = true;\n          }\n\n          keysDown[3] = value;\n          break;\n        // If \"s\" is released\n\n        case 83:\n          if (keysDown[7] != value) {\n            keyChanged = true;\n          }\n\n          keysDown[7] = value;\n          break;\n        // If left arrow is released\n\n        case 37:\n          if (keysDown[4] != value) {\n            keyChanged = true;\n          }\n\n          keysDown[4] = value;\n          break;\n        // If \"a\" is released\n\n        case 65:\n          if (keysDown[8] != value) {\n            keyChanged = true;\n          }\n\n          keysDown[8] = value;\n          break;\n        // If right arrow is released\n\n        case 39:\n          if (keysDown[5] != value) {\n            keyChanged = true;\n          }\n\n          keysDown[5] = value;\n          break;\n        // If \"d\" is released\n\n        case 68:\n          if (keysDown[9] != value) {\n            keyChanged = true;\n          }\n\n          keysDown[9] = value;\n      }\n\n      if (keyChanged && value) {\n        if (typeof performance !== \"undefined\" && performance.now()) {\n          prevTime = performance.now();\n        } else {\n          prevTime = Date.now();\n        }\n\n        animateInit();\n      }\n    }\n    /**\r\n     * Pans and/or zooms panorama based on currently pressed keys. Also handles\r\n     * panorama \"inertia\" and auto rotation.\r\n     * @private\r\n     */\n\n\n    function keyRepeat() {\n      // Only do something if the panorama is loaded\n      if (!loaded) {\n        return;\n      }\n\n      var isKeyDown = false;\n      var prevPitch = config.pitch;\n      var prevYaw = config.yaw;\n      var prevZoom = config.hfov;\n      var newTime;\n\n      if (typeof performance !== \"undefined\" && performance.now()) {\n        newTime = performance.now();\n      } else {\n        newTime = Date.now();\n      }\n\n      if (prevTime === undefined$1) {\n        prevTime = newTime;\n      }\n\n      var diff = (newTime - prevTime) * config.hfov / 1700;\n      diff = Math.min(diff, 1.0); // If minus key is down\n\n      if (keysDown[0] && config.keyboardZoom === true) {\n        setHfov(config.hfov + (speed.hfov * 0.8 + 0.5) * diff);\n        isKeyDown = true;\n      } // If plus key is down\n\n\n      if (keysDown[1] && config.keyboardZoom === true) {\n        setHfov(config.hfov + (speed.hfov * 0.8 - 0.2) * diff);\n        isKeyDown = true;\n      } // If up arrow or \"w\" is down\n\n\n      if (keysDown[2] || keysDown[6]) {\n        // Pan up\n        config.pitch += (speed.pitch * 0.8 + 0.2) * diff;\n        isKeyDown = true;\n      } // If down arrow or \"s\" is down\n\n\n      if (keysDown[3] || keysDown[7]) {\n        // Pan down\n        config.pitch += (speed.pitch * 0.8 - 0.2) * diff;\n        isKeyDown = true;\n      } // If left arrow or \"a\" is down\n\n\n      if (keysDown[4] || keysDown[8]) {\n        // Pan left\n        config.yaw += (speed.yaw * 0.8 - 0.2) * diff;\n        isKeyDown = true;\n      } // If right arrow or \"d\" is down\n\n\n      if (keysDown[5] || keysDown[9]) {\n        // Pan right\n        config.yaw += (speed.yaw * 0.8 + 0.2) * diff;\n        isKeyDown = true;\n      }\n\n      if (isKeyDown) latestInteraction = Date.now(); // If auto-rotate\n\n      if (config.autoRotate) {\n        // Pan\n        if (newTime - prevTime > 0.001) {\n          var timeDiff = (newTime - prevTime) / 1000;\n          var yawDiff = (speed.yaw / timeDiff * diff - config.autoRotate * 0.2) * timeDiff;\n          yawDiff = (-config.autoRotate > 0 ? 1 : -1) * Math.min(Math.abs(config.autoRotate * timeDiff), Math.abs(yawDiff));\n          config.yaw += yawDiff;\n        } // Deal with stopping auto rotation after a set delay\n\n\n        if (config.autoRotateStopDelay) {\n          config.autoRotateStopDelay -= newTime - prevTime;\n\n          if (config.autoRotateStopDelay <= 0) {\n            config.autoRotateStopDelay = false;\n            autoRotateSpeed = config.autoRotate;\n            config.autoRotate = 0;\n          }\n        }\n      } // Animated moves\n\n\n      if (animatedMove.pitch) {\n        animateMove(\"pitch\");\n        prevPitch = config.pitch;\n      }\n\n      if (animatedMove.yaw) {\n        animateMove(\"yaw\");\n        prevYaw = config.yaw;\n      }\n\n      if (animatedMove.hfov) {\n        animateMove(\"hfov\");\n        prevZoom = config.hfov;\n      } // \"Inertia\"\n\n\n      if (diff > 0 && !config.autoRotate) {\n        // \"Friction\"\n        var slowDownFactor = 1 - config.friction; // Yaw\n\n        if (!keysDown[4] && !keysDown[5] && !keysDown[8] && !keysDown[9] && !animatedMove.yaw) {\n          config.yaw += speed.yaw * diff * slowDownFactor;\n        } // Pitch\n\n\n        if (!keysDown[2] && !keysDown[3] && !keysDown[6] && !keysDown[7] && !animatedMove.pitch) {\n          config.pitch += speed.pitch * diff * slowDownFactor;\n        } // Zoom\n\n\n        if (!keysDown[0] && !keysDown[1] && !animatedMove.hfov) {\n          setHfov(config.hfov + speed.hfov * diff * slowDownFactor);\n        }\n      }\n\n      prevTime = newTime;\n\n      if (diff > 0) {\n        speed.yaw = speed.yaw * 0.8 + (config.yaw - prevYaw) / diff * 0.2;\n        speed.pitch = speed.pitch * 0.8 + (config.pitch - prevPitch) / diff * 0.2;\n        speed.hfov = speed.hfov * 0.8 + (config.hfov - prevZoom) / diff * 0.2; // Limit speed\n\n        var maxSpeed = config.autoRotate ? Math.abs(config.autoRotate) : 5;\n        speed.yaw = Math.min(maxSpeed, Math.max(speed.yaw, -maxSpeed));\n        speed.pitch = Math.min(maxSpeed, Math.max(speed.pitch, -maxSpeed));\n        speed.hfov = Math.min(maxSpeed, Math.max(speed.hfov, -maxSpeed));\n      } // Stop movement if opposite controls are pressed\n\n\n      if (keysDown[0] && keysDown[1]) {\n        speed.hfov = 0;\n      }\n\n      if ((keysDown[2] || keysDown[6]) && (keysDown[3] || keysDown[7])) {\n        speed.pitch = 0;\n      }\n\n      if ((keysDown[4] || keysDown[8]) && (keysDown[5] || keysDown[9])) {\n        speed.yaw = 0;\n      }\n    }\n    /**\r\n     * Animates moves.\r\n     * @param {string} axis - Axis to animate\r\n     * @private\r\n     */\n\n\n    function animateMove(axis) {\n      var t = animatedMove[axis];\n      var normTime = Math.min(1, Math.max((Date.now() - t.startTime) / 1000 / (t.duration / 1000), 0));\n      var result = t.startPosition + config.animationTimingFunction(normTime) * (t.endPosition - t.startPosition);\n\n      if (t.endPosition > t.startPosition && result >= t.endPosition || t.endPosition < t.startPosition && result <= t.endPosition || t.endPosition === t.startPosition) {\n        result = t.endPosition;\n        speed[axis] = 0;\n        delete animatedMove[axis];\n      }\n\n      config[axis] = result;\n    }\n    /**\r\n     * @param {number} t - Normalized time in animation\r\n     * @return {number} Position in animation\r\n     * @private\r\n     */\n\n\n    function timingFunction(t) {\n      // easeInOutQuad from https://gist.github.com/gre/1650294\n      return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n    }\n    /**\r\n     * Event handler for document resizes. Updates viewer size and rerenders view.\r\n     * @private\r\n     */\n\n\n    function onDocumentResize() {\n      // Resize panorama renderer (moved to onFullScreenChange)\n      //renderer.resize();\n      //animateInit();\n      // Kludge to deal with WebKit regression: https://bugs.webkit.org/show_bug.cgi?id=93525\n      onFullScreenChange(\"resize\");\n    }\n    /**\r\n     * Initializes animation.\r\n     * @private\r\n     */\n\n\n    function animateInit() {\n      if (animating) {\n        return;\n      }\n\n      animating = true;\n      animate();\n    }\n    /**\r\n     * Animates view, using requestAnimationFrame to trigger rendering.\r\n     * @private\r\n     */\n\n\n    function animate() {\n      if (destroyed) {\n        return;\n      }\n\n      render();\n      if (autoRotateStart) clearTimeout(autoRotateStart);\n\n      if (isUserInteracting || orientation === true) {\n        requestAnimationFrame(animate);\n      } else if (keysDown[0] || keysDown[1] || keysDown[2] || keysDown[3] || keysDown[4] || keysDown[5] || keysDown[6] || keysDown[7] || keysDown[8] || keysDown[9] || config.autoRotate || animatedMove.pitch || animatedMove.yaw || animatedMove.hfov || Math.abs(speed.yaw) > 0.01 || Math.abs(speed.pitch) > 0.01 || Math.abs(speed.hfov) > 0.01) {\n        keyRepeat();\n\n        if (config.autoRotateInactivityDelay >= 0 && autoRotateSpeed && Date.now() - latestInteraction > config.autoRotateInactivityDelay && !config.autoRotate) {\n          config.autoRotate = autoRotateSpeed;\n\n          _this.lookAt(origPitch, undefined$1, origHfov, 3000);\n        }\n\n        requestAnimationFrame(animate);\n      } else if (renderer && (renderer.isLoading() || config.dynamic === true && update)) {\n        requestAnimationFrame(animate);\n      } else {\n        fireEvent(\"animatefinished\", {\n          pitch: _this.getPitch(),\n          yaw: _this.getYaw(),\n          hfov: _this.getHfov()\n        });\n        animating = false;\n        prevTime = undefined$1;\n        var autoRotateStartTime = config.autoRotateInactivityDelay - (Date.now() - latestInteraction);\n\n        if (autoRotateStartTime > 0) {\n          autoRotateStart = setTimeout(function () {\n            config.autoRotate = autoRotateSpeed;\n\n            _this.lookAt(origPitch, undefined$1, origHfov, 3000);\n\n            animateInit();\n          }, autoRotateStartTime);\n        } else if (config.autoRotateInactivityDelay >= 0 && autoRotateSpeed) {\n          config.autoRotate = autoRotateSpeed;\n\n          _this.lookAt(origPitch, undefined$1, origHfov, 3000);\n\n          animateInit();\n        }\n      }\n    }\n    /**\r\n     * Renders panorama view.\r\n     * @private\r\n     */\n\n\n    function render() {\n      var tmpyaw;\n\n      if (loaded) {\n        var canvas = renderer.getCanvas();\n\n        if (config.autoRotate !== false) {\n          // When auto-rotating this check needs to happen first (see issue #764)\n          if (config.yaw > 180) {\n            config.yaw -= 360;\n          } else if (config.yaw < -180) {\n            config.yaw += 360;\n          }\n        } // Keep a tmp value of yaw for autoRotate comparison later\n\n\n        tmpyaw = config.yaw; // Optionally avoid showing background (empty space) on left or right by adapting min/max yaw\n\n        var hoffcut = 0;\n\n        if (config.avoidShowingBackground) {\n          var hfov2 = config.hfov / 2,\n              vfov2 = Math.atan2(Math.tan(hfov2 / 180 * Math.PI), canvas.width / canvas.height) * 180 / Math.PI,\n              transposed = config.vaov > config.haov;\n\n          if (transposed) {\n            vfov2 * (1 - Math.min(Math.cos((config.pitch - hfov2) / 180 * Math.PI), Math.cos((config.pitch + hfov2) / 180 * Math.PI)));\n          } else {\n            hoffcut = hfov2 * (1 - Math.min(Math.cos((config.pitch - vfov2) / 180 * Math.PI), Math.cos((config.pitch + vfov2) / 180 * Math.PI)));\n          }\n        } // Ensure the yaw is within min and max allowed\n\n\n        var yawRange = config.maxYaw - config.minYaw,\n            minYaw = -180,\n            maxYaw = 180;\n\n        if (yawRange < 360) {\n          minYaw = config.minYaw + config.hfov / 2 + hoffcut;\n          maxYaw = config.maxYaw - config.hfov / 2 - hoffcut;\n\n          if (yawRange < config.hfov) {\n            // Lock yaw to average of min and max yaw when both can be seen at once\n            minYaw = maxYaw = (minYaw + maxYaw) / 2;\n          }\n\n          config.yaw = Math.max(minYaw, Math.min(maxYaw, config.yaw));\n        }\n\n        if (!(config.autoRotate !== false)) {\n          // When not auto-rotating, this check needs to happen after the\n          // previous check (see issue #698)\n          if (config.yaw > 180) {\n            config.yaw -= 360;\n          } else if (config.yaw < -180) {\n            config.yaw += 360;\n          }\n        } // Check if we autoRotate in a limited by min and max yaw\n        // If so reverse direction\n\n\n        if (config.autoRotate !== false && tmpyaw != config.yaw && prevTime !== undefined$1) {\n          // this condition prevents changing the direction initially\n          config.autoRotate *= -1;\n        } // Ensure the calculated pitch is within min and max allowed\n\n\n        var vfov = 2 * Math.atan(Math.tan(config.hfov / 180 * Math.PI * 0.5) / (canvas.width / canvas.height)) / Math.PI * 180;\n        var minPitch = config.minPitch + vfov / 2,\n            maxPitch = config.maxPitch - vfov / 2;\n        var pitchRange = config.maxPitch - config.minPitch;\n\n        if (pitchRange < vfov) {\n          // Lock pitch to average of min and max pitch when both can be seen at once\n          minPitch = maxPitch = (minPitch + maxPitch) / 2;\n        }\n\n        if (isNaN(minPitch)) minPitch = -90;\n        if (isNaN(maxPitch)) maxPitch = 90;\n        config.pitch = Math.max(minPitch, Math.min(maxPitch, config.pitch));\n        renderer.render(config.pitch * Math.PI / 180, config.yaw * Math.PI / 180, config.hfov * Math.PI / 180, {\n          roll: config.roll * Math.PI / 180\n        });\n        renderHotSpots(); // Update compass\n\n        if (config.compass) {\n          compass.style.transform = \"rotate(\" + (-config.yaw - config.northOffset) + \"deg)\";\n          compass.style.webkitTransform = \"rotate(\" + (-config.yaw - config.northOffset) + \"deg)\";\n        }\n      }\n    }\n    /**\r\n     * Creates a new quaternion.\r\n     * @private\r\n     * @constructor\r\n     * @param {Number} w - W value\r\n     * @param {Number} x - X value\r\n     * @param {Number} y - Y value\r\n     * @param {Number} z - Z value\r\n     */\n\n\n    function Quaternion(w, x, y, z) {\n      this.w = w;\n      this.x = x;\n      this.y = y;\n      this.z = z;\n    }\n    /**\r\n     * Multiplies quaternions.\r\n     * @private\r\n     * @param {Quaternion} q - Quaternion to multiply\r\n     * @returns {Quaternion} Result of multiplication\r\n     */\n\n\n    Quaternion.prototype.multiply = function (q) {\n      return new Quaternion(this.w * q.w - this.x * q.x - this.y * q.y - this.z * q.z, this.x * q.w + this.w * q.x + this.y * q.z - this.z * q.y, this.y * q.w + this.w * q.y + this.z * q.x - this.x * q.z, this.z * q.w + this.w * q.z + this.x * q.y - this.y * q.x);\n    };\n    /**\r\n     * Converts quaternion to Euler angles.\r\n     * @private\r\n     * @returns {Number[]} [phi angle, theta angle, psi angle]\r\n     */\n\n\n    Quaternion.prototype.toEulerAngles = function () {\n      var phi = Math.atan2(2 * (this.w * this.x + this.y * this.z), 1 - 2 * (this.x * this.x + this.y * this.y)),\n          theta = Math.asin(2 * (this.w * this.y - this.z * this.x)),\n          psi = Math.atan2(2 * (this.w * this.z + this.x * this.y), 1 - 2 * (this.y * this.y + this.z * this.z));\n      return [phi, theta, psi];\n    };\n    /**\r\n     * Converts device orientation API Tait-Bryan angles to a quaternion.\r\n     * @private\r\n     * @param {Number} alpha - Alpha angle (in degrees)\r\n     * @param {Number} beta - Beta angle (in degrees)\r\n     * @param {Number} gamma - Gamma angle (in degrees)\r\n     * @returns {Quaternion} Orientation quaternion\r\n     */\n\n\n    function taitBryanToQuaternion(alpha, beta, gamma) {\n      var r = [beta ? beta * Math.PI / 180 / 2 : 0, gamma ? gamma * Math.PI / 180 / 2 : 0, alpha ? alpha * Math.PI / 180 / 2 : 0];\n      var c = [Math.cos(r[0]), Math.cos(r[1]), Math.cos(r[2])],\n          s = [Math.sin(r[0]), Math.sin(r[1]), Math.sin(r[2])];\n      return new Quaternion(c[0] * c[1] * c[2] - s[0] * s[1] * s[2], s[0] * c[1] * c[2] - c[0] * s[1] * s[2], c[0] * s[1] * c[2] + s[0] * c[1] * s[2], c[0] * c[1] * s[2] + s[0] * s[1] * c[2]);\n    }\n    /**\r\n     * Computes current device orientation quaternion from device orientation API\r\n     * Tait-Bryan angles.\r\n     * @private\r\n     * @param {Number} alpha - Alpha angle (in degrees)\r\n     * @param {Number} beta - Beta angle (in degrees)\r\n     * @param {Number} gamma - Gamma angle (in degrees)\r\n     * @returns {Quaternion} Orientation quaternion\r\n     */\n\n\n    function computeQuaternion(alpha, beta, gamma) {\n      // Convert Tait-Bryan angles to quaternion\n      var quaternion = taitBryanToQuaternion(alpha, beta, gamma); // Apply world transform\n\n      quaternion = quaternion.multiply(new Quaternion(Math.sqrt(0.5), -Math.sqrt(0.5), 0, 0)); // Apply screen transform\n\n      var angle = window.orientation ? -window.orientation * Math.PI / 180 / 2 : 0;\n      return quaternion.multiply(new Quaternion(Math.cos(angle), 0, -Math.sin(angle), 0));\n    }\n    /**\r\n     * Event handler for device orientation API. Controls pointing.\r\n     * @private\r\n     * @param {DeviceOrientationEvent} event - Device orientation event.\r\n     */\n\n\n    function orientationListener(e) {\n      if (e.hasOwnProperty(\"requestPermission\")) e.requestPermission();\n      var q = computeQuaternion(e.alpha, e.beta, e.gamma).toEulerAngles();\n\n      if (typeof orientation === \"number\" && orientation < 10) {\n        // This kludge is necessary because iOS sometimes provides a few stale\n        // device orientation events when the listener is removed and then\n        // readded. Thus, we skip the first 10 events to prevent this from\n        // causing problems.\n        orientation += 1;\n      } else if (orientation === 10) {\n        // Record starting yaw to prevent jumping\n        orientationYawOffset = q[2] / Math.PI * 180 + config.yaw;\n        orientation = true;\n        requestAnimationFrame(animate);\n      } else {\n        config.pitch = q[0] / Math.PI * 180;\n        config.roll = -q[1] / Math.PI * 180;\n        config.yaw = -q[2] / Math.PI * 180 + orientationYawOffset;\n      }\n    }\n    /**\r\n     * Initializes renderer.\r\n     * @private\r\n     */\n\n\n    function renderInit() {\n      try {\n        var params = {};\n        if (config.horizonPitch !== undefined$1) params.horizonPitch = config.horizonPitch * Math.PI / 180;\n        if (config.horizonRoll !== undefined$1) params.horizonRoll = config.horizonRoll * Math.PI / 180;\n        if (config.backgroundColor !== undefined$1) params.backgroundColor = config.backgroundColor;\n        renderer.init(panoImage, config.type, config.dynamic, config.haov * Math.PI / 180, config.vaov * Math.PI / 180, config.vOffset * Math.PI / 180, renderInitCallback, params);\n\n        if (config.dynamic !== true) {\n          // Allow image to be garbage collected\n          panoImage = undefined$1;\n        }\n      } catch (event) {\n        // Panorama not loaded\n        // Display error if there is a bad texture\n        if (event.type === \"webgl error\" || event.type === \"no webgl\") {\n          anError();\n        } else if (event.type === \"webgl size error\") {\n          anError(config.uiText.textureSizeError.replace(\"%s\", event.width).replace(\"%s\", event.maxWidth));\n        } else {\n          anError(config.uiText.unknownError);\n          throw event;\n        }\n      }\n    }\n    /**\r\n     * Triggered when render initialization finishes. Handles fading between\r\n     * scenes as well as showing the compass and hotspots and hiding the loading\r\n     * display.\r\n     * @private\r\n     */\n\n\n    function renderInitCallback() {\n      // Fade if specified\n      if (config.sceneFadeDuration && renderer.fadeImg !== undefined$1) {\n        renderer.fadeImg.style.opacity = 0; // Remove image\n\n        var fadeImg = renderer.fadeImg;\n        delete renderer.fadeImg;\n        setTimeout(function () {\n          renderContainer.removeChild(fadeImg);\n          fireEvent(\"scenechangefadedone\");\n        }, config.sceneFadeDuration);\n      } // Show compass if applicable\n\n\n      if (config.compass) {\n        compass.style.display = \"inline\";\n      } else {\n        compass.style.display = \"none\";\n      } // Show hotspots\n\n\n      createHotSpots(); // Hide loading display\n\n      infoDisplay.load.box.style.display = \"none\";\n\n      if (preview !== undefined$1) {\n        renderContainer.removeChild(preview);\n        preview = undefined$1;\n      }\n\n      loaded = true;\n      animateInit();\n      fireEvent(\"load\");\n    }\n    /**\r\n     * Creates hot spot element for the current scene.\r\n     * @private\r\n     * @param {Object} hs - The configuration for the hotspot\r\n     */\n\n\n    function createHotSpot(hs) {\n      // Make sure hot spot pitch and yaw are numbers\n      hs.pitch = Number(hs.pitch) || 0;\n      hs.yaw = Number(hs.yaw) || 0;\n      var div = document.createElement(\"div\");\n      div.className = \"pnlm-hotspot-base\";\n      if (hs.cssClass) div.className += \" \" + hs.cssClass;else div.className += \" pnlm-hotspot pnlm-sprite pnlm-\" + escapeHTML(hs.type);\n      var span = document.createElement(\"span\");\n      if (hs.text) span.innerHTML = escapeHTML(hs.text);\n      var a;\n\n      if (hs.video) {\n        var video = document.createElement(\"video\"),\n            vidp = hs.video;\n        if (config.basePath && !absoluteURL(vidp)) vidp = config.basePath + vidp;\n        video.src = sanitizeURL(vidp);\n        video.controls = true;\n        video.style.width = hs.width + \"px\";\n        renderContainer.appendChild(div);\n        span.appendChild(video);\n      } else if (hs.image) {\n        var imgp = hs.image;\n        if (config.basePath && !absoluteURL(imgp)) imgp = config.basePath + imgp;\n        a = document.createElement(\"a\");\n        a.href = sanitizeURL(hs.URL ? hs.URL : imgp);\n        a.target = \"_blank\";\n        span.appendChild(a);\n        var image = document.createElement(\"img\");\n        image.src = sanitizeURL(imgp);\n        image.style.width = hs.width + \"px\";\n        image.style.paddingTop = \"5px\";\n        renderContainer.appendChild(div);\n        a.appendChild(image);\n        span.style.maxWidth = \"initial\";\n      } else if (hs.URL) {\n        a = document.createElement(\"a\");\n        a.href = sanitizeURL(hs.URL);\n\n        if (hs.attributes) {\n          for (var key in hs.attributes) {\n            a.setAttribute(key, hs.attributes[key]);\n          }\n        } else {\n          a.target = \"_blank\";\n        }\n\n        renderContainer.appendChild(a);\n        div.className += \" pnlm-pointer\";\n        span.className += \" pnlm-pointer\";\n        a.appendChild(div);\n      } else {\n        if (hs.sceneId) {\n          div.onclick = div.ontouchend = function () {\n            if (!div.clicked) {\n              div.clicked = true;\n              dLastPitch = hs.pitch;\n              dLastYaw = hs.yaw;\n              dLastHfov = _this.getHfov();\n              setTimeout(function () {\n                lookAndWait(_this.getHfov(), dTimeLookAtHotSpot);\n              }, 10); //--- first look directly at the hotspot\n\n              lookAndWait(50, dTimeZoomInHotSpot); //--- then zoom in\n\n              setTimeout(function () {\n                _this.loadScene(hs.sceneId, dLastPitch, dLastYaw, 120);\n              }, dTimeToLoad); // then load the new scene\n              // loadScene(\n              //   hs.sceneId,\n              //   hs.targetPitch,\n              //   hs.targetYaw,\n              //   hs.targetHfov\n              // );\n            }\n\n            return false;\n          };\n\n          div.className += \" pnlm-pointer\";\n          span.className += \" pnlm-pointer\";\n        }\n\n        renderContainer.appendChild(div);\n      }\n\n      if (hs.createTooltipFunc) {\n        hs.createTooltipFunc(div, hs.createTooltipArgs);\n      } else if (hs.text || hs.video || hs.image) {\n        div.classList.add(\"pnlm-tooltip\");\n        div.appendChild(span);\n        span.style.wordBreak = \"break-word\";\n        span.style.width = span.scrollWidth - 20 + \"px\";\n        span.style.marginLeft = -(span.scrollWidth - div.offsetWidth) / 2 + \"px\";\n        span.style.marginTop = -span.scrollHeight - 12 + \"px\";\n      }\n\n      if (hs.clickHandlerFunc) {\n        div.addEventListener(\"click\", function (e) {\n          hs.clickHandlerFunc(e, hs.clickHandlerArgs);\n        }, \"false\");\n        div.className += \" pnlm-pointer\";\n        span.className += \" pnlm-pointer\";\n      }\n\n      hs.div = div;\n    }\n\n    function lookAndWait(dHfov, dTime) {\n      // Initiate LookAt / Zoom\n      var pZ = dLastPitch; // Or other pan angle to Zoom in on.\n\n      var yZ = dLastYaw; // Or other yaw angle to Zoom in on.\n\n      var vZ = dHfov; // Or other Hfov angle to Zoom in on.\n\n      var pS = dTime; // Or other zoom speed\n\n      _this.lookAt(pZ, yZ, vZ, pS);\n\n      setTimeout(function () {\n        waitForView(dLastPitch, dLastYaw, vZ);\n      }, 1000);\n    }\n\n    function waitForView(dPitch, dYaw, dHfov) {\n      var iCnt = 0;\n      let pI = Math.round(_this.getPitch()); // get actual pitch and round\n\n      let yI = Math.round(_this.getYaw()); // get actual yaw and round\n\n      let vI = Math.round(_this.getHfov()); // get actual Hfov and round\n\n      if (yI > 180) {\n        yI = yI - 360;\n\n        _this.setYaw(yI, 0);\n      }\n\n      if (yI < -180) {\n        yI = yI + 360;\n\n        _this.setYaw(yI, 0);\n      }\n\n      if (pI === dPitch && yI === dYaw && vI === dHfov) {\n        // Has LookAt finished\n        return true;\n      } else {\n        setTimeout(function () {\n          waitForView(dPitch, dYaw, dHfov);\n        }, 10);\n      }\n    }\n\n    function sceneLoadListener() {\n      //--- zoom a little bit into current viewing direction\n      lookAndWait(110, dTimeZoomInAfterLoad);\n    }\n    /**\r\n     * Creates hot spot elements for the current scene.\r\n     * @private\r\n     */\n\n\n    function createHotSpots() {\n      if (hotspotsCreated) return;\n\n      if (!config.hotSpots) {\n        config.hotSpots = [];\n      } else {\n        // Sort by pitch so tooltip is never obscured by another hot spot\n        config.hotSpots = config.hotSpots.sort(function (a, b) {\n          return a.pitch < b.pitch;\n        });\n        config.hotSpots.forEach(createHotSpot);\n      }\n\n      hotspotsCreated = true;\n      renderHotSpots();\n    }\n    /**\r\n     * Destroys currently created hot spot elements.\r\n     * @private\r\n     */\n\n\n    function destroyHotSpots() {\n      var hs = config.hotSpots;\n      hotspotsCreated = false;\n      delete config.hotSpots;\n\n      if (hs) {\n        for (var i = 0; i < hs.length; i++) {\n          var current = hs[i].div;\n\n          if (current) {\n            while (current.parentNode && current.parentNode != renderContainer) {\n              current = current.parentNode;\n            }\n\n            renderContainer.removeChild(current);\n          }\n\n          delete hs[i].div;\n        }\n      }\n    }\n    /**\r\n     * Renders hot spot, updating its position and visibility.\r\n     * @private\r\n     */\n\n\n    function renderHotSpot(hs) {\n      var hsPitchSin = Math.sin(hs.pitch * Math.PI / 180),\n          hsPitchCos = Math.cos(hs.pitch * Math.PI / 180),\n          configPitchSin = Math.sin(config.pitch * Math.PI / 180),\n          configPitchCos = Math.cos(config.pitch * Math.PI / 180),\n          yawCos = Math.cos((-hs.yaw + config.yaw) * Math.PI / 180);\n      var z = hsPitchSin * configPitchSin + hsPitchCos * yawCos * configPitchCos;\n\n      if (hs.yaw <= 90 && hs.yaw > -90 && z <= 0 || (hs.yaw > 90 || hs.yaw <= -90) && z <= 0) {\n        hs.div.style.visibility = \"hidden\";\n      } else {\n        var yawSin = Math.sin((-hs.yaw + config.yaw) * Math.PI / 180),\n            hfovTan = Math.tan(config.hfov * Math.PI / 360);\n        hs.div.style.visibility = \"visible\"; // Subpixel rendering doesn't work in Firefox\n        // https://bugzilla.mozilla.org/show_bug.cgi?id=739176\n\n        var canvas = renderer.getCanvas(),\n            canvasWidth = canvas.clientWidth,\n            canvasHeight = canvas.clientHeight;\n        var coord = [-canvasWidth / hfovTan * yawSin * hsPitchCos / z / 2, -canvasWidth / hfovTan * (hsPitchSin * configPitchCos - hsPitchCos * yawCos * configPitchSin) / z / 2]; // Apply roll\n\n        var rollSin = Math.sin(config.roll * Math.PI / 180),\n            rollCos = Math.cos(config.roll * Math.PI / 180);\n        coord = [coord[0] * rollCos - coord[1] * rollSin, coord[0] * rollSin + coord[1] * rollCos]; // Apply transform\n\n        coord[0] += (canvasWidth - hs.div.offsetWidth) / 2;\n        coord[1] += (canvasHeight - hs.div.offsetHeight) / 2;\n        var transform = \"translate(\" + coord[0] + \"px, \" + coord[1] + \"px) translateZ(9999px) rotate(\" + config.roll + \"deg)\";\n\n        if (hs.scale) {\n          transform += \" scale(\" + origHfov / config.hfov / z + \")\";\n        }\n\n        hs.div.style.webkitTransform = transform;\n        hs.div.style.MozTransform = transform;\n        hs.div.style.transform = transform;\n      }\n    }\n    /**\r\n     * Renders hot spots, updating their positions and visibility.\r\n     * @private\r\n     */\n\n\n    function renderHotSpots() {\n      config.hotSpots.forEach(renderHotSpot);\n    }\n    /**\r\n     * Merges a scene configuration into the current configuration.\r\n     * @private\r\n     * @param {string} sceneId - Identifier of scene configuration to merge in.\r\n     */\n\n\n    function mergeConfig(sceneId) {\n      config = {};\n      var k, s;\n      var photoSphereExcludes = [\"haov\", \"vaov\", \"vOffset\", \"northOffset\", \"horizonPitch\", \"horizonRoll\"];\n      specifiedPhotoSphereExcludes = []; // Merge default config\n\n      for (k in defaultConfig) {\n        if (defaultConfig.hasOwnProperty(k)) {\n          config[k] = defaultConfig[k];\n        }\n      } // Merge default scene config\n\n\n      for (k in initialConfig[\"default\"]) {\n        if (initialConfig[\"default\"].hasOwnProperty(k)) {\n          if (k === \"uiText\") {\n            for (s in initialConfig[\"default\"].uiText) {\n              if (initialConfig[\"default\"].uiText.hasOwnProperty(s)) {\n                config.uiText[s] = escapeHTML(initialConfig[\"default\"].uiText[s]);\n              }\n            }\n          } else {\n            config[k] = initialConfig[\"default\"][k];\n\n            if (photoSphereExcludes.indexOf(k) >= 0) {\n              specifiedPhotoSphereExcludes.push(k);\n            }\n          }\n        }\n      } // Merge current scene config\n\n\n      if (sceneId !== null && sceneId !== \"\" && initialConfig.scenes && initialConfig.scenes[sceneId]) {\n        var scene = initialConfig.scenes[sceneId];\n\n        for (k in scene) {\n          if (scene.hasOwnProperty(k)) {\n            if (k === \"uiText\") {\n              for (s in scene.uiText) {\n                if (scene.uiText.hasOwnProperty(s)) {\n                  config.uiText[s] = escapeHTML(scene.uiText[s]);\n                }\n              }\n            } else {\n              config[k] = scene[k];\n\n              if (photoSphereExcludes.indexOf(k) >= 0) {\n                specifiedPhotoSphereExcludes.push(k);\n              }\n            }\n          }\n        }\n\n        config.scene = sceneId;\n      } // Merge initial config\n\n\n      for (k in initialConfig) {\n        if (initialConfig.hasOwnProperty(k)) {\n          if (k === \"uiText\") {\n            for (s in initialConfig.uiText) {\n              if (initialConfig.uiText.hasOwnProperty(s)) {\n                config.uiText[s] = escapeHTML(initialConfig.uiText[s]);\n              }\n            }\n          } else {\n            config[k] = initialConfig[k];\n\n            if (photoSphereExcludes.indexOf(k) >= 0) {\n              specifiedPhotoSphereExcludes.push(k);\n            }\n          }\n        }\n      }\n    }\n    /**\r\n     * Processes configuration options.\r\n     * @param {boolean} [isPreview] - Whether or not the preview is being displayed\r\n     * @private\r\n     */\n\n\n    function processOptions(isPreview) {\n      isPreview = isPreview ? isPreview : false; // Process preview first so it always loads before the browser hits its\n      // maximum number of connections to a server as can happen with cubic\n      // panoramas\n\n      if (isPreview && \"preview\" in config) {\n        var p = config.preview;\n        if (config.basePath && !absoluteURL(p)) p = config.basePath + p;\n        preview = document.createElement(\"div\");\n        preview.className = \"pnlm-preview-img\";\n        preview.style.backgroundImage = \"url('\" + sanitizeURLForCss(p) + \"')\";\n        renderContainer.appendChild(preview);\n      } // Handle different preview values\n\n\n      var title = config.title,\n          author = config.author,\n          description = config.description;\n\n      if (isPreview) {\n        if (\"previewTitle\" in config) config.title = config.previewTitle;\n        if (\"previewDescription\" in config) config.description = config.previewDescription;\n        if (\"previewAuthor\" in config) config.author = config.previewAuthor;\n      } // Reset title / author display\n\n\n      if (!config.hasOwnProperty(\"title\")) infoDisplay.title.innerHTML = \"\";\n      if (!config.hasOwnProperty(\"description\")) infoDisplay.description.innerHTML = \"\";\n      if (!config.hasOwnProperty(\"author\")) infoDisplay.author.innerHTML = \"\";\n      if (!config.hasOwnProperty(\"title\") && !config.hasOwnProperty(\"description\") && !config.hasOwnProperty(\"author\")) infoDisplay.container.style.display = \"none\"; // Fill in load button label and loading box text\n\n      controls.load.innerHTML = \"<p>\" + config.uiText.loadButtonLabel + \"</p>\";\n      infoDisplay.load.boxp.innerHTML = config.uiText.loadingLabel; // Process other options\n\n      for (var key in config) {\n        if (config.hasOwnProperty(key)) {\n          switch (key) {\n            case \"title\":\n              infoDisplay.title.innerHTML = escapeHTML(config[key]);\n              infoDisplay.container.style.display = \"inline\";\n              break;\n\n            case \"description\":\n              infoDisplay.description.innerHTML = escapeHTML(config[key]);\n              infoDisplay.container.style.display = \"inline\";\n              break;\n\n            case \"author\":\n              var authorText = escapeHTML(config[key]);\n\n              if (config.authorURL) {\n                var authorLink = document.createElement(\"a\");\n                authorLink.href = sanitizeURL(config[\"authorURL\"]);\n                authorLink.target = \"_blank\";\n                authorLink.innerHTML = escapeHTML(config[key]);\n                authorText = authorLink.outerHTML;\n              }\n\n              infoDisplay.author.innerHTML = config.uiText.bylineLabel.replace(\"%s\", authorText);\n              infoDisplay.container.style.display = \"inline\";\n              break;\n\n            case \"fallback\":\n              var link = document.createElement(\"a\");\n              link.href = sanitizeURL(config[key]);\n              link.target = \"_blank\";\n              link.textContent = \"Click here to view this panorama in an alternative viewer.\";\n              var message = document.createElement(\"p\");\n              message.textContent = \"Your browser does not support WebGL.\";\n              message.appendChild(document.createElement(\"br\"));\n              message.appendChild(link);\n              infoDisplay.errorMsg.innerHTML = \"\"; // Removes all children nodes\n\n              infoDisplay.errorMsg.appendChild(message);\n              break;\n\n            case \"hfov\":\n              setHfov(Number(config[key]));\n              break;\n\n            case \"autoLoad\":\n              if (config[key] === true && renderer === undefined$1) {\n                // Show loading box\n                infoDisplay.load.box.style.display = \"inline\"; // Hide load button\n\n                controls.load.style.display = \"none\"; // Initialize\n\n                init();\n              }\n\n              break;\n\n            case \"showZoomCtrl\":\n              if (config[key] && config.showControls != false) {\n                // Show zoom controls\n                controls.zoom.style.display = \"block\";\n              } else {\n                // Hide zoom controls\n                controls.zoom.style.display = \"none\";\n              }\n\n              break;\n\n            case \"showFullscreenCtrl\":\n              if (config[key] && config.showControls != false && (\"fullscreen\" in document || \"mozFullScreen\" in document || \"webkitIsFullScreen\" in document || \"msFullscreenElement\" in document)) {\n                // Show fullscreen control\n                controls.fullscreen.style.display = \"block\";\n              } else {\n                // Hide fullscreen control\n                controls.fullscreen.style.display = \"none\";\n              }\n\n              break;\n\n            case \"hotSpotDebug\":\n              if (config[key]) hotSpotDebugIndicator.style.display = \"block\";else hotSpotDebugIndicator.style.display = \"none\";\n              break;\n\n            case \"showControls\":\n              if (!config[key]) {\n                controls.orientation.style.display = \"none\";\n                controls.zoom.style.display = \"none\";\n                controls.fullscreen.style.display = \"none\";\n              }\n\n              break;\n\n            case \"orientationOnByDefault\":\n              if (config[key]) {\n                startOrientation();\n                break;\n              }\n\n          }\n        }\n      }\n\n      if (isPreview) {\n        // Restore original values if changed for preview\n        if (title) config.title = title;else delete config.title;\n        if (description) config.description = description;else delete config.description;\n        if (author) config.author = author;else delete config.author;\n      }\n    }\n    /**\r\n     * Toggles fullscreen mode.\r\n     * @private\r\n     */\n\n\n    function toggleFullscreen() {\n      if (loaded && !error) {\n        if (!fullscreenActive) {\n          try {\n            if (container.requestFullscreen) {\n              container.requestFullscreen();\n            } else if (container.mozRequestFullScreen) {\n              container.mozRequestFullScreen();\n            } else if (container.msRequestFullscreen) {\n              container.msRequestFullscreen();\n            } else {\n              container.webkitRequestFullScreen();\n            }\n          } catch (event) {// Fullscreen doesn't work\n          }\n        } else {\n          if (document.exitFullscreen) {\n            document.exitFullscreen();\n          } else if (document.mozCancelFullScreen) {\n            document.mozCancelFullScreen();\n          } else if (document.webkitCancelFullScreen) {\n            document.webkitCancelFullScreen();\n          } else if (document.msExitFullscreen) {\n            document.msExitFullscreen();\n          }\n        }\n      }\n    }\n    /**\r\n     * Event handler for fullscreen changes.\r\n     * @private\r\n     */\n\n\n    function onFullScreenChange(resize) {\n      if (document.fullscreenElement || document.fullscreen || document.mozFullScreen || document.webkitIsFullScreen || document.msFullscreenElement) {\n        controls.fullscreen.classList.add(\"pnlm-fullscreen-toggle-button-active\");\n        fullscreenActive = true;\n      } else {\n        controls.fullscreen.classList.remove(\"pnlm-fullscreen-toggle-button-active\");\n        fullscreenActive = false;\n      }\n\n      if (resize !== \"resize\") fireEvent(\"fullscreenchange\", fullscreenActive); // Resize renderer (deal with browser quirks and fixes #155)\n\n      renderer.resize();\n      setHfov(config.hfov);\n      animateInit();\n    }\n    /**\r\n     * Increases panorama zoom. For use with zoom button.\r\n     * @private\r\n     */\n\n\n    function zoomIn() {\n      if (loaded) {\n        setHfov(config.hfov - 5);\n        animateInit();\n      }\n    }\n    /**\r\n     * Decreases panorama zoom. For use with zoom button.\r\n     * @private\r\n     */\n\n\n    function zoomOut() {\n      if (loaded) {\n        setHfov(config.hfov + 5);\n        animateInit();\n      }\n    }\n    /**\r\n     * Clamps horzontal field of view to viewer's limits.\r\n     * @private\r\n     * @param {number} hfov - Input horizontal field of view (in degrees)\r\n     * @return {number} - Clamped horizontal field of view (in degrees)\r\n     */\n\n\n    function constrainHfov(hfov) {\n      // Keep field of view within bounds\n      var minHfov = config.minHfov;\n\n      if (config.type === \"multires\" && renderer && !config.multiResMinHfov) {\n        minHfov = Math.min(minHfov, renderer.getCanvas().width / (config.multiRes.cubeResolution / 90 * 0.9));\n      }\n\n      if (minHfov > config.maxHfov) {\n        // Don't change view if bounds don't make sense\n        console.log(\"HFOV bounds do not make sense (minHfov > maxHfov).\");\n        return config.hfov;\n      }\n\n      var newHfov = config.hfov;\n\n      if (hfov < minHfov) {\n        newHfov = minHfov;\n      } else if (hfov > config.maxHfov) {\n        newHfov = config.maxHfov;\n      } else {\n        newHfov = hfov;\n      } // Optionally avoid showing background (empty space) on top or bottom by adapting newHfov\n\n\n      if (config.avoidShowingBackground && renderer) {\n        var canvas = renderer.getCanvas();\n        newHfov = Math.min(newHfov, Math.atan(Math.tan((config.maxPitch - config.minPitch) / 360 * Math.PI) / canvas.height * canvas.width) * 360 / Math.PI);\n      }\n\n      return newHfov;\n    }\n    /**\r\n     * Sets viewer's horizontal field of view.\r\n     * @private\r\n     * @param {number} hfov - Desired horizontal field of view in degrees.\r\n     */\n\n\n    function setHfov(hfov) {\n      config.hfov = constrainHfov(hfov);\n      fireEvent(\"zoomchange\", config.hfov);\n    }\n    /**\r\n     * Stops auto rotation and animated moves.\r\n     * @private\r\n     */\n\n\n    function stopAnimation() {\n      animatedMove = {};\n      autoRotateSpeed = config.autoRotate ? config.autoRotate : autoRotateSpeed;\n      config.autoRotate = false;\n    }\n    /**\r\n     * Loads panorama.\r\n     * @private\r\n     */\n\n\n    function load() {\n      // Since WebGL error handling is very general, first we clear any error box\n      // since it is a new scene and the error from previous maybe because of lacking\n      // memory etc and not because of a lack of WebGL support etc\n      clearError();\n      loaded = false;\n      controls.load.style.display = \"none\";\n      infoDisplay.load.box.style.display = \"inline\";\n      init();\n    }\n    /**\r\n     * Loads scene.\r\n     * @private\r\n     * @param {string} sceneId - Identifier of scene configuration to merge in.\r\n     * @param {number} targetPitch - Pitch viewer should be centered on once scene loads.\r\n     * @param {number} targetYaw - Yaw viewer should be centered on once scene loads.\r\n     * @param {number} targetHfov - HFOV viewer should use once scene loads.\r\n     * @param {boolean} [fadeDone] - If `true`, fade setup is skipped.\r\n     */\n\n\n    function loadScene(sceneId, targetPitch, targetYaw, targetHfov, fadeDone) {\n      if (!loaded) fadeDone = true; // Don't try to fade when there isn't a scene loaded\n\n      loaded = false;\n      animatedMove = {}; // Set up fade if specified\n\n      var fadeImg, workingPitch, workingYaw, workingHfov;\n\n      if (config.sceneFadeDuration && !fadeDone) {\n        var data = renderer.render(config.pitch * Math.PI / 180, config.yaw * Math.PI / 180, config.hfov * Math.PI / 180, {\n          returnImage: true\n        });\n\n        if (data !== undefined$1) {\n          fadeImg = new Image();\n          fadeImg.className = \"pnlm-fade-img\";\n          fadeImg.style.transition = \"opacity \" + config.sceneFadeDuration / 1000 + \"s\";\n          fadeImg.style.width = \"100%\";\n          fadeImg.style.height = \"100%\";\n\n          fadeImg.onload = function () {\n            loadScene(sceneId, targetPitch, targetYaw, targetHfov, true);\n          };\n\n          fadeImg.src = data;\n          renderContainer.appendChild(fadeImg);\n          renderer.fadeImg = fadeImg;\n          return;\n        }\n      } // Set new pointing\n\n\n      if (targetPitch === \"same\") {\n        workingPitch = config.pitch;\n      } else {\n        workingPitch = targetPitch;\n      }\n\n      if (targetYaw === \"same\") {\n        workingYaw = config.yaw;\n      } else if (targetYaw === \"sameAzimuth\") {\n        workingYaw = config.yaw + (config.northOffset || 0) - (initialConfig.scenes[sceneId].northOffset || 0);\n      } else {\n        workingYaw = targetYaw;\n      }\n\n      if (targetHfov === \"same\") {\n        workingHfov = config.hfov;\n      } else {\n        workingHfov = targetHfov;\n      } // Destroy hot spots from previous scene\n\n\n      destroyHotSpots(); // Create the new config for the scene\n\n      mergeConfig(sceneId); // Stop motion\n\n      speed.yaw = speed.pitch = speed.hfov = 0; // Reload scene\n\n      processOptions();\n\n      if (workingPitch !== undefined$1) {\n        config.pitch = workingPitch;\n      }\n\n      if (workingYaw !== undefined$1) {\n        config.yaw = workingYaw;\n      }\n\n      if (workingHfov !== undefined$1) {\n        config.hfov = workingHfov;\n      }\n\n      fireEvent(\"scenechange\", sceneId);\n      load();\n    }\n    /**\r\n     * Stop using device orientation.\r\n     * @private\r\n     */\n\n\n    function stopOrientation() {\n      window.removeEventListener(\"deviceorientation\", orientationListener);\n      controls.orientation.classList.remove(\"pnlm-orientation-button-active\");\n      orientation = false;\n    }\n    /**\r\n     * Start using device orientation.\r\n     * @private\r\n     */\n\n\n    function startOrientation() {\n      orientation = 1; // Fix for IOS 13 where the user needs to perform an action i.e click. Then we need to ask permission\n\n      if (DeviceOrientationEvent && typeof DeviceOrientationEvent.requestPermission === \"function\") {\n        DeviceOrientationEvent.requestPermission().then(function (response) {\n          if (response === \"granted\") {\n            window.addEventListener(\"deviceorientation\", orientationListener);\n          }\n        })[\"catch\"](console.error);\n      } else {\n        window.addEventListener(\"deviceorientation\", orientationListener);\n      } // window.addEventListener('deviceorientation', orientationListener);\n\n\n      controls.orientation.classList.add(\"pnlm-orientation-button-active\");\n    }\n    /**\r\n     * Escapes HTML string (to mitigate possible DOM XSS attacks).\r\n     * @private\r\n     * @param {string} s - String to escape\r\n     * @returns {string} Escaped string\r\n     */\n\n\n    function escapeHTML(s) {\n      if (!initialConfig.escapeHTML) return String(s).split(\"\\n\").join(\"<br>\");\n      return String(s).split(/&/g).join(\"&amp;\").split('\"').join(\"&quot;\").split(\"'\").join(\"&#39;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\").split(\"/\").join(\"&#x2f;\").split(\"\\n\").join(\"<br>\"); // Allow line breaks\n    }\n    /**\r\n     * Removes possibility of XSS attacks with URLs.\r\n     * The URL cannot be of protocol 'javascript'.\r\n     * @private\r\n     * @param {string} url - URL to sanitize\r\n     * @returns {string} Sanitized URL\r\n     */\n\n\n    function sanitizeURL(url) {\n      if (url.trim().toLowerCase().indexOf(\"javascript:\") === 0) {\n        return \"about:blank\";\n      }\n\n      return url;\n    }\n    /**\r\n     * Removes possibility of XSS atacks with URLs for CSS.\r\n     * The URL will be sanitized with `sanitizeURL()` and single quotes\r\n     * and double quotes escaped.\r\n     * @private\r\n     * @param {string} url - URL to sanitize\r\n     * @returns {string} Sanitized URL\r\n     */\n\n\n    function sanitizeURLForCss(url) {\n      return sanitizeURL(url).replace(/\"/g, \"%22\").replace(/'/g, \"%27\");\n    }\n    /**\r\n     * Checks whether or not a panorama is loaded.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {boolean} `true` if a panorama is loaded, else `false`\r\n     */\n\n\n    this.isLoaded = function () {\n      return Boolean(loaded);\n    };\n    /**\r\n     * Returns the pitch of the center of the view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} Pitch in degrees\r\n     */\n\n\n    this.getPitch = function () {\n      return config.pitch;\n    };\n    /**\r\n     * Sets the pitch of the center of the view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} pitch - Pitch in degrees\r\n     * @param {boolean|number} [animated=1000] - Animation duration in milliseconds or false for no animation\r\n     * @param {function} [callback] - Function to call when animation finishes\r\n     * @param {object} [callbackArgs] - Arguments to pass to callback function\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.setPitch = function (pitch, animated, callback, callbackArgs) {\n      latestInteraction = Date.now();\n\n      if (Math.abs(pitch - config.pitch) <= eps) {\n        if (typeof callback === \"function\") callback(callbackArgs);\n        return this;\n      }\n\n      animated = animated === undefined$1 ? 1000 : Number(animated);\n\n      if (animated) {\n        animatedMove.pitch = {\n          startTime: Date.now(),\n          startPosition: config.pitch,\n          endPosition: pitch,\n          duration: animated\n        };\n        if (typeof callback === \"function\") setTimeout(function () {\n          callback(callbackArgs);\n        }, animated);\n      } else {\n        config.pitch = pitch;\n      }\n\n      animateInit();\n      return this;\n    };\n    /**\r\n     * Returns the minimum and maximum allowed pitches (in degrees).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number[]} [minimum pitch, maximum pitch]\r\n     */\n\n\n    this.getPitchBounds = function () {\n      return [config.minPitch, config.maxPitch];\n    };\n    /**\r\n     * Set the minimum and maximum allowed pitches (in degrees).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number[]} bounds - [minimum pitch, maximum pitch]\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.setPitchBounds = function (bounds) {\n      config.minPitch = Math.max(-90, Math.min(bounds[0], 90));\n      config.maxPitch = Math.max(-90, Math.min(bounds[1], 90));\n      return this;\n    };\n    /**\r\n     * Returns the yaw of the center of the view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} Yaw in degrees\r\n     */\n\n\n    this.getYaw = function () {\n      return config.yaw;\n    };\n    /**\r\n     * Sets the yaw of the center of the view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} yaw - Yaw in degrees [-180, 180]\r\n     * @param {boolean|number} [animated=1000] - Animation duration in milliseconds or false for no animation\r\n     * @param {function} [callback] - Function to call when animation finishes\r\n     * @param {object} [callbackArgs] - Arguments to pass to callback function\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.setYaw = function (yaw, animated, callback, callbackArgs) {\n      latestInteraction = Date.now();\n\n      if (Math.abs(yaw - config.yaw) <= eps) {\n        if (typeof callback === \"function\") callback(callbackArgs);\n        return this;\n      }\n\n      animated = animated === undefined$1 ? 1000 : Number(animated);\n      yaw = (yaw + 180) % 360 - 180; // Keep in bounds\n\n      if (animated) {\n        // Animate in shortest direction\n        if (config.yaw - yaw > 180) yaw += 360;else if (yaw - config.yaw > 180) yaw -= 360;\n        animatedMove.yaw = {\n          startTime: Date.now(),\n          startPosition: config.yaw,\n          endPosition: yaw,\n          duration: animated\n        };\n        if (typeof callback === \"function\") setTimeout(function () {\n          callback(callbackArgs);\n        }, animated);\n      } else {\n        config.yaw = yaw;\n      }\n\n      animateInit();\n      return this;\n    };\n    /**\r\n     * Returns the minimum and maximum allowed pitches (in degrees).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number[]} [yaw pitch, maximum yaw]\r\n     */\n\n\n    this.getYawBounds = function () {\n      return [config.minYaw, config.maxYaw];\n    };\n    /**\r\n     * Set the minimum and maximum allowed yaws (in degrees [-180, 180]).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number[]} bounds - [minimum yaw, maximum yaw]\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.setYawBounds = function (bounds) {\n      config.minYaw = Math.max(-180, Math.min(bounds[0], 180));\n      config.maxYaw = Math.max(-180, Math.min(bounds[1], 180));\n      return this;\n    };\n    /**\r\n     * Returns the horizontal field of view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} Horizontal field of view in degrees\r\n     */\n\n\n    this.getHfov = function () {\n      return config.hfov;\n    };\n    /**\r\n     * Sets the horizontal field of view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} hfov - Horizontal field of view in degrees\r\n     * @param {boolean|number} [animated=1000] - Animation duration in milliseconds or false for no animation\r\n     * @param {function} [callback] - Function to call when animation finishes\r\n     * @param {object} [callbackArgs] - Arguments to pass to callback function\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.setHfov = function (hfov, animated, callback, callbackArgs) {\n      latestInteraction = Date.now();\n\n      if (Math.abs(hfov - config.hfov) <= eps) {\n        if (typeof callback === \"function\") callback(callbackArgs);\n        return this;\n      }\n\n      animated = animated === undefined$1 ? 1000 : Number(animated);\n\n      if (animated) {\n        animatedMove.hfov = {\n          startTime: Date.now(),\n          startPosition: config.hfov,\n          endPosition: constrainHfov(hfov),\n          duration: animated\n        };\n        if (typeof callback === \"function\") setTimeout(function () {\n          callback(callbackArgs);\n        }, animated);\n      } else {\n        setHfov(hfov);\n      }\n\n      animateInit();\n      return this;\n    };\n    /**\r\n     * Returns the minimum and maximum allowed horizontal fields of view\r\n     * (in degrees).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number[]} [minimum hfov, maximum hfov]\r\n     */\n\n\n    this.getHfovBounds = function () {\n      return [config.minHfov, config.maxHfov];\n    };\n    /**\r\n     * Set the minimum and maximum allowed horizontal fields of view (in degrees).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number[]} bounds - [minimum hfov, maximum hfov]\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.setHfovBounds = function (bounds) {\n      config.minHfov = Math.max(0, bounds[0]);\n      config.maxHfov = Math.max(0, bounds[1]);\n      return this;\n    };\n    /**\r\n     * Set a new view. Any parameters not specified remain the same.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} [pitch] - Target pitch\r\n     * @param {number} [yaw] - Target yaw\r\n     * @param {number} [hfov] - Target hfov\r\n     * @param {boolean|number} [animated=1000] - Animation duration in milliseconds or false for no animation\r\n     * @param {function} [callback] - Function to call when animation finishes\r\n     * @param {object} [callbackArgs] - Arguments to pass to callback function\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.lookAt = function (pitch, yaw, hfov, animated, callback, callbackArgs) {\n      animated = animated === undefined$1 ? 1000 : Number(animated);\n\n      if (pitch !== undefined$1 && Math.abs(pitch - config.pitch) > eps) {\n        this.setPitch(pitch, animated, callback, callbackArgs);\n        callback = undefined$1;\n      }\n\n      if (yaw !== undefined$1 && Math.abs(yaw - config.yaw) > eps) {\n        this.setYaw(yaw, animated, callback, callbackArgs);\n        callback = undefined$1;\n      }\n\n      if (hfov !== undefined$1 && Math.abs(hfov - config.hfov) > eps) {\n        this.setHfov(hfov, animated, callback, callbackArgs);\n        callback = undefined$1;\n      }\n\n      if (typeof callback === \"function\") callback(callbackArgs);\n      return this;\n    };\n    /**\r\n     * Returns the panorama's north offset.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} North offset in degrees\r\n     */\n\n\n    this.getNorthOffset = function () {\n      return config.northOffset;\n    };\n    /**\r\n     * Sets the panorama's north offset.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} heading - North offset in degrees\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.setNorthOffset = function (heading) {\n      config.northOffset = Math.min(360, Math.max(0, heading));\n      animateInit();\n      return this;\n    };\n    /**\r\n     * Returns the panorama's horizon roll.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} Horizon roll in degrees\r\n     */\n\n\n    this.getHorizonRoll = function () {\n      return config.horizonRoll;\n    };\n    /**\r\n     * Sets the panorama's horizon roll.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} roll - Horizon roll in degrees [-90, 90]\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.setHorizonRoll = function (roll) {\n      config.horizonRoll = Math.min(90, Math.max(-90, roll));\n      renderer.setPose(config.horizonPitch * Math.PI / 180, config.horizonRoll * Math.PI / 180);\n      animateInit();\n      return this;\n    };\n    /**\r\n     * Returns the panorama's horizon pitch.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} Horizon pitch in degrees\r\n     */\n\n\n    this.getHorizonPitch = function () {\n      return config.horizonPitch;\n    };\n    /**\r\n     * Sets the panorama's horizon pitch.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} pitch - Horizon pitch in degrees [-90, 90]\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.setHorizonPitch = function (pitch) {\n      config.horizonPitch = Math.min(90, Math.max(-90, pitch));\n      renderer.setPose(config.horizonPitch * Math.PI / 180, config.horizonRoll * Math.PI / 180);\n      animateInit();\n      return this;\n    };\n    /**\r\n     * Start auto rotation.\r\n     *\r\n     * Before starting rotation, the viewer is panned to `pitch`.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} [speed] - Auto rotation speed / direction. If not specified, previous value is used.\r\n     * @param {number} [pitch] - The pitch to rotate at. If not specified, inital pitch is used.\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.startAutoRotate = function (speed, pitch) {\n      speed = speed || autoRotateSpeed || 1;\n      pitch = pitch === undefined$1 ? origPitch : pitch;\n      config.autoRotate = speed;\n\n      _this.lookAt(pitch, undefined$1, origHfov, 3000);\n\n      animateInit();\n      return this;\n    };\n    /**\r\n     * Stop auto rotation.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.stopAutoRotate = function () {\n      autoRotateSpeed = config.autoRotate ? config.autoRotate : autoRotateSpeed;\n      config.autoRotate = false;\n      config.autoRotateInactivityDelay = -1;\n      return this;\n    };\n\n    this.showCompass = function (value) {\n      config.compass = value;\n      renderInitCallback();\n      console.log(config);\n      return this;\n    };\n    /**\r\n     * Stops all movement.\r\n     * @memberof Viewer\r\n     * @instance\r\n     */\n\n\n    this.stopMovement = function () {\n      stopAnimation();\n      speed = {\n        yaw: 0,\n        pitch: 0,\n        hfov: 0\n      };\n    };\n    /**\r\n     * Returns the panorama renderer.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {Renderer}\r\n     */\n\n\n    this.getRenderer = function () {\n      return renderer;\n    };\n    /**\r\n     * Sets update flag for dynamic content.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {boolean} bool - Whether or not viewer should update even when still\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.setUpdate = function (bool) {\n      update = bool === true;\n      if (renderer === undefined$1) onImageLoad();else animateInit();\n      return this;\n    };\n\n    this.changeMouseCursor = function (event) {\n      return changeMouseCursor(event);\n    };\n\n    this.sceneLoadListener = function () {\n      return sceneLoadListener();\n    };\n    /**\r\n     * Calculate panorama pitch and yaw from location of mouse event.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {MouseEvent} event - Document mouse down event.\r\n     * @returns {number[]} [pitch, yaw]\r\n     */\n\n\n    this.mouseEventToCoords = function (event) {\n      return mouseEventToCoords(event);\n    };\n    /**\r\n     * Change scene being viewed.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {string} sceneId - Identifier of scene to switch to.\r\n     * @param {number} [pitch] - Pitch to use with new scene\r\n     * @param {number} [yaw] - Yaw to use with new scene\r\n     * @param {number} [hfov] - HFOV to use with new scene\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.loadScene = function (sceneId, pitch, yaw, hfov) {\n      if (loaded !== false) loadScene(sceneId, pitch, yaw, hfov);\n      return this;\n    };\n    /**\r\n     * Get ID of current scene.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {string} ID of current scene\r\n     */\n\n\n    this.getScene = function () {\n      return config.scene;\n    };\n    /**\r\n     * Get ID of all scenes.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns [Object] ID of all scenes\r\n     */\n\n\n    this.getAllScenes = function () {\n      var allScenes = [];\n      Object.keys(initialConfig.scenes).forEach(function (scene) {\n        allScenes.push(_defineProperty({}, scene, initialConfig.scenes[scene]));\n      });\n      return allScenes;\n    };\n    /**\r\n     * Add a new scene.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {string} sceneId - The ID of the new scene\r\n     * @param {string} config - The configuration of the new scene\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.addScene = function (sceneId, config) {\n      initialConfig.scenes[sceneId] = config;\n      return this;\n    };\n    /**\r\n     * Remove a scene.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {string} sceneId - The ID of the scene\r\n     * @returns {boolean} False if the scene is the current scene or if the scene doesn't exists, else true\r\n     */\n\n\n    this.removeScene = function (sceneId) {\n      if (config.scene === sceneId || !initialConfig.scenes.hasOwnProperty(sceneId)) return false;\n      delete initialConfig.scenes[sceneId];\n      return true;\n    };\n    /**\r\n     * Toggle fullscreen.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.toggleFullscreen = function () {\n      toggleFullscreen();\n      return this;\n    };\n    /**\r\n     * Get configuration of current scene.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {Object} Configuration of current scene\r\n     */\n\n\n    this.getConfig = function () {\n      return config;\n    };\n    /**\r\n     * Get viewer's container element.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {HTMLElement} Container `div` element\r\n     */\n\n\n    this.getContainer = function () {\n      return container;\n    };\n    /**\r\n     * Add a new hot spot.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {Object} hs - The configuration for the hot spot\r\n     * @param {string} [sceneId] - Adds hot spot to specified scene if provided, else to current scene\r\n     * @returns {Viewer} `this`\r\n     * @throws Throws an error if the scene ID is provided but invalid\r\n     */\n\n\n    this.addHotSpot = function (hs, sceneId) {\n      if (sceneId === undefined$1 && config.scene === undefined$1) {\n        // Not a tour\n        config.hotSpots.push(hs);\n      } else {\n        // Tour\n        var id = sceneId !== undefined$1 ? sceneId : config.scene;\n\n        if (initialConfig.scenes.hasOwnProperty(id)) {\n          if (!initialConfig.scenes[id].hasOwnProperty(\"hotSpots\")) {\n            initialConfig.scenes[id].hotSpots = []; // Create hot spots array if needed\n\n            if (id === config.scene) config.hotSpots = initialConfig.scenes[id].hotSpots; // Link to current config\n          }\n\n          initialConfig.scenes[id].hotSpots.push(hs); // Add hot spot to config\n        } else {\n          throw \"Invalid scene ID!\";\n        }\n      }\n\n      if (sceneId === undefined$1 || config.scene === sceneId) {\n        // Add to current scene\n        createHotSpot(hs);\n        if (loaded) renderHotSpot(hs);\n      }\n\n      return this;\n    };\n    /**\r\n     * Remove a hot spot.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {string} hotSpotId - The ID of the hot spot\r\n     * @param {string} [sceneId] - Removes hot spot from specified scene if provided, else from current scene\r\n     * @returns {boolean} True if deletion is successful, else false\r\n     */\n\n\n    this.removeHotSpot = function (hotSpotId, sceneId) {\n      if (sceneId === undefined$1 || config.scene === sceneId) {\n        if (!config.hotSpots) return false;\n\n        for (var i = 0; i < config.hotSpots.length; i++) {\n          if (config.hotSpots[i].hasOwnProperty(\"id\") && config.hotSpots[i].id === hotSpotId) {\n            // Delete hot spot DOM elements\n            var current = config.hotSpots[i].div;\n\n            while (current.parentNode != renderContainer) {\n              current = current.parentNode;\n            }\n\n            renderContainer.removeChild(current);\n            delete config.hotSpots[i].div; // Remove hot spot from configuration\n\n            config.hotSpots.splice(i, 1);\n            return true;\n          }\n        }\n      } else {\n        if (initialConfig.scenes.hasOwnProperty(sceneId)) {\n          if (!initialConfig.scenes[sceneId].hasOwnProperty(\"hotSpots\")) return false;\n\n          for (var j = 0; j < initialConfig.scenes[sceneId].hotSpots.length; j++) {\n            if (initialConfig.scenes[sceneId].hotSpots[j].hasOwnProperty(\"id\") && initialConfig.scenes[sceneId].hotSpots[j].id === hotSpotId) {\n              // Remove hot spot from configuration\n              initialConfig.scenes[sceneId].hotSpots.splice(j, 1);\n              return true;\n            }\n          }\n        } else {\n          return false;\n        }\n      }\n    };\n    /**\r\n     * This method should be called if the viewer's container is resized.\r\n     * @memberof Viewer\r\n     * @instance\r\n     */\n\n\n    this.resize = function () {\n      if (renderer) onDocumentResize();\n    };\n    /**\r\n     * Check if a panorama is loaded.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {boolean} True if a panorama is loaded, else false\r\n     */\n\n\n    this.isLoaded = function () {\n      return loaded;\n    };\n    /**\r\n     * Check if device orientation control is supported.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {boolean} True if supported, else false\r\n     */\n\n\n    this.isOrientationSupported = function () {\n      return orientationSupport || false;\n    };\n    /**\r\n     * Stop using device orientation.\r\n     * @memberof Viewer\r\n     * @instance\r\n     */\n\n\n    this.stopOrientation = function () {\n      stopOrientation();\n    };\n    /**\r\n     * Start using device orientation (does nothing if not supported).\r\n     * @memberof Viewer\r\n     * @instance\r\n     */\n\n\n    this.startOrientation = function () {\n      if (orientationSupport) startOrientation();\n    };\n    /**\r\n     * Check if device orientation control is currently activated.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {boolean} True if active, else false\r\n     */\n\n\n    this.isOrientationActive = function () {\n      return Boolean(orientation);\n    };\n    /**\r\n     * Subscribe listener to specified event.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {string} type - Type of event to subscribe to.\r\n     * @param {Function} listener - Listener function to subscribe to event.\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.on = function (type, listener) {\n      externalEventListeners[type] = externalEventListeners[type] || [];\n      externalEventListeners[type].push(listener);\n      return this;\n    };\n    /**\r\n     * Remove an event listener (or listeners).\r\n     * @memberof Viewer\r\n     * @param {string} [type] - Type of event to remove listeners from. If not specified, all listeners are removed.\r\n     * @param {Function} [listener] - Listener function to remove. If not specified, all listeners of specified type are removed.\r\n     * @returns {Viewer} `this`\r\n     */\n\n\n    this.off = function (type, listener) {\n      if (!type) {\n        // Remove all listeners if type isn't specified\n        externalEventListeners = {};\n        return this;\n      }\n\n      if (listener) {\n        var i = externalEventListeners[type].indexOf(listener);\n\n        if (i >= 0) {\n          // Remove listener if found\n          externalEventListeners[type].splice(i, 1);\n        }\n\n        if (externalEventListeners[type].length === 0) {\n          // Remove category if empty\n          delete externalEventListeners[type];\n        }\n      } else {\n        // Remove category of listeners if listener isn't specified\n        delete externalEventListeners[type];\n      }\n\n      return this;\n    };\n    /**\r\n     * Fire listeners attached to specified event.\r\n     * @private\r\n     * @param {string} [type] - Type of event to fire listeners for.\r\n     */\n\n\n    function fireEvent(type) {\n      if (type in externalEventListeners) {\n        // Reverse iteration is useful, if event listener is removed inside its definition\n        for (var i = externalEventListeners[type].length; i > 0; i--) {\n          externalEventListeners[type][externalEventListeners[type].length - i].apply(null, [].slice.call(arguments, 1));\n        }\n      }\n    }\n    /**\r\n     * Destructor.\r\n     * @instance\r\n     * @memberof Viewer\r\n     */\n\n\n    this.destroy = function () {\n      destroyed = true;\n      clearTimeout(autoRotateStart);\n      if (renderer) renderer.destroy();\n\n      if (listenersAdded) {\n        document.removeEventListener(\"mousemove\", onDocumentMouseMove, false);\n        document.removeEventListener(\"mouseup\", onDocumentMouseUp, false);\n        container.removeEventListener(\"mozfullscreenchange\", onFullScreenChange, false);\n        container.removeEventListener(\"webkitfullscreenchange\", onFullScreenChange, false);\n        container.removeEventListener(\"msfullscreenchange\", onFullScreenChange, false);\n        container.removeEventListener(\"fullscreenchange\", onFullScreenChange, false);\n        window.removeEventListener(\"resize\", onDocumentResize, false);\n        window.removeEventListener(\"orientationchange\", onDocumentResize, false);\n        container.removeEventListener(\"keydown\", onDocumentKeyPress, false);\n        container.removeEventListener(\"keyup\", onDocumentKeyUp, false);\n        container.removeEventListener(\"blur\", clearKeys, false);\n        document.removeEventListener(\"mouseleave\", onDocumentMouseUp, false);\n      }\n\n      container.innerHTML = \"\";\n      container.classList.remove(\"pnlm-container\");\n    };\n  }\n\n  return {\n    viewer: function viewer(container, config) {\n      return new Viewer(container, config);\n    }\n  };\n}(typeof window === \"undefined\" ? null : window, typeof document === \"undefined\" ? null : document);\n\nvar myPromise = function myPromise(condition) {\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  var promise = new Promise(function (resolve, reject) {\n    if (condition) {\n      if (args !== []) {\n        resolve.apply(void 0, args);\n      } else {\n        reject(\"Argruments cannot be empty\");\n      }\n    } else {\n      reject(\"Something when wrong!!!\");\n    }\n  });\n  return promise;\n};\n\nvar configs = {\n  uiText: {\n    loadButtonLabel: \"Click to<br>Load<br>Panorama\",\n    loadingLabel: \"Loading...\",\n    bylineLabel: \"by %s\",\n    noPanoramaError: \"No panorama image was specified.\",\n    fileAccessError: \"The file %s could not be accessed.\",\n    malformedURLError: \"There is something wrong with the panorama URL.\",\n    iOS8WebGLError: \"Due to iOS 8's broken WebGL implementation, only progressive encoded JPEGs work for your device (this panorama uses standard encoding).\",\n    genericWebGLError: \"Your browser does not have the necessary WebGL support to display this panorama.\",\n    textureSizeError: \"This panorama is too big for your device! It's %spx wide, but your device only supports images up to %spx wide. Try another device. (If you're the author, try scaling down the image.)\",\n    unknownError: \"Unknown error. Check developer console.\"\n  },\n  styles: {\n    width: \"100%\",\n    height: \"90%\",\n    background: \"#000000\"\n  },\n  equirectangularOptions: {\n    haov: 360,\n    vaov: 180,\n    vOffset: 0,\n    ignoreGPanoXMP: false\n  },\n  panoramaConfigs: {\n    title: \"\",\n    author: \"\",\n    description: \"\",\n    autoLoad: false,\n    autoRotate: 0,\n    autoRotateInactivityDelay: 0,\n    autoRotateStopDelay: 0,\n    preview: \"\",\n    showZoomCtrl: true,\n    keyboardZoom: true,\n    mouseZoom: true,\n    doubleClickZoom: false,\n    draggable: true,\n    friction: 0.15,\n    disableKeyboardCtrl: false,\n    showFullscreenCtrl: true,\n    showControls: true,\n    touchPanSpeedCoeffFactor: 1,\n    yaw: 0,\n    pitch: 0,\n    maxPitch: 90,\n    minPitch: -90,\n    maxYaw: 180,\n    minYaw: -180,\n    hfov: 100,\n    minHfov: 50,\n    maxHfov: 120,\n    multiResMinHfov: false,\n    backgroundColor: [0, 0, 0],\n    avoidShowingBackground: false,\n    compass: false,\n    northOffset: 0,\n    hotSpots: [],\n    hotSpotDebug: false\n  }\n};\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === \"undefined\") {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName(\"head\")[0];\n  var style = document.createElement(\"style\");\n  style.type = \"text/css\";\n\n  if (insertAt === \"top\") {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = `/* Pannellum 2.4.1, https://github.com/mpetroff/pannellum */\\r\\n\\r\\n.pnlm-container {\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  overflow: hidden;\\r\\n  position: relative;\\r\\n  cursor: default;\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  font-family: Helvetica, \\\"Nimbus Sans L\\\", \\\"Liberation Sans\\\", Arial, sans-serif;\\r\\n  background: #f4f4f4 url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2267%22%20height%3D%22100%22%20viewBox%3D%220%200%2067%20100%22%3E%0A%3Cpath%20stroke%3D%22%23ccc%22%20fill%3D%22none%22%20d%3D%22M33.5%2C50%2C0%2C63%2C33.5%2C75%2C67%2C63%2C33.5%2C50m-33.5-50%2C67%2C25m-0.5%2C0%2C0%2C75m-66.5-75%2C67-25m-33.5%2C75%2C0%2C25m0-100%2C0%2C50%22%2F%3E%0A%3C%2Fsvg%3E%0A') repeat;\\r\\n  -webkit-user-select: none;\\r\\n  -khtml-user-select: none;\\r\\n  -moz-user-select: none;\\r\\n  -o-user-select: none;\\r\\n  -ms-user-select: none;\\r\\n  user-select: none;\\r\\n  outline: 0;\\r\\n  line-height: 1.4;\\r\\n  contain: content;\\r\\n}\\r\\n\\r\\n.pnlm-container * {\\r\\n  box-sizing: content-box;\\r\\n  font-family: source sans pro, ui-sans-serif;\\r\\n}\\r\\n\\r\\n.pnlm-ui {\\r\\n  position: absolute;\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  z-index: 1;\\r\\n}\\r\\n\\r\\n.pnlm-custom {\\r\\n  cursor: url(\"data:image/x-icon;base64,AAACAAEAICAAAAAAAACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAUAAAAFAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAQFBgYGBzc1ND4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAADwAAABEAAAAKAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAQAAAAIAAAACAAAAAwAAAAIAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAcAAAAJAAAABkAAAAMAAAABQAAAAMAAAABAAAAAwAAAAUAAAAHAAAACgAAAAsAAAANAAAACwAAAAkAAAAGAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAB8AAAAvAAAAKQAAAB8AAAASAAAADAAAAAcAAAALAAAAEwAAABoAAAAeAAAAIQAAACIAAAAgAAAAHQAAABYAAAAOAAAABgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFNQTs9TUE7QAAAAFgAAACsAAAAzAAAAMwAAACcAAAAeAAAAGAAAAB8AAAArAAAANQAAADoAAAA8AAAAPQAAADsAAAA4AAAALwAAACMAAAATAAAACAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkI6Mz5COjM9TUE7RAAAAHgAAADEAAAA+AAAAOwAAADUAAAAzAAAAOSSA3/8kgN//JIDf/ySA3/8kgN//AAAATQAAAEsAAABGAAAAOwAAACgAAAAVAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkI6Mz5COjNBTUE7SU1BO1wAAAD4AAABHAAAARyGR5/8jhuX/I4Lg/ySA3v8kgN//JIDf/yWD4/8hkef/IZHn/wAAAFEAAABLAAAAPgAAACcAAAARAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkI6Mz5COjNFTUE7VU1BO2iGR5/8gj+T/IZHn/yGQ5/8gj+b/IYvk/yKI4v8jg+H/JYDf/yWB4P8kf93/IZHn/wAAAFMAAABNAAAAOgAAACAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQjozPkI6M0JCOjNUcmOr/HJ3u/xye7v8cn+//HJ7u/x2b7P8dmOr/H5Tp/yGO5f8iieP/I4Lg/ySA4P8hkef/IZHn/wAAAFMAAABJAAAALgAAABQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQjozRHqf2/xmm8f8YqfP/F6z0/xet9f8XrPX/GKnz/xql8f8boO//HJrr/x+U6f8hjOX/IoTh/yWA3v8jfdv/AAECYQAAAFEAAAA6AAAAHgAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARaZ1uQUsPb/EbT4/xC4+v8Pu/v/D7v7/w+6+/8Rt/r/ErL4/xWs9f8apfH/HJ7v/x6W6v8gjeX/IoXh/ySA3/8hkef/AAAAVAAAAEMAAAAnAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAt1vj/EbP2/w68+/8Mvfz/Db79/w6+/f8Ovv3/Dr7+/w2+/v8Nvvz/D7r6/xOy9/8YqfT/G6Hv/x6W6v8hjeX/I4Th/yGR5/8AAABVAAAASQAAAC0AAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+27fMNvv3/Dr79/w3B/f8Owfz/D8H8/w/B/f8Pwfz/DsD8/w2//f8Ovf3/DLz8/xG0+f8XqvT/G6Dv/x6V6f8hi+T/I4Hf/yGR5/8AAABNAAAAMQAAABUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADbz6/w2//f8Pwfv/D8P9/w/F/f8Pxf3/Ecb9/xHG/f8Pw/z/D8L8/w7B/P8Nvfz/Db38/xK0+P8ZqPL/G53u/yCR6P8ihuL/IZHn/wAAAE4AAAA1AAAAGgAAAAUAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC3W+P8Nv/7/DsH8/xDF/P8Qx/v/Esn7/xLL+/8SzP3/Ecv9/xDI+/8Rxvz/D8P9/w/B/f8Ovf3/Dbz7/xSw9v8bpPD/Hpfq/yGM5P8hkef/AAAAUAAAAD0AAAAmAAAAEgAAAAoAAAAEAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAEs38/w/B/P8PxPz/EMj7/xLL+/8Tz/v/FNH6/xTR+v8U0Pr/Es77/xLK/P8Rx/z/FK7x/yB71v8ZkOP/ELn7/xip8/8dne7/IJDn/yGR5/8AAABSAAAASAAAADoAAAAqAAAAHQAAABEAAAAIAAAAAgAAAAAAAAAAAAAAAAAAAAASzfz/EMP9/xDH+/8RzPv/FND5/xXV+v8Z2fv/Gdr6/xfX+v8U0/r/E9H8/yCN4P8ihtv/I3vW/yVwz/8nYMj/FLD2/xyg7/8elOf/IZHn/wAAAFQAAABRAAAASwAAAEIAAAA2AAAAJwAAABUAAAAIAAAAAQAAAAAAAAAAAAAAABLN/P8Qxfv/Ecr7/xPP+/8V1fr/G9v6/x7h+P8j4vn/Hd/5/xjY+f8XrPH/HJ7r/x6T5P8hid3/In/Y/yVz0f8jf9v/I4vj/yKL4/8kkef/J5j0/iGR5/8AAABUAAAAUAAAAEoAAAA+AAAAKQAAABMAAAAEAAAAAAAAAAAAAAAALdb4/xDF/P8Sy/v/FNH6/xjY+v8d3/n/e+v5/6Hv+v9M5fn/HN75/w+5+v8VrvP/G6Ht/x2W5/8hjOL/Iozk/yyf7P9Cwfz/Qr37/0G8+/9Cuvv/Q7v7/0a69/5Du/r/AAAAUgAAAE0AAAA8AAAAIgAAAAsAAAAAAAAAAAAAAAAAAAAAEMP6/xLL+/8U0fr/GNj6/yHh+f+W7vr/zfb7/2bo+v8c3vr/EMv7/w2+/P8Tsvb/Iovk/yGL4/9Bxfv/QMH7/0DB+/9BwPv/Qb78/0K+/P9CvPv/Q737/0O7+v9Du/r/AAAAUwAAAEoAAAAuAAAAEwAAAAAAAAAAAAAAAAAAAAASzfz/Esv7/xTP+f8W1vr/HN36/zbk+v9a5/n/IOL4/xnZ+v8Y3vn/EdD6/xyb6v8hiuP/Psf7/z/F+v8/w/v/QML7/0HB+/9Awfv/QcD8/0G+/f9Bvvz/Qrz7/0O7+f9Du/r/AAAAUgAAADYAAAAaAAAAAAAAAAAAAAAAAAAAAAAAAAARxO7zE877/xTS+v8X1/r/Gtv6/xzc+v8a2vv/Ftb6/xPP+v8a4vn/IYrk/zzM/P88x/z/Psb6/z7F+v8/xPv/QML6/0DC+v9BwPv/QcD7/0G//P9Bvv3/Qr38/0O7+v8AAABUAAAAOAAAABwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAQt9nfE8/7/y3W+P8V1fv/FdX6/xXU+v8U0Pr/Esv7/xyi7P8vr/D/Osv7/zzK/P88yPz/Pcj7/z7G+/8+xPr/PsT6/0DC+v9Bwvv/QMH7/0HA+/9Bv/z/RMP8/wAAAFMAAAA3AAAAGwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAt1vj/EtD8/y3W+P8Tzvv/Es38/xHK+/8Rx/v/IYvk/zjO+/85zfv/Osv7/zrL+/87yfv/PMf7/z7H/P89xfr/QMX6/0DD+v9Bwvr/QcH7/0HB/P9Bv/n/AAEBVwAAADEAAAAVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALdb4/xLN/P8Szfz/EMPv8w2w3OEjjuX/NtD6/zbO/P85zfv/Ocz6/znL+v87yvv/Osn8/zzH/P8+xvv/PsX6/z/F+v9Aw/v/QMP6/0LH/P8AAABKAAAAJwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAASSX2+000fr/NdH8/zbQ+/84zfv/Oc36/znL+v86y/v/O8n7/zvI+/89x/z/Psb7/z7E+v8/xPv/Pbbi8AAAADQAAAAaAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIYnH3DPT+/8z0vv/NdH8/zbP+/82z/v/OM36/znM+v86y/r/Osr7/zvJ+/88yPz/Pcf7/z7F+v9Du/r/AAAAIQAAAA0AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhicfcMNX5/zPT+/8z0/z/NNH8/zTR/P82z/z/N877/znN+v85y/r/Osv6/zvK+/87yfv/Pcf3/C3W+P8AAAARAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv2vn/L9b7/zLV/P8z1Pz/NNL8/zXR/P820fz/Ns/8/zjO+/86zfv/Ocv6/znJ+f9Du/r/AAAADwAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC3W+P8t1vj/Ltf8/zHW/P8z1Pv/M9T8/zPS/P810fv/NtD8/zbO+/84yvj/Q7v6/wAAAA0AAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEO7+v9Du/r/Ltj7/y/X+/8x1fz/M9T8/zTT+/800vr/NdX3+UO7+v8AAAAHAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDu/r/LNn6/y/Y+/8w1fv/Q7v6/y3W+P8AAAAGAAAABAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////z////8fwf//hwB//8AAP//AAB//4AAf/+AAD//AAA//wAAH/8AAB/+AAAf/gAAH/4AAB/+AAAH/gAAAf8AAAD/AAAAf4AAAH/AAAB/4AAAf/gAAH//wAB//8AAf//AAH//4AD//+AB///wA////A/8=\"), auto;\\r\\n}\\r\\n\\r\\n.pnlm-grab {\\r\\n  cursor: grab;\\r\\n  cursor: ${\"url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%2226%22%20width%3D%2226%22%3E%0A%3Cpath%20stroke%3D%22%23000%22%20stroke-width%3D%221px%22%20fill%3D%22%23fff%22%20d%3D%22m15.3%2020.5s6.38-6.73%204.64-8.24-3.47%201.01-3.47%201.01%203.61-5.72%201.41-6.49c-2.2-0.769-3.33%204.36-3.33%204.36s0.873-5.76-1.06-5.76-1.58%205.39-1.58%205.39-0.574-4.59-2.18-4.12c-1.61%200.468-0.572%205.51-0.572%205.51s-1.58-4.89-2.93-3.79c-1.35%201.11%200.258%205.25%200.572%206.62%200.836%202.43%202.03%202.94%202.17%205.55%22%2F%3E%0A%3C%2Fsvg%3E%0A') 12 8, default\"}\\r\\n}\\r\\n\\r\\n.pnlm-grabbing {\\r\\n  cursor: grabbing;\\r\\n  cursor: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%2226%22%20width%3D%2226%22%3E%0A%3Cpath%20stroke%3D%22%23000%22%20stroke-width%3D%221px%22%20fill%3D%22%23fff%22%20d%3D%22m15.3%2020.5s5.07-5.29%203.77-6.74c-1.31-1.45-2.53%200.14-2.53%200.14s2.74-3.29%200.535-4.06c-2.2-0.769-2.52%201.3-2.52%201.3s0.81-2.13-1.12-2.13-1.52%201.77-1.52%201.77-0.261-1.59-1.87-1.12c-1.61%200.468-0.874%202.17-0.874%202.17s-0.651-1.55-2-0.445c-1.35%201.11-0.68%202.25-0.365%203.62%200.836%202.43%202.03%202.94%202.17%205.55%22%2F%3E%0A%3C%2Fsvg%3E%0A') 12 8, default\\r\\n}\\r\\n\\r\\n.pnlm-sprite {\\r\\n  background-image: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2226%22%20height%3D%22208%22%3E%0A%3Ccircle%20fill-opacity%3D%22.78%22%20cy%3D%22117%22%20cx%3D%2213%22%20r%3D%2211%22%20fill%3D%22%23fff%22%2F%3E%0A%3Ccircle%20fill-opacity%3D%22.78%22%20cy%3D%22143%22%20cx%3D%2213%22%20r%3D%2211%22%20fill%3D%22%23fff%22%2F%3E%0A%3Ccircle%20cy%3D%22169%22%20cx%3D%2213%22%20r%3D%227%22%20fill%3D%22none%22%20stroke%3D%22%23000%22%20stroke-width%3D%222%22%2F%3E%0A%3Ccircle%20cy%3D%22195%22%20cx%3D%2213%22%20r%3D%227%22%20fill%3D%22none%22%20stroke%3D%22%23000%22%20stroke-width%3D%222%22%2F%3E%0A%3Ccircle%20cx%3D%2213%22%20cy%3D%22195%22%20r%3D%222.5%22%2F%3E%0A%3Cpath%20d%3D%22m5%2083v6h2v-4h4v-2zm10%200v2h4v4h2v-6zm-5%205v6h6v-6zm-5%205v6h6v-2h-4v-4zm14%200v4h-4v2h6v-6z%22%2F%3E%0A%3Cpath%20d%3D%22m13%20110a7%207%200%200%200%20-7%207%207%207%200%200%200%207%207%207%207%200%200%200%207%20-7%207%207%200%200%200%20-7%20-7zm-1%203h2v2h-2zm0%203h2v5h-2z%22%2F%3E%0A%3Cpath%20d%3D%22m5%2057v6h2v-4h4v-2zm10%200v2h4v4h2v-6zm-10%2010v6h6v-2h-4v-4zm14%200v4h-4v2h6v-6z%22%2F%3E%0A%3Cpath%20d%3D%22m17%2038v2h-8v-2z%22%2F%3E%0A%3Cpath%20d%3D%22m12%209v3h-3v2h3v3h2v-3h3v-2h-3v-3z%22%2F%3E%0A%3Cpath%20d%3D%22m13%20136-6.125%206.125h4.375v7.875h3.5v-7.875h4.375z%22%2F%3E%0A%3Cpath%20d%3D%22m10.428%20173.33v-5.77l5-2.89v5.77zm1-1.73%203-1.73-3.001-1.74z%22%2F%3E%0A%3C%2Fsvg%3E%0A')\\r\\n}\\r\\n\\r\\n.pnlm-container:-moz-full-screen {\\r\\n  height: 100% !important;\\r\\n  width: 100% !important;\\r\\n  position: static !important;\\r\\n}\\r\\n\\r\\n.pnlm-container:-webkit-full-screen {\\r\\n  height: 100% !important;\\r\\n  width: 100% !important;\\r\\n  position: static !important;\\r\\n}\\r\\n\\r\\n.pnlm-container:-ms-fullscreen {\\r\\n  height: 100% !important;\\r\\n  width: 100% !important;\\r\\n  position: static !important;\\r\\n}\\r\\n\\r\\n.pnlm-container:fullscreen {\\r\\n  height: 100% !important;\\r\\n  width: 100% !important;\\r\\n  position: static !important;\\r\\n}\\r\\n\\r\\n.pnlm-render-container {\\r\\n  cursor: inherit;\\r\\n\\r\\n  /* Fix display bug in Safari 7 */\\r\\n  position: absolute;\\r\\n  height: 100%;\\r\\n  width: 100%;\\r\\n}\\r\\n\\r\\n.pnlm-controls {\\r\\n  margin-top: 4px;\\r\\n  background-color: #fff;\\r\\n  border: 1px solid #999;\\r\\n  border-color: rgba(0, 0, 0, 0.4);\\r\\n  border-radius: 3px;\\r\\n  cursor: pointer;\\r\\n  z-index: 2;\\r\\n  /* Fix Safari fullscreen bug */\\r\\n  -webkit-transform: translateZ(9999px);\\r\\n  transform: translateZ(9999px);\\r\\n}\\r\\n\\r\\n.pnlm-control:hover {\\r\\n  background-color: #f8f8f8;\\r\\n}\\r\\n\\r\\n.pnlm-controls-container {\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  left: 4px;\\r\\n  z-index: 1;\\r\\n}\\r\\n\\r\\n.pnlm-zoom-controls {\\r\\n  width: 26px;\\r\\n  height: 52px;\\r\\n}\\r\\n\\r\\n.pnlm-zoom-in {\\r\\n  width: 100%;\\r\\n  height: 50%;\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  border-radius: 3px 3px 0 0;\\r\\n}\\r\\n\\r\\n.pnlm-zoom-out {\\r\\n  width: 100%;\\r\\n  height: 50%;\\r\\n  position: absolute;\\r\\n  bottom: 0;\\r\\n  background-position: 0 -26px;\\r\\n  border-top: 1px solid #ddd;\\r\\n  border-top-color: rgba(0, 0, 0, 0.10);\\r\\n  border-radius: 0 0 3px 3px;\\r\\n}\\r\\n\\r\\n.pnlm-fullscreen-toggle-button,\\r\\n.pnlm-orientation-button,\\r\\n.pnlm-hot-spot-debug-indicator {\\r\\n  width: 26px;\\r\\n  height: 26px;\\r\\n}\\r\\n\\r\\n.pnlm-hot-spot-debug-indicator {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  width: 26px;\\r\\n  height: 26px;\\r\\n  margin: -13px 0 0 -13px;\\r\\n  background-color: rgba(255, 255, 255, 0.5);\\r\\n  border-radius: 13px;\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n.pnlm-orientation-button-inactive {\\r\\n  background-position: 0 -156px;\\r\\n}\\r\\n\\r\\n.pnlm-orientation-button-active {\\r\\n  background-position: 0 -182px;\\r\\n}\\r\\n\\r\\n.pnlm-fullscreen-toggle-button-inactive {\\r\\n  background-position: 0 -52px;\\r\\n}\\r\\n\\r\\n.pnlm-fullscreen-toggle-button-active {\\r\\n  background-position: 0 -78px;\\r\\n}\\r\\n\\r\\n.pnlm-panorama-info {\\r\\n  position: absolute;\\r\\n  bottom: 4px;\\r\\n  background-color: rgba(0, 0, 0, 0.7);\\r\\n  border-radius: 0 3px 3px 0;\\r\\n  padding-right: 10px;\\r\\n  color: #fff;\\r\\n  text-align: left;\\r\\n  display: none;\\r\\n  z-index: 2;\\r\\n  /* Fix Safari fullscreen bug */\\r\\n  -webkit-transform: translateZ(9999px);\\r\\n  transform: translateZ(9999px);\\r\\n}\\r\\n\\r\\n.pnlm-title-box {\\r\\n  position: relative;\\r\\n  font-size: 20px;\\r\\n  display: table;\\r\\n  padding-left: 5px;\\r\\n  margin-bottom: 3px;\\r\\n}\\r\\n\\r\\n.pnlm-description-box {\\r\\n  position: relative;\\r\\n  font-size: 18px;\\r\\n  display: table;\\r\\n  padding-left: 5px;\\r\\n  margin-bottom: 3px;\\r\\n}\\r\\n\\r\\n.pnlm-author-box {\\r\\n  position: relative;\\r\\n  font-size: 12px;\\r\\n  display: table;\\r\\n  padding-left: 5px;\\r\\n}\\r\\n\\r\\n.pnlm-load-box {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  width: 200px;\\r\\n  height: 150px;\\r\\n  margin: -75px 0 0 -100px;\\r\\n  background-color: rgba(0, 0, 0, 0.7);\\r\\n  border-radius: 3px;\\r\\n  text-align: center;\\r\\n  font-size: 20px;\\r\\n  display: none;\\r\\n  color: #fff;\\r\\n}\\r\\n\\r\\n.pnlm-load-box p {\\r\\n  margin: 20px 0;\\r\\n}\\r\\n\\r\\n.pnlm-lbox {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  width: 20px;\\r\\n  height: 20px;\\r\\n  margin: -10px 0 0 -10px;\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n.pnlm-loading {\\r\\n  animation-duration: 1.5s;\\r\\n  -webkit-animation-duration: 1.5s;\\r\\n  animation-name: pnlm-mv;\\r\\n  -webkit-animation-name: pnlm-mv;\\r\\n  animation-iteration-count: infinite;\\r\\n  -webkit-animation-iteration-count: infinite;\\r\\n  animation-timing-function: linear;\\r\\n  -webkit-animation-timing-function: linear;\\r\\n  height: 10px;\\r\\n  width: 10px;\\r\\n  background-color: #fff;\\r\\n  position: relative;\\r\\n}\\r\\n\\r\\n@keyframes pnlm-mv {\\r\\n  from {\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n  }\\r\\n\\r\\n  25% {\\r\\n    left: 10px;\\r\\n    top: 0;\\r\\n  }\\r\\n\\r\\n  50% {\\r\\n    left: 10px;\\r\\n    top: 10px;\\r\\n  }\\r\\n\\r\\n  75% {\\r\\n    left: 0;\\r\\n    top: 10px;\\r\\n  }\\r\\n\\r\\n  to {\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n  }\\r\\n}\\r\\n\\r\\n@-webkit-keyframes pnlm-mv {\\r\\n  from {\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n  }\\r\\n\\r\\n  25% {\\r\\n    left: 10px;\\r\\n    top: 0;\\r\\n  }\\r\\n\\r\\n  50% {\\r\\n    left: 10px;\\r\\n    top: 10px;\\r\\n  }\\r\\n\\r\\n  75% {\\r\\n    left: 0;\\r\\n    top: 10px;\\r\\n  }\\r\\n\\r\\n  to {\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n  }\\r\\n}\\r\\n\\r\\n.pnlm-load-button {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  width: 200px;\\r\\n  height: 100px;\\r\\n  margin: -50px 0 0 -100px;\\r\\n  background-color: rgba(0, 0, 0, .7);\\r\\n  border-radius: 3px;\\r\\n  text-align: center;\\r\\n  font-size: 20px;\\r\\n  display: table;\\r\\n  color: #fff;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.pnlm-load-button:hover {\\r\\n  background-color: rgba(0, 0, 0, .8);\\r\\n}\\r\\n\\r\\n.pnlm-load-button p {\\r\\n  display: table-cell;\\r\\n  vertical-align: middle;\\r\\n}\\r\\n\\r\\n.pnlm-info-box {\\r\\n  font-size: 15px;\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  width: 200px;\\r\\n  height: 150px;\\r\\n  margin: -75px 0 0 -100px;\\r\\n  background-color: #000;\\r\\n  border-radius: 3px;\\r\\n  display: table;\\r\\n  text-align: center;\\r\\n  color: #fff;\\r\\n  table-layout: fixed;\\r\\n}\\r\\n\\r\\n.pnlm-info-box a,\\r\\n.pnlm-author-box a {\\r\\n  color: #fff;\\r\\n  word-wrap: break-word;\\r\\n  overflow-wrap: break-word;\\r\\n}\\r\\n\\r\\n.pnlm-info-box p {\\r\\n  display: table-cell;\\r\\n  vertical-align: middle;\\r\\n  padding: 0 5px 0 5px;\\r\\n}\\r\\n\\r\\n.pnlm-error-msg {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n.pnlm-about-msg {\\r\\n  font-size: 11px;\\r\\n  line-height: 11px;\\r\\n  color: #fff;\\r\\n  padding: 5px 8px 5px 8px;\\r\\n  background: rgba(0, 0, 0, 0.7);\\r\\n  border-radius: 3px;\\r\\n  position: absolute;\\r\\n  top: 50px;\\r\\n  left: 50px;\\r\\n  display: none;\\r\\n  opacity: 0;\\r\\n  -moz-transition: opacity .3s ease-in-out;\\r\\n  -webkit-transition: opacity .3s ease-in-out;\\r\\n  -o-transition: opacity .3s ease-in-out;\\r\\n  -ms-transition: opacity .3s ease-in-out;\\r\\n  transition: opacity .3s ease-in-out;\\r\\n  z-index: 1;\\r\\n}\\r\\n\\r\\n.pnlm-about-msg a:link,\\r\\n.pnlm-about-msg a:visited {\\r\\n  color: #fff;\\r\\n}\\r\\n\\r\\n.pnlm-about-msg a:hover,\\r\\n.pnlm-about-msg a:active {\\r\\n  color: #eee;\\r\\n}\\r\\n\\r\\n.pnlm-hotspot-base {\\r\\n  position: absolute;\\r\\n  visibility: hidden;\\r\\n  cursor: default;\\r\\n  vertical-align: middle;\\r\\n  top: 0;\\r\\n  z-index: 1;\\r\\n}\\r\\n\\r\\n.pnlm-hotspot {\\r\\n  height: 26px;\\r\\n  width: 26px;\\r\\n  border-radius: 13px;\\r\\n}\\r\\n\\r\\n.pnlm-hotspot:hover {\\r\\n  background-color: rgba(255, 255, 255, 0.2);\\r\\n}\\r\\n\\r\\n.pnlm-hotspot.pnlm-info {\\r\\n  background-position: 0 -104px;\\r\\n}\\r\\n\\r\\n.pnlm-hotspot.pnlm-scene {\\r\\n  background-position: 0 -130px;\\r\\n}\\r\\n\\r\\ndiv.pnlm-tooltip span {\\r\\n  visibility: hidden;\\r\\n  position: absolute;\\r\\n  border-radius: 3px;\\r\\n  background-color: rgba(0, 0, 0, 0.7);\\r\\n  color: #fff;\\r\\n  text-align: center;\\r\\n  max-width: 200px;\\r\\n  padding: 5px 10px;\\r\\n  margin-left: -220px;\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\ndiv.pnlm-tooltip:hover span {\\r\\n  visibility: visible;\\r\\n}\\r\\n\\r\\ndiv.pnlm-tooltip:hover span:after {\\r\\n  content: '';\\r\\n  position: absolute;\\r\\n  width: 0;\\r\\n  height: 0;\\r\\n  border-width: 10px;\\r\\n  border-style: solid;\\r\\n  border-color: rgba(0, 0, 0, 0.7) transparent transparent transparent;\\r\\n  bottom: -20px;\\r\\n  left: -10px;\\r\\n  margin: 0 50%;\\r\\n}\\r\\n\\r\\n.pnlm-compass {\\r\\n  position: absolute;\\r\\n  width: 50px;\\r\\n  height: 50px;\\r\\n  right: 4px;\\r\\n  bottom: 4px;\\r\\n  border-radius: 25px;\\r\\n  background-image: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%2250%22%20width%3D%2250%22%3E%0A%3Cpath%20d%3D%22m24.5078%206-3.2578%2018h7.5l-3.25781-18h-0.984376zm-3.2578%2020%203.2578%2018h0.9844l3.2578-18h-7.5zm1.19531%200.9941h5.10938l-2.5547%2014.1075-2.5547-14.1075z%22%2F%3E%0A%3C%2Fsvg%3E%0A');\\r\\n  cursor: default;\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n.pnlm-world {\\r\\n  position: absolute;\\r\\n  left: 50%;\\r\\n  top: 50%;\\r\\n}\\r\\n\\r\\n.pnlm-face {\\r\\n  position: absolute;\\r\\n  -webkit-transform-origin: 0 0 0;\\r\\n  transform-origin: 0 0 0;\\r\\n}\\r\\n\\r\\n.pnlm-dragfix,\\r\\n.pnlm-preview-img {\\r\\n  position: absolute;\\r\\n  height: 100%;\\r\\n  width: 100%;\\r\\n}\\r\\n\\r\\n.pnlm-preview-img {\\r\\n  background-size: cover;\\r\\n  background-position: center;\\r\\n}\\r\\n\\r\\n.pnlm-lbar {\\r\\n  width: 150px;\\r\\n  margin: 0 auto;\\r\\n  border: #fff 1px solid;\\r\\n  height: 6px;\\r\\n}\\r\\n\\r\\n.pnlm-lbar-fill {\\r\\n  background: #fff;\\r\\n  height: 100%;\\r\\n  width: 0;\\r\\n}\\r\\n\\r\\n.pnlm-lmsg {\\r\\n  font-size: 12px;\\r\\n}\\r\\n\\r\\n.pnlm-fade-img {\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  left: 0;\\r\\n}\\r\\n\\r\\n.pnlm-pointer {\\r\\n  cursor: pointer;\\r\\n}\\r\\n`;\nstyleInject(css_248z);\nvar myPannellum = null;\n\nvar ReactPannellum = /*#__PURE__*/function (_React$Component) {\n  _inherits(ReactPannellum, _React$Component);\n\n  var _super = _createSuper(ReactPannellum);\n\n  function ReactPannellum() {\n    var _this;\n\n    _classCallCheck(this, ReactPannellum);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      imageSource: \"\",\n      equirectangularOptions: {},\n      cubeMap: [],\n      multiRes: {}\n    };\n\n    _this.init = function () {\n      var _this$state = _this.state,\n          imageSource = _this$state.imageSource,\n          equirectangularOptions = _this$state.equirectangularOptions,\n          cubeMap = _this$state.cubeMap,\n          multiRes = _this$state.multiRes;\n      var _this$props = _this.props,\n          sceneId = _this$props.sceneId,\n          config = _this$props.config,\n          type = _this$props.type;\n      myPannellum = pannellum.viewer(_this.props.id, {\n        default: {\n          firstScene: sceneId\n        },\n        scenes: _defineProperty({}, sceneId, _objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2({}, configs.panoramaConfigs), configs.equirectangularOptions), configs.uiText), config), {}, {\n          type: type,\n          imageSource: imageSource\n        }, equirectangularOptions), {}, {\n          cubeMap: cubeMap,\n          multiRes: multiRes\n        }))\n      });\n      myPannellum && myPannellum.on(\"mousedown\", function (event) {\n        return _this.props.onMouseDown(event);\n      });\n      myPannellum && myPannellum.on(\"mouseup\", function (event) {\n        return _this.props.onMouseUp(event);\n      });\n      myPannellum && myPannellum.on(\"mousemove\", function (event) {\n        return _this.props.onMouseMove(event);\n      });\n      myPannellum && myPannellum.on(\"load\", function () {\n        return myPannellum.sceneLoadListener();\n      }); // _this.props.onPanoramaLoaded &&\n      //   myPannellum.on(\"load\", function () {\n      //     return _this.props.onPanoramaLoaded();\n      //   });\n    };\n\n    return _this;\n  }\n\n  _createClass(ReactPannellum, [{\n    key: \"initPanalleum\",\n    value: function initPanalleum() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          imageSource = _this$props2.imageSource,\n          type = _this$props2.type,\n          cubeMap = _this$props2.cubeMap,\n          multiRes = _this$props2.multiRes,\n          equirectangularOptions = _this$props2.equirectangularOptions;\n\n      switch (type) {\n        case \"equirectangular\":\n          this.setState({\n            imageSource: imageSource,\n            equirectangularOptions: equirectangularOptions,\n            cubeMap: []\n          }, function () {\n            return _this2.init();\n          });\n          break;\n\n        case \"cubemap\":\n          this.setState({\n            cubeMap: cubeMap,\n            imageSource: \"\"\n          }, function () {\n            return _this2.init();\n          });\n          break;\n\n        case \"multires\":\n          this.setState({\n            cubeMap: [],\n            imageSource: \"\",\n            multiRes: multiRes\n          }, function () {\n            return _this2.init();\n          });\n          break;\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.initPanalleum();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      myPannellum && this.props.onPanoramaLoaded && myPannellum.off(\"load\", this.props.onPanoramaLoaded);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          style = _this$props3.style,\n          className = _this$props3.className,\n          id = _this$props3.id,\n          children = _this$props3.children;\n      return /*#__PURE__*/React__default[\"default\"].createElement(\"div\", {\n        id: id,\n        style: style,\n        className: className,\n        children: children\n      });\n    }\n  }], [{\n    key: \"isLoaded\",\n    value: function isLoaded() {\n      return myPannellum && myPannellum.isLoaded();\n    }\n  }, {\n    key: \"getPitch\",\n    value: function getPitch() {\n      return myPannellum && myPannellum.getPitch();\n    }\n  }, {\n    key: \"setPitch\",\n    value: function setPitch(pitch) {\n      var animated = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n      var callback = arguments.length > 2 ? arguments[2] : undefined;\n      var callbackArgs = arguments.length > 3 ? arguments[3] : undefined;\n\n      if (myPannellum) {\n        myPannellum.setPitch(pitch, animated, callback, callbackArgs);\n      }\n    }\n  }, {\n    key: \"getPitchBounds\",\n    value: function getPitchBounds() {\n      return myPannellum && myPannellum.getPitchBounds();\n    }\n  }, {\n    key: \"setPitchBounds\",\n    value: function setPitchBounds(bounds) {\n      if (myPannellum) {\n        myPannellum.setPitchBounds(bounds);\n      }\n    }\n  }, {\n    key: \"getYaw\",\n    value: function getYaw() {\n      return myPannellum && myPannellum.getYaw();\n    }\n  }, {\n    key: \"setYaw\",\n    value: function setYaw(yaw) {\n      var animated = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n      var callback = arguments.length > 2 ? arguments[2] : undefined;\n      var callbackArgs = arguments.length > 3 ? arguments[3] : undefined;\n\n      if (myPannellum) {\n        myPannellum.setYaw(yaw, animated, callback, callbackArgs);\n      }\n    }\n  }, {\n    key: \"getYawBounds\",\n    value: function getYawBounds() {\n      return myPannellum && myPannellum.getYawBounds();\n    }\n  }, {\n    key: \"setYawBounds\",\n    value: function setYawBounds(bounds) {\n      myPromise(myPannellum, {\n        bounds: bounds\n      }).then(function (_ref) {\n        var bounds = _ref.bounds;\n        myPannellum.setYawBounds(bounds);\n      })[\"catch\"](function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"getHfov\",\n    value: function getHfov() {\n      return myPannellum && myPannellum.getHfov();\n    }\n  }, {\n    key: \"setHfov\",\n    value: function setHfov(hfov) {\n      var animated = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n      var callback = arguments.length > 2 ? arguments[2] : undefined;\n      var callbackArgs = arguments.length > 3 ? arguments[3] : undefined;\n\n      if (myPannellum) {\n        myPannellum.setHfov(hfov, animated, callback, callbackArgs);\n      }\n    }\n  }, {\n    key: \"getHfovBounds\",\n    value: function getHfovBounds() {\n      return myPannellum && myPannellum.getHfovBounds();\n    }\n  }, {\n    key: \"setHfovBounds\",\n    value: function setHfovBounds(bounds) {\n      myPromise(myPannellum, {\n        bounds: bounds\n      }).then(function (_ref2) {\n        var bounds = _ref2.bounds;\n        myPannellum.setHfovBounds(bounds);\n      })[\"catch\"](function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"lookAt\",\n    value: function lookAt(pitch, yaw, hfov) {\n      var animated = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1000;\n      var callback = arguments.length > 4 ? arguments[4] : undefined;\n      var callbackArgs = arguments.length > 5 ? arguments[5] : undefined;\n\n      if (myPannellum) {\n        myPannellum.lookAt(pitch, yaw, hfov, animated, callback, callbackArgs);\n      }\n    }\n  }, {\n    key: \"getNorthOffset\",\n    value: function getNorthOffset() {\n      return myPannellum && myPannellum.getNorthOffset();\n    }\n  }, {\n    key: \"setNorthOffset\",\n    value: function setNorthOffset(heading) {\n      myPromise(myPannellum, {\n        heading: heading\n      }).then(function (_ref3) {\n        var heading = _ref3.heading;\n        myPannellum.setNorthOffset(heading);\n      })[\"catch\"](function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"getHorizonRoll\",\n    value: function getHorizonRoll() {\n      return myPannellum && myPannellum.getHorizonRoll();\n    }\n  }, {\n    key: \"setHorizonRoll\",\n    value: function setHorizonRoll(roll) {\n      myPromise(myPannellum, {\n        roll: roll\n      }).then(function (_ref4) {\n        var roll = _ref4.roll;\n        myPannellum.setHorizonRoll(roll);\n      })[\"catch\"](function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"getHorizonPitch\",\n    value: function getHorizonPitch() {\n      return myPannellum && myPannellum.getHorizonPitch();\n    }\n  }, {\n    key: \"setHorizonPitch\",\n    value: function setHorizonPitch(pitch) {\n      myPromise(myPannellum, {\n        pitch: pitch\n      }).then(function (_ref5) {\n        var pitch = _ref5.pitch;\n        myPannellum.setHorizonPitch(pitch);\n      })[\"catch\"](function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"startAutoRotate\",\n    value: function startAutoRotate(speed, pitch) {\n      myPromise(myPannellum, {\n        pitch: pitch\n      }).then(function (_ref6) {\n        var pitch = _ref6.pitch;\n        myPannellum.startAutoRotate(speed, pitch);\n      })[\"catch\"](function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"stopAutoRotate\",\n    value: function stopAutoRotate() {\n      if (myPannellum) {\n        myPannellum.stopAutoRotate();\n      }\n    }\n  }, {\n    key: \"showCompass\",\n    value: function showCompass(value) {\n      myPromise(myPannellum, {}).then(function () {\n        myPannellum.showCompass(value);\n      })[\"catch\"](function (err) {\n        console.log(err);\n      });\n    }\n  }, {\n    key: \"changeMouseCursor\",\n    value: function changeMouseCursor(event) {\n      return myPannellum && myPannellum.changeMouseCursor(event);\n    }\n  }, {\n    key: \"mouseEventToCoords\",\n    value: function mouseEventToCoords(event) {\n      return myPannellum && myPannellum.mouseEventToCoords(event);\n    }\n  }, {\n    key: \"addScene\",\n    value: function addScene(sceneId, config, callback) {\n      if (sceneId && sceneId !== \"\" && config && config !== {}) {\n        myPromise(myPannellum, {\n          sceneId: sceneId,\n          config: config,\n          callback: callback\n        }).then(function (_ref7) {\n          var sceneId = _ref7.sceneId,\n              config = _ref7.config,\n              callback = _ref7.callback;\n          myPannellum.addScene(sceneId, config);\n          callback && callback();\n        })[\"catch\"](function (err) {\n          console.log(err);\n        });\n      } else {\n        console.log(\"sceneId cannot be empty and config.imageSource cannot be empty!!\");\n      }\n    }\n  }, {\n    key: \"getCurrentScene\",\n    value: function getCurrentScene() {\n      return myPannellum && myPannellum.getScene();\n    }\n  }, {\n    key: \"getAllScenes\",\n    value: function getAllScenes() {\n      return myPannellum && myPannellum.getAllScenes();\n    }\n  }, {\n    key: \"removeScene\",\n    value: function removeScene(sceneId, callback) {\n      if (sceneId && sceneId !== \"\") {\n        myPromise(myPannellum, {\n          sceneId: sceneId\n        }).then(function (_ref8) {\n          var sceneId = _ref8.sceneId;\n          myPannellum.removeScene(sceneId);\n          callback && callback();\n        })[\"catch\"](function (err) {\n          console.log(err);\n        });\n      } else {\n        console.log(\"sceneId cannot be empty\");\n      }\n    }\n  }, {\n    key: \"loadScene\",\n    value: function loadScene(sceneId, targetPitch, targetYaw, targetHfov, fadeDone) {\n      if (myPannellum && sceneId && sceneId !== \"\") {\n        myPannellum.loadScene(sceneId, targetPitch, targetYaw, targetHfov, fadeDone);\n      }\n    }\n  }, {\n    key: \"toggleFullscreen\",\n    value: function toggleFullscreen() {\n      return myPannellum && myPannellum.toggleFullscreen();\n    }\n  }, {\n    key: \"getConfig\",\n    value: function getConfig() {\n      return myPannellum && myPannellum.getConfig();\n    }\n  }, {\n    key: \"getContainer\",\n    value: function getContainer() {\n      return myPannellum && myPannellum.getContainer();\n    }\n  }, {\n    key: \"addHotSpot\",\n    value: function addHotSpot(hotspot, sceneId) {\n      if (hotspot !== {}) {\n        myPromise(myPannellum, {\n          hotspot: hotspot,\n          sceneId: sceneId\n        }).then(function (_ref9) {\n          var hotspot = _ref9.hotspot,\n              sceneId = _ref9.sceneId;\n          myPannellum.addHotSpot(hotspot, sceneId);\n        })[\"catch\"](function (err) {\n          console.log(err);\n        });\n      } else {\n        console.log(\"hotspot cannot be empty, please check hotspot elements needed in document: config props `hotSpots`.\");\n      }\n    }\n  }, {\n    key: \"removeHotSpot\",\n    value: function removeHotSpot(hotSpotId, sceneId) {\n      if (hotSpotId !== \"\") {\n        myPromise(myPannellum, {\n          hotSpotId: hotSpotId,\n          sceneId: sceneId\n        }).then(function (_ref10) {\n          var hotSpotId = _ref10.hotSpotId,\n              sceneId = _ref10.sceneId;\n          myPannellum.removeHotSpot(hotSpotId, sceneId);\n        })[\"catch\"](function (err) {\n          console.log(err);\n        });\n      } else {\n        console.log(\"hotspotId cannot be empty!!\");\n      }\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      return myPannellum && myPannellum.destroy();\n    }\n  }, {\n    key: \"stopMovement\",\n    value: function stopMovement() {\n      return myPannellum && myPannellum.stopMovement();\n    }\n  }, {\n    key: \"resize\",\n    value: function resize() {\n      return myPannellum && myPannellum.resize();\n    }\n  }, {\n    key: \"isOrientationSupported\",\n    value: function isOrientationSupported() {\n      return myPannellum && myPannellum.isOrientationSupported();\n    }\n  }, {\n    key: \"stopOrientation\",\n    value: function stopOrientation() {\n      return myPannellum && myPannellum.stopOrientation();\n    }\n  }, {\n    key: \"startOrientation\",\n    value: function startOrientation() {\n      return myPannellum && myPannellum.startOrientation();\n    }\n  }, {\n    key: \"isOrientationActive\",\n    value: function isOrientationActive() {\n      return myPannellum && myPannellum.isOrientationActive();\n    }\n  }, {\n    key: \"getViewer\",\n    value: function getViewer() {\n      return myPannellum;\n    }\n  }]);\n\n  return ReactPannellum;\n}(React__default[\"default\"].Component);\n\nReactPannellum.propTypes = {\n  id: PropTypes__default[\"default\"].string.isRequired,\n  sceneId: PropTypes__default[\"default\"].string.isRequired,\n  children: PropTypes__default[\"default\"].any,\n  type: PropTypes__default[\"default\"].string,\n  imageSource: PropTypes__default[\"default\"].string,\n  equirectangularOptions: PropTypes__default[\"default\"].shape({}),\n  cubeMap: PropTypes__default[\"default\"].arrayOf(PropTypes__default[\"default\"].string),\n  multiRes: PropTypes__default[\"default\"].shape({\n    basePath: PropTypes__default[\"default\"].string,\n    path: PropTypes__default[\"default\"].string,\n    fallbackPath: PropTypes__default[\"default\"].string,\n    extension: PropTypes__default[\"default\"].string,\n    tileResolution: PropTypes__default[\"default\"].number,\n    maxLevel: PropTypes__default[\"default\"].number,\n    cubeResolution: PropTypes__default[\"default\"].number\n  }),\n  config: PropTypes__default[\"default\"].shape({}),\n  className: PropTypes__default[\"default\"].string,\n  style: PropTypes__default[\"default\"].shape({}),\n  onPanoramaLoaded: PropTypes__default[\"default\"].func,\n  onMouseDown: PropTypes__default[\"default\"].func,\n  onMouseUp: PropTypes__default[\"default\"].func,\n  onMouseMove: PropTypes__default[\"default\"].func\n};\nReactPannellum.defaultProps = {\n  type: \"equirectangular\",\n  imageSource: \"\",\n  equirectangularOptions: {},\n  cubeMap: [],\n  multiRes: {},\n  className: \"\",\n  style: configs.styles,\n  config: {},\n  onMouseDown: () => {},\n  onMouseUp: () => {},\n  onMouseMove: () => {}\n};\nexport const addScene = ReactPannellum.addScene;\nexport const getCurrentScene = ReactPannellum.getCurrentScene;\nexport const getAllScenes = ReactPannellum.getAllScenes;\nexport const removeScene = ReactPannellum.removeScene;\nexport const loadScene = ReactPannellum.loadScene;\nexport const isLoaded = ReactPannellum.isLoaded;\nexport const getPitch = ReactPannellum.getPitch;\nexport const setPitch = ReactPannellum.setPitch;\nexport const getPitchBounds = ReactPannellum.getPitchBounds;\nexport const setPitchBounds = ReactPannellum.setPitchBounds;\nexport const getYaw = ReactPannellum.getYaw;\nexport const setYaw = ReactPannellum.setYaw;\nexport const getYawBounds = ReactPannellum.getYawBounds;\nexport const setYawBounds = ReactPannellum.setYawBounds;\nexport const getHfov = ReactPannellum.getHfov;\nexport const setHfov = ReactPannellum.setHfov;\nexport const getHfovBounds = ReactPannellum.getHfovBounds;\nexport const setHfovBounds = ReactPannellum.setHfovBounds;\nexport const lookAt = ReactPannellum.lookAt;\nexport const getNorthOffset = ReactPannellum.getNorthOffset;\nexport const setNorthOffset = ReactPannellum.setNorthOffset;\nexport const getHorizonRoll = ReactPannellum.getHorizonRoll;\nexport const setHorizonRoll = ReactPannellum.setHorizonRoll;\nexport const getHorizonPitch = ReactPannellum.getHorizonPitch;\nexport const setHorizonPitch = ReactPannellum.setHorizonPitch;\nexport const startAutoRotate = ReactPannellum.startAutoRotate;\nexport const stopAutoRotate = ReactPannellum.stopAutoRotate;\nexport const mouseEventToCoords = ReactPannellum.mouseEventToCoords;\nexport const changeMouseCursor = ReactPannellum.changeMouseCursor;\nexport const showCompass = ReactPannellum.showCompass;\nexport const toggleFullscreen = ReactPannellum.toggleFullscreen;\nexport const getConfig = ReactPannellum.getConfig;\nexport const getContainer = ReactPannellum.getContainer;\nexport const addHotSpot = ReactPannellum.addHotSpot;\nexport const removeHotSpot = ReactPannellum.removeHotSpot;\nexport const destroy = ReactPannellum.destroy;\nexport const stopMovement = ReactPannellum.stopMovement;\nexport const resize = ReactPannellum.resize;\nexport const isOrientationSupported = ReactPannellum.isOrientationSupported;\nexport const stopOrientation = ReactPannellum.stopOrientation;\nexport const startOrientation = ReactPannellum.startOrientation;\nexport const isOrientationActive = ReactPannellum.isOrientationActive;\nexport const getViewer = ReactPannellum.getViewer;\nexport default ReactPannellum; // exports.addHotSpot = addHotSpot;\n// exports.addScene = addScene;\n// exports.default = ReactPannellum;\n// exports.destroy = destroy;\n// exports.getAllScenes = getAllScenes;\n// exports.getConfig = getConfig;\n// exports.getContainer = getContainer;\n// exports.getCurrentScene = getCurrentScene;\n// exports.getHfov = getHfov;\n// exports.getHfovBounds = getHfovBounds;\n// exports.getHorizonPitch = getHorizonPitch;\n// exports.getHorizonRoll = getHorizonRoll;\n// exports.getNorthOffset = getNorthOffset;\n// exports.getPitch = getPitch;\n// exports.getPitchBounds = getPitchBounds;\n// exports.getViewer = getViewer;\n// exports.getYaw = getYaw;\n// exports.getYawBounds = getYawBounds;\n// exports.isLoaded = isLoaded;\n// exports.isOrientationActive = isOrientationActive;\n// exports.isOrientationSupported = isOrientationSupported;\n// exports.loadScene = loadScene;\n// exports.lookAt = lookAt;\n// exports.mouseEventToCoords = mouseEventToCoords;\n// exports.changeMouseCursor = changeMouseCursor;\n// exports.removeHotSpot = removeHotSpot;\n// exports.removeScene = removeScene;\n// exports.resize = resize;\n// exports.setHfov = setHfov;\n// exports.setHfovBounds = setHfovBounds;\n// exports.setHorizonPitch = setHorizonPitch;\n// exports.setHorizonRoll = setHorizonRoll;\n// exports.setNorthOffset = setNorthOffset;\n// exports.setPitch = setPitch;\n// exports.setPitchBounds = setPitchBounds;\n// exports.setYaw = setYaw;\n// exports.setYawBounds = setYawBounds;\n// exports.startAutoRotate = startAutoRotate;\n// exports.showCompass = showCompass;\n// exports.startOrientation = startOrientation;\n// exports.stopAutoRotate = stopAutoRotate;\n// exports.stopMovement = stopMovement;\n// exports.stopOrientation = stopOrientation;\n// exports.toggleFullscreen = toggleFullscreen;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"React__default\");\n$RefreshReg$(_c2, \"PropTypes__default\");","map":{"version":3,"sources":["E:/Viettel/View360/pannellum/src/pages/pannellum-view/libs/react-pannellum/dist/index.js"],"names":["React","require","PropTypes","_interopDefaultLegacy","e","default","React__default","PropTypes__default","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","_defineProperty","obj","value","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","arguments","source","forEach","getOwnPropertyDescriptors","defineProperties","_inherits","subClass","superClass","create","constructor","_setPrototypeOf","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","p","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","call","_assertThisInitialized","self","ReferenceError","_possibleConstructorReturn","_createSuper","Derived","hasNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","libpannellum","window","document","undefined$1","Renderer","container","canvas","createElement","style","width","height","appendChild","program","gl","vs","fs","fallbackImgSize","world","vtmps","pose","image","imageType","dynamic","texCoordBuffer","cubeVertBuf","cubeVertTexCoordBuf","cubeVertIndBuf","globalParams","init","_image","_imageType","_dynamic","haov","vaov","voffset","callback","params","console","log","type","detachShader","deleteShader","bindBuffer","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","texture","deleteTexture","nodeCache","deleteProgram","s","faceMissing","cubeImgWidth","fillMissingFaces","imgSize","nbytes","imageArray","Uint8ClampedArray","rgb","backgroundColor","backgroundSquare","ImageData","navigator","userAgent","toLowerCase","match","getContext","alpha","depth","getError","handleWebGLError1286","hasOwnProperty","documentElement","appVersion","indexOf","removeChild","className","path","basePath","fallbackPath","sides","loaded","onLoad","faceCanvas","side","faceContext","drawImage","imgData","getImageData","data","j","putImageData","incLoaded","faceImg","Image","crossOrigin","onload","onerror","src","replace","extension","fullpath","invTileResolution","tileResolution","vertices","createCube","slice","maxWidth","getParameter","MAX_TEXTURE_SIZE","Math","max","MAX_CUBE_MAP_TEXTURE_SIZE","horizonPitch","horizonRoll","glBindType","TEXTURE_2D","viewport","drawingBufferWidth","drawingBufferHeight","getShaderPrecisionFormat","precision","FRAGMENT_SHADER","HIGH_FLOAT","fragEquiCubeBase","createShader","VERTEX_SHADER","vertexSrc","v","vMulti","shaderSource","compileShader","fragmentSrc","fragEquirectangular","TEXTURE_CUBE_MAP","fragCube","fragMulti","createProgram","attachShader","linkProgram","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","getProgramParameter","LINK_STATUS","getProgramInfoLog","useProgram","drawInProgress","color","clearColor","clear","COLOR_BUFFER_BIT","texCoordLocation","getAttribLocation","enableVertexAttribArray","createBuffer","bufferData","Float32Array","STATIC_DRAW","vertexAttribPointer","FLOAT","aspectRatio","getUniformLocation","uniform1f","psi","theta","f","h","vo","rot","PI","uniform4fv","concat","createTexture","bindTexture","texImage2D","TEXTURE_CUBE_MAP_POSITIVE_X","RGB","UNSIGNED_BYTE","TEXTURE_CUBE_MAP_NEGATIVE_X","TEXTURE_CUBE_MAP_POSITIVE_Y","TEXTURE_CUBE_MAP_NEGATIVE_Y","TEXTURE_CUBE_MAP_POSITIVE_Z","TEXTURE_CUBE_MAP_NEGATIVE_Z","uniform1i","cropCanvas","cropContext","cropImage","texture2","activeTexture","TEXTURE1","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","TEXTURE0","vertPosLocation","Uint16Array","perspUniform","cubeUniform","level","currentNodes","nodeCacheTimestamp","err","destroy","contains","getExtension","loseContext","resize","pixelRatio","devicePixelRatio","clientWidth","clientHeight","setPose","render","pitch","yaw","hfov","focal","roll","orig_pitch","orig_yaw","x","cos","sin","y","z","asin","min","atan2","w","roll_adj","acos","sqrt","transforms","b","u","d","l","r","tan","zoom","transform","faces","face","querySelector","webkitTransform","vfov","atan","drawArrays","TRIANGLES","perspMatrix","makePersp","checkZoom","matrix","identityMatrix3","rotateMatrix","makeMatrix4","uniformMatrix4fv","transposeMatrix4","rotPersp","rotatePersp","sort","multiresNodeSort","removed","splice","ntmp","MultiresNode","testMultiresNode","multiresNodeRenderSort","pendingTextureRequests","node","textureLoad","setTimeout","processNextTile","multiresDraw","returnImage","toDataURL","isLoading","textureLoaded","getCanvas","a","timestamp","diff","drawElements","UNSIGNED_SHORT","checkSquareInView","phi","ydiff","abs","inCurrent","k","cubeSize","cubeResolution","pow","maxLevel","numTiles","ceil","doubleTileSize","lastTileSize","children","vtmp","f1","f2","f3","i1","i2","i3","m","angle","axis","c","aspect","znear","zfar","fovy","processLoadedTexture","img","tex","loadTexture","cacheTop","textureImageCache","TextureImageLoader","loadFn","releaseTextureImageLoader","addEventListener","PendingTextureRequest","til","req","shift","_crossOrigin","newLevel","applyRotPerspToVec","checkInView","vpp","winX","winY","winZ","ret","check1","check2","check3","check4","testX","testY","testZ","round","join","renderer","imagetype","pannellum","Viewer","initialConfig","_this","config","dLastPitch","dLastYaw","dLastHfov","preview","isAdd","dTimeLookAtHotSpot","dTimeZoomInHotSpot","dTimeZoomInAfterLoad","dTimeToLoad","isUserInteracting","latestInteraction","Date","now","onPointerDownPointerX","onPointerDownPointerY","onPointerDownPointerDist","onPointerDownYaw","onPointerDownPitch","keysDown","Array","fullscreenActive","error","listenersAdded","panoImage","prevTime","speed","animating","orientation","orientationYawOffset","autoRotateStart","autoRotateSpeed","origHfov","origPitch","animatedMove","externalEventListeners","specifiedPhotoSphereExcludes","update","eps","hotspotsCreated","destroyed","defaultConfig","minHfov","multiResMinHfov","maxHfov","minPitch","maxPitch","minYaw","maxYaw","vOffset","autoRotate","autoRotateInactivityDelay","autoRotateStopDelay","northOffset","showFullscreenCtrl","dynamicUpdate","doubleClickZoom","keyboardZoom","mouseZoom","showZoomCtrl","autoLoad","showControls","orientationOnByDefault","hotSpotDebug","avoidShowingBackground","animationTimingFunction","timingFunction","draggable","disableKeyboardCtrl","touchPanSpeedCoeffFactor","capturedKeyNumbers","friction","uiText","loadButtonLabel","loadingLabel","bylineLabel","noPanoramaError","fileAccessError","malformedURLError","iOS8WebGLError","genericWebGLError","textureSizeError","unknownError","getElementById","classList","add","tabIndex","uiContainer","renderContainer","dragFix","aboutMsg","innerHTML","aboutMessage","infoDisplay","hotSpotDebugIndicator","title","description","author","load","box","boxp","lbox","lbar","lbarFill","msg","errorMsg","controls","processOptions","zoomIn","zoomOut","fullscreen","toggleFullscreen","fullscreenEnabled","mozFullScreenEnabled","webkitFullscreenEnabled","msFullscreenEnabled","stopOrientation","startOrientation","stopPropagation","orientationSupport","DeviceOrientationEvent","location","protocol","compass","firstScene","mergeConfig","div","getElementsByTagName","anError","display","JSON","parse","stringify","multiRes","test","imageSource","itemsToLoad","onImageLoad","onError","href","outerHTML","cubeMap","absoluteURL","sanitizeURL","URL","revokeObjectURL","xhr","XMLHttpRequest","onloadend","status","textContent","response","parseGPanoXMP","onprogress","lengthComputable","percent","total","unit","numerator","denominator","toFixed","open","responseType","setRequestHeader","withCredentials","send","remove","panorama","url","RegExp","onDocumentMouseDown","onDocumentMouseMove","onDocumentMouseUp","onDocumentMouseWheel","onDocumentDoubleClick","onFullScreenChange","onDocumentResize","onDocumentKeyPress","onDocumentKeyUp","clearKeys","pointerAction","touchAction","onDocumentPointerDown","onDocumentPointerMove","onDocumentPointerUp","onDocumentTouchStart","onDocumentTouchMove","onDocumentTouchEnd","pointerEnabled","renderInit","setHfov","reader","FileReader","flagIndex","start","ignoreGPanoXMP","xmpData","substring","getTag","tag","Number","xmp","fullWidth","croppedWidth","fullHeight","croppedHeight","topPixels","heading","createObjectURL","readAsBinaryString","readAsText","fireEvent","clearError","event","pos","mousePosition","left","top","clearTimeout","t1","t2","opacity","preventDefault","bounds","getBoundingClientRect","clientX","pageX","clientY","pageY","focus","coords","mouseEventToCoords","stopAnimation","animateInit","lookAt","changeMouseCursor","isAddInfo","isAddScene","canvasWidth","canvasHeight","root","pos0","targetTouches","pos1","clientDist","touchmovePanSpeedCoeff","pointerIDs","pointerCoordinates","pointerType","pointerId","defined","wheelDeltaY","wheelDelta","detail","keynumber","which","keycode","changeKey","keyChanged","performance","keyRepeat","isKeyDown","prevPitch","prevYaw","prevZoom","newTime","timeDiff","yawDiff","animateMove","slowDownFactor","maxSpeed","t","normTime","startTime","duration","startPosition","endPosition","animate","requestAnimationFrame","getPitch","getYaw","getHfov","autoRotateStartTime","tmpyaw","hoffcut","hfov2","vfov2","transposed","yawRange","pitchRange","isNaN","renderHotSpots","Quaternion","multiply","q","toEulerAngles","taitBryanToQuaternion","beta","gamma","computeQuaternion","quaternion","orientationListener","requestPermission","renderInitCallback","sceneFadeDuration","fadeImg","createHotSpots","createHotSpot","hs","cssClass","escapeHTML","span","text","video","vidp","imgp","paddingTop","attributes","setAttribute","sceneId","onclick","ontouchend","clicked","lookAndWait","loadScene","createTooltipFunc","createTooltipArgs","wordBreak","scrollWidth","marginLeft","offsetWidth","marginTop","scrollHeight","clickHandlerFunc","clickHandlerArgs","dHfov","dTime","pZ","yZ","vZ","pS","waitForView","dPitch","dYaw","iCnt","pI","yI","vI","setYaw","sceneLoadListener","hotSpots","destroyHotSpots","current","parentNode","renderHotSpot","hsPitchSin","hsPitchCos","configPitchSin","configPitchCos","yawCos","visibility","yawSin","hfovTan","coord","rollSin","rollCos","offsetHeight","scale","MozTransform","photoSphereExcludes","scenes","scene","isPreview","backgroundImage","sanitizeURLForCss","previewTitle","previewDescription","previewAuthor","authorText","authorURL","authorLink","link","message","requestFullscreen","mozRequestFullScreen","msRequestFullscreen","webkitRequestFullScreen","exitFullscreen","mozCancelFullScreen","webkitCancelFullScreen","msExitFullscreen","fullscreenElement","mozFullScreen","webkitIsFullScreen","msFullscreenElement","constrainHfov","newHfov","targetPitch","targetYaw","targetHfov","fadeDone","workingPitch","workingYaw","workingHfov","transition","removeEventListener","then","String","split","trim","isLoaded","setPitch","animated","callbackArgs","getPitchBounds","setPitchBounds","getYawBounds","setYawBounds","getHfovBounds","setHfovBounds","getNorthOffset","setNorthOffset","getHorizonRoll","setHorizonRoll","getHorizonPitch","setHorizonPitch","startAutoRotate","stopAutoRotate","showCompass","stopMovement","getRenderer","setUpdate","bool","getScene","getAllScenes","allScenes","addScene","removeScene","getConfig","getContainer","addHotSpot","id","removeHotSpot","hotSpotId","isOrientationSupported","isOrientationActive","on","listener","off","viewer","myPromise","condition","_len","args","_key","promise","Promise","resolve","reject","configs","styles","background","equirectangularOptions","panoramaConfigs","styleInject","css","ref","insertAt","head","firstChild","insertBefore","styleSheet","cssText","createTextNode","css_248z","myPannellum","ReactPannellum","_React$Component","_super","state","_this$state","_this$props","onMouseDown","onMouseUp","onMouseMove","initPanalleum","_this2","_this$props2","setState","componentDidMount","componentWillUnmount","onPanoramaLoaded","_this$props3","undefined","_ref","_ref2","_ref3","_ref4","_ref5","_ref6","_ref7","getCurrentScene","_ref8","hotspot","_ref9","_ref10","getViewer","Component","propTypes","string","isRequired","any","shape","arrayOf","number","func","defaultProps"],"mappings":"AAAC,YAAD,C,CAEA;;;AAEA,IAAIA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAAnB;;AACA,IAAIC,SAAS,GAAGD,OAAO,CAAC,YAAD,CAAvB;;AAEA,SAASE,qBAAT,CAA+BC,CAA/B,EAAkC;AAChC,SAAOA,CAAC,IAAI,OAAOA,CAAP,KAAa,QAAlB,IAA8B,aAAaA,CAA3C,GAA+CA,CAA/C,GAAmD;AAAEC,IAAAA,OAAO,EAAED;AAAX,GAA1D;AACD;;AAED,IAAIE,cAAc,GAAG,aAAcH,qBAAqB,CAACH,KAAD,CAAxD;;KAAIM,c;;AACJ,IAAIC,kBAAkB,GAAG,aAAcJ,qBAAqB,CAACD,SAAD,CAA5D;;MAAIK,kB;;AAEJ,SAASC,eAAT,CAAyBC,QAAzB,EAAmCC,WAAnC,EAAgD;AAC9C,MAAI,EAAED,QAAQ,YAAYC,WAAtB,CAAJ,EAAwC;AACtC,UAAM,IAAIC,SAAJ,CAAc,mCAAd,CAAN;AACD;AACF;;AAED,SAASC,iBAAT,CAA2BC,MAA3B,EAAmCC,KAAnC,EAA0C;AACxC,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,KAAK,CAACE,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACrC,QAAIE,UAAU,GAAGH,KAAK,CAACC,CAAD,CAAtB;AACAE,IAAAA,UAAU,CAACC,UAAX,GAAwBD,UAAU,CAACC,UAAX,IAAyB,KAAjD;AACAD,IAAAA,UAAU,CAACE,YAAX,GAA0B,IAA1B;AACA,QAAI,WAAWF,UAAf,EAA2BA,UAAU,CAACG,QAAX,GAAsB,IAAtB;AAC3BC,IAAAA,MAAM,CAACC,cAAP,CAAsBT,MAAtB,EAA8BI,UAAU,CAACM,GAAzC,EAA8CN,UAA9C;AACD;AACF;;AAED,SAASO,YAAT,CAAsBd,WAAtB,EAAmCe,UAAnC,EAA+CC,WAA/C,EAA4D;AAC1D,MAAID,UAAJ,EAAgBb,iBAAiB,CAACF,WAAW,CAACiB,SAAb,EAAwBF,UAAxB,CAAjB;AAChB,MAAIC,WAAJ,EAAiBd,iBAAiB,CAACF,WAAD,EAAcgB,WAAd,CAAjB;AACjB,SAAOhB,WAAP;AACD;;AAED,SAASkB,eAAT,CAAyBC,GAAzB,EAA8BN,GAA9B,EAAmCO,KAAnC,EAA0C;AACxC,MAAIP,GAAG,IAAIM,GAAX,EAAgB;AACdR,IAAAA,MAAM,CAACC,cAAP,CAAsBO,GAAtB,EAA2BN,GAA3B,EAAgC;AAC9BO,MAAAA,KAAK,EAAEA,KADuB;AAE9BZ,MAAAA,UAAU,EAAE,IAFkB;AAG9BC,MAAAA,YAAY,EAAE,IAHgB;AAI9BC,MAAAA,QAAQ,EAAE;AAJoB,KAAhC;AAMD,GAPD,MAOO;AACLS,IAAAA,GAAG,CAACN,GAAD,CAAH,GAAWO,KAAX;AACD;;AAED,SAAOD,GAAP;AACD;;AAED,SAASE,OAAT,CAAiBC,MAAjB,EAAyBC,cAAzB,EAAyC;AACvC,MAAIC,IAAI,GAAGb,MAAM,CAACa,IAAP,CAAYF,MAAZ,CAAX;;AAEA,MAAIX,MAAM,CAACc,qBAAX,EAAkC;AAChC,QAAIC,OAAO,GAAGf,MAAM,CAACc,qBAAP,CAA6BH,MAA7B,CAAd;AACA,QAAIC,cAAJ,EACEG,OAAO,GAAGA,OAAO,CAACC,MAAR,CAAe,UAAUC,GAAV,EAAe;AACtC,aAAOjB,MAAM,CAACkB,wBAAP,CAAgCP,MAAhC,EAAwCM,GAAxC,EAA6CpB,UAApD;AACD,KAFS,CAAV;AAGFgB,IAAAA,IAAI,CAACM,IAAL,CAAUC,KAAV,CAAgBP,IAAhB,EAAsBE,OAAtB;AACD;;AAED,SAAOF,IAAP;AACD;;AAED,SAASQ,cAAT,CAAwB7B,MAAxB,EAAgC;AAC9B,OAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4B,SAAS,CAAC3B,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AACzC,QAAI6B,MAAM,GAAGD,SAAS,CAAC5B,CAAD,CAAT,IAAgB,IAAhB,GAAuB4B,SAAS,CAAC5B,CAAD,CAAhC,GAAsC,EAAnD;;AAEA,QAAIA,CAAC,GAAG,CAAR,EAAW;AACTgB,MAAAA,OAAO,CAACV,MAAM,CAACuB,MAAD,CAAP,EAAiB,IAAjB,CAAP,CAA8BC,OAA9B,CAAsC,UAAUtB,GAAV,EAAe;AACnDK,QAAAA,eAAe,CAACf,MAAD,EAASU,GAAT,EAAcqB,MAAM,CAACrB,GAAD,CAApB,CAAf;AACD,OAFD;AAGD,KAJD,MAIO,IAAIF,MAAM,CAACyB,yBAAX,EAAsC;AAC3CzB,MAAAA,MAAM,CAAC0B,gBAAP,CAAwBlC,MAAxB,EAAgCQ,MAAM,CAACyB,yBAAP,CAAiCF,MAAjC,CAAhC;AACD,KAFM,MAEA;AACLb,MAAAA,OAAO,CAACV,MAAM,CAACuB,MAAD,CAAP,CAAP,CAAwBC,OAAxB,CAAgC,UAAUtB,GAAV,EAAe;AAC7CF,QAAAA,MAAM,CAACC,cAAP,CACET,MADF,EAEEU,GAFF,EAGEF,MAAM,CAACkB,wBAAP,CAAgCK,MAAhC,EAAwCrB,GAAxC,CAHF;AAKD,OAND;AAOD;AACF;;AAED,SAAOV,MAAP;AACD;;AAED,SAASmC,SAAT,CAAmBC,QAAnB,EAA6BC,UAA7B,EAAyC;AACvC,MAAI,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,UAAU,KAAK,IAAvD,EAA6D;AAC3D,UAAM,IAAIvC,SAAJ,CAAc,oDAAd,CAAN;AACD;;AAEDsC,EAAAA,QAAQ,CAACtB,SAAT,GAAqBN,MAAM,CAAC8B,MAAP,CAAcD,UAAU,IAAIA,UAAU,CAACvB,SAAvC,EAAkD;AACrEyB,IAAAA,WAAW,EAAE;AACXtB,MAAAA,KAAK,EAAEmB,QADI;AAEX7B,MAAAA,QAAQ,EAAE,IAFC;AAGXD,MAAAA,YAAY,EAAE;AAHH;AADwD,GAAlD,CAArB;AAOA,MAAI+B,UAAJ,EAAgBG,eAAe,CAACJ,QAAD,EAAWC,UAAX,CAAf;AACjB;;AAED,SAASI,eAAT,CAAyBC,CAAzB,EAA4B;AAC1BD,EAAAA,eAAe,GAAGjC,MAAM,CAACmC,cAAP,GACdnC,MAAM,CAACoC,cADO,GAEd,SAASH,eAAT,CAAyBC,CAAzB,EAA4B;AAC1B,WAAOA,CAAC,CAACG,SAAF,IAAerC,MAAM,CAACoC,cAAP,CAAsBF,CAAtB,CAAtB;AACD,GAJL;AAKA,SAAOD,eAAe,CAACC,CAAD,CAAtB;AACD;;AAED,SAASF,eAAT,CAAyBE,CAAzB,EAA4BI,CAA5B,EAA+B;AAC7BN,EAAAA,eAAe,GACbhC,MAAM,CAACmC,cAAP,IACA,SAASH,eAAT,CAAyBE,CAAzB,EAA4BI,CAA5B,EAA+B;AAC7BJ,IAAAA,CAAC,CAACG,SAAF,GAAcC,CAAd;AACA,WAAOJ,CAAP;AACD,GALH;;AAOA,SAAOF,eAAe,CAACE,CAAD,EAAII,CAAJ,CAAtB;AACD;;AAED,SAASC,yBAAT,GAAqC;AACnC,MAAI,OAAOC,OAAP,KAAmB,WAAnB,IAAkC,CAACA,OAAO,CAACC,SAA/C,EAA0D,OAAO,KAAP;AAC1D,MAAID,OAAO,CAACC,SAAR,CAAkBC,IAAtB,EAA4B,OAAO,KAAP;AAC5B,MAAI,OAAOC,KAAP,KAAiB,UAArB,EAAiC,OAAO,IAAP;;AAEjC,MAAI;AACFC,IAAAA,OAAO,CAACtC,SAAR,CAAkBuC,OAAlB,CAA0BC,IAA1B,CACEN,OAAO,CAACC,SAAR,CAAkBG,OAAlB,EAA2B,EAA3B,EAA+B,YAAY,CAAE,CAA7C,CADF;AAGA,WAAO,IAAP;AACD,GALD,CAKE,OAAO7D,CAAP,EAAU;AACV,WAAO,KAAP;AACD;AACF;;AAED,SAASgE,sBAAT,CAAgCC,IAAhC,EAAsC;AACpC,MAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AACnB,UAAM,IAAIC,cAAJ,CACJ,2DADI,CAAN;AAGD;;AAED,SAAOD,IAAP;AACD;;AAED,SAASE,0BAAT,CAAoCF,IAApC,EAA0CF,IAA1C,EAAgD;AAC9C,MAAIA,IAAI,KAAK,OAAOA,IAAP,KAAgB,QAAhB,IAA4B,OAAOA,IAAP,KAAgB,UAAjD,CAAR,EAAsE;AACpE,WAAOA,IAAP;AACD;;AAED,SAAOC,sBAAsB,CAACC,IAAD,CAA7B;AACD;;AAED,SAASG,YAAT,CAAsBC,OAAtB,EAA+B;AAC7B,MAAIC,yBAAyB,GAAGd,yBAAyB,EAAzD;;AAEA,SAAO,SAASe,oBAAT,GAAgC;AACrC,QAAIC,KAAK,GAAGtB,eAAe,CAACmB,OAAD,CAA3B;AAAA,QACEI,MADF;;AAGA,QAAIH,yBAAJ,EAA+B;AAC7B,UAAII,SAAS,GAAGxB,eAAe,CAAC,IAAD,CAAf,CAAsBF,WAAtC;;AAEAyB,MAAAA,MAAM,GAAGhB,OAAO,CAACC,SAAR,CAAkBc,KAAlB,EAAyBjC,SAAzB,EAAoCmC,SAApC,CAAT;AACD,KAJD,MAIO;AACLD,MAAAA,MAAM,GAAGD,KAAK,CAACnC,KAAN,CAAY,IAAZ,EAAkBE,SAAlB,CAAT;AACD;;AAED,WAAO4B,0BAA0B,CAAC,IAAD,EAAOM,MAAP,CAAjC;AACD,GAbD;AAcD;AAED;;;AACA,IAAIE,YAAY,GAAI,UAAUC,MAAV,EAAkBC,QAAlB,EAA4BC,WAA5B,EAAyC;AAC3D,MAAI,CAACF,MAAD,IAAW,CAACC,QAAhB,EAA0B;;AAE1B,WAASE,QAAT,CAAkBC,SAAlB,EAA6B;AAAA;;AAC3B,QAAIC,MAAM,GAAGJ,QAAQ,CAACK,aAAT,CAAuB,QAAvB,CAAb;AACAD,IAAAA,MAAM,CAACE,KAAP,CAAaC,KAAb,GAAqBH,MAAM,CAACE,KAAP,CAAaE,MAAb,GAAsB,MAA3C;AACAL,IAAAA,SAAS,CAACM,WAAV,CAAsBL,MAAtB;AACA,QAAIM,OAAJ,EAAaC,EAAb,EAAiBC,EAAjB,EAAqBC,EAArB;AACA,QAAIC,eAAJ;AACA,QAAIC,KAAJ;AACA,QAAIC,KAAJ;AACA,QAAIC,IAAJ;AACA,QAAIC,KAAJ,EAAWC,SAAX,EAAsBC,OAAtB;AACA,QAAIC,cAAJ,EAAoBC,WAApB,EAAiCC,mBAAjC,EAAsDC,cAAtD;AACA,QAAIC,YAAJ;AACA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEI,SAAKC,IAAL,MAAY,UACVC,MADU,EAEVC,UAFU,EAGVC,QAHU,EAIVC,IAJU,EAKVC,IALU,EAMVC,OANU,EAOVC,QAPU,EAQVC,MARU,EASV;AAAA;;AACA;AACA,UAAIN,UAAU,KAAK3B,WAAnB,EAAgC2B,UAAU,GAAG,iBAAb;;AAEhC,UACEA,UAAU,IAAI,iBAAd,IACAA,UAAU,IAAI,SADd,IAEAA,UAAU,IAAI,UAHhB,EAIE;AACAO,QAAAA,OAAO,CAACC,GAAR,CAAY,sCAAZ;AACA,cAAM;AACJC,UAAAA,IAAI,EAAE;AADF,SAAN;AAGD;;AAEDlB,MAAAA,SAAS,GAAGS,UAAZ;AACAV,MAAAA,KAAK,GAAGS,MAAR;AACAP,MAAAA,OAAO,GAAGS,QAAV;AACAJ,MAAAA,YAAY,GAAGS,MAAM,IAAI,EAAzB,CAlBA,CAkB6B;;AAE7B,UAAIxB,OAAJ,EAAa;AACX,YAAIE,EAAJ,EAAQ;AACND,UAAAA,EAAE,CAAC2B,YAAH,CAAgB5B,OAAhB,EAAyBE,EAAzB;AACAD,UAAAA,EAAE,CAAC4B,YAAH,CAAgB3B,EAAhB;AACD;;AAED,YAAIC,EAAJ,EAAQ;AACNF,UAAAA,EAAE,CAAC2B,YAAH,CAAgB5B,OAAhB,EAAyBG,EAAzB;AACAF,UAAAA,EAAE,CAAC4B,YAAH,CAAgB1B,EAAhB;AACD;;AAEDF,QAAAA,EAAE,CAAC6B,UAAH,CAAc7B,EAAE,CAAC8B,YAAjB,EAA+B,IAA/B;AACA9B,QAAAA,EAAE,CAAC6B,UAAH,CAAc7B,EAAE,CAAC+B,oBAAjB,EAAuC,IAAvC;AACA,YAAIhC,OAAO,CAACiC,OAAZ,EAAqBhC,EAAE,CAACiC,aAAH,CAAiBlC,OAAO,CAACiC,OAAzB;AACrB,YAAIjC,OAAO,CAACmC,SAAZ,EACE,KAAK,IAAI/G,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4E,OAAO,CAACmC,SAAR,CAAkB9G,MAAtC,EAA8CD,CAAC,EAA/C,EAAmD;AACjD6E,UAAAA,EAAE,CAACiC,aAAH,CAAiBlC,OAAO,CAACmC,SAAR,CAAkB/G,CAAlB,EAAqB6G,OAAtC;AACD;AACHhC,QAAAA,EAAE,CAACmC,aAAH,CAAiBpC,OAAjB;AACAA,QAAAA,OAAO,GAAGT,WAAV;AACD;;AAEDgB,MAAAA,IAAI,GAAGhB,WAAP;AACA,UAAI8C,CAAJ;AACA,UAAIC,WAAW,GAAG,KAAlB;AACA,UAAIC,YAAJ;;AAEA,UAAI9B,SAAS,IAAI,SAAjB,EAA4B;AAC1B,aAAK4B,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtB,cAAI7B,KAAK,CAAC6B,CAAD,CAAL,CAASxC,KAAT,GAAiB,CAArB,EAAwB;AACtB,gBAAI0C,YAAY,KAAKhD,WAArB,EAAkCgD,YAAY,GAAG/B,KAAK,CAAC6B,CAAD,CAAL,CAASxC,KAAxB;AAClC,gBAAI0C,YAAY,IAAI/B,KAAK,CAAC6B,CAAD,CAAL,CAASxC,KAA7B,EACE4B,OAAO,CAACC,GAAR,CACE,0CACEa,YADF,GAEE,OAFF,GAGE/B,KAAK,CAAC6B,CAAD,CAAL,CAASxC,KAJb;AAMH,WATD,MASOyC,WAAW,GAAG,IAAd;AACR;AACF;;AAED,eAASE,gBAAT,CAA0BC,OAA1B,EAAmC;AACjC,YAAIH,WAAJ,EAAiB;AACf;AACA,cAAII,MAAM,GAAGD,OAAO,GAAGA,OAAV,GAAoB,CAAjC,CAFe,CAEqB;;AAEpC,cAAIE,UAAU,GAAG,IAAIC,iBAAJ,CAAsBF,MAAtB,CAAjB;AACA,cAAIG,GAAG,GAAGrB,MAAM,CAACsB,eAAP,GAAyBtB,MAAM,CAACsB,eAAhC,GAAkD,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAA5D;AACAD,UAAAA,GAAG,CAAC,CAAD,CAAH,IAAU,GAAV;AACAA,UAAAA,GAAG,CAAC,CAAD,CAAH,IAAU,GAAV;AACAA,UAAAA,GAAG,CAAC,CAAD,CAAH,IAAU,GAAV,CARe,CAQA;;AAEf,eAAK,IAAIzH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsH,MAApB,EAA4BtH,CAAC,EAA7B,EAAiC;AAC/BuH,YAAAA,UAAU,CAACvH,CAAC,EAAF,CAAV,GAAkByH,GAAG,CAAC,CAAD,CAArB;AACAF,YAAAA,UAAU,CAACvH,CAAC,EAAF,CAAV,GAAkByH,GAAG,CAAC,CAAD,CAArB;AACAF,YAAAA,UAAU,CAACvH,CAAC,EAAF,CAAV,GAAkByH,GAAG,CAAC,CAAD,CAArB;AACD;;AAED,cAAIE,gBAAgB,GAAG,IAAIC,SAAJ,CAAcL,UAAd,EAA0BF,OAA1B,EAAmCA,OAAnC,CAAvB;;AAEA,eAAKJ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtB,gBAAI7B,KAAK,CAAC6B,CAAD,CAAL,CAASxC,KAAT,IAAkB,CAAtB,EAAyBW,KAAK,CAAC6B,CAAD,CAAL,GAAWU,gBAAX;AAC1B;AACF;AACF,OArFD,CAqFE;AACF;AACA;AACA;AACA;AACA;AACA;;;AAEA,UACE,EACEtC,SAAS,IAAI,SAAb,IACA,CAAC8B,YAAY,GAAIA,YAAY,GAAG,CAAhC,MAAwC,CADxC,KAECU,SAAS,CAACC,SAAV,CACEC,WADF,GAEEC,KAFF,CAEQ,4BAFR,KAGCH,SAAS,CAACC,SAAV,CACGC,WADH,GAEGC,KAFH,CAES,4BAFT,CAHD,IAMCH,SAAS,CAACC,SAAV,CACGC,WADH,GAEGC,KAFH,CAES,6BAFT,CAND,IASCH,SAAS,CAACC,SAAV,CAAoBE,KAApB,CAA0B,sBAA1B,CAXF,CADF,CADF,EAeE;AACA;AACA,YAAI,CAACnD,EAAL,EACEA,EAAE,GAAGP,MAAM,CAAC2D,UAAP,CAAkB,oBAAlB,EAAwC;AAC3CC,UAAAA,KAAK,EAAE,KADoC;AAE3CC,UAAAA,KAAK,EAAE;AAFoC,SAAxC,CAAL;AAIF,YAAItD,EAAE,IAAIA,EAAE,CAACuD,QAAH,MAAiB,IAA3B,EAAiCC,oBAAoB;AACtD,OApHD,CAoHE;AACF;AACA;AACA;AACA;;;AAEA,UACE,CAACxD,EAAD,KACEQ,SAAS,IAAI,UAAb,IAA2BD,KAAK,CAACkD,cAAN,CAAqB,cAArB,CAA5B,IACCjD,SAAS,IAAI,SAFf,MAGC,sBAAsBnB,QAAQ,CAACqE,eAAT,CAAyB/D,KAA/C,IACCqD,SAAS,CAACC,SAAV,CAAoBE,KAApB,CAA0B,sBAA1B,CADD,IAECH,SAAS,CAACW,UAAV,CAAqBC,OAArB,CAA6B,SAA7B,MAA4C,CAAC,CAL/C,CADF,EAOE;AACA;AACA,YAAIxD,KAAJ,EAAW;AACTZ,UAAAA,SAAS,CAACqE,WAAV,CAAsBzD,KAAtB;AACD,SAJD,CAIE;;;AAEFA,QAAAA,KAAK,GAAGf,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAR;AACAU,QAAAA,KAAK,CAAC0D,SAAN,GAAkB,YAAlB,CAPA,CAOgC;;AAEhC,YAAIC,IAAJ;;AAEA,YAAIxD,KAAK,CAACyD,QAAV,EAAoB;AAClBD,UAAAA,IAAI,GAAGxD,KAAK,CAACyD,QAAN,GAAiBzD,KAAK,CAAC0D,YAA9B;AACD,SAFD,MAEO;AACLF,UAAAA,IAAI,GAAGxD,KAAK,CAAC0D,YAAb;AACD;;AAED,YAAIC,KAAK,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,CAAZ;AACA,YAAIC,MAAM,GAAG,CAAb;;AAEA,YAAIC,MAAM,GAAG,SAASA,MAAT,GAAkB;AAC7B;AACA,cAAIC,UAAU,GAAGhF,QAAQ,CAACK,aAAT,CAAuB,QAAvB,CAAjB;AACA2E,UAAAA,UAAU,CAACP,SAAX,GAAuB,oBAAoBI,KAAK,CAAC,KAAKI,IAAN,CAAzB,GAAuC,MAA9D;AACAlE,UAAAA,KAAK,CAACN,WAAN,CAAkBuE,UAAlB;AACA,cAAIE,WAAW,GAAGF,UAAU,CAACjB,UAAX,CAAsB,IAAtB,CAAlB;AACAiB,UAAAA,UAAU,CAAC1E,KAAX,CAAiBC,KAAjB,GAAyB,KAAKA,KAAL,GAAa,CAAb,GAAiB,IAA1C;AACAyE,UAAAA,UAAU,CAAC1E,KAAX,CAAiBE,MAAjB,GAA0B,KAAKA,MAAL,GAAc,CAAd,GAAkB,IAA5C;AACAwE,UAAAA,UAAU,CAACzE,KAAX,GAAmB,KAAKA,KAAL,GAAa,CAAhC;AACAyE,UAAAA,UAAU,CAACxE,MAAX,GAAoB,KAAKA,MAAL,GAAc,CAAlC;AACA0E,UAAAA,WAAW,CAACC,SAAZ,CAAsB,IAAtB,EAA4B,CAA5B,EAA+B,CAA/B;AACA,cAAIC,OAAO,GAAGF,WAAW,CAACG,YAAZ,CACZ,CADY,EAEZ,CAFY,EAGZL,UAAU,CAACzE,KAHC,EAIZyE,UAAU,CAACxE,MAJC,CAAd;AAMA,cAAI8E,IAAI,GAAGF,OAAO,CAACE,IAAnB,CAjB6B,CAiBJ;;AAEzB,cAAIxJ,CAAJ;AACA,cAAIyJ,CAAJ;;AAEA,eAAKzJ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGkJ,UAAU,CAACzE,KAAX,GAAmB,CAAnC,EAAsCzE,CAAC,EAAvC,EAA2C;AACzC,iBAAKyJ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtBD,cAAAA,IAAI,CAAC,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAhB,IAAyB,CAAzB,GAA6BgF,CAA9B,CAAJ,GACED,IAAI,CAAC,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAX,GAAmB,CAAxB,IAA6B,CAA7B,GAAiCgF,CAAlC,CADN;AAEAD,cAAAA,IAAI,CAAC,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,CAAL,IAAmD,CAAnD,GAAuD+E,CAAxD,CAAJ,GACED,IAAI,CAAC,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,CAAL,IAAmD,CAAnD,GAAuD+E,CAAxD,CADN;AAED;AACF;;AAED,eAAKzJ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGkJ,UAAU,CAACxE,MAAX,GAAoB,CAApC,EAAuC1E,CAAC,EAAxC,EAA4C;AAC1C,iBAAKyJ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtBD,cAAAA,IAAI,CAAC,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAf,GAAuB,CAAxB,IAA6B,CAA7B,GAAiCgF,CAAlC,CAAJ,GACED,IAAI,CAAC,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAf,GAAuB,CAAxB,IAA6B,CAA7B,GAAiCgF,CAAlC,CADN;AAEAD,cAAAA,IAAI,CAAC,CAAC,CAACxJ,CAAC,GAAG,CAAL,IAAUkJ,UAAU,CAACzE,KAArB,GAA6B,CAA9B,IAAmC,CAAnC,GAAuCgF,CAAxC,CAAJ,GACED,IAAI,CAAC,CAAC,CAACxJ,CAAC,GAAG,CAAL,IAAUkJ,UAAU,CAACzE,KAArB,GAA6B,CAA9B,IAAmC,CAAnC,GAAuCgF,CAAxC,CADN;AAED;AACF;;AAED,eAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtBD,YAAAA,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,GAAmB,CAApB,IAAyB,CAAzB,GAA6BgF,CAA9B,CAAJ,GACED,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,GAAmB,CAAnB,GAAuB,CAAxB,IAA6B,CAA7B,GAAiCgF,CAAlC,CADN;AAEAD,YAAAA,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,GAAmB,CAAnB,GAAuB,CAAxB,IAA6B,CAA7B,GAAiCgF,CAAlC,CAAJ,GACED,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,GAAmB,CAAnB,GAAuB,CAAxB,IAA6B,CAA7B,GAAiCgF,CAAlC,CADN;AAEAD,YAAAA,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,IAA6C,CAA9C,IAAmD,CAAnD,GAAuD+E,CAAxD,CAAJ,GACED,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,IAA6C,CAA9C,IAAmD,CAAnD,GAAuD+E,CAAxD,CADN;AAEAD,YAAAA,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,IAA6C,CAA9C,IAAmD,CAAnD,GAAuD+E,CAAxD,CAAJ,GACED,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,IAA6C,CAA9C,IAAmD,CAAnD,GAAuD+E,CAAxD,CADN;AAED;;AAED,eAAKzJ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGkJ,UAAU,CAACzE,KAAX,GAAmB,CAAnC,EAAsCzE,CAAC,EAAvC,EAA2C;AACzC,iBAAKyJ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtBD,cAAAA,IAAI,CAACxJ,CAAC,GAAG,CAAJ,GAAQyJ,CAAT,CAAJ,GAAkBD,IAAI,CAAC,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAhB,IAAyB,CAAzB,GAA6BgF,CAA9B,CAAtB;AACAD,cAAAA,IAAI,CAAC,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,CAAL,IAAmD,CAAnD,GAAuD+E,CAAxD,CAAJ,GACED,IAAI,CAAC,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,CAAL,IAAmD,CAAnD,GAAuD+E,CAAxD,CADN;AAED;AACF;;AAED,eAAKzJ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGkJ,UAAU,CAACxE,MAAX,GAAoB,CAApC,EAAuC1E,CAAC,EAAxC,EAA4C;AAC1C,iBAAKyJ,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtBD,cAAAA,IAAI,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAf,GAAuB,CAAvB,GAA2BgF,CAA5B,CAAJ,GACED,IAAI,CAAC,CAACxJ,CAAC,GAAGkJ,UAAU,CAACzE,KAAf,GAAuB,CAAxB,IAA6B,CAA7B,GAAiCgF,CAAlC,CADN;AAEAD,cAAAA,IAAI,CAAC,CAAC,CAACxJ,CAAC,GAAG,CAAL,IAAUkJ,UAAU,CAACzE,KAArB,GAA6B,CAA9B,IAAmC,CAAnC,GAAuCgF,CAAxC,CAAJ,GACED,IAAI,CAAC,CAAC,CAACxJ,CAAC,GAAG,CAAL,IAAUkJ,UAAU,CAACzE,KAArB,GAA6B,CAA9B,IAAmC,CAAnC,GAAuCgF,CAAxC,CADN;AAED;AACF;;AAED,eAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtBD,YAAAA,IAAI,CAACC,CAAD,CAAJ,GAAUD,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,GAAmB,CAApB,IAAyB,CAAzB,GAA6BgF,CAA9B,CAAd;AACAD,YAAAA,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,GAAmB,CAApB,IAAyB,CAAzB,GAA6BgF,CAA9B,CAAJ,GACED,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,GAAmB,CAAnB,GAAuB,CAAxB,IAA6B,CAA7B,GAAiCgF,CAAlC,CADN;AAEAD,YAAAA,IAAI,CAACN,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,IAA6C,CAA7C,GAAiD+E,CAAlD,CAAJ,GACED,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,IAA6C,CAA9C,IAAmD,CAAnD,GAAuD+E,CAAxD,CADN;AAEAD,YAAAA,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,GAAmByE,UAAU,CAACxE,MAA9B,GAAuC,CAAxC,IAA6C,CAA7C,GAAiD+E,CAAlD,CAAJ,GACED,IAAI,CAAC,CAACN,UAAU,CAACzE,KAAX,IAAoByE,UAAU,CAACxE,MAAX,GAAoB,CAAxC,IAA6C,CAA9C,IAAmD,CAAnD,GAAuD+E,CAAxD,CADN;AAED,WA5E4B,CA4E3B;;;AAEFL,UAAAA,WAAW,CAACM,YAAZ,CAAyBJ,OAAzB,EAAkC,CAAlC,EAAqC,CAArC;AACAK,UAAAA,SAAS,CAACvG,IAAV,CAAe,IAAf;AACD,SAhFD;;AAkFA,YAAIuG,SAAS,GAAG,SAASA,SAAT,GAAqB;AACnC,cAAI,KAAKlF,KAAL,GAAa,CAAjB,EAAoB;AAClB,gBAAIO,eAAe,KAAKb,WAAxB,EAAqCa,eAAe,GAAG,KAAKP,KAAvB;AACrC,gBAAIO,eAAe,IAAI,KAAKP,KAA5B,EACE4B,OAAO,CAACC,GAAR,CACE,8CACEtB,eADF,GAEE,OAFF,GAGE,KAAKP,KAJT;AAMH,WATD,MASOyC,WAAW,GAAG,IAAd;;AAEP8B,UAAAA,MAAM;;AAEN,cAAIA,MAAM,IAAI,CAAd,EAAiB;AACfhE,YAAAA,eAAe,GAAG,KAAKP,KAAvB;AACAJ,YAAAA,SAAS,CAACM,WAAV,CAAsBM,KAAtB;AACAkB,YAAAA,QAAQ;AACT;AACF,SAnBD;;AAqBAe,QAAAA,WAAW,GAAG,KAAd;;AAEA,aAAKD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtB,cAAI2C,OAAO,GAAG,IAAIC,KAAJ,EAAd;AACAD,UAAAA,OAAO,CAACE,WAAR,GAAsBnE,YAAY,CAACmE,WAAb,GAClBnE,YAAY,CAACmE,WADK,GAElB,WAFJ;AAGAF,UAAAA,OAAO,CAACT,IAAR,GAAelC,CAAf;AACA2C,UAAAA,OAAO,CAACG,MAAR,GAAiBd,MAAjB;AACAW,UAAAA,OAAO,CAACI,OAAR,GAAkBL,SAAlB,CAPsB,CAOO;;AAE7B,cAAItE,SAAS,IAAI,UAAjB,EAA6B;AAC3BuE,YAAAA,OAAO,CAACK,GAAR,GAAcrB,IAAI,CAACsB,OAAL,CAAa,IAAb,EAAmBnB,KAAK,CAAC9B,CAAD,CAAxB,IAA+B,GAA/B,GAAqC7B,KAAK,CAAC+E,SAAzD;AACD,WAFD,MAEO;AACLP,YAAAA,OAAO,CAACK,GAAR,GAAc7E,KAAK,CAAC6B,CAAD,CAAL,CAASgD,GAAvB;AACD;AACF;;AAED7C,QAAAA,gBAAgB,CAACpC,eAAD,CAAhB;AACA;AACD,OAtJD,MAsJO,IAAI,CAACH,EAAL,EAAS;AACdwB,QAAAA,OAAO,CAACC,GAAR,CAAY,mCAAZ;AACA,cAAM;AACJC,UAAAA,IAAI,EAAE;AADF,SAAN;AAGD;;AAED,UAAIlB,SAAS,IAAI,SAAjB,EAA4B+B,gBAAgB,CAACD,YAAD,CAAhB;;AAE5B,UAAI/B,KAAK,CAACyD,QAAV,EAAoB;AAClBzD,QAAAA,KAAK,CAACgF,QAAN,GAAiBhF,KAAK,CAACyD,QAAN,GAAiBzD,KAAK,CAACwD,IAAxC;AACD,OAFD,MAEO;AACLxD,QAAAA,KAAK,CAACgF,QAAN,GAAiBhF,KAAK,CAACwD,IAAvB;AACD;;AAEDxD,MAAAA,KAAK,CAACiF,iBAAN,GAA0B,IAAIjF,KAAK,CAACkF,cAApC;AACA,UAAIC,QAAQ,GAAGC,UAAU,EAAzB;AACAtF,MAAAA,KAAK,GAAG,EAAR;;AAEA,WAAK+B,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtB/B,QAAAA,KAAK,CAAC+B,CAAD,CAAL,GAAWsD,QAAQ,CAACE,KAAT,CAAexD,CAAC,GAAG,EAAnB,EAAuBA,CAAC,GAAG,EAAJ,GAAS,EAAhC,CAAX;AACAsD,QAAAA,QAAQ,GAAGC,UAAU,EAArB;AACD,OAtSD,CAsSE;;;AAEF,UAAIE,QAAQ,GAAG,CAAf;;AAEA,UAAIrF,SAAS,IAAI,iBAAjB,EAAoC;AAClCqF,QAAAA,QAAQ,GAAG7F,EAAE,CAAC8F,YAAH,CAAgB9F,EAAE,CAAC+F,gBAAnB,CAAX;;AAEA,YAAIC,IAAI,CAACC,GAAL,CAAS1F,KAAK,CAACX,KAAN,GAAc,CAAvB,EAA0BW,KAAK,CAACV,MAAhC,IAA0CgG,QAA9C,EAAwD;AACtDrE,UAAAA,OAAO,CAACC,GAAR,CACE,uCACElB,KAAK,CAACX,KADR,GAEE,WAFF,GAGE,8CAHF,GAIEiG,QAAQ,GAAG,CAJb,GAKE,KANJ;AAQA,gBAAM;AACJnE,YAAAA,IAAI,EAAE,kBADF;AAEJ9B,YAAAA,KAAK,EAAEW,KAAK,CAACX,KAFT;AAGJiG,YAAAA,QAAQ,EAAEA,QAAQ,GAAG;AAHjB,WAAN;AAKD;AACF,OAlBD,MAkBO,IAAIrF,SAAS,IAAI,SAAjB,EAA4B;AACjC,YAAI8B,YAAY,GAAGtC,EAAE,CAAC8F,YAAH,CAAgB9F,EAAE,CAACkG,yBAAnB,CAAnB,EAAkE;AAChE1E,UAAAA,OAAO,CAACC,GAAR,CACE,uCACEa,YADF,GAEE,WAFF,GAGE,8CAHF,GAIEuD,QAJF,GAKE,KANJ;AAQA,gBAAM;AACJnE,YAAAA,IAAI,EAAE,kBADF;AAEJ9B,YAAAA,KAAK,EAAE0C,YAFH;AAGJuD,YAAAA,QAAQ,EAAEA;AAHN,WAAN;AAKD;AACF,OA5UD,CA4UE;;;AAEF,UACEtE,MAAM,KAAKjC,WAAX,KACCiC,MAAM,CAAC4E,YAAP,KAAwB7G,WAAxB,IACCiC,MAAM,CAAC6E,WAAP,KAAuB9G,WAFzB,CADF,EAKEgB,IAAI,GAAG,CACLiB,MAAM,CAAC4E,YAAP,IAAuB7G,WAAvB,GAAqC,CAArC,GAAyCiC,MAAM,CAAC4E,YAD3C,EAEL5E,MAAM,CAAC6E,WAAP,IAAsB9G,WAAtB,GAAoC,CAApC,GAAwCiC,MAAM,CAAC6E,WAF1C,CAAP,CAnVF,CAsVK;;AAEL,UAAIC,UAAU,GAAGrG,EAAE,CAACsG,UAApB,CAxVA,CAwVgC;;AAEhCtG,MAAAA,EAAE,CAACuG,QAAH,CAAY,CAAZ,EAAe,CAAf,EAAkBvG,EAAE,CAACwG,kBAArB,EAAyCxG,EAAE,CAACyG,mBAA5C,EA1VA,CA0VkE;;AAElE,UAAIzG,EAAE,CAAC0G,wBAAP,EAAiC;AAC/B,YAAIC,SAAS,GAAG3G,EAAE,CAAC0G,wBAAH,CACd1G,EAAE,CAAC4G,eADW,EAEd5G,EAAE,CAAC6G,UAFW,CAAhB;;AAKA,YAAIF,SAAS,IAAIA,SAAS,CAACA,SAAV,GAAsB,CAAvC,EAA0C;AACxC;AACAG,UAAAA,gBAAgB,GAAGA,gBAAgB,CAACzB,OAAjB,CAAyB,OAAzB,EAAkC,SAAlC,CAAnB;AACD;AACF,OAtWD,CAsWE;;;AAEFpF,MAAAA,EAAE,GAAGD,EAAE,CAAC+G,YAAH,CAAgB/G,EAAE,CAACgH,aAAnB,CAAL;AACA,UAAIC,SAAS,GAAGC,CAAhB;;AAEA,UAAI1G,SAAS,IAAI,UAAjB,EAA6B;AAC3ByG,QAAAA,SAAS,GAAGE,MAAZ;AACD;;AAEDnH,MAAAA,EAAE,CAACoH,YAAH,CAAgBnH,EAAhB,EAAoBgH,SAApB;AACAjH,MAAAA,EAAE,CAACqH,aAAH,CAAiBpH,EAAjB,EAhXA,CAgXsB;;AAEtBC,MAAAA,EAAE,GAAGF,EAAE,CAAC+G,YAAH,CAAgB/G,EAAE,CAAC4G,eAAnB,CAAL;AACA,UAAIU,WAAW,GAAGC,mBAAlB;;AAEA,UAAI/G,SAAS,IAAI,SAAjB,EAA4B;AAC1B6F,QAAAA,UAAU,GAAGrG,EAAE,CAACwH,gBAAhB;AACAF,QAAAA,WAAW,GAAGG,QAAd;AACD,OAHD,MAGO,IAAIjH,SAAS,IAAI,UAAjB,EAA6B;AAClC8G,QAAAA,WAAW,GAAGI,SAAd;AACD;;AAED1H,MAAAA,EAAE,CAACoH,YAAH,CAAgBlH,EAAhB,EAAoBoH,WAApB;AACAtH,MAAAA,EAAE,CAACqH,aAAH,CAAiBnH,EAAjB,EA7XA,CA6XsB;;AAEtBH,MAAAA,OAAO,GAAGC,EAAE,CAAC2H,aAAH,EAAV;AACA3H,MAAAA,EAAE,CAAC4H,YAAH,CAAgB7H,OAAhB,EAAyBE,EAAzB;AACAD,MAAAA,EAAE,CAAC4H,YAAH,CAAgB7H,OAAhB,EAAyBG,EAAzB;AACAF,MAAAA,EAAE,CAAC6H,WAAH,CAAe9H,OAAf,EAlYA,CAkYyB;;AAEzB,UAAI,CAACC,EAAE,CAAC8H,kBAAH,CAAsB7H,EAAtB,EAA0BD,EAAE,CAAC+H,cAA7B,CAAL,EACEvG,OAAO,CAACC,GAAR,CAAYzB,EAAE,CAACgI,gBAAH,CAAoB/H,EAApB,CAAZ;AACF,UAAI,CAACD,EAAE,CAAC8H,kBAAH,CAAsB5H,EAAtB,EAA0BF,EAAE,CAAC+H,cAA7B,CAAL,EACEvG,OAAO,CAACC,GAAR,CAAYzB,EAAE,CAACgI,gBAAH,CAAoB9H,EAApB,CAAZ;AACF,UAAI,CAACF,EAAE,CAACiI,mBAAH,CAAuBlI,OAAvB,EAAgCC,EAAE,CAACkI,WAAnC,CAAL,EACE1G,OAAO,CAACC,GAAR,CAAYzB,EAAE,CAACmI,iBAAH,CAAqBpI,OAArB,CAAZ,EAzYF,CAyY8C;;AAE9CC,MAAAA,EAAE,CAACoI,UAAH,CAAcrI,OAAd;AACAA,MAAAA,OAAO,CAACsI,cAAR,GAAyB,KAAzB,CA5YA,CA4YgC;;AAEhC,UAAIC,KAAK,GAAG/G,MAAM,CAACsB,eAAP,GAAyBtB,MAAM,CAACsB,eAAhC,GAAkD,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAA9D;AACA7C,MAAAA,EAAE,CAACuI,UAAH,CAAcD,KAAK,CAAC,CAAD,CAAnB,EAAwBA,KAAK,CAAC,CAAD,CAA7B,EAAkCA,KAAK,CAAC,CAAD,CAAvC,EAA4C,GAA5C;AACAtI,MAAAA,EAAE,CAACwI,KAAH,CAASxI,EAAE,CAACyI,gBAAZ,EAhZA,CAgZ+B;;AAE/B1I,MAAAA,OAAO,CAAC2I,gBAAR,GAA2B1I,EAAE,CAAC2I,iBAAH,CAAqB5I,OAArB,EAA8B,YAA9B,CAA3B;AACAC,MAAAA,EAAE,CAAC4I,uBAAH,CAA2B7I,OAAO,CAAC2I,gBAAnC;;AAEA,UAAIlI,SAAS,IAAI,UAAjB,EAA6B;AAC3B;AACA,YAAI,CAACE,cAAL,EAAqBA,cAAc,GAAGV,EAAE,CAAC6I,YAAH,EAAjB;AACrB7I,QAAAA,EAAE,CAAC6B,UAAH,CAAc7B,EAAE,CAAC8B,YAAjB,EAA+BpB,cAA/B;AACAV,QAAAA,EAAE,CAAC8I,UAAH,CACE9I,EAAE,CAAC8B,YADL,EAEE,IAAIiH,YAAJ,CAAiB,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAC,CAAlB,EAAqB,CAAC,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAAC,CAAhC,EAAmC,CAAC,CAApC,EAAuC,CAAC,CAAxC,CAAjB,CAFF,EAGE/I,EAAE,CAACgJ,WAHL;AAKAhJ,QAAAA,EAAE,CAACiJ,mBAAH,CACElJ,OAAO,CAAC2I,gBADV,EAEE,CAFF,EAGE1I,EAAE,CAACkJ,KAHL,EAIE,KAJF,EAKE,CALF,EAME,CANF,EAT2B,CAgBxB;;AAEHnJ,QAAAA,OAAO,CAACoJ,WAAR,GAAsBnJ,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,eAA/B,CAAtB;AACAC,QAAAA,EAAE,CAACqJ,SAAH,CACEtJ,OAAO,CAACoJ,WADV,EAEEnJ,EAAE,CAACwG,kBAAH,GAAwBxG,EAAE,CAACyG,mBAF7B,EAnB2B,CAsBxB;;AAEH1G,QAAAA,OAAO,CAACuJ,GAAR,GAActJ,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,OAA/B,CAAd;AACAA,QAAAA,OAAO,CAACwJ,KAAR,GAAgBvJ,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,SAA/B,CAAhB;AACAA,QAAAA,OAAO,CAACyJ,CAAR,GAAYxJ,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,KAA/B,CAAZ;AACAA,QAAAA,OAAO,CAAC0J,CAAR,GAAYzJ,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,KAA/B,CAAZ;AACAA,QAAAA,OAAO,CAACmH,CAAR,GAAYlH,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,KAA/B,CAAZ;AACAA,QAAAA,OAAO,CAAC2J,EAAR,GAAa1J,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,MAA/B,CAAb;AACAA,QAAAA,OAAO,CAAC4J,GAAR,GAAc3J,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,OAA/B,CAAd,CA9B2B,CA8B4B;;AAEvDC,QAAAA,EAAE,CAACqJ,SAAH,CAAatJ,OAAO,CAAC0J,CAArB,EAAwBtI,IAAI,IAAI6E,IAAI,CAAC4D,EAAL,GAAU,GAAd,CAA5B;AACA5J,QAAAA,EAAE,CAACqJ,SAAH,CAAatJ,OAAO,CAACmH,CAArB,EAAwB9F,IAAI,GAAG4E,IAAI,CAAC4D,EAApC;AACA5J,QAAAA,EAAE,CAACqJ,SAAH,CAAatJ,OAAO,CAAC2J,EAArB,EAA0BrI,OAAO,GAAG2E,IAAI,CAAC4D,EAAhB,GAAsB,CAA/C,EAlC2B,CAkCwB;;AAEnD,YAAIpJ,SAAS,IAAI,iBAAjB,EAAoC;AAClCT,UAAAA,OAAO,CAAC8C,eAAR,GAA0B7C,EAAE,CAACoJ,kBAAH,CACxBrJ,OADwB,EAExB,mBAFwB,CAA1B;AAIAC,UAAAA,EAAE,CAAC6J,UAAH,CAAc9J,OAAO,CAAC8C,eAAtB,EAAuCyF,KAAK,CAACwB,MAAN,CAAa,CAAC,CAAD,CAAb,CAAvC;AACD,SA1C0B,CA0CzB;;;AAEF/J,QAAAA,OAAO,CAACiC,OAAR,GAAkBhC,EAAE,CAAC+J,aAAH,EAAlB;AACA/J,QAAAA,EAAE,CAACgK,WAAH,CAAe3D,UAAf,EAA2BtG,OAAO,CAACiC,OAAnC,EA7C2B,CA6CkB;;AAE7C,YAAIxB,SAAS,IAAI,SAAjB,EAA4B;AAC1B;AACAR,UAAAA,EAAE,CAACiK,UAAH,CACEjK,EAAE,CAACkK,2BADL,EAEE,CAFF,EAGElK,EAAE,CAACmK,GAHL,EAIEnK,EAAE,CAACmK,GAJL,EAKEnK,EAAE,CAACoK,aALL,EAME7J,KAAK,CAAC,CAAD,CANP;AAQAP,UAAAA,EAAE,CAACiK,UAAH,CACEjK,EAAE,CAACqK,2BADL,EAEE,CAFF,EAGErK,EAAE,CAACmK,GAHL,EAIEnK,EAAE,CAACmK,GAJL,EAKEnK,EAAE,CAACoK,aALL,EAME7J,KAAK,CAAC,CAAD,CANP;AAQAP,UAAAA,EAAE,CAACiK,UAAH,CACEjK,EAAE,CAACsK,2BADL,EAEE,CAFF,EAGEtK,EAAE,CAACmK,GAHL,EAIEnK,EAAE,CAACmK,GAJL,EAKEnK,EAAE,CAACoK,aALL,EAME7J,KAAK,CAAC,CAAD,CANP;AAQAP,UAAAA,EAAE,CAACiK,UAAH,CACEjK,EAAE,CAACuK,2BADL,EAEE,CAFF,EAGEvK,EAAE,CAACmK,GAHL,EAIEnK,EAAE,CAACmK,GAJL,EAKEnK,EAAE,CAACoK,aALL,EAME7J,KAAK,CAAC,CAAD,CANP;AAQAP,UAAAA,EAAE,CAACiK,UAAH,CACEjK,EAAE,CAACwK,2BADL,EAEE,CAFF,EAGExK,EAAE,CAACmK,GAHL,EAIEnK,EAAE,CAACmK,GAJL,EAKEnK,EAAE,CAACoK,aALL,EAME7J,KAAK,CAAC,CAAD,CANP;AAQAP,UAAAA,EAAE,CAACiK,UAAH,CACEjK,EAAE,CAACyK,2BADL,EAEE,CAFF,EAGEzK,EAAE,CAACmK,GAHL,EAIEnK,EAAE,CAACmK,GAJL,EAKEnK,EAAE,CAACoK,aALL,EAME7J,KAAK,CAAC,CAAD,CANP;AAQD,SAlDD,MAkDO;AACL,cAAIA,KAAK,CAACX,KAAN,IAAeiG,QAAnB,EAA6B;AAC3B7F,YAAAA,EAAE,CAAC0K,SAAH,CAAa1K,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,cAA/B,CAAb,EAA6D,CAA7D,EAD2B,CACsC;;AAEjEC,YAAAA,EAAE,CAACiK,UAAH,CACE5D,UADF,EAEE,CAFF,EAGErG,EAAE,CAACmK,GAHL,EAIEnK,EAAE,CAACmK,GAJL,EAKEnK,EAAE,CAACoK,aALL,EAME7J,KANF;AAQD,WAXD,MAWO;AACL;AACAP,YAAAA,EAAE,CAAC0K,SAAH,CAAa1K,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,cAA/B,CAAb,EAA6D,CAA7D,EAFK,CAE4D;;AAEjE,gBAAI4K,UAAU,GAAGtL,QAAQ,CAACK,aAAT,CAAuB,QAAvB,CAAjB;AACAiL,YAAAA,UAAU,CAAC/K,KAAX,GAAmBW,KAAK,CAACX,KAAN,GAAc,CAAjC;AACA+K,YAAAA,UAAU,CAAC9K,MAAX,GAAoBU,KAAK,CAACV,MAA1B;AACA,gBAAI+K,WAAW,GAAGD,UAAU,CAACvH,UAAX,CAAsB,IAAtB,CAAlB;AACAwH,YAAAA,WAAW,CAACpG,SAAZ,CAAsBjE,KAAtB,EAA6B,CAA7B,EAAgC,CAAhC,EARK,CAQ+B;;AAEpC,gBAAIsK,SAAS,GAAGD,WAAW,CAAClG,YAAZ,CACd,CADc,EAEd,CAFc,EAGdnE,KAAK,CAACX,KAAN,GAAc,CAHA,EAIdW,KAAK,CAACV,MAJQ,CAAhB;AAMAG,YAAAA,EAAE,CAACiK,UAAH,CACE5D,UADF,EAEE,CAFF,EAGErG,EAAE,CAACmK,GAHL,EAIEnK,EAAE,CAACmK,GAJL,EAKEnK,EAAE,CAACoK,aALL,EAMES,SANF,EAhBK,CAuBF;;AAEH9K,YAAAA,OAAO,CAAC+K,QAAR,GAAmB9K,EAAE,CAAC+J,aAAH,EAAnB;AACA/J,YAAAA,EAAE,CAAC+K,aAAH,CAAiB/K,EAAE,CAACgL,QAApB;AACAhL,YAAAA,EAAE,CAACgK,WAAH,CAAe3D,UAAf,EAA2BtG,OAAO,CAAC+K,QAAnC;AACA9K,YAAAA,EAAE,CAAC0K,SAAH,CAAa1K,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,UAA/B,CAAb,EAAyD,CAAzD,EA5BK,CA4BwD;;AAE7D6K,YAAAA,WAAW,CAACpG,SAAZ,CAAsBjE,KAAtB,EAA6B,CAACA,KAAK,CAACX,KAAP,GAAe,CAA5C,EAA+C,CAA/C;AACAiL,YAAAA,SAAS,GAAGD,WAAW,CAAClG,YAAZ,CACV,CADU,EAEV,CAFU,EAGVnE,KAAK,CAACX,KAAN,GAAc,CAHJ,EAIVW,KAAK,CAACV,MAJI,CAAZ;AAMAG,YAAAA,EAAE,CAACiK,UAAH,CACE5D,UADF,EAEE,CAFF,EAGErG,EAAE,CAACmK,GAHL,EAIEnK,EAAE,CAACmK,GAJL,EAKEnK,EAAE,CAACoK,aALL,EAMES,SANF,EArCK,CA4CF;;AAEH7K,YAAAA,EAAE,CAACiL,aAAH,CAAiB5E,UAAjB,EAA6BrG,EAAE,CAACkL,cAAhC,EAAgDlL,EAAE,CAACmL,aAAnD;AACAnL,YAAAA,EAAE,CAACiL,aAAH,CAAiB5E,UAAjB,EAA6BrG,EAAE,CAACoL,cAAhC,EAAgDpL,EAAE,CAACmL,aAAnD;AACAnL,YAAAA,EAAE,CAACiL,aAAH,CAAiB5E,UAAjB,EAA6BrG,EAAE,CAACqL,kBAAhC,EAAoDrL,EAAE,CAACsL,MAAvD;AACAtL,YAAAA,EAAE,CAACiL,aAAH,CAAiB5E,UAAjB,EAA6BrG,EAAE,CAACuL,kBAAhC,EAAoDvL,EAAE,CAACsL,MAAvD,EAjDK,CAiD2D;;AAEhEtL,YAAAA,EAAE,CAAC+K,aAAH,CAAiB/K,EAAE,CAACwL,QAApB;AACD;AACF,SAlK0B,CAkKzB;;;AAEFxL,QAAAA,EAAE,CAACiL,aAAH,CAAiB5E,UAAjB,EAA6BrG,EAAE,CAACkL,cAAhC,EAAgDlL,EAAE,CAACmL,aAAnD;AACAnL,QAAAA,EAAE,CAACiL,aAAH,CAAiB5E,UAAjB,EAA6BrG,EAAE,CAACoL,cAAhC,EAAgDpL,EAAE,CAACmL,aAAnD;AACAnL,QAAAA,EAAE,CAACiL,aAAH,CAAiB5E,UAAjB,EAA6BrG,EAAE,CAACqL,kBAAhC,EAAoDrL,EAAE,CAACsL,MAAvD;AACAtL,QAAAA,EAAE,CAACiL,aAAH,CAAiB5E,UAAjB,EAA6BrG,EAAE,CAACuL,kBAAhC,EAAoDvL,EAAE,CAACsL,MAAvD;AACD,OAxKD,MAwKO;AACL;AACAvL,QAAAA,OAAO,CAAC0L,eAAR,GAA0BzL,EAAE,CAAC2I,iBAAH,CAAqB5I,OAArB,EAA8B,aAA9B,CAA1B;AACAC,QAAAA,EAAE,CAAC4I,uBAAH,CAA2B7I,OAAO,CAAC0L,eAAnC,EAHK,CAGgD;;AAErD,YAAI,CAAC9K,WAAL,EAAkBA,WAAW,GAAGX,EAAE,CAAC6I,YAAH,EAAd;AAClB,YAAI,CAACjI,mBAAL,EAA0BA,mBAAmB,GAAGZ,EAAE,CAAC6I,YAAH,EAAtB;AAC1B,YAAI,CAAChI,cAAL,EAAqBA,cAAc,GAAGb,EAAE,CAAC6I,YAAH,EAAjB,CAPhB,CAOoD;;AAEzD7I,QAAAA,EAAE,CAAC6B,UAAH,CAAc7B,EAAE,CAAC8B,YAAjB,EAA+BlB,mBAA/B;AACAZ,QAAAA,EAAE,CAAC8I,UAAH,CACE9I,EAAE,CAAC8B,YADL,EAEE,IAAIiH,YAAJ,CAAiB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,CAAjB,CAFF,EAGE/I,EAAE,CAACgJ,WAHL,EAVK,CAcF;;AAEHhJ,QAAAA,EAAE,CAAC6B,UAAH,CAAc7B,EAAE,CAAC+B,oBAAjB,EAAuClB,cAAvC;AACAb,QAAAA,EAAE,CAAC8I,UAAH,CACE9I,EAAE,CAAC+B,oBADL,EAEE,IAAI2J,WAAJ,CAAgB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CAAhB,CAFF,EAGE1L,EAAE,CAACgJ,WAHL,EAjBK,CAqBF;;AAEHjJ,QAAAA,OAAO,CAAC4L,YAAR,GAAuB3L,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,eAA/B,CAAvB;AACAA,QAAAA,OAAO,CAAC6L,WAAR,GAAsB5L,EAAE,CAACoJ,kBAAH,CAAsBrJ,OAAtB,EAA+B,cAA/B,CAAtB,CAxBK,CAwBiE;;AAEtEA,QAAAA,OAAO,CAAC8L,KAAR,GAAgB,CAAC,CAAjB;AACA9L,QAAAA,OAAO,CAAC+L,YAAR,GAAuB,EAAvB;AACA/L,QAAAA,OAAO,CAACmC,SAAR,GAAoB,EAApB;AACAnC,QAAAA,OAAO,CAACgM,kBAAR,GAA6B,CAA7B;AACD,OA3lBD,CA2lBE;;;AAEF,UAAIC,GAAG,GAAGhM,EAAE,CAACuD,QAAH,EAAV;;AAEA,UAAIyI,GAAG,KAAK,CAAZ,EAAe;AACbxK,QAAAA,OAAO,CAACC,GAAR,CAAY,yCAAZ,EAAuDuK,GAAvD;AACA,cAAM;AACJtK,UAAAA,IAAI,EAAE;AADF,SAAN;AAGD;;AAEDJ,MAAAA,QAAQ;AACT,KAhnBD;AAAA,cAoZEtB,EAAE,CAACoI,UApZL;AAAA;AAinBA;AACJ;AACA;AACA;AACA;;AAEI,SAAK6D,OAAL,GAAe,YAAY;AACzB,UAAIzM,SAAS,KAAKF,WAAlB,EAA+B;AAC7B,YAAIG,MAAM,KAAKH,WAAX,IAA0BE,SAAS,CAAC0M,QAAV,CAAmBzM,MAAnB,CAA9B,EAA0D;AACxDD,UAAAA,SAAS,CAACqE,WAAV,CAAsBpE,MAAtB;AACD;;AAED,YAAIW,KAAK,KAAKd,WAAV,IAAyBE,SAAS,CAAC0M,QAAV,CAAmB9L,KAAnB,CAA7B,EAAwD;AACtDZ,UAAAA,SAAS,CAACqE,WAAV,CAAsBzD,KAAtB;AACD;AACF;;AAED,UAAIJ,EAAJ,EAAQ;AACN;AACA;AACA,YAAIsF,SAAS,GAAGtF,EAAE,CAACmM,YAAH,CAAgB,oBAAhB,CAAhB;AACA,YAAI7G,SAAJ,EAAeA,SAAS,CAAC8G,WAAV;AAChB;AACF,KAjBD;AAkBA;AACJ;AACA;AACA;AACA;;;AAEI,SAAKC,MAAL,GAAc,YAAY;AACxB,UAAIC,UAAU,GAAGlN,MAAM,CAACmN,gBAAP,IAA2B,CAA5C;AACA9M,MAAAA,MAAM,CAACG,KAAP,GAAeH,MAAM,CAAC+M,WAAP,GAAqBF,UAApC;AACA7M,MAAAA,MAAM,CAACI,MAAP,GAAgBJ,MAAM,CAACgN,YAAP,GAAsBH,UAAtC;;AAEA,UAAItM,EAAJ,EAAQ;AACN,YAAIA,EAAE,CAACuD,QAAH,MAAiB,IAArB,EAA2BC,oBAAoB;AAC/CxD,QAAAA,EAAE,CAACuG,QAAH,CAAY,CAAZ,EAAe,CAAf,EAAkBvG,EAAE,CAACwG,kBAArB,EAAyCxG,EAAE,CAACyG,mBAA5C;;AAEA,YAAIjG,SAAS,IAAI,UAAjB,EAA6B;AAC3BR,UAAAA,EAAE,CAACqJ,SAAH,CACEtJ,OAAO,CAACoJ,WADV,EAEE1J,MAAM,CAAC+M,WAAP,GAAqB/M,MAAM,CAACgN,YAF9B;AAID;AACF;AACF,KAhBD,CA9qB2B,CA8rBxB;;;AAEH,SAAKJ,MAAL;AACA;AACJ;AACA;AACA;AACA;;AAEI,SAAKK,OAAL,GAAe,UAAUvG,YAAV,EAAwBC,WAAxB,EAAqC;AAClD9F,MAAAA,IAAI,GAAG,CAAC6F,YAAD,EAAeC,WAAf,CAAP;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKuG,MAAL,GAAc,UAAUC,KAAV,EAAiBC,GAAjB,EAAsBC,IAAtB,EAA4BvL,MAA5B,EAAoC;AAChD,UAAIwL,KAAJ;AAAA,UACE5R,CADF;AAAA,UAEEiH,CAFF;AAAA,UAGE4K,IAAI,GAAG,CAHT;AAIA,UAAIzL,MAAM,KAAKjC,WAAf,EAA4BiC,MAAM,GAAG,EAAT;AAC5B,UAAIA,MAAM,CAACyL,IAAX,EAAiBA,IAAI,GAAGzL,MAAM,CAACyL,IAAd,CAN+B,CAMX;;AAErC,UAAI1M,IAAI,KAAKhB,WAAb,EAA0B;AACxB,YAAI6G,YAAY,GAAG7F,IAAI,CAAC,CAAD,CAAvB;AAAA,YACE8F,WAAW,GAAG9F,IAAI,CAAC,CAAD,CADpB,CADwB,CAEC;;AAEzB,YAAI2M,UAAU,GAAGL,KAAjB;AAAA,YACEM,QAAQ,GAAGL,GADb;AAAA,YAEEM,CAAC,GACCnH,IAAI,CAACoH,GAAL,CAAShH,WAAT,IAAwBJ,IAAI,CAACqH,GAAL,CAAST,KAAT,CAAxB,GAA0C5G,IAAI,CAACqH,GAAL,CAASlH,YAAT,CAA1C,GACAH,IAAI,CAACoH,GAAL,CAASR,KAAT,KACG5G,IAAI,CAACoH,GAAL,CAASjH,YAAT,IAAyBH,IAAI,CAACoH,GAAL,CAASP,GAAT,CAAzB,GACC7G,IAAI,CAACqH,GAAL,CAASjH,WAAT,IAAwBJ,IAAI,CAACqH,GAAL,CAASlH,YAAT,CAAxB,GAAiDH,IAAI,CAACqH,GAAL,CAASR,GAAT,CAFrD,CAJJ;AAAA,YAOES,CAAC,GACC,CAACtH,IAAI,CAACqH,GAAL,CAAST,KAAT,CAAD,GAAmB5G,IAAI,CAACqH,GAAL,CAASjH,WAAT,CAAnB,GACAJ,IAAI,CAACoH,GAAL,CAASR,KAAT,IAAkB5G,IAAI,CAACoH,GAAL,CAAShH,WAAT,CAAlB,GAA0CJ,IAAI,CAACqH,GAAL,CAASR,GAAT,CAT9C;AAAA,YAUEU,CAAC,GACCvH,IAAI,CAACoH,GAAL,CAAShH,WAAT,IAAwBJ,IAAI,CAACoH,GAAL,CAASjH,YAAT,CAAxB,GAAiDH,IAAI,CAACqH,GAAL,CAAST,KAAT,CAAjD,GACA5G,IAAI,CAACoH,GAAL,CAASR,KAAT,KACG,CAAC5G,IAAI,CAACoH,GAAL,CAASP,GAAT,CAAD,GAAiB7G,IAAI,CAACqH,GAAL,CAASlH,YAAT,CAAjB,GACCH,IAAI,CAACoH,GAAL,CAASjH,YAAT,IAAyBH,IAAI,CAACqH,GAAL,CAASjH,WAAT,CAAzB,GAAiDJ,IAAI,CAACqH,GAAL,CAASR,GAAT,CAFrD,CAZJ;AAeAD,QAAAA,KAAK,GAAG5G,IAAI,CAACwH,IAAL,CAAUxH,IAAI,CAACC,GAAL,CAASD,IAAI,CAACyH,GAAL,CAASF,CAAT,EAAY,CAAZ,CAAT,EAAyB,CAAC,CAA1B,CAAV,CAAR;AACAV,QAAAA,GAAG,GAAG7G,IAAI,CAAC0H,KAAL,CAAWJ,CAAX,EAAcH,CAAd,CAAN,CApBwB,CAoBA;;AAExB,YAAIjG,CAAC,GAAG,CACJlB,IAAI,CAACoH,GAAL,CAASH,UAAT,KACGjH,IAAI,CAACqH,GAAL,CAASjH,WAAT,IACCJ,IAAI,CAACqH,GAAL,CAASlH,YAAT,CADD,GAECH,IAAI,CAACoH,GAAL,CAASF,QAAT,CAFD,GAGClH,IAAI,CAACoH,GAAL,CAASjH,YAAT,IAAyBH,IAAI,CAACqH,GAAL,CAASH,QAAT,CAJ7B,CADI,EAMJlH,IAAI,CAACoH,GAAL,CAASH,UAAT,IAAuBjH,IAAI,CAACoH,GAAL,CAAShH,WAAT,CAAvB,GAA+CJ,IAAI,CAACoH,GAAL,CAASF,QAAT,CAN3C,EAOJlH,IAAI,CAACoH,GAAL,CAASH,UAAT,KACGjH,IAAI,CAACoH,GAAL,CAASjH,YAAT,IACCH,IAAI,CAACqH,GAAL,CAASjH,WAAT,CADD,GAECJ,IAAI,CAACoH,GAAL,CAASF,QAAT,CAFD,GAGClH,IAAI,CAACqH,GAAL,CAASH,QAAT,IAAqBlH,IAAI,CAACqH,GAAL,CAASlH,YAAT,CAJzB,CAPI,CAAR;AAAA,YAaEwH,CAAC,GAAG,CACF,CAAC3H,IAAI,CAACoH,GAAL,CAASR,KAAT,CAAD,GAAmB5G,IAAI,CAACqH,GAAL,CAASR,GAAT,CADjB,EAEF7G,IAAI,CAACoH,GAAL,CAASR,KAAT,IAAkB5G,IAAI,CAACoH,GAAL,CAASP,GAAT,CAFhB,CAbN;AAiBA,YAAIe,QAAQ,GAAG5H,IAAI,CAAC6H,IAAL,CACb7H,IAAI,CAACC,GAAL,CACED,IAAI,CAACyH,GAAL,CACE,CAACvG,CAAC,CAAC,CAAD,CAAD,GAAOyG,CAAC,CAAC,CAAD,CAAR,GAAczG,CAAC,CAAC,CAAD,CAAD,GAAOyG,CAAC,CAAC,CAAD,CAAvB,KACG3H,IAAI,CAAC8H,IAAL,CAAU5G,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAtB,GAA4BA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAA9C,IACClB,IAAI,CAAC8H,IAAL,CAAUH,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAhC,CAFJ,CADF,EAIE,CAJF,CADF,EAOE,CAAC,CAPH,CADa,CAAf;AAWA,YAAIzG,CAAC,CAAC,CAAD,CAAD,GAAO,CAAX,EAAc0G,QAAQ,GAAG,IAAI5H,IAAI,CAAC4D,EAAT,GAAcgE,QAAzB;AACdZ,QAAAA,IAAI,IAAIY,QAAR;AACD,OA5D+C,CA4D9C;;;AAEF,UAAI,CAAC5N,EAAD,KAAQQ,SAAS,IAAI,UAAb,IAA2BA,SAAS,IAAI,SAAhD,CAAJ,EAAgE;AAC9D;AACA4B,QAAAA,CAAC,GAAGjC,eAAe,GAAG,CAAtB;AACA,YAAI4N,UAAU,GAAG;AACfvE,UAAAA,CAAC,EACC,mBAAmBpH,CAAC,GAAG,CAAvB,IAA4B,OAA5B,IAAuCA,CAAC,GAAG,CAA3C,IAAgD,OAAhD,GAA0DA,CAA1D,GAA8D,KAFjD;AAGf4L,UAAAA,CAAC,EACC,kBACC5L,CAAC,GAAG,CADL,IAEA,OAFA,IAGCA,CAAC,GAAG,CAHL,IAIA,MAJA,GAKAA,CALA,GAMA,qCAVa;AAWf6L,UAAAA,CAAC,EACC,mBACC7L,CAAC,GAAG,CADL,IAEA,OAFA,GAGAA,CAHA,GAIA,MAJA,IAKCA,CAAC,GAAG,CALL,IAMA,qBAlBa;AAmBf8L,UAAAA,CAAC,EACC,mBACC9L,CAAC,GAAG,CADL,IAEA,MAFA,GAGAA,CAHA,GAIA,OAJA,IAKCA,CAAC,GAAG,CALL,IAMA,oBA1Ba;AA2Bf+L,UAAAA,CAAC,EACC,kBACA/L,CADA,GAEA,OAFA,IAGCA,CAAC,GAAG,CAHL,IAIA,MAJA,IAKCA,CAAC,GAAG,CALL,IAMA,oDAlCa;AAmCfgM,UAAAA,CAAC,EACC,iBACAhM,CADA,GAEA,OAFA,IAGCA,CAAC,GAAG,CAHL,IAIA,OAJA,IAKCA,CAAC,GAAG,CALL,IAMA;AA1Ca,SAAjB;AA4CA2K,QAAAA,KAAK,GAAG,IAAI/G,IAAI,CAACqI,GAAL,CAASvB,IAAI,GAAG,CAAhB,CAAZ;AACA,YAAIwB,IAAI,GAAIvB,KAAK,GAAGtN,MAAM,CAAC+M,WAAhB,GAA+B,CAA/B,GAAmC,IAA9C;AACA,YAAI+B,SAAS,GACX,iBACAD,IADA,GAEA,eAFA,GAGAA,IAHA,GAIA,YAJA,GAKA1B,KALA,GAMA,eANA,GAOAC,GAPA,GAQA,OATF,CAjD8D,CA0DnD;;AAEX,YAAI2B,KAAK,GAAG/S,MAAM,CAACa,IAAP,CAAYyR,UAAZ,CAAZ;;AAEA,aAAK5S,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtB,cAAIsT,IAAI,GAAGrO,KAAK,CAACsO,aAAN,CAAoB,WAAWF,KAAK,CAACrT,CAAD,CAAhB,GAAsB,MAA1C,CAAX;AACA,cAAI,CAACsT,IAAL,EAAW,SAFW,CAED;;AAErBA,UAAAA,IAAI,CAAC9O,KAAL,CAAWgP,eAAX,GAA6BJ,SAAS,GAAGR,UAAU,CAACS,KAAK,CAACrT,CAAD,CAAN,CAAnD;AACAsT,UAAAA,IAAI,CAAC9O,KAAL,CAAW4O,SAAX,GAAuBA,SAAS,GAAGR,UAAU,CAACS,KAAK,CAACrT,CAAD,CAAN,CAA7C;AACD;;AAED;AACD;;AAED,UAAIqF,SAAS,IAAI,UAAjB,EAA6B;AAC3B;AACA,YAAIoO,IAAI,GACN,IACA5I,IAAI,CAAC6I,IAAL,CACE7I,IAAI,CAACqI,GAAL,CAASvB,IAAI,GAAG,GAAhB,KACG9M,EAAE,CAACwG,kBAAH,GAAwBxG,EAAE,CAACyG,mBAD9B,CADF,CAFF;AAMAsG,QAAAA,KAAK,GAAG,IAAI/G,IAAI,CAACqI,GAAL,CAASO,IAAI,GAAG,GAAhB,CAAZ,CAR2B,CAQO;;AAElC5O,QAAAA,EAAE,CAACqJ,SAAH,CAAatJ,OAAO,CAACuJ,GAArB,EAA0BuD,GAA1B;AACA7M,QAAAA,EAAE,CAACqJ,SAAH,CAAatJ,OAAO,CAACwJ,KAArB,EAA4BqD,KAA5B;AACA5M,QAAAA,EAAE,CAACqJ,SAAH,CAAatJ,OAAO,CAAC4J,GAArB,EAA0BqD,IAA1B;AACAhN,QAAAA,EAAE,CAACqJ,SAAH,CAAatJ,OAAO,CAACyJ,CAArB,EAAwBuD,KAAxB;;AAEA,YAAItM,OAAO,KAAK,IAAhB,EAAsB;AACpB;AACA,cAAID,SAAS,IAAI,iBAAjB,EAAoC;AAClCR,YAAAA,EAAE,CAACgK,WAAH,CAAehK,EAAE,CAACsG,UAAlB,EAA8BvG,OAAO,CAACiC,OAAtC;AACAhC,YAAAA,EAAE,CAACiK,UAAH,CACEjK,EAAE,CAACsG,UADL,EAEE,CAFF,EAGEtG,EAAE,CAACmK,GAHL,EAIEnK,EAAE,CAACmK,GAJL,EAKEnK,EAAE,CAACoK,aALL,EAME7J,KANF;AAQD;AACF,SA5B0B,CA4BzB;;;AAEFP,QAAAA,EAAE,CAAC8O,UAAH,CAAc9O,EAAE,CAAC+O,SAAjB,EAA4B,CAA5B,EAA+B,CAA/B;AACD,OA/BD,MA+BO;AACL;AACA,YAAIC,WAAW,GAAGC,SAAS,CACzBnC,IADyB,EAEzB9M,EAAE,CAACwG,kBAAH,GAAwBxG,EAAE,CAACyG,mBAFF,EAGzB,GAHyB,EAIzB,KAJyB,CAA3B,CAFK,CAOF;;AAEHyI,QAAAA,SAAS,CAACpC,IAAD,CAAT,CATK,CASY;;AAEjB,YAAIqC,MAAM,GAAGC,eAAe,EAA5B;AACAD,QAAAA,MAAM,GAAGE,YAAY,CAACF,MAAD,EAAS,CAACnC,IAAV,EAAgB,GAAhB,CAArB;AACAmC,QAAAA,MAAM,GAAGE,YAAY,CAACF,MAAD,EAAS,CAACvC,KAAV,EAAiB,GAAjB,CAArB;AACAuC,QAAAA,MAAM,GAAGE,YAAY,CAACF,MAAD,EAAStC,GAAT,EAAc,GAAd,CAArB;AACAsC,QAAAA,MAAM,GAAGG,WAAW,CAACH,MAAD,CAApB,CAfK,CAeyB;;AAE9BnP,QAAAA,EAAE,CAACuP,gBAAH,CACExP,OAAO,CAAC4L,YADV,EAEE,KAFF,EAGE,IAAI5C,YAAJ,CAAiByG,gBAAgB,CAACR,WAAD,CAAjC,CAHF;AAKAhP,QAAAA,EAAE,CAACuP,gBAAH,CACExP,OAAO,CAAC6L,WADV,EAEE,KAFF,EAGE,IAAI7C,YAAJ,CAAiByG,gBAAgB,CAACL,MAAD,CAAjC,CAHF,EAtBK,CA0BF;;AAEH,YAAIM,QAAQ,GAAGC,WAAW,CAACV,WAAD,EAAcG,MAAd,CAA1B;AACApP,QAAAA,OAAO,CAACmC,SAAR,CAAkByN,IAAlB,CAAuBC,gBAAvB;;AAEA,YACE7P,OAAO,CAACmC,SAAR,CAAkB9G,MAAlB,GAA2B,GAA3B,IACA2E,OAAO,CAACmC,SAAR,CAAkB9G,MAAlB,GAA2B2E,OAAO,CAAC+L,YAAR,CAAqB1Q,MAArB,GAA8B,EAF3D,EAGE;AACA;AACA,cAAIyU,OAAO,GAAG9P,OAAO,CAACmC,SAAR,CAAkB4N,MAAlB,CACZ,GADY,EAEZ/P,OAAO,CAACmC,SAAR,CAAkB9G,MAAlB,GAA2B,GAFf,CAAd;;AAKA,eAAK,IAAIwJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiL,OAAO,CAACzU,MAA5B,EAAoCwJ,CAAC,EAArC,EAAyC;AACvC;AACA5E,YAAAA,EAAE,CAACiC,aAAH,CAAiB4N,OAAO,CAACjL,CAAD,CAAP,CAAW5C,OAA5B;AACD;AACF;;AAEDjC,QAAAA,OAAO,CAAC+L,YAAR,GAAuB,EAAvB;AACA,YAAI5H,KAAK,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,CAAZ;;AAEA,aAAK9B,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtB,cAAI2N,IAAI,GAAG,IAAIC,YAAJ,CACT3P,KAAK,CAAC+B,CAAD,CADI,EAET8B,KAAK,CAAC9B,CAAD,CAFI,EAGT,CAHS,EAIT,CAJS,EAKT,CALS,EAMT7B,KAAK,CAACgF,QANG,CAAX;AAQA0K,UAAAA,gBAAgB,CAACR,QAAD,EAAWM,IAAX,EAAiBnD,KAAjB,EAAwBC,GAAxB,CAAhB;AACD;;AAED9M,QAAAA,OAAO,CAAC+L,YAAR,CAAqB6D,IAArB,CAA0BO,sBAA1B,EA9DK,CA8D8C;;AAEnD,aAAK/U,CAAC,GAAGgV,sBAAsB,CAAC/U,MAAvB,GAAgC,CAAzC,EAA4CD,CAAC,IAAI,CAAjD,EAAoDA,CAAC,EAArD,EAAyD;AACvD,cACE4E,OAAO,CAAC+L,YAAR,CAAqBlI,OAArB,CAA6BuM,sBAAsB,CAAChV,CAAD,CAAtB,CAA0BiV,IAAvD,MAAiE,CAAC,CADpE,EAEE;AACAD,YAAAA,sBAAsB,CAAChV,CAAD,CAAtB,CAA0BiV,IAA1B,CAA+BC,WAA/B,GAA6C,KAA7C;AACAF,YAAAA,sBAAsB,CAACL,MAAvB,CAA8B3U,CAA9B,EAAiC,CAAjC;AACD;AACF,SAvEI,CAuEH;;;AAEF,YAAIgV,sBAAsB,CAAC/U,MAAvB,KAAkC,CAAtC,EAAyC;AACvC,eAAKD,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG4E,OAAO,CAAC+L,YAAR,CAAqB1Q,MAArC,EAA6CD,CAAC,EAA9C,EAAkD;AAChD,gBAAIiV,IAAI,GAAGrQ,OAAO,CAAC+L,YAAR,CAAqB3Q,CAArB,CAAX;;AAEA,gBAAI,CAACiV,IAAI,CAACpO,OAAN,IAAiB,CAACoO,IAAI,CAACC,WAA3B,EAAwC;AACtCD,cAAAA,IAAI,CAACC,WAAL,GAAmB,IAAnB;AACAC,cAAAA,UAAU,CAACC,eAAD,EAAkB,CAAlB,EAAqBH,IAArB,CAAV,CAFsC,CAEA;;AAEtC;AACD;AACF;AACF,SApFI,CAoFH;;;AAEFI,QAAAA,YAAY;AACb;;AAED,UAAIjP,MAAM,CAACkP,WAAP,KAAuBnR,WAA3B,EAAwC;AACtC,eAAOG,MAAM,CAACiR,SAAP,CAAiB,WAAjB,CAAP;AACD;AACF,KAlQD;AAmQA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKC,SAAL,GAAiB,YAAY;AAC3B,UAAI3Q,EAAE,IAAIQ,SAAS,IAAI,UAAvB,EAAmC;AACjC,aAAK,IAAIrF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4E,OAAO,CAAC+L,YAAR,CAAqB1Q,MAAzC,EAAiDD,CAAC,EAAlD,EAAsD;AACpD,cAAI,CAAC4E,OAAO,CAAC+L,YAAR,CAAqB3Q,CAArB,EAAwByV,aAA7B,EAA4C;AAC1C,mBAAO,IAAP;AACD;AACF;AACF;;AAED,aAAO,KAAP;AACD,KAVD;AAWA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKC,SAAL,GAAiB,YAAY;AAC3B,aAAOpR,MAAP;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAASmQ,gBAAT,CAA0BkB,CAA1B,EAA6B9C,CAA7B,EAAgC;AAC9B;AACA,UAAI8C,CAAC,CAACjF,KAAF,IAAW,CAAX,IAAgBmC,CAAC,CAACnC,KAAF,IAAW,CAA/B,EAAkC;AAChC,eAAO,CAAC,CAAR;AACD;;AAED,UAAImC,CAAC,CAACnC,KAAF,IAAW,CAAX,IAAgBiF,CAAC,CAACjF,KAAF,IAAW,CAA/B,EAAkC;AAChC,eAAO,CAAP;AACD,OAR6B,CAQ5B;;;AAEF,aAAOmC,CAAC,CAAC+C,SAAF,GAAcD,CAAC,CAACC,SAAvB;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAASb,sBAAT,CAAgCY,CAAhC,EAAmC9C,CAAnC,EAAsC;AACpC;AACA,UAAI8C,CAAC,CAACjF,KAAF,IAAWmC,CAAC,CAACnC,KAAjB,EAAwB;AACtB,eAAOiF,CAAC,CAACjF,KAAF,GAAUmC,CAAC,CAACnC,KAAnB;AACD,OAJmC,CAIlC;;;AAEF,aAAOiF,CAAC,CAACE,IAAF,GAAShD,CAAC,CAACgD,IAAlB;AACD;AACD;AACJ;AACA;AACA;;;AAEI,aAASR,YAAT,GAAwB;AACtB,UAAI,CAACzQ,OAAO,CAACsI,cAAb,EAA6B;AAC3BtI,QAAAA,OAAO,CAACsI,cAAR,GAAyB,IAAzB;AACArI,QAAAA,EAAE,CAACwI,KAAH,CAASxI,EAAE,CAACyI,gBAAZ;;AAEA,aAAK,IAAItN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4E,OAAO,CAAC+L,YAAR,CAAqB1Q,MAAzC,EAAiDD,CAAC,EAAlD,EAAsD;AACpD,cAAI4E,OAAO,CAAC+L,YAAR,CAAqB3Q,CAArB,EAAwByV,aAAxB,GAAwC,CAA5C,EAA+C;AAC7C;AACA;AACA;AACA5Q,YAAAA,EAAE,CAAC6B,UAAH,CAAc7B,EAAE,CAAC8B,YAAjB,EAA+BnB,WAA/B;AACAX,YAAAA,EAAE,CAAC8I,UAAH,CACE9I,EAAE,CAAC8B,YADL,EAEE,IAAIiH,YAAJ,CAAiBhJ,OAAO,CAAC+L,YAAR,CAAqB3Q,CAArB,EAAwBuK,QAAzC,CAFF,EAGE1F,EAAE,CAACgJ,WAHL;AAKAhJ,YAAAA,EAAE,CAACiJ,mBAAH,CACElJ,OAAO,CAAC0L,eADV,EAEE,CAFF,EAGEzL,EAAE,CAACkJ,KAHL,EAIE,KAJF,EAKE,CALF,EAME,CANF,EAV6C,CAiB1C;;AAEHlJ,YAAAA,EAAE,CAAC6B,UAAH,CAAc7B,EAAE,CAAC8B,YAAjB,EAA+BlB,mBAA/B;AACAZ,YAAAA,EAAE,CAACiJ,mBAAH,CACElJ,OAAO,CAAC2I,gBADV,EAEE,CAFF,EAGE1I,EAAE,CAACkJ,KAHL,EAIE,KAJF,EAKE,CALF,EAME,CANF,EApB6C,CA2B1C;;AAEHlJ,YAAAA,EAAE,CAACgK,WAAH,CAAehK,EAAE,CAACsG,UAAlB,EAA8BvG,OAAO,CAAC+L,YAAR,CAAqB3Q,CAArB,EAAwB6G,OAAtD,EA7B6C,CA6BmB;;AAEhEhC,YAAAA,EAAE,CAACiR,YAAH,CAAgBjR,EAAE,CAAC+O,SAAnB,EAA8B,CAA9B,EAAiC/O,EAAE,CAACkR,cAApC,EAAoD,CAApD;AACD;AACF;;AAEDnR,QAAAA,OAAO,CAACsI,cAAR,GAAyB,KAAzB;AACD;AACF;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAAS2H,YAAT,CAAsBtK,QAAtB,EAAgCpB,IAAhC,EAAsCuH,KAAtC,EAA6CsB,CAA7C,EAAgDG,CAAhD,EAAmDvJ,IAAnD,EAAyD;AACvD,WAAK2B,QAAL,GAAgBA,QAAhB;AACA,WAAKpB,IAAL,GAAYA,IAAZ;AACA,WAAKuH,KAAL,GAAaA,KAAb;AACA,WAAKsB,CAAL,GAASA,CAAT;AACA,WAAKG,CAAL,GAASA,CAAT;AACA,WAAKvJ,IAAL,GAAYA,IAAI,CACbsB,OADS,CACD,IADC,EACKf,IADL,EAETe,OAFS,CAED,IAFC,EAEKwG,KAFL,EAGTxG,OAHS,CAGD,IAHC,EAGK8H,CAHL,EAIT9H,OAJS,CAID,IAJC,EAIKiI,CAJL,CAAZ;AAKD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAAS2C,gBAAT,CAA0BR,QAA1B,EAAoCW,IAApC,EAA0CxD,KAA1C,EAAiDC,GAAjD,EAAsDC,IAAtD,EAA4D;AAC1D,UAAIqE,iBAAiB,CAAC1B,QAAD,EAAWW,IAAI,CAAC1K,QAAhB,CAArB,EAAgD;AAC9C;AACA,YAAIwB,CAAC,GAAGkJ,IAAI,CAAC1K,QAAb;AACA,YAAIyH,CAAC,GAAGjG,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAf,GAAqBA,CAAC,CAAC,CAAD,CAA9B;AACA,YAAIoG,CAAC,GAAGpG,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAf,GAAqBA,CAAC,CAAC,EAAD,CAA9B;AACA,YAAIqG,CAAC,GAAGrG,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAf,GAAqBA,CAAC,CAAC,EAAD,CAA9B;AACA,YAAIkH,CAAC,GAAGpI,IAAI,CAAC8H,IAAL,CAAUX,CAAC,GAAGA,CAAJ,GAAQG,CAAC,GAAGA,CAAZ,GAAgBC,CAAC,GAAGA,CAA9B,CAAR;AACA,YAAIhE,KAAK,GAAGvD,IAAI,CAACwH,IAAL,CAAUD,CAAC,GAAGa,CAAd,CAAZ;AACA,YAAIgD,GAAG,GAAGpL,IAAI,CAAC0H,KAAL,CAAWJ,CAAX,EAAcH,CAAd,CAAV;AACA,YAAIkE,KAAK,GAAGD,GAAG,GAAGvE,GAAlB;AACAwE,QAAAA,KAAK,IACHA,KAAK,GAAGrL,IAAI,CAAC4D,EAAb,GAAkB,CAAC,CAAD,GAAK5D,IAAI,CAAC4D,EAA5B,GAAiCyH,KAAK,GAAG,CAACrL,IAAI,CAAC4D,EAAd,GAAmB,IAAI5D,IAAI,CAAC4D,EAA5B,GAAiC,CADpE;AAEAyH,QAAAA,KAAK,GAAGrL,IAAI,CAACsL,GAAL,CAASD,KAAT,CAAR;AACAjB,QAAAA,IAAI,CAACY,IAAL,GAAYhL,IAAI,CAAC6H,IAAL,CACV7H,IAAI,CAACqH,GAAL,CAAST,KAAT,IAAkB5G,IAAI,CAACqH,GAAL,CAAS9D,KAAT,CAAlB,GACEvD,IAAI,CAACoH,GAAL,CAASR,KAAT,IAAkB5G,IAAI,CAACoH,GAAL,CAAS7D,KAAT,CAAlB,GAAoCvD,IAAI,CAACoH,GAAL,CAASiE,KAAT,CAF5B,CAAZ,CAb8C,CAgB3C;;AAEH,YAAIE,SAAS,GAAG,KAAhB;;AAEA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGzR,OAAO,CAACmC,SAAR,CAAkB9G,MAAtC,EAA8CoW,CAAC,EAA/C,EAAmD;AACjD,cAAIzR,OAAO,CAACmC,SAAR,CAAkBsP,CAAlB,EAAqBzN,IAArB,IAA6BqM,IAAI,CAACrM,IAAtC,EAA4C;AAC1CwN,YAAAA,SAAS,GAAG,IAAZ;AACAxR,YAAAA,OAAO,CAACmC,SAAR,CAAkBsP,CAAlB,EAAqBT,SAArB,GAAiChR,OAAO,CAACgM,kBAAR,EAAjC;AACAhM,YAAAA,OAAO,CAACmC,SAAR,CAAkBsP,CAAlB,EAAqBR,IAArB,GAA4BZ,IAAI,CAACY,IAAjC;AACAjR,YAAAA,OAAO,CAAC+L,YAAR,CAAqBlP,IAArB,CAA0BmD,OAAO,CAACmC,SAAR,CAAkBsP,CAAlB,CAA1B;AACA;AACD;AACF;;AAED,YAAI,CAACD,SAAL,EAAgB;AACd;AACAnB,UAAAA,IAAI,CAACW,SAAL,GAAiBhR,OAAO,CAACgM,kBAAR,EAAjB;AACAhM,UAAAA,OAAO,CAAC+L,YAAR,CAAqBlP,IAArB,CAA0BwT,IAA1B;AACArQ,UAAAA,OAAO,CAACmC,SAAR,CAAkBtF,IAAlB,CAAuBwT,IAAvB;AACD,SAnC6C,CAmC5C;AACF;;;AAEA,YAAIA,IAAI,CAACvE,KAAL,GAAa9L,OAAO,CAAC8L,KAAzB,EAAgC;AAC9B,cAAI4F,QAAQ,GACVlR,KAAK,CAACmR,cAAN,GAAuB1L,IAAI,CAAC2L,GAAL,CAAS,CAAT,EAAYvB,IAAI,CAACvE,KAAL,GAAatL,KAAK,CAACqR,QAA/B,CADzB;AAEA,cAAIC,QAAQ,GAAG7L,IAAI,CAAC8L,IAAL,CAAUL,QAAQ,GAAGlR,KAAK,CAACiF,iBAA3B,IAAgD,CAA/D;AACA,cAAIuM,cAAc,GAAIN,QAAQ,GAAGlR,KAAK,CAACkF,cAAlB,GAAoC,CAAzD;AACA,cAAIuM,YAAY,GAAIP,QAAQ,GAAG,CAAZ,GAAiBlR,KAAK,CAACkF,cAA1C;;AAEA,cAAIuM,YAAY,KAAK,CAArB,EAAwB;AACtBA,YAAAA,YAAY,GAAGzR,KAAK,CAACkF,cAArB;AACD;;AAED,cAAIsM,cAAc,KAAK,CAAvB,EAA0B;AACxBA,YAAAA,cAAc,GAAGxR,KAAK,CAACkF,cAAN,GAAuB,CAAxC;AACD;;AAED,cAAI+D,CAAC,GAAG,GAAR;;AAEA,cAAI4G,IAAI,CAACjD,CAAL,IAAU0E,QAAV,IAAsBzB,IAAI,CAAC9C,CAAL,IAAUuE,QAApC,EAA8C;AAC5CrI,YAAAA,CAAC,GACC,MACAjJ,KAAK,CAACkF,cAAN,IAAwBlF,KAAK,CAACkF,cAAN,GAAuBuM,YAA/C,CAFF;AAGD;;AAED,cAAI7W,CAAC,GAAG,MAAMqO,CAAd;AACA,cAAIyI,QAAQ,GAAG,EAAf;AACA,cAAIC,IAAJ,EAAUnC,IAAV;AACA,cAAIoC,EAAE,GAAG3I,CAAT;AAAA,cACE4I,EAAE,GAAG5I,CADP;AAAA,cAEE6I,EAAE,GAAG7I,CAFP;AAAA,cAGE8I,EAAE,GAAGnX,CAHP;AAAA,cAIEoX,EAAE,GAAGpX,CAJP;AAAA,cAKEqX,EAAE,GAAGrX,CALP,CA1B8B,CA+BpB;;AAEV,cAAI6W,YAAY,GAAGzR,KAAK,CAACkF,cAAzB,EAAyC;AACvC,gBAAI2K,IAAI,CAACjD,CAAL,IAAU0E,QAAV,IAAsBzB,IAAI,CAAC9C,CAAL,IAAUuE,QAApC,EAA8C;AAC5CO,cAAAA,EAAE,GAAG,GAAL;AACAG,cAAAA,EAAE,GAAG,GAAL;;AAEA,kBAAInC,IAAI,CAAC9L,IAAL,IAAa,GAAb,IAAoB8L,IAAI,CAAC9L,IAAL,IAAa,GAArC,EAA0C;AACxC+N,gBAAAA,EAAE,GAAG,GAAL;AACAG,gBAAAA,EAAE,GAAG,GAAL;AACD;AACF,aARD,MAQO,IAAIpC,IAAI,CAACjD,CAAL,IAAU0E,QAAV,IAAsBzB,IAAI,CAAC9C,CAAL,IAAUuE,QAApC,EAA8C;AACnDM,cAAAA,EAAE,GAAG,GAAL;AACAG,cAAAA,EAAE,GAAG,GAAL;;AAEA,kBAAIlC,IAAI,CAAC9L,IAAL,IAAa,GAAb,IAAoB8L,IAAI,CAAC9L,IAAL,IAAa,GAArC,EAA0C;AACxC+N,gBAAAA,EAAE,GAAG,GAAL;AACAG,gBAAAA,EAAE,GAAG,GAAL;AACD;AACF;AACF,WAnD6B,CAmD5B;;;AAEF,cAAIT,cAAc,IAAIxR,KAAK,CAACkF,cAA5B,EAA4C;AAC1C,gBAAI2K,IAAI,CAACjD,CAAL,IAAU0E,QAAd,EAAwB;AACtBM,cAAAA,EAAE,GAAG,CAAL;AACAG,cAAAA,EAAE,GAAG,CAAL;;AAEA,kBAAIlC,IAAI,CAAC9L,IAAL,IAAa,GAAb,IAAoB8L,IAAI,CAAC9L,IAAL,IAAa,GAArC,EAA0C;AACxC+N,gBAAAA,EAAE,GAAG,CAAL;AACAG,gBAAAA,EAAE,GAAG,CAAL;AACD;AACF;;AAED,gBAAIpC,IAAI,CAAC9C,CAAL,IAAUuE,QAAd,EAAwB;AACtBO,cAAAA,EAAE,GAAG,CAAL;AACAG,cAAAA,EAAE,GAAG,CAAL;;AAEA,kBAAInC,IAAI,CAAC9L,IAAL,IAAa,GAAb,IAAoB8L,IAAI,CAAC9L,IAAL,IAAa,GAArC,EAA0C;AACxC+N,gBAAAA,EAAE,GAAG,CAAL;AACAG,gBAAAA,EAAE,GAAG,CAAL;AACD;AACF;AACF;;AAEDN,UAAAA,IAAI,GAAG,CACLhL,CAAC,CAAC,CAAD,CADI,EAELA,CAAC,CAAC,CAAD,CAFI,EAGLA,CAAC,CAAC,CAAD,CAHI,EAILA,CAAC,CAAC,CAAD,CAAD,GAAOiL,EAAP,GAAYjL,CAAC,CAAC,CAAD,CAAD,GAAOoL,EAJd,EAKLpL,CAAC,CAAC,CAAD,CAAD,GAAOsC,CAAP,GAAWtC,CAAC,CAAC,CAAD,CAAD,GAAO/L,CALb,EAML+L,CAAC,CAAC,CAAD,CAAD,GAAOmL,EAAP,GAAYnL,CAAC,CAAC,CAAD,CAAD,GAAOsL,EANd,EAOLtL,CAAC,CAAC,CAAD,CAAD,GAAOiL,EAAP,GAAYjL,CAAC,CAAC,CAAD,CAAD,GAAOoL,EAPd,EAQLpL,CAAC,CAAC,CAAD,CAAD,GAAOkL,EAAP,GAAYlL,CAAC,CAAC,CAAD,CAAD,GAAOqL,EARd,EASLrL,CAAC,CAAC,CAAD,CAAD,GAAOmL,EAAP,GAAYnL,CAAC,CAAC,CAAD,CAAD,GAAOsL,EATd,EAULtL,CAAC,CAAC,CAAD,CAAD,GAAOsC,CAAP,GAAWtC,CAAC,CAAC,CAAD,CAAD,GAAO/L,CAVb,EAWL+L,CAAC,CAAC,CAAD,CAAD,GAAOkL,EAAP,GAAYlL,CAAC,CAAC,EAAD,CAAD,GAAQqL,EAXf,EAYLrL,CAAC,CAAC,CAAD,CAAD,GAAOmL,EAAP,GAAYnL,CAAC,CAAC,EAAD,CAAD,GAAQsL,EAZf,CAAP;AAcAzC,UAAAA,IAAI,GAAG,IAAIC,YAAJ,CACLkC,IADK,EAEL9B,IAAI,CAAC9L,IAFA,EAGL8L,IAAI,CAACvE,KAAL,GAAa,CAHR,EAILuE,IAAI,CAACjD,CAAL,GAAS,CAJJ,EAKLiD,IAAI,CAAC9C,CAAL,GAAS,CALJ,EAML/M,KAAK,CAACgF,QAND,CAAP;AAQA0M,UAAAA,QAAQ,CAACrV,IAAT,CAAcmT,IAAd;;AAEA,cAAI,EAAEK,IAAI,CAACjD,CAAL,IAAU0E,QAAV,IAAsBE,cAAc,IAAIxR,KAAK,CAACkF,cAAhD,CAAJ,EAAqE;AACnEyM,YAAAA,IAAI,GAAG,CACLhL,CAAC,CAAC,CAAD,CAAD,GAAOiL,EAAP,GAAYjL,CAAC,CAAC,CAAD,CAAD,GAAOoL,EADd,EAELpL,CAAC,CAAC,CAAD,CAAD,GAAOsC,CAAP,GAAWtC,CAAC,CAAC,CAAD,CAAD,GAAO/L,CAFb,EAGL+L,CAAC,CAAC,CAAD,CAAD,GAAOmL,EAAP,GAAYnL,CAAC,CAAC,CAAD,CAAD,GAAOsL,EAHd,EAILtL,CAAC,CAAC,CAAD,CAJI,EAKLA,CAAC,CAAC,CAAD,CALI,EAMLA,CAAC,CAAC,CAAD,CANI,EAOLA,CAAC,CAAC,CAAD,CAAD,GAAOsC,CAAP,GAAWtC,CAAC,CAAC,CAAD,CAAD,GAAO/L,CAPb,EAQL+L,CAAC,CAAC,CAAD,CAAD,GAAOkL,EAAP,GAAYlL,CAAC,CAAC,CAAD,CAAD,GAAOqL,EARd,EASLrL,CAAC,CAAC,CAAD,CAAD,GAAOmL,EAAP,GAAYnL,CAAC,CAAC,CAAD,CAAD,GAAOsL,EATd,EAULtL,CAAC,CAAC,CAAD,CAAD,GAAOiL,EAAP,GAAYjL,CAAC,CAAC,CAAD,CAAD,GAAOoL,EAVd,EAWLpL,CAAC,CAAC,CAAD,CAAD,GAAOkL,EAAP,GAAYlL,CAAC,CAAC,CAAD,CAAD,GAAOqL,EAXd,EAYLrL,CAAC,CAAC,CAAD,CAAD,GAAOmL,EAAP,GAAYnL,CAAC,CAAC,CAAD,CAAD,GAAOsL,EAZd,CAAP;AAcAzC,YAAAA,IAAI,GAAG,IAAIC,YAAJ,CACLkC,IADK,EAEL9B,IAAI,CAAC9L,IAFA,EAGL8L,IAAI,CAACvE,KAAL,GAAa,CAHR,EAILuE,IAAI,CAACjD,CAAL,GAAS,CAAT,GAAa,CAJR,EAKLiD,IAAI,CAAC9C,CAAL,GAAS,CALJ,EAML/M,KAAK,CAACgF,QAND,CAAP;AAQA0M,YAAAA,QAAQ,CAACrV,IAAT,CAAcmT,IAAd;AACD;;AAED,cACE,EAAEK,IAAI,CAACjD,CAAL,IAAU0E,QAAV,IAAsBE,cAAc,IAAIxR,KAAK,CAACkF,cAAhD,KACA,EAAE2K,IAAI,CAAC9C,CAAL,IAAUuE,QAAV,IAAsBE,cAAc,IAAIxR,KAAK,CAACkF,cAAhD,CAFF,EAGE;AACAyM,YAAAA,IAAI,GAAG,CACLhL,CAAC,CAAC,CAAD,CAAD,GAAOiL,EAAP,GAAYjL,CAAC,CAAC,CAAD,CAAD,GAAOoL,EADd,EAELpL,CAAC,CAAC,CAAD,CAAD,GAAOkL,EAAP,GAAYlL,CAAC,CAAC,CAAD,CAAD,GAAOqL,EAFd,EAGLrL,CAAC,CAAC,CAAD,CAAD,GAAOmL,EAAP,GAAYnL,CAAC,CAAC,CAAD,CAAD,GAAOsL,EAHd,EAILtL,CAAC,CAAC,CAAD,CAAD,GAAOsC,CAAP,GAAWtC,CAAC,CAAC,CAAD,CAAD,GAAO/L,CAJb,EAKL+L,CAAC,CAAC,CAAD,CAAD,GAAOkL,EAAP,GAAYlL,CAAC,CAAC,CAAD,CAAD,GAAOqL,EALd,EAMLrL,CAAC,CAAC,CAAD,CAAD,GAAOmL,EAAP,GAAYnL,CAAC,CAAC,CAAD,CAAD,GAAOsL,EANd,EAOLtL,CAAC,CAAC,CAAD,CAPI,EAQLA,CAAC,CAAC,CAAD,CARI,EASLA,CAAC,CAAC,CAAD,CATI,EAULA,CAAC,CAAC,CAAD,CAAD,GAAOiL,EAAP,GAAYjL,CAAC,CAAC,CAAD,CAAD,GAAOoL,EAVd,EAWLpL,CAAC,CAAC,EAAD,CAAD,GAAQsC,CAAR,GAAYtC,CAAC,CAAC,CAAD,CAAD,GAAO/L,CAXd,EAYL+L,CAAC,CAAC,EAAD,CAAD,GAAQmL,EAAR,GAAanL,CAAC,CAAC,CAAD,CAAD,GAAOsL,EAZf,CAAP;AAcAzC,YAAAA,IAAI,GAAG,IAAIC,YAAJ,CACLkC,IADK,EAEL9B,IAAI,CAAC9L,IAFA,EAGL8L,IAAI,CAACvE,KAAL,GAAa,CAHR,EAILuE,IAAI,CAACjD,CAAL,GAAS,CAAT,GAAa,CAJR,EAKLiD,IAAI,CAAC9C,CAAL,GAAS,CAAT,GAAa,CALR,EAML/M,KAAK,CAACgF,QAND,CAAP;AAQA0M,YAAAA,QAAQ,CAACrV,IAAT,CAAcmT,IAAd;AACD;;AAED,cAAI,EAAEK,IAAI,CAAC9C,CAAL,IAAUuE,QAAV,IAAsBE,cAAc,IAAIxR,KAAK,CAACkF,cAAhD,CAAJ,EAAqE;AACnEyM,YAAAA,IAAI,GAAG,CACLhL,CAAC,CAAC,CAAD,CAAD,GAAOsC,CAAP,GAAWtC,CAAC,CAAC,CAAD,CAAD,GAAO/L,CADb,EAEL+L,CAAC,CAAC,CAAD,CAAD,GAAOkL,EAAP,GAAYlL,CAAC,CAAC,EAAD,CAAD,GAAQqL,EAFf,EAGLrL,CAAC,CAAC,CAAD,CAAD,GAAOmL,EAAP,GAAYnL,CAAC,CAAC,EAAD,CAAD,GAAQsL,EAHf,EAILtL,CAAC,CAAC,CAAD,CAAD,GAAOiL,EAAP,GAAYjL,CAAC,CAAC,CAAD,CAAD,GAAOoL,EAJd,EAKLpL,CAAC,CAAC,CAAD,CAAD,GAAOkL,EAAP,GAAYlL,CAAC,CAAC,CAAD,CAAD,GAAOqL,EALd,EAMLrL,CAAC,CAAC,CAAD,CAAD,GAAOmL,EAAP,GAAYnL,CAAC,CAAC,CAAD,CAAD,GAAOsL,EANd,EAOLtL,CAAC,CAAC,CAAD,CAAD,GAAOiL,EAAP,GAAYjL,CAAC,CAAC,CAAD,CAAD,GAAOoL,EAPd,EAQLpL,CAAC,CAAC,EAAD,CAAD,GAAQsC,CAAR,GAAYtC,CAAC,CAAC,CAAD,CAAD,GAAO/L,CARd,EASL+L,CAAC,CAAC,EAAD,CAAD,GAAQmL,EAAR,GAAanL,CAAC,CAAC,CAAD,CAAD,GAAOsL,EATf,EAULtL,CAAC,CAAC,CAAD,CAVI,EAWLA,CAAC,CAAC,EAAD,CAXI,EAYLA,CAAC,CAAC,EAAD,CAZI,CAAP;AAcA6I,YAAAA,IAAI,GAAG,IAAIC,YAAJ,CACLkC,IADK,EAEL9B,IAAI,CAAC9L,IAFA,EAGL8L,IAAI,CAACvE,KAAL,GAAa,CAHR,EAILuE,IAAI,CAACjD,CAAL,GAAS,CAJJ,EAKLiD,IAAI,CAAC9C,CAAL,GAAS,CAAT,GAAa,CALR,EAML/M,KAAK,CAACgF,QAND,CAAP;AAQA0M,YAAAA,QAAQ,CAACrV,IAAT,CAAcmT,IAAd;AACD;;AAED,eAAK,IAAInL,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGqN,QAAQ,CAAC7W,MAA7B,EAAqCwJ,CAAC,EAAtC,EAA0C;AACxCqL,YAAAA,gBAAgB,CAACR,QAAD,EAAWwC,QAAQ,CAACrN,CAAD,CAAnB,EAAwBgI,KAAxB,EAA+BC,GAA/B,CAAhB;AACD;AACF;AACF;AACF;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASlH,UAAT,GAAsB;AACpB,aAAO,CACL,CAAC,CADI,EAEL,CAFK,EAGL,CAAC,CAHI,EAIL,CAJK,EAKL,CALK,EAML,CAAC,CANI,EAOL,CAPK,EAQL,CAAC,CARI,EASL,CAAC,CATI,EAUL,CAAC,CAVI,EAWL,CAAC,CAXI,EAYL,CAAC,CAZI,EAYD;AACJ,OAbK,EAcL,CAdK,EAeL,CAfK,EAgBL,CAAC,CAhBI,EAiBL,CAjBK,EAkBL,CAlBK,EAmBL,CAAC,CAnBI,EAoBL,CAAC,CApBI,EAqBL,CArBK,EAsBL,CAtBK,EAuBL,CAAC,CAvBI,EAwBL,CAxBK,EAwBF;AACH,OAAC,CAzBI,EA0BL,CA1BK,EA2BL,CA3BK,EA4BL,CA5BK,EA6BL,CA7BK,EA8BL,CA9BK,EA+BL,CA/BK,EAgCL,CAhCK,EAiCL,CAAC,CAjCI,EAkCL,CAAC,CAlCI,EAmCL,CAnCK,EAoCL,CAAC,CApCI,EAoCD;AACJ,OAAC,CArCI,EAsCL,CAAC,CAtCI,EAuCL,CAAC,CAvCI,EAwCL,CAxCK,EAyCL,CAAC,CAzCI,EA0CL,CAAC,CA1CI,EA2CL,CA3CK,EA4CL,CAAC,CA5CI,EA6CL,CA7CK,EA8CL,CAAC,CA9CI,EA+CL,CAAC,CA/CI,EAgDL,CAhDK,EAgDF;AACH,OAAC,CAjDI,EAkDL,CAlDK,EAmDL,CAnDK,EAoDL,CAAC,CApDI,EAqDL,CArDK,EAsDL,CAAC,CAtDI,EAuDL,CAAC,CAvDI,EAwDL,CAAC,CAxDI,EAyDL,CAAC,CAzDI,EA0DL,CAAC,CA1DI,EA2DL,CAAC,CA3DI,EA4DL,CA5DK,EA4DF;AACH,OA7DK,EA8DL,CA9DK,EA+DL,CAAC,CA/DI,EAgEL,CAhEK,EAiEL,CAjEK,EAkEL,CAlEK,EAmEL,CAnEK,EAoEL,CAAC,CApEI,EAqEL,CArEK,EAsEL,CAtEK,EAuEL,CAAC,CAvEI,EAwEL,CAAC,CAxEI,CAwED;AAxEC,OAAP;AA0ED;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASyJ,eAAT,GAA2B;AACzB,aAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAP;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAASC,YAAT,CAAsBoD,CAAtB,EAAyBC,KAAzB,EAAgCC,IAAhC,EAAsC;AACpC,UAAIvQ,CAAC,GAAG4D,IAAI,CAACqH,GAAL,CAASqF,KAAT,CAAR;AACA,UAAIE,CAAC,GAAG5M,IAAI,CAACoH,GAAL,CAASsF,KAAT,CAAR;;AAEA,UAAIC,IAAI,IAAI,GAAZ,EAAiB;AACf,eAAO,CACLF,CAAC,CAAC,CAAD,CADI,EAELG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CAFX,EAGLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CAHX,EAILA,CAAC,CAAC,CAAD,CAJI,EAKLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CALX,EAMLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CANX,EAOLA,CAAC,CAAC,CAAD,CAPI,EAQLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CARX,EASLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CATX,CAAP;AAWD;;AAED,UAAIE,IAAI,IAAI,GAAZ,EAAiB;AACf,eAAO,CACLC,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CADX,EAELA,CAAC,CAAC,CAAD,CAFI,EAGLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CAHX,EAILG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CAJX,EAKLA,CAAC,CAAC,CAAD,CALI,EAMLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CANX,EAOLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CAPX,EAQLA,CAAC,CAAC,CAAD,CARI,EASLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CATX,CAAP;AAWD;;AAED,UAAIE,IAAI,IAAI,GAAZ,EAAiB;AACf,eAAO,CACLC,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CADX,EAELG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CAFX,EAGLA,CAAC,CAAC,CAAD,CAHI,EAILG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CAJX,EAKLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CALX,EAMLA,CAAC,CAAC,CAAD,CANI,EAOLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CAPX,EAQLG,CAAC,GAAGH,CAAC,CAAC,CAAD,CAAL,GAAWrQ,CAAC,GAAGqQ,CAAC,CAAC,CAAD,CARX,EASLA,CAAC,CAAC,CAAD,CATI,CAAP;AAWD;AACF;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASnD,WAAT,CAAqBmD,CAArB,EAAwB;AACtB,aAAO,CACLA,CAAC,CAAC,CAAD,CADI,EAELA,CAAC,CAAC,CAAD,CAFI,EAGLA,CAAC,CAAC,CAAD,CAHI,EAIL,CAJK,EAKLA,CAAC,CAAC,CAAD,CALI,EAMLA,CAAC,CAAC,CAAD,CANI,EAOLA,CAAC,CAAC,CAAD,CAPI,EAQL,CARK,EASLA,CAAC,CAAC,CAAD,CATI,EAULA,CAAC,CAAC,CAAD,CAVI,EAWLA,CAAC,CAAC,CAAD,CAXI,EAYL,CAZK,EAaL,CAbK,EAcL,CAdK,EAeL,CAfK,EAgBL,CAhBK,CAAP;AAkBD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASjD,gBAAT,CAA0BiD,CAA1B,EAA6B;AAC3B,aAAO,CACLA,CAAC,CAAC,CAAD,CADI,EAELA,CAAC,CAAC,CAAD,CAFI,EAGLA,CAAC,CAAC,CAAD,CAHI,EAILA,CAAC,CAAC,EAAD,CAJI,EAKLA,CAAC,CAAC,CAAD,CALI,EAMLA,CAAC,CAAC,CAAD,CANI,EAOLA,CAAC,CAAC,CAAD,CAPI,EAQLA,CAAC,CAAC,EAAD,CARI,EASLA,CAAC,CAAC,CAAD,CATI,EAULA,CAAC,CAAC,CAAD,CAVI,EAWLA,CAAC,CAAC,EAAD,CAXI,EAYLA,CAAC,CAAC,EAAD,CAZI,EAaLA,CAAC,CAAC,CAAD,CAbI,EAcLA,CAAC,CAAC,CAAD,CAdI,EAeLA,CAAC,CAAC,EAAD,CAfI,EAgBLA,CAAC,CAAC,EAAD,CAhBI,CAAP;AAkBD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAASxD,SAAT,CAAmBnC,IAAnB,EAAyB+F,MAAzB,EAAiCC,KAAjC,EAAwCC,IAAxC,EAA8C;AAC5C,UAAIC,IAAI,GACN,IACAhN,IAAI,CAAC6I,IAAL,CACG7I,IAAI,CAACqI,GAAL,CAASvB,IAAI,GAAG,CAAhB,IAAqB9M,EAAE,CAACyG,mBAAzB,GAAgDzG,EAAE,CAACwG,kBADrD,CAFF;AAKA,UAAIgD,CAAC,GAAG,IAAIxD,IAAI,CAACqI,GAAL,CAAS2E,IAAI,GAAG,CAAhB,CAAZ;AACA,aAAO,CACLxJ,CAAC,GAAGqJ,MADC,EAEL,CAFK,EAGL,CAHK,EAIL,CAJK,EAKL,CALK,EAMLrJ,CANK,EAOL,CAPK,EAQL,CARK,EASL,CATK,EAUL,CAVK,EAWL,CAACuJ,IAAI,GAAGD,KAAR,KAAkBA,KAAK,GAAGC,IAA1B,CAXK,EAYJ,IAAIA,IAAJ,GAAWD,KAAZ,IAAsBA,KAAK,GAAGC,IAA9B,CAZK,EAaL,CAbK,EAcL,CAdK,EAeL,CAAC,CAfI,EAgBL,CAhBK,CAAP;AAkBD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASE,oBAAT,CAA8BC,GAA9B,EAAmCC,GAAnC,EAAwC;AACtCnT,MAAAA,EAAE,CAACgK,WAAH,CAAehK,EAAE,CAACsG,UAAlB,EAA8B6M,GAA9B;AACAnT,MAAAA,EAAE,CAACiK,UAAH,CAAcjK,EAAE,CAACsG,UAAjB,EAA6B,CAA7B,EAAgCtG,EAAE,CAACmK,GAAnC,EAAwCnK,EAAE,CAACmK,GAA3C,EAAgDnK,EAAE,CAACoK,aAAnD,EAAkE8I,GAAlE;AACAlT,MAAAA,EAAE,CAACiL,aAAH,CAAiBjL,EAAE,CAACsG,UAApB,EAAgCtG,EAAE,CAACuL,kBAAnC,EAAuDvL,EAAE,CAACsL,MAA1D;AACAtL,MAAAA,EAAE,CAACiL,aAAH,CAAiBjL,EAAE,CAACsG,UAApB,EAAgCtG,EAAE,CAACqL,kBAAnC,EAAuDrL,EAAE,CAACsL,MAA1D;AACAtL,MAAAA,EAAE,CAACiL,aAAH,CAAiBjL,EAAE,CAACsG,UAApB,EAAgCtG,EAAE,CAACkL,cAAnC,EAAmDlL,EAAE,CAACmL,aAAtD;AACAnL,MAAAA,EAAE,CAACiL,aAAH,CAAiBjL,EAAE,CAACsG,UAApB,EAAgCtG,EAAE,CAACoL,cAAnC,EAAmDpL,EAAE,CAACmL,aAAtD;AACAnL,MAAAA,EAAE,CAACgK,WAAH,CAAehK,EAAE,CAACsG,UAAlB,EAA8B,IAA9B;AACD;;AAED,QAAI6J,sBAAsB,GAAG,EAA7B,CA3kD2B,CA2kDM;;AAEjC,QAAIiD,WAAW,GAAI,YAAY;AAC7B,UAAIC,QAAQ,GAAG,CAAf,CAD6B,CACX;;AAElB,UAAIC,iBAAiB,GAAG,EAAxB;AACA,UAAIrO,WAAJ;;AAEA,eAASsO,kBAAT,GAA8B;AAC5B,YAAI9U,IAAI,GAAG,IAAX;AACA,aAAKuD,OAAL,GAAe,KAAKV,QAAL,GAAgB,IAA/B;AACA,aAAKf,KAAL,GAAa,IAAIyE,KAAJ,EAAb;AACA,aAAKzE,KAAL,CAAW0E,WAAX,GAAyBA,WAAW,GAAGA,WAAH,GAAiB,WAArD;;AAEA,YAAIuO,MAAM,GAAG,SAASA,MAAT,GAAkB;AAC7B,cAAI/U,IAAI,CAAC8B,KAAL,CAAWX,KAAX,GAAmB,CAAnB,IAAwBnB,IAAI,CAAC8B,KAAL,CAAWV,MAAX,GAAoB,CAAhD,EAAmD;AACjD;AACAoT,YAAAA,oBAAoB,CAACxU,IAAI,CAAC8B,KAAN,EAAa9B,IAAI,CAACuD,OAAlB,CAApB;AACAvD,YAAAA,IAAI,CAAC6C,QAAL,CAAc7C,IAAI,CAACuD,OAAnB,EAA4B,IAA5B;AACD,WAJD,MAIO;AACLvD,YAAAA,IAAI,CAAC6C,QAAL,CAAc7C,IAAI,CAACuD,OAAnB,EAA4B,KAA5B;AACD;;AAEDyR,UAAAA,yBAAyB,CAAChV,IAAD,CAAzB;AACD,SAVD;;AAYA,aAAK8B,KAAL,CAAWmT,gBAAX,CAA4B,MAA5B,EAAoCF,MAApC;AACA,aAAKjT,KAAL,CAAWmT,gBAAX,CAA4B,OAA5B,EAAqCF,MAArC,EAnB4B,CAmBkB;AAC/C;;AAEDD,MAAAA,kBAAkB,CAACxX,SAAnB,CAA6BqX,WAA7B,GAA2C,UACzChO,GADyC,EAEzCpD,OAFyC,EAGzCV,QAHyC,EAIzC;AACA,aAAKU,OAAL,GAAeA,OAAf;AACA,aAAKV,QAAL,GAAgBA,QAAhB;AACA,aAAKf,KAAL,CAAW6E,GAAX,GAAiBA,GAAjB;AACD,OARD;;AAUA,eAASuO,qBAAT,CAA+BvD,IAA/B,EAAqChL,GAArC,EAA0CpD,OAA1C,EAAmDV,QAAnD,EAA6D;AAC3D,aAAK8O,IAAL,GAAYA,IAAZ;AACA,aAAKhL,GAAL,GAAWA,GAAX;AACA,aAAKpD,OAAL,GAAeA,OAAf;AACA,aAAKV,QAAL,GAAgBA,QAAhB;AACD;;AAED,eAASmS,yBAAT,CAAmCG,GAAnC,EAAwC;AACtC,YAAIzD,sBAAsB,CAAC/U,MAA3B,EAAmC;AACjC,cAAIyY,GAAG,GAAG1D,sBAAsB,CAAC2D,KAAvB,EAAV;AACAF,UAAAA,GAAG,CAACR,WAAJ,CAAgBS,GAAG,CAACzO,GAApB,EAAyByO,GAAG,CAAC7R,OAA7B,EAAsC6R,GAAG,CAACvS,QAA1C;AACD,SAHD,MAGOgS,iBAAiB,CAACD,QAAQ,EAAT,CAAjB,GAAgCO,GAAhC;AACR;;AAED,WAAK,IAAIzY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGkY,QAApB,EAA8BlY,CAAC,EAA/B,EAAmC;AACjCmY,QAAAA,iBAAiB,CAACnY,CAAD,CAAjB,GAAuB,IAAIoY,kBAAJ,EAAvB;AACD;;AAED,aAAO,UAAUnD,IAAV,EAAgBhL,GAAhB,EAAqB9D,QAArB,EAA+ByS,YAA/B,EAA6C;AAClD9O,QAAAA,WAAW,GAAG8O,YAAd;AACA,YAAI/R,OAAO,GAAGhC,EAAE,CAAC+J,aAAH,EAAd;AACA,YAAIsJ,QAAJ,EACEC,iBAAiB,CAAC,EAAED,QAAH,CAAjB,CAA8BD,WAA9B,CAA0ChO,GAA1C,EAA+CpD,OAA/C,EAAwDV,QAAxD,EADF,KAGE6O,sBAAsB,CAACvT,IAAvB,CACE,IAAI+W,qBAAJ,CAA0BvD,IAA1B,EAAgChL,GAAhC,EAAqCpD,OAArC,EAA8CV,QAA9C,CADF;AAGF,eAAOU,OAAP;AACD,OAVD;AAWD,KAnEiB,EAAlB;AAoEA;AACJ;AACA;AACA;AACA;;;AAEI,aAASuO,eAAT,CAAyBH,IAAzB,EAA+B;AAC7BgD,MAAAA,WAAW,CACThD,IADS,EAETA,IAAI,CAACrM,IAAL,GAAY,GAAZ,GAAkBxD,KAAK,CAAC+E,SAFf,EAGT,UAAUtD,OAAV,EAAmBmC,MAAnB,EAA2B;AACzBiM,QAAAA,IAAI,CAACpO,OAAL,GAAeA,OAAf;AACAoO,QAAAA,IAAI,CAACQ,aAAL,GAAqBzM,MAAM,GAAG,CAAH,GAAO,CAAlC;AACD,OANQ,EAOTrD,YAAY,CAACmE,WAPJ,CAAX;AASD;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASiK,SAAT,CAAmBpC,IAAnB,EAAyB;AACvB;AACA,UAAIkH,QAAQ,GAAG,CAAf;;AAEA,aACEA,QAAQ,GAAGzT,KAAK,CAACqR,QAAjB,IACA5R,EAAE,CAACwG,kBAAH,GACEjG,KAAK,CAACkF,cAAN,GACEO,IAAI,CAAC2L,GAAL,CAAS,CAAT,EAAYqC,QAAQ,GAAG,CAAvB,CADF,GAEEhO,IAAI,CAACqI,GAAL,CAASvB,IAAI,GAAG,CAAhB,CAFF,GAGE,KANN,EAOE;AACAkH,QAAAA,QAAQ;AACT,OAbsB,CAarB;;;AAEFjU,MAAAA,OAAO,CAAC8L,KAAR,GAAgBmI,QAAhB;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAAStE,WAAT,CAAqB3R,CAArB,EAAwBqQ,CAAxB,EAA2B;AACzB,aAAO,CACLrQ,CAAC,CAAC,CAAD,CAAD,GAAOqQ,CAAC,CAAC,CAAD,CADH,EAELrQ,CAAC,CAAC,CAAD,CAAD,GAAOqQ,CAAC,CAAC,CAAD,CAFH,EAGLrQ,CAAC,CAAC,CAAD,CAAD,GAAOqQ,CAAC,CAAC,CAAD,CAHH,EAIL,CAJK,EAKLrQ,CAAC,CAAC,CAAD,CAAD,GAAOqQ,CAAC,CAAC,CAAD,CALH,EAMLrQ,CAAC,CAAC,CAAD,CAAD,GAAOqQ,CAAC,CAAC,CAAD,CANH,EAOLrQ,CAAC,CAAC,CAAD,CAAD,GAAOqQ,CAAC,CAAC,CAAD,CAPH,EAQL,CARK,EASLrQ,CAAC,CAAC,EAAD,CAAD,GAAQqQ,CAAC,CAAC,CAAD,CATJ,EAULrQ,CAAC,CAAC,EAAD,CAAD,GAAQqQ,CAAC,CAAC,CAAD,CAVJ,EAWLrQ,CAAC,CAAC,EAAD,CAAD,GAAQqQ,CAAC,CAAC,EAAD,CAXJ,EAYLrQ,CAAC,CAAC,EAAD,CAZI,EAaL,CAACqQ,CAAC,CAAC,CAAD,CAbG,EAcL,CAACA,CAAC,CAAC,CAAD,CAdG,EAeL,CAACA,CAAC,CAAC,EAAD,CAfG,EAgBL,CAhBK,CAAP;AAkBD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAAS6F,kBAAT,CAA4BxB,CAA5B,EAA+BvL,CAA/B,EAAkC;AAChC,aAAO,CACLuL,CAAC,CAAC,CAAD,CAAD,GAAOvL,CAAC,CAAC,CAAD,CAAR,GAAcuL,CAAC,CAAC,CAAD,CAAD,GAAOvL,CAAC,CAAC,CAAD,CAAtB,GAA4BuL,CAAC,CAAC,CAAD,CAAD,GAAOvL,CAAC,CAAC,CAAD,CAD/B,EAELuL,CAAC,CAAC,CAAD,CAAD,GAAOvL,CAAC,CAAC,CAAD,CAAR,GAAcuL,CAAC,CAAC,CAAD,CAAD,GAAOvL,CAAC,CAAC,CAAD,CAAtB,GAA4BuL,CAAC,CAAC,CAAD,CAAD,GAAOvL,CAAC,CAAC,CAAD,CAF/B,EAGLuL,CAAC,CAAC,EAAD,CAAD,GAAQA,CAAC,CAAC,CAAD,CAAD,GAAOvL,CAAC,CAAC,CAAD,CAAhB,GAAsBuL,CAAC,CAAC,CAAD,CAAD,GAAOvL,CAAC,CAAC,CAAD,CAA9B,GAAoCuL,CAAC,CAAC,EAAD,CAAD,GAAQvL,CAAC,CAAC,CAAD,CAHxC,EAIL,KAAKuL,CAAC,CAAC,EAAD,CAAD,GAAQvL,CAAC,CAAC,CAAD,CAAT,GAAeuL,CAAC,CAAC,EAAD,CAAD,GAAQvL,CAAC,CAAC,CAAD,CAAxB,GAA8BuL,CAAC,CAAC,EAAD,CAAD,GAAQvL,CAAC,CAAC,CAAD,CAA5C,CAJK,CAAP;AAMD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAASgN,WAAT,CAAqBzB,CAArB,EAAwBvL,CAAxB,EAA2B;AACzB,UAAIiN,GAAG,GAAGF,kBAAkB,CAACxB,CAAD,EAAIvL,CAAJ,CAA5B;AACA,UAAIkN,IAAI,GAAGD,GAAG,CAAC,CAAD,CAAH,GAASA,GAAG,CAAC,CAAD,CAAvB;AACA,UAAIE,IAAI,GAAGF,GAAG,CAAC,CAAD,CAAH,GAASA,GAAG,CAAC,CAAD,CAAvB;AACA,UAAIG,IAAI,GAAGH,GAAG,CAAC,CAAD,CAAH,GAASA,GAAG,CAAC,CAAD,CAAvB;AACA,UAAII,GAAG,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAV;AACA,UAAIH,IAAI,GAAG,CAAC,CAAZ,EAAeG,GAAG,CAAC,CAAD,CAAH,GAAS,CAAC,CAAV;AACf,UAAIH,IAAI,GAAG,CAAX,EAAcG,GAAG,CAAC,CAAD,CAAH,GAAS,CAAT;AACd,UAAIF,IAAI,GAAG,CAAC,CAAZ,EAAeE,GAAG,CAAC,CAAD,CAAH,GAAS,CAAC,CAAV;AACf,UAAIF,IAAI,GAAG,CAAX,EAAcE,GAAG,CAAC,CAAD,CAAH,GAAS,CAAT;AACd,UAAID,IAAI,GAAG,CAAC,CAAR,IAAaA,IAAI,GAAG,CAAxB,EAA2BC,GAAG,CAAC,CAAD,CAAH,GAAS,CAAT;AAC3B,aAAOA,GAAP;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAASpD,iBAAT,CAA2BsB,CAA3B,EAA8BvL,CAA9B,EAAiC;AAC/B,UAAIsN,MAAM,GAAGN,WAAW,CAACzB,CAAD,EAAIvL,CAAC,CAACtB,KAAF,CAAQ,CAAR,EAAW,CAAX,CAAJ,CAAxB;AACA,UAAI6O,MAAM,GAAGP,WAAW,CAACzB,CAAD,EAAIvL,CAAC,CAACtB,KAAF,CAAQ,CAAR,EAAW,CAAX,CAAJ,CAAxB;AACA,UAAI8O,MAAM,GAAGR,WAAW,CAACzB,CAAD,EAAIvL,CAAC,CAACtB,KAAF,CAAQ,CAAR,EAAW,CAAX,CAAJ,CAAxB;AACA,UAAI+O,MAAM,GAAGT,WAAW,CAACzB,CAAD,EAAIvL,CAAC,CAACtB,KAAF,CAAQ,CAAR,EAAW,EAAX,CAAJ,CAAxB;AACA,UAAIgP,KAAK,GAAGJ,MAAM,CAAC,CAAD,CAAN,GAAYC,MAAM,CAAC,CAAD,CAAlB,GAAwBC,MAAM,CAAC,CAAD,CAA9B,GAAoCC,MAAM,CAAC,CAAD,CAAtD;AACA,UAAIC,KAAK,IAAI,CAAC,CAAV,IAAeA,KAAK,IAAI,CAA5B,EAA+B,OAAO,KAAP;AAC/B,UAAIC,KAAK,GAAGL,MAAM,CAAC,CAAD,CAAN,GAAYC,MAAM,CAAC,CAAD,CAAlB,GAAwBC,MAAM,CAAC,CAAD,CAA9B,GAAoCC,MAAM,CAAC,CAAD,CAAtD;AACA,UAAIE,KAAK,IAAI,CAAC,CAAV,IAAeA,KAAK,IAAI,CAA5B,EAA+B,OAAO,KAAP;AAC/B,UAAIC,KAAK,GAAGN,MAAM,CAAC,CAAD,CAAN,GAAYC,MAAM,CAAC,CAAD,CAAlB,GAAwBC,MAAM,CAAC,CAAD,CAA9B,GAAoCC,MAAM,CAAC,CAAD,CAAtD;AACA,aAAOG,KAAK,IAAI,CAAhB;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAAStR,oBAAT,GAAgC;AAC9BhC,MAAAA,OAAO,CAACC,GAAR,CAAY,yCAAZ;AACAhC,MAAAA,MAAM,CAACG,KAAP,GAAeoG,IAAI,CAAC+O,KAAL,CAAWtV,MAAM,CAACG,KAAP,GAAe,CAA1B,CAAf;AACAH,MAAAA,MAAM,CAACI,MAAP,GAAgBmG,IAAI,CAAC+O,KAAL,CAAWtV,MAAM,CAACI,MAAP,GAAgB,CAA3B,CAAhB;AACD;AACF,GA/xD0D,CA+xDzD;;;AAEF,MAAIqH,CAAC,GAAG,CACN,4BADM,EAEN,0BAFM,EAGN,eAHM,EAGW;AACjB,6CAJM,EAIuC;AAC7C,4BALM,EAMN,GANM,EAON8N,IAPM,CAOD,EAPC,CAAR,CAjyD2D,CAwyD/C;;AAEZ,MAAI7N,MAAM,GAAG,CACX,6BADW,EAEX,4BAFW,EAGX,4BAHW,EAIX,6BAJW,EAKX,kCALW,EAMX,mBANW,EAMU;AACrB,wEAPW,EAO6D;AACxE,4BARW,EASX,GATW,EAUX6N,IAVW,CAUN,EAVM,CAAb,CA1yD2D,CAozD/C;;AAEZ,MAAIlO,gBAAgB,GAAG,CACrB,wBADqB,EACK;AAC1B,gCAFqB,EAGrB,sBAHqB,EAIrB,wBAJqB,EAKrB,oBALqB,EAMrB,oBANqB,EAOrB,oBAPqB,EAQrB,qBARqB,EASrB,sBATqB,EAUrB,6CAVqB,EAU0B;AAC/C,+BAXqB,EAYrB,6BAZqB,EAarB,4BAbqB,EAcrB,kCAdqB,EAce;AACpC,4BAfqB,EAeO;AAC5B,mCAhBqB,EAiBrB,eAjBqB,EAiBJ;AACjB,2CAlBqB,EAmBrB,yBAnBqB,EAoBrB,4BApBqB,EAqBrB,4BArBqB,EAsBrB,wCAtBqB,EAuBrB,wCAvBqB,EAwBrB,gCAxBqB,EAyBrB,gCAzBqB,EA0BrB,8CA1BqB,EA2BrB,2CA3BqB,EA4BrB,sDA5BqB,EA6BrB,+DA7BqB,EA8BrBkO,IA9BqB,CA8BhB,IA9BgB,CAAvB,CAtzD2D,CAo1D7C;;AAEd,MAAIvN,QAAQ,GACVX,gBAAgB,GAChB,CACE;AACA,4BAFF,EAGE,kGAHF,EAIE,GAJF,EAKEkO,IALF,CAKO,IALP,CAFF,CAt1D2D,CA61D3C;;AAEhB,MAAIzN,mBAAmB,GACrBT,gBAAgB,GAChB,CACE;AACA,6CAFF,EAE+C;AAC7C,qDAHF,EAGuD;AACrD;AACA,wFALF,EAME,mCANF,EAOE,QAPF,EAQE,oBARF,EAQwB;AACtB,qBATF,EAUE,yGAVF,EAWE,MAXF,EAYE,+GAZF,EAaE,UAbF,EAcE,iHAdF,EAeE,GAfF,EAgBE,GAhBF,EAiBE,GAjBF,EAkBEkO,IAlBF,CAkBO,IAlBP,CAFF,CA/1D2D,CAm3D3C;;AAEhB,MAAItN,SAAS,GAAG,CACd,kCADc,EAEd,8BAFc,EAEkB;AAChC,qBAHc,EAGO;AACrB,oDAJc,EAIsC;AACpD,KALc,EAMdsN,IANc,CAMT,EANS,CAAhB;AAOA,SAAO;AACLC,IAAAA,QAAQ,EAAE,SAASA,QAAT,CAAkBzV,SAAlB,EAA6Be,KAA7B,EAAoC2U,SAApC,EAA+CzU,OAA/C,EAAwD;AAChE,aAAO,IAAIlB,QAAJ,CAAaC,SAAb,EAAwBe,KAAxB,EAA+B2U,SAA/B,EAA0CzU,OAA1C,CAAP;AACD;AAHI,GAAP;AAKD,CAj4DkB,CAk4DjB,OAAOrB,MAAP,KAAkB,WAAlB,GAAgC,IAAhC,GAAuCA,MAl4DtB,EAm4DjB,OAAOC,QAAP,KAAoB,WAApB,GAAkC,IAAlC,GAAyCA,QAn4DxB,CAAnB;;AAs4DA,IAAI8V,SAAS,GAAI,UAAU/V,MAAV,EAAkBC,QAAlB,EAA4BC,WAA5B,EAAyC;AACxD,WAAS8V,MAAT,CAAgB5V,SAAhB,EAA2B6V,aAA3B,EAA0C;AACxC,QAAIC,KAAK,GAAG,IAAZ,CADwC,CACtB;;;AAElB,QAAIC,MAAJ;AAAA,QACEN,QADF;AAAA,QAEEO,UAFF;AAAA,QAGEC,QAHF;AAAA,QAIEC,SAJF;AAAA,QAKEC,OALF;AAAA,QAMEC,KAAK,GAAG,EANV;AAAA,QAOEC,kBAAkB,GAAG,GAPvB;AAAA,QAQEC,kBAAkB,GAAG,IARvB;AAAA,QASEC,oBAAoB,GAAG,GATzB;AAAA,QAUEC,WAAW,GAAG,IAVhB;AAAA,QAWEC,iBAAiB,GAAG,KAXtB;AAAA,QAYEC,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAZtB;AAAA,QAaEC,qBAAqB,GAAG,CAb1B;AAAA,QAcEC,qBAAqB,GAAG,CAd1B;AAAA,QAeEC,wBAAwB,GAAG,CAAC,CAf9B;AAAA,QAgBEC,gBAAgB,GAAG,CAhBrB;AAAA,QAiBEC,kBAAkB,GAAG,CAjBvB;AAAA,QAkBEC,QAAQ,GAAG,IAAIC,KAAJ,CAAU,EAAV,CAlBb;AAAA,QAmBEC,gBAAgB,GAAG,KAnBrB;AAAA,QAoBEzS,MApBF;AAAA,QAqBE0S,KAAK,GAAG,KArBV;AAAA,QAsBEC,cAAc,GAAG,KAtBnB;AAAA,QAuBEC,SAvBF;AAAA,QAwBEC,QAxBF;AAAA,QAyBEC,KAAK,GAAG;AACNpK,MAAAA,GAAG,EAAE,CADC;AAEND,MAAAA,KAAK,EAAE,CAFD;AAGNE,MAAAA,IAAI,EAAE;AAHA,KAzBV;AAAA,QA8BEoK,SAAS,GAAG,KA9Bd;AAAA,QA+BEC,WAAW,GAAG,KA/BhB;AAAA,QAgCEC,oBAAoB,GAAG,CAhCzB;AAAA,QAiCEC,eAjCF;AAAA,QAkCEC,eAAe,GAAG,CAlCpB;AAAA,QAmCEC,QAnCF;AAAA,QAoCEC,SApCF;AAAA,QAqCEC,YAAY,GAAG,EArCjB;AAAA,QAsCEC,sBAAsB,GAAG,EAtC3B;AAAA,QAuCEC,4BAA4B,GAAG,EAvCjC;AAAA,QAwCEC,MAAM,GAAG,KAxCX;AAAA,QAyCE;AACAC,IAAAA,GAAG,GAAG,IA1CR;AAAA,QA2CEC,eAAe,GAAG,KA3CpB;AAAA,QA4CEC,SAAS,GAAG,KA5Cd;AA6CA,QAAIC,aAAa,GAAG;AAClBlL,MAAAA,IAAI,EAAE,GADY;AAElBmL,MAAAA,OAAO,EAAE,EAFS;AAGlBC,MAAAA,eAAe,EAAE,KAHC;AAIlBC,MAAAA,OAAO,EAAE,GAJS;AAKlBvL,MAAAA,KAAK,EAAE,CALW;AAMlBwL,MAAAA,QAAQ,EAAE,CAAC,EANO;AAOlBC,MAAAA,QAAQ,EAAE,EAPQ;AAQlBxL,MAAAA,GAAG,EAAE,CARa;AASlByL,MAAAA,MAAM,EAAE,CAAC,GATS;AAUlBC,MAAAA,MAAM,EAAE,GAVU;AAWlBvL,MAAAA,IAAI,EAAE,CAXY;AAYlB7L,MAAAA,IAAI,EAAE,GAZY;AAalBC,MAAAA,IAAI,EAAE,GAbY;AAclBoX,MAAAA,OAAO,EAAE,CAdS;AAelBC,MAAAA,UAAU,EAAE,KAfM;AAgBlBC,MAAAA,yBAAyB,EAAE,CAAC,CAhBV;AAiBlBC,MAAAA,mBAAmB,EAAE,CAjBH;AAkBlBjX,MAAAA,IAAI,EAAE,iBAlBY;AAmBlBkX,MAAAA,WAAW,EAAE,CAnBK;AAoBlBC,MAAAA,kBAAkB,EAAE,IApBF;AAqBlBpY,MAAAA,OAAO,EAAE,KArBS;AAsBlBqY,MAAAA,aAAa,EAAE,KAtBG;AAuBlBC,MAAAA,eAAe,EAAE,IAvBC;AAwBlBC,MAAAA,YAAY,EAAE,IAxBI;AAyBlBC,MAAAA,SAAS,EAAE,IAzBO;AA0BlBC,MAAAA,YAAY,EAAE,IA1BI;AA2BlBC,MAAAA,QAAQ,EAAE,KA3BQ;AA4BlBC,MAAAA,YAAY,EAAE,IA5BI;AA6BlBC,MAAAA,sBAAsB,EAAE,KA7BN;AA8BlBC,MAAAA,YAAY,EAAE,KA9BI;AA+BlBzW,MAAAA,eAAe,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CA/BC;AAgClB0W,MAAAA,sBAAsB,EAAE,KAhCN;AAiClBC,MAAAA,uBAAuB,EAAEC,cAjCP;AAkClBC,MAAAA,SAAS,EAAE,IAlCO;AAmClBC,MAAAA,mBAAmB,EAAE,KAnCH;AAoClB1U,MAAAA,WAAW,EAAE,WApCK;AAqClB2U,MAAAA,wBAAwB,EAAE,CArCR;AAsClBC,MAAAA,kBAAkB,EAAE,CAClB,EADkB,EACd,EADc,EACV,EADU,EACN,EADM,EACF,EADE,EACE,EADF,EACM,EADN,EACU,EADV,EACc,EADd,EACkB,EADlB,EACsB,EADtB,EAC0B,EAD1B,EAC8B,GAD9B,EACmC,GADnC,EACwC,GADxC,EAC6C,GAD7C,EACkD,GADlD,CAtCF;AAyClBC,MAAAA,QAAQ,EAAE;AAzCQ,KAApB,CAhDwC,CA0FrC;AACH;AACA;;AAEA9B,IAAAA,aAAa,CAAC+B,MAAd,GAAuB;AACrB;AACAC,MAAAA,eAAe,EAAE,8BAFI;AAGrBC,MAAAA,YAAY,EAAE,YAHO;AAIrBC,MAAAA,WAAW,EAAE,OAJQ;AAKrB;AACA;AACAC,MAAAA,eAAe,EAAE,kCAPI;AAQrBC,MAAAA,eAAe,EAAE,oCARI;AASrB;AACAC,MAAAA,iBAAiB,EAAE,iDAVE;AAWrBC,MAAAA,cAAc,EACZ,sDACA,uDADA,GAEA,mCAdmB;AAerBC,MAAAA,iBAAiB,EACf,kFAhBmB;AAiBrBC,MAAAA,gBAAgB,EACd,oDACA,wDADA,GAEA,gCAFA,GAGA,sDArBmB;AAsBrB;AACAC,MAAAA,YAAY,EAAE;AAvBO,KAAvB,CA9FwC,CAsHrC;;AAEHjb,IAAAA,SAAS,GACP,OAAOA,SAAP,KAAqB,QAArB,GACIH,QAAQ,CAACqb,cAAT,CAAwBlb,SAAxB,CADJ,GAEIA,SAHN;AAIAA,IAAAA,SAAS,CAACmb,SAAV,CAAoBC,GAApB,CAAwB,gBAAxB;AACApb,IAAAA,SAAS,CAACqb,QAAV,GAAqB,CAArB,CA7HwC,CA6HhB;;AAExB,QAAIC,WAAW,GAAGzb,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAlB;AACAob,IAAAA,WAAW,CAAChX,SAAZ,GAAwB,SAAxB;AACAtE,IAAAA,SAAS,CAACM,WAAV,CAAsBgb,WAAtB,EAjIwC,CAiIJ;;AAEpC,QAAIC,eAAe,GAAG1b,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAtB;AACAqb,IAAAA,eAAe,CAACjX,SAAhB,GAA4B,uBAA5B;AACAtE,IAAAA,SAAS,CAACM,WAAV,CAAsBib,eAAtB;AACA,QAAIC,OAAO,GAAG3b,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAd;AACAsb,IAAAA,OAAO,CAAClX,SAAR,GAAoB,cAApB;AACAgX,IAAAA,WAAW,CAAChb,WAAZ,CAAwBkb,OAAxB,EAxIwC,CAwIN;;AAElC,QAAIC,QAAQ,GAAG5b,QAAQ,CAACK,aAAT,CAAuB,MAAvB,CAAf;AACAub,IAAAA,QAAQ,CAACnX,SAAT,GAAqB,gBAArB;AACAmX,IAAAA,QAAQ,CAACC,SAAT,GACE,gFADF;AAEAJ,IAAAA,WAAW,CAAChb,WAAZ,CAAwBmb,QAAxB;AACAD,IAAAA,OAAO,CAACtH,gBAAR,CAAyB,aAAzB,EAAwCyH,YAAxC,EA/IwC,CA+Ie;;AAEvD,QAAIC,WAAW,GAAG,EAAlB,CAjJwC,CAiJlB;;AAEtB,QAAIC,qBAAqB,GAAGhc,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAA5B;AACA2b,IAAAA,qBAAqB,CAACvX,SAAtB,GACE,2CADF;AAEAgX,IAAAA,WAAW,CAAChb,WAAZ,CAAwBub,qBAAxB,EAtJwC,CAsJQ;;AAEhDD,IAAAA,WAAW,CAAC5b,SAAZ,GAAwBH,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAxB;AACA0b,IAAAA,WAAW,CAAC5b,SAAZ,CAAsBsE,SAAtB,GAAkC,oBAAlC;AACAsX,IAAAA,WAAW,CAACE,KAAZ,GAAoBjc,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAApB;AACA0b,IAAAA,WAAW,CAACE,KAAZ,CAAkBxX,SAAlB,GAA8B,gBAA9B;AACAsX,IAAAA,WAAW,CAAC5b,SAAZ,CAAsBM,WAAtB,CAAkCsb,WAAW,CAACE,KAA9C;AACAF,IAAAA,WAAW,CAACG,WAAZ,GAA0Blc,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAA1B;AACA0b,IAAAA,WAAW,CAACG,WAAZ,CAAwBzX,SAAxB,GAAoC,sBAApC;AACAsX,IAAAA,WAAW,CAAC5b,SAAZ,CAAsBM,WAAtB,CAAkCsb,WAAW,CAACG,WAA9C;AACAH,IAAAA,WAAW,CAACI,MAAZ,GAAqBnc,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAArB;AACA0b,IAAAA,WAAW,CAACI,MAAZ,CAAmB1X,SAAnB,GAA+B,iBAA/B;AACAsX,IAAAA,WAAW,CAAC5b,SAAZ,CAAsBM,WAAtB,CAAkCsb,WAAW,CAACI,MAA9C;AACAV,IAAAA,WAAW,CAAChb,WAAZ,CAAwBsb,WAAW,CAAC5b,SAApC,EAnKwC,CAmKQ;;AAEhD4b,IAAAA,WAAW,CAACK,IAAZ,GAAmB,EAAnB;AACAL,IAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,GAAuBrc,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAvB;AACA0b,IAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,CAAqB5X,SAArB,GAAiC,eAAjC;AACAsX,IAAAA,WAAW,CAACK,IAAZ,CAAiBE,IAAjB,GAAwBtc,QAAQ,CAACK,aAAT,CAAuB,GAAvB,CAAxB;AACA0b,IAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,CAAqB5b,WAArB,CAAiCsb,WAAW,CAACK,IAAZ,CAAiBE,IAAlD;AACAP,IAAAA,WAAW,CAACK,IAAZ,CAAiBG,IAAjB,GAAwBvc,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAxB;AACA0b,IAAAA,WAAW,CAACK,IAAZ,CAAiBG,IAAjB,CAAsB9X,SAAtB,GAAkC,WAAlC;AACAsX,IAAAA,WAAW,CAACK,IAAZ,CAAiBG,IAAjB,CAAsBV,SAAtB,GAAkC,kCAAlC;AACAE,IAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,CAAqB5b,WAArB,CAAiCsb,WAAW,CAACK,IAAZ,CAAiBG,IAAlD;AACAR,IAAAA,WAAW,CAACK,IAAZ,CAAiBI,IAAjB,GAAwBxc,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAxB;AACA0b,IAAAA,WAAW,CAACK,IAAZ,CAAiBI,IAAjB,CAAsB/X,SAAtB,GAAkC,WAAlC;AACAsX,IAAAA,WAAW,CAACK,IAAZ,CAAiBK,QAAjB,GAA4Bzc,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAA5B;AACA0b,IAAAA,WAAW,CAACK,IAAZ,CAAiBK,QAAjB,CAA0BhY,SAA1B,GAAsC,gBAAtC;AACAsX,IAAAA,WAAW,CAACK,IAAZ,CAAiBI,IAAjB,CAAsB/b,WAAtB,CAAkCsb,WAAW,CAACK,IAAZ,CAAiBK,QAAnD;AACAV,IAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,CAAqB5b,WAArB,CAAiCsb,WAAW,CAACK,IAAZ,CAAiBI,IAAlD;AACAT,IAAAA,WAAW,CAACK,IAAZ,CAAiBM,GAAjB,GAAuB1c,QAAQ,CAACK,aAAT,CAAuB,GAAvB,CAAvB;AACA0b,IAAAA,WAAW,CAACK,IAAZ,CAAiBM,GAAjB,CAAqBjY,SAArB,GAAiC,WAAjC;AACAsX,IAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,CAAqB5b,WAArB,CAAiCsb,WAAW,CAACK,IAAZ,CAAiBM,GAAlD;AACAjB,IAAAA,WAAW,CAAChb,WAAZ,CAAwBsb,WAAW,CAACK,IAAZ,CAAiBC,GAAzC,EAvLwC,CAuLO;;AAE/CN,IAAAA,WAAW,CAACY,QAAZ,GAAuB3c,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAvB;AACA0b,IAAAA,WAAW,CAACY,QAAZ,CAAqBlY,SAArB,GAAiC,8BAAjC;AACAgX,IAAAA,WAAW,CAAChb,WAAZ,CAAwBsb,WAAW,CAACY,QAApC,EA3LwC,CA2LO;;AAE/C,QAAIC,QAAQ,GAAG,EAAf;AACAA,IAAAA,QAAQ,CAACzc,SAAT,GAAqBH,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAArB;AACAuc,IAAAA,QAAQ,CAACzc,SAAT,CAAmBsE,SAAnB,GAA+B,yBAA/B;AACAgX,IAAAA,WAAW,CAAChb,WAAZ,CAAwBmc,QAAQ,CAACzc,SAAjC,EAhMwC,CAgMK;;AAE7Cyc,IAAAA,QAAQ,CAACR,IAAT,GAAgBpc,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAhB;AACAuc,IAAAA,QAAQ,CAACR,IAAT,CAAc3X,SAAd,GAA0B,kBAA1B;AACAmY,IAAAA,QAAQ,CAACR,IAAT,CAAc/H,gBAAd,CAA+B,OAA/B,EAAwC,YAAY;AAClDwI,MAAAA,cAAc;AACdT,MAAAA,IAAI;AACL,KAHD;AAIAX,IAAAA,WAAW,CAAChb,WAAZ,CAAwBmc,QAAQ,CAACR,IAAjC,EAxMwC,CAwMA;;AAExCQ,IAAAA,QAAQ,CAAC3N,IAAT,GAAgBjP,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAhB;AACAuc,IAAAA,QAAQ,CAAC3N,IAAT,CAAcxK,SAAd,GAA0B,kCAA1B;AACAmY,IAAAA,QAAQ,CAACE,MAAT,GAAkB9c,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAlB;AACAuc,IAAAA,QAAQ,CAACE,MAAT,CAAgBrY,SAAhB,GAA4B,uCAA5B;AACAmY,IAAAA,QAAQ,CAACE,MAAT,CAAgBzI,gBAAhB,CAAiC,OAAjC,EAA0CyI,MAA1C;AACAF,IAAAA,QAAQ,CAAC3N,IAAT,CAAcxO,WAAd,CAA0Bmc,QAAQ,CAACE,MAAnC;AACAF,IAAAA,QAAQ,CAACG,OAAT,GAAmB/c,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAnB;AACAuc,IAAAA,QAAQ,CAACG,OAAT,CAAiBtY,SAAjB,GAA6B,wCAA7B;AACAmY,IAAAA,QAAQ,CAACG,OAAT,CAAiB1I,gBAAjB,CAAkC,OAAlC,EAA2C0I,OAA3C;AACAH,IAAAA,QAAQ,CAAC3N,IAAT,CAAcxO,WAAd,CAA0Bmc,QAAQ,CAACG,OAAnC;AACAH,IAAAA,QAAQ,CAACzc,SAAT,CAAmBM,WAAnB,CAA+Bmc,QAAQ,CAAC3N,IAAxC,EApNwC,CAoNO;;AAE/C2N,IAAAA,QAAQ,CAACI,UAAT,GAAsBhd,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAtB;AACAuc,IAAAA,QAAQ,CAACI,UAAT,CAAoB3I,gBAApB,CAAqC,OAArC,EAA8C4I,gBAA9C;AACAL,IAAAA,QAAQ,CAACI,UAAT,CAAoBvY,SAApB,GACE,6GADF;AAEA,QACEzE,QAAQ,CAACkd,iBAAT,IACAld,QAAQ,CAACmd,oBADT,IAEAnd,QAAQ,CAACod,uBAFT,IAGApd,QAAQ,CAACqd,mBAJX,EAMET,QAAQ,CAACzc,SAAT,CAAmBM,WAAnB,CAA+Bmc,QAAQ,CAACI,UAAxC,EAhOsC,CAgOe;;AAEvDJ,IAAAA,QAAQ,CAAC9E,WAAT,GAAuB9X,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAvB;AACAuc,IAAAA,QAAQ,CAAC9E,WAAT,CAAqBzD,gBAArB,CAAsC,OAAtC,EAA+C,UAAUlZ,CAAV,EAAa;AAC1D,UAAI2c,WAAJ,EAAiBwF,eAAe,GAAhC,KACKC,gBAAgB;AACtB,KAHD;AAIAX,IAAAA,QAAQ,CAAC9E,WAAT,CAAqBzD,gBAArB,CAAsC,WAAtC,EAAmD,UAAUlZ,CAAV,EAAa;AAC9DA,MAAAA,CAAC,CAACqiB,eAAF;AACD,KAFD;AAGAZ,IAAAA,QAAQ,CAAC9E,WAAT,CAAqBzD,gBAArB,CAAsC,YAAtC,EAAoD,UAAUlZ,CAAV,EAAa;AAC/DA,MAAAA,CAAC,CAACqiB,eAAF;AACD,KAFD;AAGAZ,IAAAA,QAAQ,CAAC9E,WAAT,CAAqBzD,gBAArB,CAAsC,aAAtC,EAAqD,UAAUlZ,CAAV,EAAa;AAChEA,MAAAA,CAAC,CAACqiB,eAAF;AACD,KAFD;AAGAZ,IAAAA,QAAQ,CAAC9E,WAAT,CAAqBrT,SAArB,GACE,iGADF;AAEA,QAAIgZ,kBAAkB,GAAG,KAAzB;;AAEA,QACE1d,MAAM,CAAC2d,sBAAP,IACAC,QAAQ,CAACC,QAAT,KAAsB,QADtB,IAEAja,SAAS,CAACC,SAAV,CAAoBC,WAApB,GAAkCU,OAAlC,CAA0C,MAA1C,KAAqD,CAHvD,EAIE;AACA;AACA;AACA;AACA;AACAqY,MAAAA,QAAQ,CAACzc,SAAT,CAAmBM,WAAnB,CAA+Bmc,QAAQ,CAAC9E,WAAxC;AACA2F,MAAAA,kBAAkB,GAAG,IAArB;AACD,KA/PuC,CA+PtC;;;AAEF,QAAII,OAAO,GAAG7d,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAd;AACAwd,IAAAA,OAAO,CAACpZ,SAAR,GAAoB,yCAApB;AACAgX,IAAAA,WAAW,CAAChb,WAAZ,CAAwBod,OAAxB,EAnQwC,CAmQN;;AAElC,QAAI7H,aAAa,CAAC8H,UAAlB,EAA8B;AAC5B;AACAC,MAAAA,WAAW,CAAC/H,aAAa,CAAC8H,UAAf,CAAX;AACD,KAHD,MAGO,IACL9H,aAAa,CAAC,SAAD,CAAb,IACAA,aAAa,CAAC,SAAD,CAAb,CAAyB8H,UAFpB,EAGL;AACA;AACAC,MAAAA,WAAW,CAAC/H,aAAa,CAAC,SAAD,CAAb,CAAyB8H,UAA1B,CAAX;AACD,KANM,MAMA;AACLC,MAAAA,WAAW,CAAC,IAAD,CAAX;AACD;;AAEDlB,IAAAA,cAAc,CAAC,IAAD,CAAd;AACA;AACJ;AACA;AACA;;AAEI,aAASnb,IAAT,GAAgB;AACd;AACA;AACA;AACA,UAAIsc,GAAG,GAAGhe,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAV;AACA2d,MAAAA,GAAG,CAACnC,SAAJ,GAAgB,uCAAhB;;AAEA,UAAImC,GAAG,CAACC,oBAAJ,CAAyB,GAAzB,EAA8BliB,MAA9B,KAAyC,CAA7C,EAAgD;AAC9CmiB,QAAAA,OAAO;AACP;AACD;;AAEDhG,MAAAA,QAAQ,GAAGhC,MAAM,CAACzI,IAAlB;AACA0K,MAAAA,SAAS,GAAGjC,MAAM,CAAC3I,KAAnB;AACA,UAAIzR,CAAJ,EAAO4C,CAAP;;AAEA,UAAIwX,MAAM,CAAC7T,IAAP,KAAgB,SAApB,EAA+B;AAC7BqV,QAAAA,SAAS,GAAG,EAAZ;;AAEA,aAAK5b,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,CAAhB,EAAmBA,CAAC,EAApB,EAAwB;AACtB4b,UAAAA,SAAS,CAACna,IAAV,CAAe,IAAIoI,KAAJ,EAAf;AACA+R,UAAAA,SAAS,CAAC5b,CAAD,CAAT,CAAa8J,WAAb,GAA2BsQ,MAAM,CAACtQ,WAAlC;AACD;;AAEDmW,QAAAA,WAAW,CAACK,IAAZ,CAAiBG,IAAjB,CAAsBjc,KAAtB,CAA4B6d,OAA5B,GAAsC,OAAtC;AACApC,QAAAA,WAAW,CAACK,IAAZ,CAAiBI,IAAjB,CAAsBlc,KAAtB,CAA4B6d,OAA5B,GAAsC,MAAtC;AACD,OAVD,MAUO,IAAIjI,MAAM,CAAC7T,IAAP,KAAgB,UAApB,EAAgC;AACrC,YAAIkR,CAAC,GAAG6K,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAepI,MAAM,CAACqI,QAAtB,CAAX,CAAR,CADqC,CACgB;AACrD;AACA;;AAEA,YACErI,MAAM,CAACvR,QAAP,IACAuR,MAAM,CAACqI,QAAP,CAAgB5Z,QADhB,IAEA,CAAC,qBAAqB6Z,IAArB,CAA0BtI,MAAM,CAACqI,QAAP,CAAgB5Z,QAA1C,CAHH,EAIE;AACA4O,UAAAA,CAAC,CAAC5O,QAAF,GAAauR,MAAM,CAACvR,QAAP,GAAkBuR,MAAM,CAACqI,QAAP,CAAgB5Z,QAA/C;AACD,SAND,MAMO,IAAIuR,MAAM,CAACqI,QAAP,CAAgB5Z,QAApB,EAA8B;AACnC4O,UAAAA,CAAC,CAAC5O,QAAF,GAAauR,MAAM,CAACqI,QAAP,CAAgB5Z,QAA7B;AACD,SAFM,MAEA,IAAIuR,MAAM,CAACvR,QAAX,EAAqB;AAC1B4O,UAAAA,CAAC,CAAC5O,QAAF,GAAauR,MAAM,CAACvR,QAApB;AACD;;AAED+S,QAAAA,SAAS,GAAGnE,CAAZ;AACD,OAlBM,MAkBA;AACL,YAAI2C,MAAM,CAAC9U,OAAP,KAAmB,IAAvB,EAA6B;AAC3BsW,UAAAA,SAAS,GAAGxB,MAAM,CAACuI,WAAnB;AACD,SAFD,MAEO;AACL,cAAIvI,MAAM,CAACuI,WAAP,KAAuBxe,WAA3B,EAAwC;AACtCie,YAAAA,OAAO,CAAChI,MAAM,CAACwE,MAAP,CAAcI,eAAf,CAAP;AACA;AACD;;AAEDpD,UAAAA,SAAS,GAAG,IAAI/R,KAAJ,EAAZ;AACD;AACF,OAvDa,CAuDZ;;;AAEF,UAAIuQ,MAAM,CAAC7T,IAAP,KAAgB,SAApB,EAA+B;AAC7B;AACA,YAAIqc,WAAW,GAAG,CAAlB;;AAEA,YAAI3Z,MAAM,GAAG,SAASA,MAAT,GAAkB;AAC7B2Z,UAAAA,WAAW;;AAEX,cAAIA,WAAW,KAAK,CAApB,EAAuB;AACrBC,YAAAA,WAAW;AACZ;AACF,SAND;;AAQA,YAAIC,OAAO,GAAG,SAASA,OAAT,CAAiBzjB,CAAjB,EAAoB;AAChC,cAAIsW,CAAC,GAAGzR,QAAQ,CAACK,aAAT,CAAuB,GAAvB,CAAR;AACAoR,UAAAA,CAAC,CAACoN,IAAF,GAAS1jB,CAAC,CAACS,MAAF,CAASmK,GAAlB;AACA0L,UAAAA,CAAC,CAACoK,SAAF,GAAcpK,CAAC,CAACoN,IAAhB;AACAX,UAAAA,OAAO,CAAChI,MAAM,CAACwE,MAAP,CAAcK,eAAd,CAA8B/U,OAA9B,CAAsC,IAAtC,EAA4CyL,CAAC,CAACqN,SAA9C,CAAD,CAAP;AACD,SALD;;AAOA,aAAKhjB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG4b,SAAS,CAAC3b,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACrC4b,UAAAA,SAAS,CAAC5b,CAAD,CAAT,CAAa+J,MAAb,GAAsBd,MAAtB;AACA2S,UAAAA,SAAS,CAAC5b,CAAD,CAAT,CAAagK,OAAb,GAAuB8Y,OAAvB;AACAlgB,UAAAA,CAAC,GAAGwX,MAAM,CAAC6I,OAAP,CAAejjB,CAAf,CAAJ;;AAEA,cAAI4C,CAAC,KAAK,MAAV,EAAkB;AAChB;AACAyD,YAAAA,OAAO,CAACC,GAAR,CACE,yDAAyDtG,CAD3D;AAGAiJ,YAAAA,MAAM;AACP,WAND,MAMO;AACL,gBAAImR,MAAM,CAACvR,QAAP,IAAmB,CAACqa,WAAW,CAACtgB,CAAD,CAAnC,EAAwC;AACtCA,cAAAA,CAAC,GAAGwX,MAAM,CAACvR,QAAP,GAAkBjG,CAAtB;AACD;;AAEDgZ,YAAAA,SAAS,CAAC5b,CAAD,CAAT,CAAa+J,MAAb,GAAsBd,MAAtB;AACA2S,YAAAA,SAAS,CAAC5b,CAAD,CAAT,CAAagK,OAAb,GAAuB8Y,OAAvB;AACAlH,YAAAA,SAAS,CAAC5b,CAAD,CAAT,CAAaiK,GAAb,GAAmBkZ,WAAW,CAACvgB,CAAD,CAA9B,CAPK,CAO8B;AACpC;AACF;AACF,OAxCD,MAwCO,IAAIwX,MAAM,CAAC7T,IAAP,KAAgB,UAApB,EAAgC;AACrCsc,QAAAA,WAAW;AACZ,OAFM,MAEA;AACLjgB,QAAAA,CAAC,GAAG,EAAJ;;AAEA,YAAIwX,MAAM,CAACvR,QAAX,EAAqB;AACnBjG,UAAAA,CAAC,GAAGwX,MAAM,CAACvR,QAAX;AACD;;AAED,YAAIuR,MAAM,CAAC9U,OAAP,KAAmB,IAAvB,EAA6B;AAC3B;AACA1C,UAAAA,CAAC,GAAGsgB,WAAW,CAAC9I,MAAM,CAACuI,WAAR,CAAX,GACAvI,MAAM,CAACuI,WADP,GAEA/f,CAAC,GAAGwX,MAAM,CAACuI,WAFf;;AAIA/G,UAAAA,SAAS,CAAC7R,MAAV,GAAmB,YAAY;AAC7B9F,YAAAA,MAAM,CAACmf,GAAP,CAAWC,eAAX,CAA2B,KAAKpZ,GAAhC,EAD6B,CACS;;AAEtC4Y,YAAAA,WAAW;AACZ,WAJD;;AAMA,cAAIS,GAAG,GAAG,IAAIC,cAAJ,EAAV;;AAEAD,UAAAA,GAAG,CAACE,SAAJ,GAAgB,YAAY;AAC1B,gBAAIF,GAAG,CAACG,MAAJ,IAAc,GAAlB,EAAuB;AACrB;AACA,kBAAI9N,CAAC,GAAGzR,QAAQ,CAACK,aAAT,CAAuB,GAAvB,CAAR;AACAoR,cAAAA,CAAC,CAACoN,IAAF,GAASngB,CAAT;AACA+S,cAAAA,CAAC,CAAC+N,WAAF,GAAgB/N,CAAC,CAACoN,IAAlB;AACAX,cAAAA,OAAO,CAAChI,MAAM,CAACwE,MAAP,CAAcK,eAAd,CAA8B/U,OAA9B,CAAsC,IAAtC,EAA4CyL,CAAC,CAACqN,SAA9C,CAAD,CAAP;AACD;;AAED,gBAAIjL,GAAG,GAAG,KAAK4L,QAAf;AACAC,YAAAA,aAAa,CAAC7L,GAAD,CAAb;AACAkI,YAAAA,WAAW,CAACK,IAAZ,CAAiBM,GAAjB,CAAqBb,SAArB,GAAiC,EAAjC;AACD,WAZD;;AAcAuD,UAAAA,GAAG,CAACO,UAAJ,GAAiB,UAAUxkB,CAAV,EAAa;AAC5B,gBAAIA,CAAC,CAACykB,gBAAN,EAAwB;AACtB;AACA,kBAAIC,OAAO,GAAI1kB,CAAC,CAAC2J,MAAF,GAAW3J,CAAC,CAAC2kB,KAAd,GAAuB,GAArC;AACA/D,cAAAA,WAAW,CAACK,IAAZ,CAAiBK,QAAjB,CAA0Bnc,KAA1B,CAAgCC,KAAhC,GAAwCsf,OAAO,GAAG,GAAlD;AACA,kBAAIE,IAAJ,EAAUC,SAAV,EAAqBC,WAArB;;AAEA,kBAAI9kB,CAAC,CAAC2kB,KAAF,GAAU,GAAd,EAAmB;AACjBC,gBAAAA,IAAI,GAAG,IAAP;AACAC,gBAAAA,SAAS,GAAG,CAAC7kB,CAAC,CAAC2J,MAAF,GAAW,GAAZ,EAAiBob,OAAjB,CAAyB,CAAzB,CAAZ;AACAD,gBAAAA,WAAW,GAAG,CAAC9kB,CAAC,CAAC2kB,KAAF,GAAU,GAAX,EAAgBI,OAAhB,CAAwB,CAAxB,CAAd;AACD,eAJD,MAIO,IAAI/kB,CAAC,CAAC2kB,KAAF,GAAU,GAAd,EAAmB;AACxBC,gBAAAA,IAAI,GAAG,IAAP;AACAC,gBAAAA,SAAS,GAAG,CAAC7kB,CAAC,CAAC2J,MAAF,GAAW,GAAZ,EAAiBob,OAAjB,CAAyB,CAAzB,CAAZ;AACAD,gBAAAA,WAAW,GAAG,CAAC9kB,CAAC,CAAC2kB,KAAF,GAAU,GAAX,EAAgBI,OAAhB,CAAwB,CAAxB,CAAd;AACD,eAJM,MAIA;AACLH,gBAAAA,IAAI,GAAG,GAAP;AACAC,gBAAAA,SAAS,GAAG7kB,CAAC,CAAC2J,MAAd;AACAmb,gBAAAA,WAAW,GAAG9kB,CAAC,CAAC2kB,KAAhB;AACD;;AAED/D,cAAAA,WAAW,CAACK,IAAZ,CAAiBM,GAAjB,CAAqBb,SAArB,GACEmE,SAAS,GAAG,KAAZ,GAAoBC,WAApB,GAAkC,GAAlC,GAAwCF,IAD1C;AAED,aAtBD,MAsBO;AACL;AACAhE,cAAAA,WAAW,CAACK,IAAZ,CAAiBG,IAAjB,CAAsBjc,KAAtB,CAA4B6d,OAA5B,GAAsC,OAAtC;AACApC,cAAAA,WAAW,CAACK,IAAZ,CAAiBI,IAAjB,CAAsBlc,KAAtB,CAA4B6d,OAA5B,GAAsC,MAAtC;AACD;AACF,WA5BD;;AA8BA,cAAI;AACFiB,YAAAA,GAAG,CAACe,IAAJ,CAAS,KAAT,EAAgBzhB,CAAhB,EAAmB,IAAnB;AACD,WAFD,CAEE,OAAOvD,CAAP,EAAU;AACV;AACA+iB,YAAAA,OAAO,CAAChI,MAAM,CAACwE,MAAP,CAAcM,iBAAf,CAAP;AACD;;AAEDoE,UAAAA,GAAG,CAACgB,YAAJ,GAAmB,MAAnB;AACAhB,UAAAA,GAAG,CAACiB,gBAAJ,CAAqB,QAArB,EAA+B,mBAA/B;AACAjB,UAAAA,GAAG,CAACkB,eAAJ,GAAsBpK,MAAM,CAACtQ,WAAP,KAAuB,iBAA7C;AACAwZ,UAAAA,GAAG,CAACmB,IAAJ;AACD;AACF;;AAED,UAAIrK,MAAM,CAACmE,SAAX,EAAsBoB,WAAW,CAACH,SAAZ,CAAsBC,GAAtB,CAA0B,WAA1B;AACtBE,MAAAA,WAAW,CAACH,SAAZ,CAAsBkF,MAAtB,CAA6B,eAA7B,EAnLc,CAmLiC;;AAE/CjI,MAAAA,MAAM,GAAGrC,MAAM,CAACuD,aAAP,KAAyB,IAAlC;;AAEA,UAAIvD,MAAM,CAAC9U,OAAP,IAAkBmX,MAAtB,EAA8B;AAC5Bb,QAAAA,SAAS,GAAGxB,MAAM,CAACuK,QAAnB;AACA9B,QAAAA,WAAW;AACZ;AACF;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASK,WAAT,CAAqB0B,GAArB,EAA0B;AACxB;AACA,aACE,IAAIC,MAAJ,CAAW,iBAAX,EAA8B,GAA9B,EAAmCnC,IAAnC,CAAwCkC,GAAxC,KACAA,GAAG,CAAC,CAAD,CAAH,KAAW,GADX,IAEAA,GAAG,CAACna,KAAJ,CAAU,CAAV,EAAa,CAAb,MAAoB,OAHtB;AAKD;AACD;AACJ;AACA;AACA;;;AAEI,aAASoY,WAAT,GAAuB;AACrB,UAAI,CAAC/I,QAAL,EAAeA,QAAQ,GAAG,IAAI9V,YAAY,CAAC8V,QAAjB,CAA0B8F,eAA1B,CAAX,CADM,CACiD;;AAEtE,UAAI,CAACjE,cAAL,EAAqB;AACnBA,QAAAA,cAAc,GAAG,IAAjB;AACAkE,QAAAA,OAAO,CAACtH,gBAAR,CAAyB,WAAzB,EAAsCuM,mBAAtC,EAA2D,KAA3D;AACA5gB,QAAAA,QAAQ,CAACqU,gBAAT,CAA0B,WAA1B,EAAuCwM,mBAAvC,EAA4D,KAA5D;AACA7gB,QAAAA,QAAQ,CAACqU,gBAAT,CAA0B,SAA1B,EAAqCyM,iBAArC,EAAwD,KAAxD;;AAEA,YAAI5K,MAAM,CAAC0D,SAAX,EAAsB;AACpB6B,UAAAA,WAAW,CAACpH,gBAAZ,CACE,YADF,EAEE0M,oBAFF,EAGE,KAHF;AAKAtF,UAAAA,WAAW,CAACpH,gBAAZ,CACE,gBADF,EAEE0M,oBAFF,EAGE,KAHF;AAKD;;AAED,YAAI7K,MAAM,CAACwD,eAAX,EAA4B;AAC1BiC,UAAAA,OAAO,CAACtH,gBAAR,CAAyB,UAAzB,EAAqC2M,qBAArC,EAA4D,KAA5D;AACD;;AAED7gB,QAAAA,SAAS,CAACkU,gBAAV,CACE,qBADF,EAEE4M,kBAFF,EAGE,KAHF;AAKA9gB,QAAAA,SAAS,CAACkU,gBAAV,CACE,wBADF,EAEE4M,kBAFF,EAGE,KAHF;AAKA9gB,QAAAA,SAAS,CAACkU,gBAAV,CACE,oBADF,EAEE4M,kBAFF,EAGE,KAHF;AAKA9gB,QAAAA,SAAS,CAACkU,gBAAV,CACE,kBADF,EAEE4M,kBAFF,EAGE,KAHF;AAKAlhB,QAAAA,MAAM,CAACsU,gBAAP,CAAwB,QAAxB,EAAkC6M,gBAAlC,EAAoD,KAApD;AACAnhB,QAAAA,MAAM,CAACsU,gBAAP,CAAwB,mBAAxB,EAA6C6M,gBAA7C,EAA+D,KAA/D;;AAEA,YAAI,CAAChL,MAAM,CAACoE,mBAAZ,EAAiC;AAC/Bna,UAAAA,SAAS,CAACkU,gBAAV,CAA2B,SAA3B,EAAsC8M,kBAAtC,EAA0D,KAA1D;AACAhhB,UAAAA,SAAS,CAACkU,gBAAV,CAA2B,OAA3B,EAAoC+M,eAApC,EAAqD,KAArD;AACAjhB,UAAAA,SAAS,CAACkU,gBAAV,CAA2B,MAA3B,EAAmCgN,SAAnC,EAA8C,KAA9C;AACD;;AAEDrhB,QAAAA,QAAQ,CAACqU,gBAAT,CAA0B,YAA1B,EAAwCyM,iBAAxC,EAA2D,KAA3D;;AAEA,YACE9gB,QAAQ,CAACqE,eAAT,CAAyB/D,KAAzB,CAA+BghB,aAA/B,KAAiD,EAAjD,IACAthB,QAAQ,CAACqE,eAAT,CAAyB/D,KAAzB,CAA+BihB,WAA/B,KAA+C,EAFjD,EAGE;AACA5F,UAAAA,OAAO,CAACtH,gBAAR,CAAyB,aAAzB,EAAwCmN,qBAAxC,EAA+D,KAA/D;AACA7F,UAAAA,OAAO,CAACtH,gBAAR,CAAyB,aAAzB,EAAwCoN,qBAAxC,EAA+D,KAA/D;AACA9F,UAAAA,OAAO,CAACtH,gBAAR,CAAyB,WAAzB,EAAsCqN,mBAAtC,EAA2D,KAA3D;AACA/F,UAAAA,OAAO,CAACtH,gBAAR,CAAyB,cAAzB,EAAyCqN,mBAAzC,EAA8D,KAA9D;AACD,SARD,MAQO;AACL/F,UAAAA,OAAO,CAACtH,gBAAR,CAAyB,YAAzB,EAAuCsN,oBAAvC,EAA6D,KAA7D;AACAhG,UAAAA,OAAO,CAACtH,gBAAR,CAAyB,WAAzB,EAAsCuN,mBAAtC,EAA2D,KAA3D;AACAjG,UAAAA,OAAO,CAACtH,gBAAR,CAAyB,UAAzB,EAAqCwN,kBAArC,EAAyD,KAAzD;AACD,SAlEkB,CAkEjB;;;AAEF,YAAI9hB,MAAM,CAAC4D,SAAP,CAAiBme,cAArB,EACE3hB,SAAS,CAACG,KAAV,CAAgBihB,WAAhB,GAA8B,MAA9B;AACH;;AAEDQ,MAAAA,UAAU;AACVC,MAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAR,CAAP,CA5EqB,CA4EC;;AAEtBwD,MAAAA,UAAU,CAAC,YAAY,CAAE,CAAf,EAAiB,GAAjB,CAAV;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASyO,aAAT,CAAuBxe,KAAvB,EAA8B;AAC5B,UAAI+gB,MAAM,GAAG,IAAIC,UAAJ,EAAb;AACAD,MAAAA,MAAM,CAAC5N,gBAAP,CAAwB,SAAxB,EAAmC,YAAY;AAC7C,YAAIR,GAAG,GAAGoO,MAAM,CAACriB,MAAjB,CAD6C,CACpB;AACzB;;AAEA,YACE+D,SAAS,CAACC,SAAV,CAAoBC,WAApB,GAAkCC,KAAlC,CAAwC,4BAAxC,CADF,EAEE;AACA,cAAIqe,SAAS,GAAGtO,GAAG,CAACtP,OAAJ,CAAY,UAAZ,CAAhB;AACA,cAAI4d,SAAS,GAAG,CAAZ,IAAiBA,SAAS,GAAG,KAAjC,EACEjE,OAAO,CAAChI,MAAM,CAACwE,MAAP,CAAcO,cAAf,CAAP;AACH;;AAED,YAAImH,KAAK,GAAGvO,GAAG,CAACtP,OAAJ,CAAY,YAAZ,CAAZ;;AAEA,YAAI6d,KAAK,GAAG,CAAC,CAAT,IAAclM,MAAM,CAACmM,cAAP,KAA0B,IAA5C,EAAkD;AAChD,cAAIC,OAAO,GAAGzO,GAAG,CAAC0O,SAAJ,CAAcH,KAAd,EAAqBvO,GAAG,CAACtP,OAAJ,CAAY,cAAZ,IAA8B,EAAnD,CAAd,CADgD,CACsB;;AAEtE,cAAIie,MAAM,GAAG,SAASA,MAAT,CAAgBC,GAAhB,EAAqB;AAChC,gBAAI7iB,MAAJ;;AAEA,gBAAI0iB,OAAO,CAAC/d,OAAR,CAAgBke,GAAG,GAAG,IAAtB,KAA+B,CAAnC,EAAsC;AACpC7iB,cAAAA,MAAM,GAAG0iB,OAAO,CAACC,SAAR,CACPD,OAAO,CAAC/d,OAAR,CAAgBke,GAAG,GAAG,IAAtB,IAA8BA,GAAG,CAAC1mB,MAAlC,GAA2C,CADpC,CAAT;AAGA6D,cAAAA,MAAM,GAAGA,MAAM,CAAC2iB,SAAP,CAAiB,CAAjB,EAAoB3iB,MAAM,CAAC2E,OAAP,CAAe,GAAf,CAApB,CAAT;AACD,aALD,MAKO,IAAI+d,OAAO,CAAC/d,OAAR,CAAgBke,GAAG,GAAG,GAAtB,KAA8B,CAAlC,EAAqC;AAC1C7iB,cAAAA,MAAM,GAAG0iB,OAAO,CAACC,SAAR,CACPD,OAAO,CAAC/d,OAAR,CAAgBke,GAAG,GAAG,GAAtB,IAA6BA,GAAG,CAAC1mB,MAAjC,GAA0C,CADnC,CAAT;AAGA6D,cAAAA,MAAM,GAAGA,MAAM,CAAC2iB,SAAP,CAAiB,CAAjB,EAAoB3iB,MAAM,CAAC2E,OAAP,CAAe,GAAf,CAApB,CAAT;AACD;;AAED,gBAAI3E,MAAM,KAAKK,WAAf,EAA4B;AAC1B,qBAAOyiB,MAAM,CAAC9iB,MAAD,CAAb;AACD;;AAED,mBAAO,IAAP;AACD,WApBD,CAHgD,CAuB7C;;;AAEH,cAAI+iB,GAAG,GAAG;AACRC,YAAAA,SAAS,EAAEJ,MAAM,CAAC,2BAAD,CADT;AAERK,YAAAA,YAAY,EAAEL,MAAM,CAAC,mCAAD,CAFZ;AAGRM,YAAAA,UAAU,EAAEN,MAAM,CAAC,4BAAD,CAHV;AAIRO,YAAAA,aAAa,EAAEP,MAAM,CAAC,oCAAD,CAJb;AAKRQ,YAAAA,SAAS,EAAER,MAAM,CAAC,4BAAD,CALT;AAMRS,YAAAA,OAAO,EAAET,MAAM,CAAC,0BAAD,CANP;AAOR1b,YAAAA,YAAY,EAAE0b,MAAM,CAAC,wBAAD,CAPZ;AAQRzb,YAAAA,WAAW,EAAEyb,MAAM,CAAC,uBAAD;AARX,WAAV;;AAWA,cACEG,GAAG,CAACC,SAAJ,KAAkB,IAAlB,IACAD,GAAG,CAACE,YAAJ,KAAqB,IADrB,IAEAF,GAAG,CAACG,UAAJ,KAAmB,IAFnB,IAGAH,GAAG,CAACI,aAAJ,KAAsB,IAHtB,IAIAJ,GAAG,CAACK,SAAJ,KAAkB,IALpB,EAME;AACA;AACA,gBAAI1K,4BAA4B,CAAC/T,OAA7B,CAAqC,MAArC,IAA+C,CAAnD,EACE2R,MAAM,CAACpU,IAAP,GAAe6gB,GAAG,CAACE,YAAJ,GAAmBF,GAAG,CAACC,SAAxB,GAAqC,GAAnD;AACF,gBAAItK,4BAA4B,CAAC/T,OAA7B,CAAqC,MAArC,IAA+C,CAAnD,EACE2R,MAAM,CAACnU,IAAP,GAAe4gB,GAAG,CAACI,aAAJ,GAAoBJ,GAAG,CAACG,UAAzB,GAAuC,GAArD;AACF,gBAAIxK,4BAA4B,CAAC/T,OAA7B,CAAqC,SAArC,IAAkD,CAAtD,EACE2R,MAAM,CAACiD,OAAP,GACE,CAAC,CAACwJ,GAAG,CAACK,SAAJ,GAAgBL,GAAG,CAACI,aAAJ,GAAoB,CAArC,IAA0CJ,GAAG,CAACG,UAA9C,GACC,GADF,IAEA,CAAC,GAHH;;AAKF,gBACEH,GAAG,CAACM,OAAJ,KAAgB,IAAhB,IACA3K,4BAA4B,CAAC/T,OAA7B,CAAqC,aAArC,IAAsD,CAFxD,EAGE;AACA;AACA2R,cAAAA,MAAM,CAACqD,WAAP,GAAqBoJ,GAAG,CAACM,OAAzB;;AAEA,kBAAI/M,MAAM,CAAC2H,OAAP,KAAmB,KAAvB,EAA8B;AAC5B3H,gBAAAA,MAAM,CAAC2H,OAAP,GAAiB,IAAjB;AACD;AACF;;AAED,gBAAI8E,GAAG,CAAC7b,YAAJ,KAAqB,IAArB,IAA6B6b,GAAG,CAAC5b,WAAJ,KAAoB,IAArD,EAA2D;AACzD,kBAAIuR,4BAA4B,CAAC/T,OAA7B,CAAqC,cAArC,IAAuD,CAA3D,EACE2R,MAAM,CAACpP,YAAP,GAAsB6b,GAAG,CAAC7b,YAA1B;AACF,kBAAIwR,4BAA4B,CAAC/T,OAA7B,CAAqC,aAArC,IAAsD,CAA1D,EACE2R,MAAM,CAACnP,WAAP,GAAqB4b,GAAG,CAAC5b,WAAzB;AACH,aA7BD,CA6BE;;AACH;AACF,SAvF4C,CAuF3C;;;AAEF2Q,QAAAA,SAAS,CAAC3R,GAAV,GAAgBhG,MAAM,CAACmf,GAAP,CAAWgE,eAAX,CAA2BhiB,KAA3B,CAAhB;AACD,OA1FD;AA2FA,UAAI+gB,MAAM,CAACkB,kBAAP,KAA8BljB,WAAlC,EACEgiB,MAAM,CAACkB,kBAAP,CAA0BjiB,KAA1B,EADF,KAEK+gB,MAAM,CAACmB,UAAP,CAAkBliB,KAAlB;AACN;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASgd,OAAT,CAAiBvB,QAAjB,EAA2B;AACzB,UAAIA,QAAQ,KAAK1c,WAAjB,EAA8B0c,QAAQ,GAAGzG,MAAM,CAACwE,MAAP,CAAcQ,iBAAzB;AAC9Ba,MAAAA,WAAW,CAACY,QAAZ,CAAqBd,SAArB,GAAiC,QAAQc,QAAR,GAAmB,MAApD;AACAC,MAAAA,QAAQ,CAACR,IAAT,CAAc9b,KAAd,CAAoB6d,OAApB,GAA8B,MAA9B;AACApC,MAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,CAAqB/b,KAArB,CAA2B6d,OAA3B,GAAqC,MAArC;AACApC,MAAAA,WAAW,CAACY,QAAZ,CAAqBrc,KAArB,CAA2B6d,OAA3B,GAAqC,OAArC;AACA3G,MAAAA,KAAK,GAAG,IAAR;AACA1S,MAAAA,MAAM,GAAG7E,WAAT;AACAyb,MAAAA,eAAe,CAACpb,KAAhB,CAAsB6d,OAAtB,GAAgC,MAAhC;AACAkF,MAAAA,SAAS,CAAC,OAAD,EAAU1G,QAAV,CAAT;AACD;AACD;AACJ;AACA;AACA;;;AAEI,aAAS2G,UAAT,GAAsB;AACpB,UAAI9L,KAAJ,EAAW;AACTuE,QAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,CAAqB/b,KAArB,CAA2B6d,OAA3B,GAAqC,MAArC;AACApC,QAAAA,WAAW,CAACY,QAAZ,CAAqBrc,KAArB,CAA2B6d,OAA3B,GAAqC,MAArC;AACA3G,QAAAA,KAAK,GAAG,KAAR;AACAkE,QAAAA,eAAe,CAACpb,KAAhB,CAAsB6d,OAAtB,GAAgC,OAAhC;AACAkF,QAAAA,SAAS,CAAC,cAAD,CAAT;AACD;AACF;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASvH,YAAT,CAAsByH,KAAtB,EAA6B;AAC3B,UAAIC,GAAG,GAAGC,aAAa,CAACF,KAAD,CAAvB;AACA3H,MAAAA,QAAQ,CAACtb,KAAT,CAAeojB,IAAf,GAAsBF,GAAG,CAAC1V,CAAJ,GAAQ,IAA9B;AACA8N,MAAAA,QAAQ,CAACtb,KAAT,CAAeqjB,GAAf,GAAqBH,GAAG,CAACvV,CAAJ,GAAQ,IAA7B;AACA2V,MAAAA,YAAY,CAAC9H,YAAY,CAAC+H,EAAd,CAAZ;AACAD,MAAAA,YAAY,CAAC9H,YAAY,CAACgI,EAAd,CAAZ;AACAlI,MAAAA,QAAQ,CAACtb,KAAT,CAAe6d,OAAf,GAAyB,OAAzB;AACAvC,MAAAA,QAAQ,CAACtb,KAAT,CAAeyjB,OAAf,GAAyB,CAAzB;AACAjI,MAAAA,YAAY,CAAC+H,EAAb,GAAkB5S,UAAU,CAAC,YAAY;AACvC2K,QAAAA,QAAQ,CAACtb,KAAT,CAAeyjB,OAAf,GAAyB,CAAzB;AACD,OAF2B,EAEzB,IAFyB,CAA5B;AAGAjI,MAAAA,YAAY,CAACgI,EAAb,GAAkB7S,UAAU,CAAC,YAAY;AACvC2K,QAAAA,QAAQ,CAACtb,KAAT,CAAe6d,OAAf,GAAyB,MAAzB;AACD,OAF2B,EAEzB,IAFyB,CAA5B;AAGAoF,MAAAA,KAAK,CAACS,cAAN;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASP,aAAT,CAAuBF,KAAvB,EAA8B;AAC5B,UAAIU,MAAM,GAAG9jB,SAAS,CAAC+jB,qBAAV,EAAb;AACA,UAAIV,GAAG,GAAG,EAAV,CAF4B,CAEd;;AAEdA,MAAAA,GAAG,CAAC1V,CAAJ,GAAQ,CAACyV,KAAK,CAACY,OAAN,IAAiBZ,KAAK,CAACa,KAAxB,IAAiCH,MAAM,CAACP,IAAhD;AACAF,MAAAA,GAAG,CAACvV,CAAJ,GAAQ,CAACsV,KAAK,CAACc,OAAN,IAAiBd,KAAK,CAACe,KAAxB,IAAiCL,MAAM,CAACN,GAAhD;AACA,aAAOH,GAAP;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAAS5C,mBAAT,CAA6B2C,KAA7B,EAAoC;AAClC;AACAA,MAAAA,KAAK,CAACS,cAAN,GAFkC,CAEV;;AAExB7jB,MAAAA,SAAS,CAACokB,KAAV,GAJkC,CAIf;;AAEnB,UAAI,CAACzf,MAAD,IAAW,CAACoR,MAAM,CAACmE,SAAvB,EAAkC;AAChCgJ,QAAAA,SAAS,CAAC,WAAD,EAAcE,KAAd,CAAT;AACA;AACD,OATiC,CAShC;;;AAEF,UAAIC,GAAG,GAAGC,aAAa,CAACF,KAAD,CAAvB,CAXkC,CAWF;;AAEhC,UAAIrN,MAAM,CAAC+D,YAAX,EAAyB;AACvB,YAAIuK,MAAM,GAAGC,kBAAkB,CAAClB,KAAD,CAA/B;AACAphB,QAAAA,OAAO,CAACC,GAAR,CACE,YACEoiB,MAAM,CAAC,CAAD,CADR,GAEE,SAFF,GAGEA,MAAM,CAAC,CAAD,CAHR,GAIE,kBAJF,GAKEtO,MAAM,CAAC3I,KALT,GAME,gBANF,GAOE2I,MAAM,CAAC1I,GAPT,GAQE,UARF,GASE0I,MAAM,CAACzI,IAVX;AAYD,OA3BiC,CA2BhC;;;AAEFiX,MAAAA,aAAa;AACbpH,MAAAA,eAAe;AACfpH,MAAAA,MAAM,CAACvI,IAAP,GAAc,CAAd;AACAiK,MAAAA,KAAK,CAACnK,IAAN,GAAa,CAAb;AACAmJ,MAAAA,iBAAiB,GAAG,IAApB;AACAC,MAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;AACAC,MAAAA,qBAAqB,GAAGwM,GAAG,CAAC1V,CAA5B;AACAmJ,MAAAA,qBAAqB,GAAGuM,GAAG,CAACvV,CAA5B;AACAkJ,MAAAA,gBAAgB,GAAGjB,MAAM,CAAC1I,GAA1B;AACA4J,MAAAA,kBAAkB,GAAGlB,MAAM,CAAC3I,KAA5B;AACAkO,MAAAA,WAAW,CAACH,SAAZ,CAAsBC,GAAtB,CAA0B,eAA1B;AACAE,MAAAA,WAAW,CAACH,SAAZ,CAAsBkF,MAAtB,CAA6B,WAA7B;AACA6C,MAAAA,SAAS,CAAC,WAAD,EAAcE,KAAd,CAAT;AACAoB,MAAAA,WAAW;AACZ;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAAS3D,qBAAT,CAA+BuC,KAA/B,EAAsC;AACpC,UAAIrN,MAAM,CAAC0C,OAAP,KAAmB1C,MAAM,CAACzI,IAA9B,EAAoC;AAClCwI,QAAAA,KAAK,CAAC+L,OAAN,CAAc9J,QAAd,EAAwB,IAAxB;AACD,OAFD,MAEO;AACL,YAAIsM,MAAM,GAAGC,kBAAkB,CAAClB,KAAD,CAA/B;;AAEAtN,QAAAA,KAAK,CAAC2O,MAAN,CAAaJ,MAAM,CAAC,CAAD,CAAnB,EAAwBA,MAAM,CAAC,CAAD,CAA9B,EAAmCtO,MAAM,CAAC0C,OAA1C,EAAmD,IAAnD;AACD;AACF;;AAED,aAASiM,iBAAT,CAA2BtB,KAA3B,EAAkC;AAChChN,MAAAA,KAAK,GAAG,EAAE,GAAGgN;AAAL,OAAR;;AACA,UAAIhN,KAAK,CAACuO,SAAN,KAAoB,IAApB,IAA4BvO,KAAK,CAACwO,UAAN,KAAqB,IAArD,EAA2D;AACzD7O,QAAAA,MAAM,CAACmE,SAAP,GAAmB,KAAnB;AACAoB,QAAAA,WAAW,CAACH,SAAZ,CAAsBkF,MAAtB,CAA6B,WAA7B;AACA/E,QAAAA,WAAW,CAACH,SAAZ,CAAsBC,GAAtB,CAA0B,aAA1B;AACD,OAJD,MAIO;AACLrF,QAAAA,MAAM,CAACmE,SAAP,GAAmB,IAAnB;AACAoB,QAAAA,WAAW,CAACH,SAAZ,CAAsBC,GAAtB,CAA0B,WAA1B;AACAE,QAAAA,WAAW,CAACH,SAAZ,CAAsBkF,MAAtB,CAA6B,aAA7B;AACD;AACF;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASiE,kBAAT,CAA4BlB,KAA5B,EAAmC;AACjC,UAAIC,GAAG,GAAGC,aAAa,CAACF,KAAD,CAAvB;AACA,UAAInjB,MAAM,GAAGwV,QAAQ,CAACpE,SAAT,EAAb;AACA,UAAIwT,WAAW,GAAG5kB,MAAM,CAAC+M,WAAzB;AAAA,UACE8X,YAAY,GAAG7kB,MAAM,CAACgN,YADxB;AAEA,UAAIU,CAAC,GAAI0V,GAAG,CAAC1V,CAAJ,GAAQkX,WAAT,GAAwB,CAAxB,GAA4B,CAApC;AACA,UAAI/W,CAAC,GAAI,CAAC,IAAKuV,GAAG,CAACvV,CAAJ,GAAQgX,YAAT,GAAyB,CAA9B,IAAmCA,YAApC,GAAoDD,WAA5D;AACA,UAAItX,KAAK,GAAG,IAAI/G,IAAI,CAACqI,GAAL,CAAUkH,MAAM,CAACzI,IAAP,GAAc9G,IAAI,CAAC4D,EAApB,GAA0B,GAAnC,CAAhB;AACA,UAAIxH,CAAC,GAAG4D,IAAI,CAACqH,GAAL,CAAUkI,MAAM,CAAC3I,KAAP,GAAe5G,IAAI,CAAC4D,EAArB,GAA2B,GAApC,CAAR;AACA,UAAIgJ,CAAC,GAAG5M,IAAI,CAACoH,GAAL,CAAUmI,MAAM,CAAC3I,KAAP,GAAe5G,IAAI,CAAC4D,EAArB,GAA2B,GAApC,CAAR;AACA,UAAIkH,CAAC,GAAG/D,KAAK,GAAG6F,CAAR,GAAYtF,CAAC,GAAGlL,CAAxB;AACA,UAAImiB,IAAI,GAAGve,IAAI,CAAC8H,IAAL,CAAUX,CAAC,GAAGA,CAAJ,GAAQ2D,CAAC,GAAGA,CAAtB,CAAX;AACA,UAAIlE,KAAK,GAAI5G,IAAI,CAAC6I,IAAL,CAAU,CAACvB,CAAC,GAAGsF,CAAJ,GAAQ7F,KAAK,GAAG3K,CAAjB,IAAsBmiB,IAAhC,IAAwC,GAAzC,GAAgDve,IAAI,CAAC4D,EAAjE;AACA,UAAIiD,GAAG,GAAI7G,IAAI,CAAC0H,KAAL,CAAWP,CAAC,GAAGoX,IAAf,EAAqBzT,CAAC,GAAGyT,IAAzB,IAAiC,GAAlC,GAAyCve,IAAI,CAAC4D,EAA9C,GAAmD2L,MAAM,CAAC1I,GAApE;AACA,UAAIA,GAAG,GAAG,CAAC,GAAX,EAAgBA,GAAG,IAAI,GAAP;AAChB,UAAIA,GAAG,GAAG,GAAV,EAAeA,GAAG,IAAI,GAAP;AACf,aAAO,CAACD,KAAD,EAAQC,GAAR,CAAP;AACD;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASqT,mBAAT,CAA6B0C,KAA7B,EAAoC;AAClC,UAAI3M,iBAAiB,IAAI9R,MAAzB,EAAiC;AAC/B+R,QAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;AACA,YAAI3W,MAAM,GAAGwV,QAAQ,CAACpE,SAAT,EAAb;AACA,YAAIwT,WAAW,GAAG5kB,MAAM,CAAC+M,WAAzB;AAAA,YACE8X,YAAY,GAAG7kB,MAAM,CAACgN,YADxB;AAEA,YAAIoW,GAAG,GAAGC,aAAa,CAACF,KAAD,CAAvB,CAL+B,CAKC;;AAEhC,YAAI/V,GAAG,GACF,CAAC7G,IAAI,CAAC6I,IAAL,CAAWwH,qBAAqB,GAAGgO,WAAzB,GAAwC,CAAxC,GAA4C,CAAtD,IACFre,IAAI,CAAC6I,IAAL,CAAWgU,GAAG,CAAC1V,CAAJ,GAAQkX,WAAT,GAAwB,CAAxB,GAA4B,CAAtC,CADC,IAED,GAFA,GAGAre,IAAI,CAAC4D,EAHN,GAIC2L,MAAM,CAACzI,IAJT,GAKE,EALF,GAMA0J,gBAPF;AAQAS,QAAAA,KAAK,CAACpK,GAAN,GAAa,CAACA,GAAG,GAAG0I,MAAM,CAAC1I,GAAd,IAAqB,GAAtB,GAA6B,GAAzC;AACA0I,QAAAA,MAAM,CAAC1I,GAAP,GAAaA,GAAb;AACA,YAAI+B,IAAI,GACL,IACC5I,IAAI,CAAC6I,IAAL,CACG7I,IAAI,CAACqI,GAAL,CAAUkH,MAAM,CAACzI,IAAP,GAAc,GAAf,GAAsB9G,IAAI,CAAC4D,EAApC,IAA0C0a,YAA3C,GACED,WAFJ,CADD,GAKC,GALF,GAMAre,IAAI,CAAC4D,EAPP;AAQA,YAAIgD,KAAK,GACJ,CAAC5G,IAAI,CAAC6I,IAAL,CAAWgU,GAAG,CAACvV,CAAJ,GAAQgX,YAAT,GAAyB,CAAzB,GAA6B,CAAvC,IACFte,IAAI,CAAC6I,IAAL,CAAWyH,qBAAqB,GAAGgO,YAAzB,GAAyC,CAAzC,GAA6C,CAAvD,CADC,IAED,GAFA,GAGAte,IAAI,CAAC4D,EAHN,GAICgF,IAJF,GAKE,EALF,GAMA6H,kBAPF;AAQAQ,QAAAA,KAAK,CAACrK,KAAN,GAAc,CAACA,KAAK,GAAG2I,MAAM,CAAC3I,KAAhB,IAAyB,GAAvC;AACA2I,QAAAA,MAAM,CAAC3I,KAAP,GAAeA,KAAf;AACD;AACF;AACD;AACJ;AACA;AACA;;;AAEI,aAASuT,iBAAT,CAA2ByC,KAA3B,EAAkC;AAChC,UAAI,CAAC3M,iBAAL,EAAwB;AACtB;AACD;;AAEDA,MAAAA,iBAAiB,GAAG,KAApB;;AAEA,UAAIE,IAAI,CAACC,GAAL,KAAaF,iBAAb,GAAiC,EAArC,EAAyC;AACvC;AACA;AACAe,QAAAA,KAAK,CAACrK,KAAN,GAAcqK,KAAK,CAACpK,GAAN,GAAY,CAA1B;AACD;;AAEDiO,MAAAA,WAAW,CAACH,SAAZ,CAAsBC,GAAtB,CAA0B,WAA1B;AACAE,MAAAA,WAAW,CAACH,SAAZ,CAAsBkF,MAAtB,CAA6B,eAA7B;AACA3J,MAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;AACAsM,MAAAA,SAAS,CAAC,SAAD,EAAYE,KAAZ,CAAT;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAAS5B,oBAAT,CAA8B4B,KAA9B,EAAqC;AACnC;AACA,UAAI,CAACze,MAAD,IAAW,CAACoR,MAAM,CAACmE,SAAvB,EAAkC;AAChC;AACD,OAJkC,CAIjC;;;AAEFqK,MAAAA,aAAa;AACbpH,MAAAA,eAAe;AACfpH,MAAAA,MAAM,CAACvI,IAAP,GAAc,CAAd;AACAiK,MAAAA,KAAK,CAACnK,IAAN,GAAa,CAAb,CATmC,CASnB;;AAEhB,UAAI0X,IAAI,GAAG1B,aAAa,CAACF,KAAK,CAAC6B,aAAN,CAAoB,CAApB,CAAD,CAAxB;AACApO,MAAAA,qBAAqB,GAAGmO,IAAI,CAACrX,CAA7B;AACAmJ,MAAAA,qBAAqB,GAAGkO,IAAI,CAAClX,CAA7B;;AAEA,UAAIsV,KAAK,CAAC6B,aAAN,CAAoBrpB,MAApB,KAA+B,CAAnC,EAAsC;AACpC;AACA,YAAIspB,IAAI,GAAG5B,aAAa,CAACF,KAAK,CAAC6B,aAAN,CAAoB,CAApB,CAAD,CAAxB;AACApO,QAAAA,qBAAqB,IAAI,CAACqO,IAAI,CAACvX,CAAL,GAASqX,IAAI,CAACrX,CAAf,IAAoB,GAA7C;AACAmJ,QAAAA,qBAAqB,IAAI,CAACoO,IAAI,CAACpX,CAAL,GAASkX,IAAI,CAAClX,CAAf,IAAoB,GAA7C;AACAiJ,QAAAA,wBAAwB,GAAGvQ,IAAI,CAAC8H,IAAL,CACzB,CAAC0W,IAAI,CAACrX,CAAL,GAASuX,IAAI,CAACvX,CAAf,KAAqBqX,IAAI,CAACrX,CAAL,GAASuX,IAAI,CAACvX,CAAnC,IACE,CAACqX,IAAI,CAAClX,CAAL,GAASoX,IAAI,CAACpX,CAAf,KAAqBkX,IAAI,CAAClX,CAAL,GAASoX,IAAI,CAACpX,CAAnC,CAFuB,CAA3B;AAID;;AAED2I,MAAAA,iBAAiB,GAAG,IAApB;AACAC,MAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;AACAI,MAAAA,gBAAgB,GAAGjB,MAAM,CAAC1I,GAA1B;AACA4J,MAAAA,kBAAkB,GAAGlB,MAAM,CAAC3I,KAA5B;AACA8V,MAAAA,SAAS,CAAC,YAAD,EAAeE,KAAf,CAAT;AACAoB,MAAAA,WAAW;AACZ;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAAS/C,mBAAT,CAA6B2B,KAA7B,EAAoC;AAClC,UAAI,CAACrN,MAAM,CAACmE,SAAZ,EAAuB;AACrB;AACD,OAHiC,CAGhC;;;AAEFkJ,MAAAA,KAAK,CAACS,cAAN;;AAEA,UAAIlf,MAAJ,EAAY;AACV+R,QAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;AACD;;AAED,UAAIH,iBAAiB,IAAI9R,MAAzB,EAAiC;AAC/B,YAAIqgB,IAAI,GAAG1B,aAAa,CAACF,KAAK,CAAC6B,aAAN,CAAoB,CAApB,CAAD,CAAxB;AACA,YAAIjB,OAAO,GAAGgB,IAAI,CAACrX,CAAnB;AACA,YAAIuW,OAAO,GAAGc,IAAI,CAAClX,CAAnB;;AAEA,YACEsV,KAAK,CAAC6B,aAAN,CAAoBrpB,MAApB,KAA+B,CAA/B,IACAmb,wBAAwB,IAAI,CAAC,CAF/B,EAGE;AACA,cAAImO,IAAI,GAAG5B,aAAa,CAACF,KAAK,CAAC6B,aAAN,CAAoB,CAApB,CAAD,CAAxB;AACAjB,UAAAA,OAAO,IAAI,CAACkB,IAAI,CAACvX,CAAL,GAASqX,IAAI,CAACrX,CAAf,IAAoB,GAA/B;AACAuW,UAAAA,OAAO,IAAI,CAACgB,IAAI,CAACpX,CAAL,GAASkX,IAAI,CAAClX,CAAf,IAAoB,GAA/B;AACA,cAAIqX,UAAU,GAAG3e,IAAI,CAAC8H,IAAL,CACf,CAAC0W,IAAI,CAACrX,CAAL,GAASuX,IAAI,CAACvX,CAAf,KAAqBqX,IAAI,CAACrX,CAAL,GAASuX,IAAI,CAACvX,CAAnC,IACE,CAACqX,IAAI,CAAClX,CAAL,GAASoX,IAAI,CAACpX,CAAf,KAAqBkX,IAAI,CAAClX,CAAL,GAASoX,IAAI,CAACpX,CAAnC,CAFa,CAAjB;AAIA+T,UAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAP,GAAc,CAACyJ,wBAAwB,GAAGoO,UAA5B,IAA0C,GAAzD,CAAP;AACApO,UAAAA,wBAAwB,GAAGoO,UAA3B;AACD,SAlB8B,CAkB7B;AACF;AACA;AACA;AACA;AACA;AACA;;;AAEA,YAAIC,sBAAsB,GACvBrP,MAAM,CAACzI,IAAP,GAAc,GAAf,GAAsByI,MAAM,CAACqE,wBAD/B;AAEA,YAAI/M,GAAG,GACL,CAACwJ,qBAAqB,GAAGmN,OAAzB,IAAoCoB,sBAApC,GACApO,gBAFF;AAGAS,QAAAA,KAAK,CAACpK,GAAN,GAAa,CAACA,GAAG,GAAG0I,MAAM,CAAC1I,GAAd,IAAqB,GAAtB,GAA6B,GAAzC;AACA0I,QAAAA,MAAM,CAAC1I,GAAP,GAAaA,GAAb;AACA,YAAID,KAAK,GACP,CAAC8W,OAAO,GAAGpN,qBAAX,IAAoCsO,sBAApC,GACAnO,kBAFF;AAGAQ,QAAAA,KAAK,CAACrK,KAAN,GAAc,CAACA,KAAK,GAAG2I,MAAM,CAAC3I,KAAhB,IAAyB,GAAvC;AACA2I,QAAAA,MAAM,CAAC3I,KAAP,GAAeA,KAAf;AACD;AACF;AACD;AACJ;AACA;AACA;;;AAEI,aAASsU,kBAAT,GAA8B;AAC5BjL,MAAAA,iBAAiB,GAAG,KAApB;;AAEA,UAAIE,IAAI,CAACC,GAAL,KAAaF,iBAAb,GAAiC,GAArC,EAA0C;AACxCe,QAAAA,KAAK,CAACrK,KAAN,GAAcqK,KAAK,CAACpK,GAAN,GAAY,CAA1B;AACD;;AAED0J,MAAAA,wBAAwB,GAAG,CAAC,CAA5B;AACAL,MAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;AACAsM,MAAAA,SAAS,CAAC,UAAD,EAAaE,KAAb,CAAT;AACD;;AAED,QAAIiC,UAAU,GAAG,EAAjB;AAAA,QACEC,kBAAkB,GAAG,EADvB;AAEA;AACJ;AACA;AACA;AACA;;AAEI,aAASjE,qBAAT,CAA+B+B,KAA/B,EAAsC;AACpC,UAAIA,KAAK,CAACmC,WAAN,KAAsB,OAA1B,EAAmC;AACjC;AACA,YAAI,CAAC5gB,MAAD,IAAW,CAACoR,MAAM,CAACmE,SAAvB,EAAkC;AAClCmL,QAAAA,UAAU,CAACjoB,IAAX,CAAgBgmB,KAAK,CAACoC,SAAtB;AACAF,QAAAA,kBAAkB,CAACloB,IAAnB,CAAwB;AACtB4mB,UAAAA,OAAO,EAAEZ,KAAK,CAACY,OADO;AAEtBE,UAAAA,OAAO,EAAEd,KAAK,CAACc;AAFO,SAAxB;AAIAd,QAAAA,KAAK,CAAC6B,aAAN,GAAsBK,kBAAtB;AACA9D,QAAAA,oBAAoB,CAAC4B,KAAD,CAApB;AACAA,QAAAA,KAAK,CAACS,cAAN;AACD;AACF;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASvC,qBAAT,CAA+B8B,KAA/B,EAAsC;AACpC,UAAIA,KAAK,CAACmC,WAAN,KAAsB,OAA1B,EAAmC;AACjC,YAAI,CAACxP,MAAM,CAACmE,SAAZ,EAAuB;;AAEvB,aAAK,IAAIve,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0pB,UAAU,CAACzpB,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC1C,cAAIynB,KAAK,CAACoC,SAAN,KAAoBH,UAAU,CAAC1pB,CAAD,CAAlC,EAAuC;AACrC2pB,YAAAA,kBAAkB,CAAC3pB,CAAD,CAAlB,CAAsBqoB,OAAtB,GAAgCZ,KAAK,CAACY,OAAtC;AACAsB,YAAAA,kBAAkB,CAAC3pB,CAAD,CAAlB,CAAsBuoB,OAAtB,GAAgCd,KAAK,CAACc,OAAtC;AACAd,YAAAA,KAAK,CAAC6B,aAAN,GAAsBK,kBAAtB;AACA7D,YAAAA,mBAAmB,CAAC2B,KAAD,CAAnB;AACAA,YAAAA,KAAK,CAACS,cAAN;AACA;AACD;AACF;AACF;AACF;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAAStC,mBAAT,CAA6B6B,KAA7B,EAAoC;AAClC,UAAIA,KAAK,CAACmC,WAAN,KAAsB,OAA1B,EAAmC;AACjC,YAAIE,OAAO,GAAG,KAAd;;AAEA,aAAK,IAAI9pB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0pB,UAAU,CAACzpB,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC1C,cAAIynB,KAAK,CAACoC,SAAN,KAAoBH,UAAU,CAAC1pB,CAAD,CAAlC,EAAuC0pB,UAAU,CAAC1pB,CAAD,CAAV,GAAgBmE,WAAhB;AACvC,cAAIulB,UAAU,CAAC1pB,CAAD,CAAd,EAAmB8pB,OAAO,GAAG,IAAV;AACpB;;AAED,YAAI,CAACA,OAAL,EAAc;AACZJ,UAAAA,UAAU,GAAG,EAAb;AACAC,UAAAA,kBAAkB,GAAG,EAArB;AACA5D,UAAAA,kBAAkB;AACnB;;AAED0B,QAAAA,KAAK,CAACS,cAAN;AACD;AACF;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASjD,oBAAT,CAA8BwC,KAA9B,EAAqC;AACnC;AACA,UACE,CAACze,MAAD,IACCoR,MAAM,CAAC0D,SAAP,KAAqB,gBAArB,IAAyC,CAACrC,gBAF7C,EAGE;AACA;AACD;;AAEDgM,MAAAA,KAAK,CAACS,cAAN,GATmC,CASX;;AAExBU,MAAAA,aAAa;AACb7N,MAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;;AAEA,UAAIwM,KAAK,CAACsC,WAAV,EAAuB;AACrB;AACA7D,QAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAP,GAAc8V,KAAK,CAACsC,WAAN,GAAoB,IAAnC,CAAP;AACAjO,QAAAA,KAAK,CAACnK,IAAN,GAAa8V,KAAK,CAACuC,UAAN,GAAmB,CAAnB,GAAuB,CAAvB,GAA2B,CAAC,CAAzC;AACD,OAJD,MAIO,IAAIvC,KAAK,CAACuC,UAAV,EAAsB;AAC3B;AACA9D,QAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAP,GAAc8V,KAAK,CAACuC,UAAN,GAAmB,IAAlC,CAAP;AACAlO,QAAAA,KAAK,CAACnK,IAAN,GAAa8V,KAAK,CAACuC,UAAN,GAAmB,CAAnB,GAAuB,CAAvB,GAA2B,CAAC,CAAzC;AACD,OAJM,MAIA,IAAIvC,KAAK,CAACwC,MAAV,EAAkB;AACvB;AACA/D,QAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAP,GAAc8V,KAAK,CAACwC,MAAN,GAAe,GAA9B,CAAP;AACAnO,QAAAA,KAAK,CAACnK,IAAN,GAAa8V,KAAK,CAACwC,MAAN,GAAe,CAAf,GAAmB,CAAnB,GAAuB,CAAC,CAArC;AACD;;AAEDpB,MAAAA,WAAW;AACZ;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASxD,kBAAT,CAA4BoC,KAA5B,EAAmC;AACjC;AACAmB,MAAAA,aAAa;AACb7N,MAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;AACAuG,MAAAA,eAAe;AACfpH,MAAAA,MAAM,CAACvI,IAAP,GAAc,CAAd,CALiC,CAKhB;;AAEjB,UAAIqY,SAAS,GAAGzC,KAAK,CAAC0C,KAAN,IAAe1C,KAAK,CAAC2C,OAArC,CAPiC,CAOa;;AAE9C,UAAIhQ,MAAM,CAACsE,kBAAP,CAA0BjW,OAA1B,CAAkCyhB,SAAlC,IAA+C,CAAnD,EAAsD;AACtDzC,MAAAA,KAAK,CAACS,cAAN,GAViC,CAUT;;AAExB,UAAIgC,SAAS,KAAK,EAAlB,EAAsB;AACpB;AACA,YAAIzO,gBAAJ,EAAsB;AACpB0F,UAAAA,gBAAgB;AACjB;AACF,OALD,MAKO;AACL;AACAkJ,QAAAA,SAAS,CAACH,SAAD,EAAY,IAAZ,CAAT;AACD;AACF;AACD;AACJ;AACA;AACA;;;AAEI,aAAS3E,SAAT,GAAqB;AACnB,WAAK,IAAIvlB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AAC3Bub,QAAAA,QAAQ,CAACvb,CAAD,CAAR,GAAc,KAAd;AACD;AACF;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASslB,eAAT,CAAyBmC,KAAzB,EAAgC;AAC9B;AACA,UAAIyC,SAAS,GAAGzC,KAAK,CAAC0C,KAAN,IAAe1C,KAAK,CAAC2C,OAArC,CAF8B,CAEgB;;AAE9C,UAAIhQ,MAAM,CAACsE,kBAAP,CAA0BjW,OAA1B,CAAkCyhB,SAAlC,IAA+C,CAAnD,EAAsD;AACtDzC,MAAAA,KAAK,CAACS,cAAN,GAL8B,CAKN;;AAExBmC,MAAAA,SAAS,CAACH,SAAD,EAAY,KAAZ,CAAT;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASG,SAAT,CAAmBH,SAAnB,EAA8BnpB,KAA9B,EAAqC;AACnC,UAAIupB,UAAU,GAAG,KAAjB;;AAEA,cAAQJ,SAAR;AACE;AACA,aAAK,GAAL;AACA,aAAK,GAAL;AACA,aAAK,EAAL;AACA,aAAK,GAAL;AACE,cAAI3O,QAAQ,CAAC,CAAD,CAAR,IAAexa,KAAnB,EAA0B;AACxBupB,YAAAA,UAAU,GAAG,IAAb;AACD;;AAED/O,UAAAA,QAAQ,CAAC,CAAD,CAAR,GAAcxa,KAAd;AACA;AACF;;AAEA,aAAK,GAAL;AACA,aAAK,GAAL;AACA,aAAK,EAAL;AACA,aAAK,EAAL;AACE,cAAIwa,QAAQ,CAAC,CAAD,CAAR,IAAexa,KAAnB,EAA0B;AACxBupB,YAAAA,UAAU,GAAG,IAAb;AACD;;AAED/O,UAAAA,QAAQ,CAAC,CAAD,CAAR,GAAcxa,KAAd;AACA;AACF;;AAEA,aAAK,EAAL;AACE,cAAIwa,QAAQ,CAAC,CAAD,CAAR,IAAexa,KAAnB,EAA0B;AACxBupB,YAAAA,UAAU,GAAG,IAAb;AACD;;AAED/O,UAAAA,QAAQ,CAAC,CAAD,CAAR,GAAcxa,KAAd;AACA;AACF;;AAEA,aAAK,EAAL;AACE,cAAIwa,QAAQ,CAAC,CAAD,CAAR,IAAexa,KAAnB,EAA0B;AACxBupB,YAAAA,UAAU,GAAG,IAAb;AACD;;AAED/O,UAAAA,QAAQ,CAAC,CAAD,CAAR,GAAcxa,KAAd;AACA;AACF;;AAEA,aAAK,EAAL;AACE,cAAIwa,QAAQ,CAAC,CAAD,CAAR,IAAexa,KAAnB,EAA0B;AACxBupB,YAAAA,UAAU,GAAG,IAAb;AACD;;AAED/O,UAAAA,QAAQ,CAAC,CAAD,CAAR,GAAcxa,KAAd;AACA;AACF;;AAEA,aAAK,EAAL;AACE,cAAIwa,QAAQ,CAAC,CAAD,CAAR,IAAexa,KAAnB,EAA0B;AACxBupB,YAAAA,UAAU,GAAG,IAAb;AACD;;AAED/O,UAAAA,QAAQ,CAAC,CAAD,CAAR,GAAcxa,KAAd;AACA;AACF;;AAEA,aAAK,EAAL;AACE,cAAIwa,QAAQ,CAAC,CAAD,CAAR,IAAexa,KAAnB,EAA0B;AACxBupB,YAAAA,UAAU,GAAG,IAAb;AACD;;AAED/O,UAAAA,QAAQ,CAAC,CAAD,CAAR,GAAcxa,KAAd;AACA;AACF;;AAEA,aAAK,EAAL;AACE,cAAIwa,QAAQ,CAAC,CAAD,CAAR,IAAexa,KAAnB,EAA0B;AACxBupB,YAAAA,UAAU,GAAG,IAAb;AACD;;AAED/O,UAAAA,QAAQ,CAAC,CAAD,CAAR,GAAcxa,KAAd;AACA;AACF;;AAEA,aAAK,EAAL;AACE,cAAIwa,QAAQ,CAAC,CAAD,CAAR,IAAexa,KAAnB,EAA0B;AACxBupB,YAAAA,UAAU,GAAG,IAAb;AACD;;AAED/O,UAAAA,QAAQ,CAAC,CAAD,CAAR,GAAcxa,KAAd;AACA;AACF;;AAEA,aAAK,EAAL;AACE,cAAIwa,QAAQ,CAAC,CAAD,CAAR,IAAexa,KAAnB,EAA0B;AACxBupB,YAAAA,UAAU,GAAG,IAAb;AACD;;AAED/O,UAAAA,QAAQ,CAAC,CAAD,CAAR,GAAcxa,KAAd;AA9FJ;;AAiGA,UAAIupB,UAAU,IAAIvpB,KAAlB,EAAyB;AACvB,YAAI,OAAOwpB,WAAP,KAAuB,WAAvB,IAAsCA,WAAW,CAACtP,GAAZ,EAA1C,EAA6D;AAC3DY,UAAAA,QAAQ,GAAG0O,WAAW,CAACtP,GAAZ,EAAX;AACD,SAFD,MAEO;AACLY,UAAAA,QAAQ,GAAGb,IAAI,CAACC,GAAL,EAAX;AACD;;AAED4N,QAAAA,WAAW;AACZ;AACF;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAAS2B,SAAT,GAAqB;AACnB;AACA,UAAI,CAACxhB,MAAL,EAAa;AACX;AACD;;AAED,UAAIyhB,SAAS,GAAG,KAAhB;AACA,UAAIC,SAAS,GAAGtQ,MAAM,CAAC3I,KAAvB;AACA,UAAIkZ,OAAO,GAAGvQ,MAAM,CAAC1I,GAArB;AACA,UAAIkZ,QAAQ,GAAGxQ,MAAM,CAACzI,IAAtB;AACA,UAAIkZ,OAAJ;;AAEA,UAAI,OAAON,WAAP,KAAuB,WAAvB,IAAsCA,WAAW,CAACtP,GAAZ,EAA1C,EAA6D;AAC3D4P,QAAAA,OAAO,GAAGN,WAAW,CAACtP,GAAZ,EAAV;AACD,OAFD,MAEO;AACL4P,QAAAA,OAAO,GAAG7P,IAAI,CAACC,GAAL,EAAV;AACD;;AAED,UAAIY,QAAQ,KAAK1X,WAAjB,EAA8B;AAC5B0X,QAAAA,QAAQ,GAAGgP,OAAX;AACD;;AAED,UAAIhV,IAAI,GAAI,CAACgV,OAAO,GAAGhP,QAAX,IAAuBzB,MAAM,CAACzI,IAA/B,GAAuC,IAAlD;AACAkE,MAAAA,IAAI,GAAGhL,IAAI,CAACyH,GAAL,CAASuD,IAAT,EAAe,GAAf,CAAP,CAvBmB,CAuBS;;AAE5B,UAAI0F,QAAQ,CAAC,CAAD,CAAR,IAAenB,MAAM,CAACyD,YAAP,KAAwB,IAA3C,EAAiD;AAC/CqI,QAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAP,GAAc,CAACmK,KAAK,CAACnK,IAAN,GAAa,GAAb,GAAmB,GAApB,IAA2BkE,IAA1C,CAAP;AACA4U,QAAAA,SAAS,GAAG,IAAZ;AACD,OA5BkB,CA4BjB;;;AAEF,UAAIlP,QAAQ,CAAC,CAAD,CAAR,IAAenB,MAAM,CAACyD,YAAP,KAAwB,IAA3C,EAAiD;AAC/CqI,QAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAP,GAAc,CAACmK,KAAK,CAACnK,IAAN,GAAa,GAAb,GAAmB,GAApB,IAA2BkE,IAA1C,CAAP;AACA4U,QAAAA,SAAS,GAAG,IAAZ;AACD,OAjCkB,CAiCjB;;;AAEF,UAAIlP,QAAQ,CAAC,CAAD,CAAR,IAAeA,QAAQ,CAAC,CAAD,CAA3B,EAAgC;AAC9B;AACAnB,QAAAA,MAAM,CAAC3I,KAAP,IAAgB,CAACqK,KAAK,CAACrK,KAAN,GAAc,GAAd,GAAoB,GAArB,IAA4BoE,IAA5C;AACA4U,QAAAA,SAAS,GAAG,IAAZ;AACD,OAvCkB,CAuCjB;;;AAEF,UAAIlP,QAAQ,CAAC,CAAD,CAAR,IAAeA,QAAQ,CAAC,CAAD,CAA3B,EAAgC;AAC9B;AACAnB,QAAAA,MAAM,CAAC3I,KAAP,IAAgB,CAACqK,KAAK,CAACrK,KAAN,GAAc,GAAd,GAAoB,GAArB,IAA4BoE,IAA5C;AACA4U,QAAAA,SAAS,GAAG,IAAZ;AACD,OA7CkB,CA6CjB;;;AAEF,UAAIlP,QAAQ,CAAC,CAAD,CAAR,IAAeA,QAAQ,CAAC,CAAD,CAA3B,EAAgC;AAC9B;AACAnB,QAAAA,MAAM,CAAC1I,GAAP,IAAc,CAACoK,KAAK,CAACpK,GAAN,GAAY,GAAZ,GAAkB,GAAnB,IAA0BmE,IAAxC;AACA4U,QAAAA,SAAS,GAAG,IAAZ;AACD,OAnDkB,CAmDjB;;;AAEF,UAAIlP,QAAQ,CAAC,CAAD,CAAR,IAAeA,QAAQ,CAAC,CAAD,CAA3B,EAAgC;AAC9B;AACAnB,QAAAA,MAAM,CAAC1I,GAAP,IAAc,CAACoK,KAAK,CAACpK,GAAN,GAAY,GAAZ,GAAkB,GAAnB,IAA0BmE,IAAxC;AACA4U,QAAAA,SAAS,GAAG,IAAZ;AACD;;AAED,UAAIA,SAAJ,EAAe1P,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB,CA3DI,CA2D4B;;AAE/C,UAAIb,MAAM,CAACkD,UAAX,EAAuB;AACrB;AACA,YAAIuN,OAAO,GAAGhP,QAAV,GAAqB,KAAzB,EAAgC;AAC9B,cAAIiP,QAAQ,GAAG,CAACD,OAAO,GAAGhP,QAAX,IAAuB,IAAtC;AACA,cAAIkP,OAAO,GACT,CAAEjP,KAAK,CAACpK,GAAN,GAAYoZ,QAAb,GAAyBjV,IAAzB,GAAgCuE,MAAM,CAACkD,UAAP,GAAoB,GAArD,IACAwN,QAFF;AAGAC,UAAAA,OAAO,GACL,CAAC,CAAC3Q,MAAM,CAACkD,UAAR,GAAqB,CAArB,GAAyB,CAAzB,GAA6B,CAAC,CAA/B,IACAzS,IAAI,CAACyH,GAAL,CAASzH,IAAI,CAACsL,GAAL,CAASiE,MAAM,CAACkD,UAAP,GAAoBwN,QAA7B,CAAT,EAAiDjgB,IAAI,CAACsL,GAAL,CAAS4U,OAAT,CAAjD,CAFF;AAGA3Q,UAAAA,MAAM,CAAC1I,GAAP,IAAcqZ,OAAd;AACD,SAXoB,CAWnB;;;AAEF,YAAI3Q,MAAM,CAACoD,mBAAX,EAAgC;AAC9BpD,UAAAA,MAAM,CAACoD,mBAAP,IAA8BqN,OAAO,GAAGhP,QAAxC;;AAEA,cAAIzB,MAAM,CAACoD,mBAAP,IAA8B,CAAlC,EAAqC;AACnCpD,YAAAA,MAAM,CAACoD,mBAAP,GAA6B,KAA7B;AACArB,YAAAA,eAAe,GAAG/B,MAAM,CAACkD,UAAzB;AACAlD,YAAAA,MAAM,CAACkD,UAAP,GAAoB,CAApB;AACD;AACF;AACF,OAnFkB,CAmFjB;;;AAEF,UAAIhB,YAAY,CAAC7K,KAAjB,EAAwB;AACtBuZ,QAAAA,WAAW,CAAC,OAAD,CAAX;AACAN,QAAAA,SAAS,GAAGtQ,MAAM,CAAC3I,KAAnB;AACD;;AAED,UAAI6K,YAAY,CAAC5K,GAAjB,EAAsB;AACpBsZ,QAAAA,WAAW,CAAC,KAAD,CAAX;AACAL,QAAAA,OAAO,GAAGvQ,MAAM,CAAC1I,GAAjB;AACD;;AAED,UAAI4K,YAAY,CAAC3K,IAAjB,EAAuB;AACrBqZ,QAAAA,WAAW,CAAC,MAAD,CAAX;AACAJ,QAAAA,QAAQ,GAAGxQ,MAAM,CAACzI,IAAlB;AACD,OAlGkB,CAkGjB;;;AAEF,UAAIkE,IAAI,GAAG,CAAP,IAAY,CAACuE,MAAM,CAACkD,UAAxB,EAAoC;AAClC;AACA,YAAI2N,cAAc,GAAG,IAAI7Q,MAAM,CAACuE,QAAhC,CAFkC,CAEQ;;AAE1C,YACE,CAACpD,QAAQ,CAAC,CAAD,CAAT,IACA,CAACA,QAAQ,CAAC,CAAD,CADT,IAEA,CAACA,QAAQ,CAAC,CAAD,CAFT,IAGA,CAACA,QAAQ,CAAC,CAAD,CAHT,IAIA,CAACe,YAAY,CAAC5K,GALhB,EAME;AACA0I,UAAAA,MAAM,CAAC1I,GAAP,IAAcoK,KAAK,CAACpK,GAAN,GAAYmE,IAAZ,GAAmBoV,cAAjC;AACD,SAZiC,CAYhC;;;AAEF,YACE,CAAC1P,QAAQ,CAAC,CAAD,CAAT,IACA,CAACA,QAAQ,CAAC,CAAD,CADT,IAEA,CAACA,QAAQ,CAAC,CAAD,CAFT,IAGA,CAACA,QAAQ,CAAC,CAAD,CAHT,IAIA,CAACe,YAAY,CAAC7K,KALhB,EAME;AACA2I,UAAAA,MAAM,CAAC3I,KAAP,IAAgBqK,KAAK,CAACrK,KAAN,GAAcoE,IAAd,GAAqBoV,cAArC;AACD,SAtBiC,CAsBhC;;;AAEF,YAAI,CAAC1P,QAAQ,CAAC,CAAD,CAAT,IAAgB,CAACA,QAAQ,CAAC,CAAD,CAAzB,IAAgC,CAACe,YAAY,CAAC3K,IAAlD,EAAwD;AACtDuU,UAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAP,GAAcmK,KAAK,CAACnK,IAAN,GAAakE,IAAb,GAAoBoV,cAAnC,CAAP;AACD;AACF;;AAEDpP,MAAAA,QAAQ,GAAGgP,OAAX;;AAEA,UAAIhV,IAAI,GAAG,CAAX,EAAc;AACZiG,QAAAA,KAAK,CAACpK,GAAN,GAAYoK,KAAK,CAACpK,GAAN,GAAY,GAAZ,GAAmB,CAAC0I,MAAM,CAAC1I,GAAP,GAAaiZ,OAAd,IAAyB9U,IAA1B,GAAkC,GAAhE;AACAiG,QAAAA,KAAK,CAACrK,KAAN,GACEqK,KAAK,CAACrK,KAAN,GAAc,GAAd,GAAqB,CAAC2I,MAAM,CAAC3I,KAAP,GAAeiZ,SAAhB,IAA6B7U,IAA9B,GAAsC,GAD5D;AAEAiG,QAAAA,KAAK,CAACnK,IAAN,GAAamK,KAAK,CAACnK,IAAN,GAAa,GAAb,GAAoB,CAACyI,MAAM,CAACzI,IAAP,GAAciZ,QAAf,IAA2B/U,IAA5B,GAAoC,GAApE,CAJY,CAI6D;;AAEzE,YAAIqV,QAAQ,GAAG9Q,MAAM,CAACkD,UAAP,GAAoBzS,IAAI,CAACsL,GAAL,CAASiE,MAAM,CAACkD,UAAhB,CAApB,GAAkD,CAAjE;AACAxB,QAAAA,KAAK,CAACpK,GAAN,GAAY7G,IAAI,CAACyH,GAAL,CAAS4Y,QAAT,EAAmBrgB,IAAI,CAACC,GAAL,CAASgR,KAAK,CAACpK,GAAf,EAAoB,CAACwZ,QAArB,CAAnB,CAAZ;AACApP,QAAAA,KAAK,CAACrK,KAAN,GAAc5G,IAAI,CAACyH,GAAL,CAAS4Y,QAAT,EAAmBrgB,IAAI,CAACC,GAAL,CAASgR,KAAK,CAACrK,KAAf,EAAsB,CAACyZ,QAAvB,CAAnB,CAAd;AACApP,QAAAA,KAAK,CAACnK,IAAN,GAAa9G,IAAI,CAACyH,GAAL,CAAS4Y,QAAT,EAAmBrgB,IAAI,CAACC,GAAL,CAASgR,KAAK,CAACnK,IAAf,EAAqB,CAACuZ,QAAtB,CAAnB,CAAb;AACD,OA7IkB,CA6IjB;;;AAEF,UAAI3P,QAAQ,CAAC,CAAD,CAAR,IAAeA,QAAQ,CAAC,CAAD,CAA3B,EAAgC;AAC9BO,QAAAA,KAAK,CAACnK,IAAN,GAAa,CAAb;AACD;;AAED,UAAI,CAAC4J,QAAQ,CAAC,CAAD,CAAR,IAAeA,QAAQ,CAAC,CAAD,CAAxB,MAAiCA,QAAQ,CAAC,CAAD,CAAR,IAAeA,QAAQ,CAAC,CAAD,CAAxD,CAAJ,EAAkE;AAChEO,QAAAA,KAAK,CAACrK,KAAN,GAAc,CAAd;AACD;;AAED,UAAI,CAAC8J,QAAQ,CAAC,CAAD,CAAR,IAAeA,QAAQ,CAAC,CAAD,CAAxB,MAAiCA,QAAQ,CAAC,CAAD,CAAR,IAAeA,QAAQ,CAAC,CAAD,CAAxD,CAAJ,EAAkE;AAChEO,QAAAA,KAAK,CAACpK,GAAN,GAAY,CAAZ;AACD;AACF;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASsZ,WAAT,CAAqBxT,IAArB,EAA2B;AACzB,UAAI2T,CAAC,GAAG7O,YAAY,CAAC9E,IAAD,CAApB;AACA,UAAI4T,QAAQ,GAAGvgB,IAAI,CAACyH,GAAL,CACb,CADa,EAEbzH,IAAI,CAACC,GAAL,CAAS,CAACkQ,IAAI,CAACC,GAAL,KAAakQ,CAAC,CAACE,SAAhB,IAA6B,IAA7B,IAAqCF,CAAC,CAACG,QAAF,GAAa,IAAlD,CAAT,EAAkE,CAAlE,CAFa,CAAf;AAIA,UAAIxnB,MAAM,GACRqnB,CAAC,CAACI,aAAF,GACAnR,MAAM,CAACiE,uBAAP,CAA+B+M,QAA/B,KACGD,CAAC,CAACK,WAAF,GAAgBL,CAAC,CAACI,aADrB,CAFF;;AAKA,UACGJ,CAAC,CAACK,WAAF,GAAgBL,CAAC,CAACI,aAAlB,IAAmCznB,MAAM,IAAIqnB,CAAC,CAACK,WAAhD,IACCL,CAAC,CAACK,WAAF,GAAgBL,CAAC,CAACI,aAAlB,IAAmCznB,MAAM,IAAIqnB,CAAC,CAACK,WADhD,IAEAL,CAAC,CAACK,WAAF,KAAkBL,CAAC,CAACI,aAHtB,EAIE;AACAznB,QAAAA,MAAM,GAAGqnB,CAAC,CAACK,WAAX;AACA1P,QAAAA,KAAK,CAACtE,IAAD,CAAL,GAAc,CAAd;AACA,eAAO8E,YAAY,CAAC9E,IAAD,CAAnB;AACD;;AAED4C,MAAAA,MAAM,CAAC5C,IAAD,CAAN,GAAe1T,MAAf;AACD;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASwa,cAAT,CAAwB6M,CAAxB,EAA2B;AACzB;AACA,aAAOA,CAAC,GAAG,GAAJ,GAAU,IAAIA,CAAJ,GAAQA,CAAlB,GAAsB,CAAC,CAAD,GAAK,CAAC,IAAI,IAAIA,CAAT,IAAcA,CAAhD;AACD;AACD;AACJ;AACA;AACA;;;AAEI,aAAS/F,gBAAT,GAA4B;AAC1B;AACA;AACA;AACA;AACAD,MAAAA,kBAAkB,CAAC,QAAD,CAAlB;AACD;AACD;AACJ;AACA;AACA;;;AAEI,aAAS0D,WAAT,GAAuB;AACrB,UAAI9M,SAAJ,EAAe;AACb;AACD;;AAEDA,MAAAA,SAAS,GAAG,IAAZ;AACA0P,MAAAA,OAAO;AACR;AACD;AACJ;AACA;AACA;;;AAEI,aAASA,OAAT,GAAmB;AACjB,UAAI7O,SAAJ,EAAe;AACb;AACD;;AAEDpL,MAAAA,MAAM;AACN,UAAI0K,eAAJ,EAAqB4L,YAAY,CAAC5L,eAAD,CAAZ;;AAErB,UAAIpB,iBAAiB,IAAIkB,WAAW,KAAK,IAAzC,EAA+C;AAC7C0P,QAAAA,qBAAqB,CAACD,OAAD,CAArB;AACD,OAFD,MAEO,IACLlQ,QAAQ,CAAC,CAAD,CAAR,IACAA,QAAQ,CAAC,CAAD,CADR,IAEAA,QAAQ,CAAC,CAAD,CAFR,IAGAA,QAAQ,CAAC,CAAD,CAHR,IAIAA,QAAQ,CAAC,CAAD,CAJR,IAKAA,QAAQ,CAAC,CAAD,CALR,IAMAA,QAAQ,CAAC,CAAD,CANR,IAOAA,QAAQ,CAAC,CAAD,CAPR,IAQAA,QAAQ,CAAC,CAAD,CARR,IASAA,QAAQ,CAAC,CAAD,CATR,IAUAnB,MAAM,CAACkD,UAVP,IAWAhB,YAAY,CAAC7K,KAXb,IAYA6K,YAAY,CAAC5K,GAZb,IAaA4K,YAAY,CAAC3K,IAbb,IAcA9G,IAAI,CAACsL,GAAL,CAAS2F,KAAK,CAACpK,GAAf,IAAsB,IAdtB,IAeA7G,IAAI,CAACsL,GAAL,CAAS2F,KAAK,CAACrK,KAAf,IAAwB,IAfxB,IAgBA5G,IAAI,CAACsL,GAAL,CAAS2F,KAAK,CAACnK,IAAf,IAAuB,IAjBlB,EAkBL;AACA6Y,QAAAA,SAAS;;AAET,YACEpQ,MAAM,CAACmD,yBAAP,IAAoC,CAApC,IACApB,eADA,IAEAnB,IAAI,CAACC,GAAL,KAAaF,iBAAb,GAAiCX,MAAM,CAACmD,yBAFxC,IAGA,CAACnD,MAAM,CAACkD,UAJV,EAKE;AACAlD,UAAAA,MAAM,CAACkD,UAAP,GAAoBnB,eAApB;;AAEAhC,UAAAA,KAAK,CAAC2O,MAAN,CAAazM,SAAb,EAAwBlY,WAAxB,EAAqCiY,QAArC,EAA+C,IAA/C;AACD;;AAEDsP,QAAAA,qBAAqB,CAACD,OAAD,CAArB;AACD,OAjCM,MAiCA,IACL3R,QAAQ,KACPA,QAAQ,CAACtE,SAAT,MAAyB4E,MAAM,CAAC9U,OAAP,KAAmB,IAAnB,IAA2BmX,MAD7C,CADH,EAGL;AACAiP,QAAAA,qBAAqB,CAACD,OAAD,CAArB;AACD,OALM,MAKA;AACLlE,QAAAA,SAAS,CAAC,iBAAD,EAAoB;AAC3B9V,UAAAA,KAAK,EAAE0I,KAAK,CAACwR,QAAN,EADoB;AAE3Bja,UAAAA,GAAG,EAAEyI,KAAK,CAACyR,MAAN,EAFsB;AAG3Bja,UAAAA,IAAI,EAAEwI,KAAK,CAAC0R,OAAN;AAHqB,SAApB,CAAT;AAKA9P,QAAAA,SAAS,GAAG,KAAZ;AACAF,QAAAA,QAAQ,GAAG1X,WAAX;AACA,YAAI2nB,mBAAmB,GACrB1R,MAAM,CAACmD,yBAAP,IAAoCvC,IAAI,CAACC,GAAL,KAAaF,iBAAjD,CADF;;AAGA,YAAI+Q,mBAAmB,GAAG,CAA1B,EAA6B;AAC3B5P,UAAAA,eAAe,GAAG/G,UAAU,CAAC,YAAY;AACvCiF,YAAAA,MAAM,CAACkD,UAAP,GAAoBnB,eAApB;;AAEAhC,YAAAA,KAAK,CAAC2O,MAAN,CAAazM,SAAb,EAAwBlY,WAAxB,EAAqCiY,QAArC,EAA+C,IAA/C;;AAEAyM,YAAAA,WAAW;AACZ,WAN2B,EAMzBiD,mBANyB,CAA5B;AAOD,SARD,MAQO,IAAI1R,MAAM,CAACmD,yBAAP,IAAoC,CAApC,IAAyCpB,eAA7C,EAA8D;AACnE/B,UAAAA,MAAM,CAACkD,UAAP,GAAoBnB,eAApB;;AAEAhC,UAAAA,KAAK,CAAC2O,MAAN,CAAazM,SAAb,EAAwBlY,WAAxB,EAAqCiY,QAArC,EAA+C,IAA/C;;AAEAyM,UAAAA,WAAW;AACZ;AACF;AACF;AACD;AACJ;AACA;AACA;;;AAEI,aAASrX,MAAT,GAAkB;AAChB,UAAIua,MAAJ;;AAEA,UAAI/iB,MAAJ,EAAY;AACV,YAAI1E,MAAM,GAAGwV,QAAQ,CAACpE,SAAT,EAAb;;AAEA,YAAI0E,MAAM,CAACkD,UAAP,KAAsB,KAA1B,EAAiC;AAC/B;AACA,cAAIlD,MAAM,CAAC1I,GAAP,GAAa,GAAjB,EAAsB;AACpB0I,YAAAA,MAAM,CAAC1I,GAAP,IAAc,GAAd;AACD,WAFD,MAEO,IAAI0I,MAAM,CAAC1I,GAAP,GAAa,CAAC,GAAlB,EAAuB;AAC5B0I,YAAAA,MAAM,CAAC1I,GAAP,IAAc,GAAd;AACD;AACF,SAVS,CAUR;;;AAEFqa,QAAAA,MAAM,GAAG3R,MAAM,CAAC1I,GAAhB,CAZU,CAYW;;AAErB,YAAIsa,OAAO,GAAG,CAAd;;AAEA,YAAI5R,MAAM,CAACgE,sBAAX,EAAmC;AACjC,cAAI6N,KAAK,GAAG7R,MAAM,CAACzI,IAAP,GAAc,CAA1B;AAAA,cACEua,KAAK,GACFrhB,IAAI,CAAC0H,KAAL,CACC1H,IAAI,CAACqI,GAAL,CAAU+Y,KAAK,GAAG,GAAT,GAAgBphB,IAAI,CAAC4D,EAA9B,CADD,EAECnK,MAAM,CAACG,KAAP,GAAeH,MAAM,CAACI,MAFvB,IAIC,GAJF,GAKAmG,IAAI,CAAC4D,EAPT;AAAA,cAQE0d,UAAU,GAAG/R,MAAM,CAACnU,IAAP,GAAcmU,MAAM,CAACpU,IARpC;;AAUA,cAAImmB,UAAJ,EAAgB;AACdD,YAAAA,KAAK,IACF,IACCrhB,IAAI,CAACyH,GAAL,CACEzH,IAAI,CAACoH,GAAL,CAAU,CAACmI,MAAM,CAAC3I,KAAP,GAAewa,KAAhB,IAAyB,GAA1B,GAAiCphB,IAAI,CAAC4D,EAA/C,CADF,EAEE5D,IAAI,CAACoH,GAAL,CAAU,CAACmI,MAAM,CAAC3I,KAAP,GAAewa,KAAhB,IAAyB,GAA1B,GAAiCphB,IAAI,CAAC4D,EAA/C,CAFF,CAFC,CAAL;AAMD,WAPD,MAOO;AACLud,YAAAA,OAAO,GACLC,KAAK,IACJ,IACCphB,IAAI,CAACyH,GAAL,CACEzH,IAAI,CAACoH,GAAL,CAAU,CAACmI,MAAM,CAAC3I,KAAP,GAAeya,KAAhB,IAAyB,GAA1B,GAAiCrhB,IAAI,CAAC4D,EAA/C,CADF,EAEE5D,IAAI,CAACoH,GAAL,CAAU,CAACmI,MAAM,CAAC3I,KAAP,GAAeya,KAAhB,IAAyB,GAA1B,GAAiCrhB,IAAI,CAAC4D,EAA/C,CAFF,CAFG,CADP;AAOD;AACF,SA3CS,CA2CR;;;AAEF,YAAI2d,QAAQ,GAAGhS,MAAM,CAACgD,MAAP,GAAgBhD,MAAM,CAAC+C,MAAtC;AAAA,YACEA,MAAM,GAAG,CAAC,GADZ;AAAA,YAEEC,MAAM,GAAG,GAFX;;AAIA,YAAIgP,QAAQ,GAAG,GAAf,EAAoB;AAClBjP,UAAAA,MAAM,GAAG/C,MAAM,CAAC+C,MAAP,GAAgB/C,MAAM,CAACzI,IAAP,GAAc,CAA9B,GAAkCqa,OAA3C;AACA5O,UAAAA,MAAM,GAAGhD,MAAM,CAACgD,MAAP,GAAgBhD,MAAM,CAACzI,IAAP,GAAc,CAA9B,GAAkCqa,OAA3C;;AAEA,cAAII,QAAQ,GAAGhS,MAAM,CAACzI,IAAtB,EAA4B;AAC1B;AACAwL,YAAAA,MAAM,GAAGC,MAAM,GAAG,CAACD,MAAM,GAAGC,MAAV,IAAoB,CAAtC;AACD;;AAEDhD,UAAAA,MAAM,CAAC1I,GAAP,GAAa7G,IAAI,CAACC,GAAL,CAASqS,MAAT,EAAiBtS,IAAI,CAACyH,GAAL,CAAS8K,MAAT,EAAiBhD,MAAM,CAAC1I,GAAxB,CAAjB,CAAb;AACD;;AAED,YAAI,EAAE0I,MAAM,CAACkD,UAAP,KAAsB,KAAxB,CAAJ,EAAoC;AAClC;AACA;AACA,cAAIlD,MAAM,CAAC1I,GAAP,GAAa,GAAjB,EAAsB;AACpB0I,YAAAA,MAAM,CAAC1I,GAAP,IAAc,GAAd;AACD,WAFD,MAEO,IAAI0I,MAAM,CAAC1I,GAAP,GAAa,CAAC,GAAlB,EAAuB;AAC5B0I,YAAAA,MAAM,CAAC1I,GAAP,IAAc,GAAd;AACD;AACF,SArES,CAqER;AACF;;;AAEA,YACE0I,MAAM,CAACkD,UAAP,KAAsB,KAAtB,IACAyO,MAAM,IAAI3R,MAAM,CAAC1I,GADjB,IAEAmK,QAAQ,KAAK1X,WAHf,EAIE;AACA;AACAiW,UAAAA,MAAM,CAACkD,UAAP,IAAqB,CAAC,CAAtB;AACD,SA/ES,CA+ER;;;AAEF,YAAI7J,IAAI,GACJ,IACA5I,IAAI,CAAC6I,IAAL,CACE7I,IAAI,CAACqI,GAAL,CAAUkH,MAAM,CAACzI,IAAP,GAAc,GAAf,GAAsB9G,IAAI,CAAC4D,EAA3B,GAAgC,GAAzC,KACGnK,MAAM,CAACG,KAAP,GAAeH,MAAM,CAACI,MADzB,CADF,CADD,GAKCmG,IAAI,CAAC4D,EALP,GAMA,GAPF;AAQA,YAAIwO,QAAQ,GAAG7C,MAAM,CAAC6C,QAAP,GAAkBxJ,IAAI,GAAG,CAAxC;AAAA,YACEyJ,QAAQ,GAAG9C,MAAM,CAAC8C,QAAP,GAAkBzJ,IAAI,GAAG,CADtC;AAEA,YAAI4Y,UAAU,GAAGjS,MAAM,CAAC8C,QAAP,GAAkB9C,MAAM,CAAC6C,QAA1C;;AAEA,YAAIoP,UAAU,GAAG5Y,IAAjB,EAAuB;AACrB;AACAwJ,UAAAA,QAAQ,GAAGC,QAAQ,GAAG,CAACD,QAAQ,GAAGC,QAAZ,IAAwB,CAA9C;AACD;;AAED,YAAIoP,KAAK,CAACrP,QAAD,CAAT,EAAqBA,QAAQ,GAAG,CAAC,EAAZ;AACrB,YAAIqP,KAAK,CAACpP,QAAD,CAAT,EAAqBA,QAAQ,GAAG,EAAX;AACrB9C,QAAAA,MAAM,CAAC3I,KAAP,GAAe5G,IAAI,CAACC,GAAL,CAASmS,QAAT,EAAmBpS,IAAI,CAACyH,GAAL,CAAS4K,QAAT,EAAmB9C,MAAM,CAAC3I,KAA1B,CAAnB,CAAf;AACAqI,QAAAA,QAAQ,CAACtI,MAAT,CACG4I,MAAM,CAAC3I,KAAP,GAAe5G,IAAI,CAAC4D,EAArB,GAA2B,GAD7B,EAEG2L,MAAM,CAAC1I,GAAP,GAAa7G,IAAI,CAAC4D,EAAnB,GAAyB,GAF3B,EAGG2L,MAAM,CAACzI,IAAP,GAAc9G,IAAI,CAAC4D,EAApB,GAA0B,GAH5B,EAIE;AACEoD,UAAAA,IAAI,EAAGuI,MAAM,CAACvI,IAAP,GAAchH,IAAI,CAAC4D,EAApB,GAA0B;AADlC,SAJF;AAQA8d,QAAAA,cAAc,GA7GJ,CA6GQ;;AAElB,YAAInS,MAAM,CAAC2H,OAAX,EAAoB;AAClBA,UAAAA,OAAO,CAACvd,KAAR,CAAc4O,SAAd,GACE,aAAa,CAACgH,MAAM,CAAC1I,GAAR,GAAc0I,MAAM,CAACqD,WAAlC,IAAiD,MADnD;AAEAsE,UAAAA,OAAO,CAACvd,KAAR,CAAcgP,eAAd,GACE,aAAa,CAAC4G,MAAM,CAAC1I,GAAR,GAAc0I,MAAM,CAACqD,WAAlC,IAAiD,MADnD;AAED;AACF;AACF;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAAS+O,UAAT,CAAoBha,CAApB,EAAuBR,CAAvB,EAA0BG,CAA1B,EAA6BC,CAA7B,EAAgC;AAC9B,WAAKI,CAAL,GAASA,CAAT;AACA,WAAKR,CAAL,GAASA,CAAT;AACA,WAAKG,CAAL,GAASA,CAAT;AACA,WAAKC,CAAL,GAASA,CAAT;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEIoa,IAAAA,UAAU,CAAC5rB,SAAX,CAAqB6rB,QAArB,GAAgC,UAAUC,CAAV,EAAa;AAC3C,aAAO,IAAIF,UAAJ,CACL,KAAKha,CAAL,GAASka,CAAC,CAACla,CAAX,GAAe,KAAKR,CAAL,GAAS0a,CAAC,CAAC1a,CAA1B,GAA8B,KAAKG,CAAL,GAASua,CAAC,CAACva,CAAzC,GAA6C,KAAKC,CAAL,GAASsa,CAAC,CAACta,CADnD,EAEL,KAAKJ,CAAL,GAAS0a,CAAC,CAACla,CAAX,GAAe,KAAKA,CAAL,GAASka,CAAC,CAAC1a,CAA1B,GAA8B,KAAKG,CAAL,GAASua,CAAC,CAACta,CAAzC,GAA6C,KAAKA,CAAL,GAASsa,CAAC,CAACva,CAFnD,EAGL,KAAKA,CAAL,GAASua,CAAC,CAACla,CAAX,GAAe,KAAKA,CAAL,GAASka,CAAC,CAACva,CAA1B,GAA8B,KAAKC,CAAL,GAASsa,CAAC,CAAC1a,CAAzC,GAA6C,KAAKA,CAAL,GAAS0a,CAAC,CAACta,CAHnD,EAIL,KAAKA,CAAL,GAASsa,CAAC,CAACla,CAAX,GAAe,KAAKA,CAAL,GAASka,CAAC,CAACta,CAA1B,GAA8B,KAAKJ,CAAL,GAAS0a,CAAC,CAACva,CAAzC,GAA6C,KAAKA,CAAL,GAASua,CAAC,CAAC1a,CAJnD,CAAP;AAMD,KAPD;AAQA;AACJ;AACA;AACA;AACA;;;AAEIwa,IAAAA,UAAU,CAAC5rB,SAAX,CAAqB+rB,aAArB,GAAqC,YAAY;AAC/C,UAAI1W,GAAG,GAAGpL,IAAI,CAAC0H,KAAL,CACN,KAAK,KAAKC,CAAL,GAAS,KAAKR,CAAd,GAAkB,KAAKG,CAAL,GAAS,KAAKC,CAArC,CADM,EAEN,IAAI,KAAK,KAAKJ,CAAL,GAAS,KAAKA,CAAd,GAAkB,KAAKG,CAAL,GAAS,KAAKA,CAArC,CAFE,CAAV;AAAA,UAIE/D,KAAK,GAAGvD,IAAI,CAACwH,IAAL,CAAU,KAAK,KAAKG,CAAL,GAAS,KAAKL,CAAd,GAAkB,KAAKC,CAAL,GAAS,KAAKJ,CAArC,CAAV,CAJV;AAAA,UAKE7D,GAAG,GAAGtD,IAAI,CAAC0H,KAAL,CACJ,KAAK,KAAKC,CAAL,GAAS,KAAKJ,CAAd,GAAkB,KAAKJ,CAAL,GAAS,KAAKG,CAArC,CADI,EAEJ,IAAI,KAAK,KAAKA,CAAL,GAAS,KAAKA,CAAd,GAAkB,KAAKC,CAAL,GAAS,KAAKA,CAArC,CAFA,CALR;AASA,aAAO,CAAC6D,GAAD,EAAM7H,KAAN,EAAaD,GAAb,CAAP;AACD,KAXD;AAYA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAASye,qBAAT,CAA+B1kB,KAA/B,EAAsC2kB,IAAtC,EAA4CC,KAA5C,EAAmD;AACjD,UAAI7Z,CAAC,GAAG,CACN4Z,IAAI,GAAIA,IAAI,GAAGhiB,IAAI,CAAC4D,EAAb,GAAmB,GAAnB,GAAyB,CAA5B,GAAgC,CAD9B,EAENqe,KAAK,GAAIA,KAAK,GAAGjiB,IAAI,CAAC4D,EAAd,GAAoB,GAApB,GAA0B,CAA7B,GAAiC,CAFhC,EAGNvG,KAAK,GAAIA,KAAK,GAAG2C,IAAI,CAAC4D,EAAd,GAAoB,GAApB,GAA0B,CAA7B,GAAiC,CAHhC,CAAR;AAKA,UAAIgJ,CAAC,GAAG,CAAC5M,IAAI,CAACoH,GAAL,CAASgB,CAAC,CAAC,CAAD,CAAV,CAAD,EAAiBpI,IAAI,CAACoH,GAAL,CAASgB,CAAC,CAAC,CAAD,CAAV,CAAjB,EAAiCpI,IAAI,CAACoH,GAAL,CAASgB,CAAC,CAAC,CAAD,CAAV,CAAjC,CAAR;AAAA,UACEhM,CAAC,GAAG,CAAC4D,IAAI,CAACqH,GAAL,CAASe,CAAC,CAAC,CAAD,CAAV,CAAD,EAAiBpI,IAAI,CAACqH,GAAL,CAASe,CAAC,CAAC,CAAD,CAAV,CAAjB,EAAiCpI,IAAI,CAACqH,GAAL,CAASe,CAAC,CAAC,CAAD,CAAV,CAAjC,CADN;AAEA,aAAO,IAAIuZ,UAAJ,CACL/U,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAf,GAAqBxQ,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAD/B,EAELA,CAAC,CAAC,CAAD,CAAD,GAAOwQ,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAAf,GAAqBA,CAAC,CAAC,CAAD,CAAD,GAAOxQ,CAAC,CAAC,CAAD,CAAR,GAAcA,CAAC,CAAC,CAAD,CAF/B,EAGLwQ,CAAC,CAAC,CAAD,CAAD,GAAOxQ,CAAC,CAAC,CAAD,CAAR,GAAcwQ,CAAC,CAAC,CAAD,CAAf,GAAqBxQ,CAAC,CAAC,CAAD,CAAD,GAAOwQ,CAAC,CAAC,CAAD,CAAR,GAAcxQ,CAAC,CAAC,CAAD,CAH/B,EAILwQ,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcxQ,CAAC,CAAC,CAAD,CAAf,GAAqBA,CAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAcwQ,CAAC,CAAC,CAAD,CAJ/B,CAAP;AAMD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAASsV,iBAAT,CAA2B7kB,KAA3B,EAAkC2kB,IAAlC,EAAwCC,KAAxC,EAA+C;AAC7C;AACA,UAAIE,UAAU,GAAGJ,qBAAqB,CAAC1kB,KAAD,EAAQ2kB,IAAR,EAAcC,KAAd,CAAtC,CAF6C,CAEe;;AAE5DE,MAAAA,UAAU,GAAGA,UAAU,CAACP,QAAX,CACX,IAAID,UAAJ,CAAe3hB,IAAI,CAAC8H,IAAL,CAAU,GAAV,CAAf,EAA+B,CAAC9H,IAAI,CAAC8H,IAAL,CAAU,GAAV,CAAhC,EAAgD,CAAhD,EAAmD,CAAnD,CADW,CAAb,CAJ6C,CAM1C;;AAEH,UAAI4E,KAAK,GAAGtT,MAAM,CAAC+X,WAAP,GACP,CAAC/X,MAAM,CAAC+X,WAAR,GAAsBnR,IAAI,CAAC4D,EAA5B,GAAkC,GAAlC,GAAwC,CADhC,GAER,CAFJ;AAGA,aAAOue,UAAU,CAACP,QAAX,CACL,IAAID,UAAJ,CAAe3hB,IAAI,CAACoH,GAAL,CAASsF,KAAT,CAAf,EAAgC,CAAhC,EAAmC,CAAC1M,IAAI,CAACqH,GAAL,CAASqF,KAAT,CAApC,EAAqD,CAArD,CADK,CAAP;AAGD;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAAS0V,mBAAT,CAA6B5tB,CAA7B,EAAgC;AAC9B,UAAIA,CAAC,CAACiJ,cAAF,CAAiB,mBAAjB,CAAJ,EAA2CjJ,CAAC,CAAC6tB,iBAAF;AAC3C,UAAIR,CAAC,GAAGK,iBAAiB,CAAC1tB,CAAC,CAAC6I,KAAH,EAAU7I,CAAC,CAACwtB,IAAZ,EAAkBxtB,CAAC,CAACytB,KAApB,CAAjB,CAA4CH,aAA5C,EAAR;;AAEA,UAAI,OAAO3Q,WAAP,KAAuB,QAAvB,IAAmCA,WAAW,GAAG,EAArD,EAAyD;AACvD;AACA;AACA;AACA;AACAA,QAAAA,WAAW,IAAI,CAAf;AACD,OAND,MAMO,IAAIA,WAAW,KAAK,EAApB,EAAwB;AAC7B;AACAC,QAAAA,oBAAoB,GAAIyQ,CAAC,CAAC,CAAD,CAAD,GAAO7hB,IAAI,CAAC4D,EAAb,GAAmB,GAAnB,GAAyB2L,MAAM,CAAC1I,GAAvD;AACAsK,QAAAA,WAAW,GAAG,IAAd;AACA0P,QAAAA,qBAAqB,CAACD,OAAD,CAArB;AACD,OALM,MAKA;AACLrR,QAAAA,MAAM,CAAC3I,KAAP,GAAgBib,CAAC,CAAC,CAAD,CAAD,GAAO7hB,IAAI,CAAC4D,EAAb,GAAmB,GAAlC;AACA2L,QAAAA,MAAM,CAACvI,IAAP,GAAe,CAAC6a,CAAC,CAAC,CAAD,CAAF,GAAQ7hB,IAAI,CAAC4D,EAAd,GAAoB,GAAlC;AACA2L,QAAAA,MAAM,CAAC1I,GAAP,GAAc,CAACgb,CAAC,CAAC,CAAD,CAAF,GAAQ7hB,IAAI,CAAC4D,EAAd,GAAoB,GAApB,GAA0BwN,oBAAvC;AACD;AACF;AACD;AACJ;AACA;AACA;;;AAEI,aAASgK,UAAT,GAAsB;AACpB,UAAI;AACF,YAAI7f,MAAM,GAAG,EAAb;AACA,YAAIgU,MAAM,CAACpP,YAAP,KAAwB7G,WAA5B,EACEiC,MAAM,CAAC4E,YAAP,GAAuBoP,MAAM,CAACpP,YAAP,GAAsBH,IAAI,CAAC4D,EAA5B,GAAkC,GAAxD;AACF,YAAI2L,MAAM,CAACnP,WAAP,KAAuB9G,WAA3B,EACEiC,MAAM,CAAC6E,WAAP,GAAsBmP,MAAM,CAACnP,WAAP,GAAqBJ,IAAI,CAAC4D,EAA3B,GAAiC,GAAtD;AACF,YAAI2L,MAAM,CAAC1S,eAAP,KAA2BvD,WAA/B,EACEiC,MAAM,CAACsB,eAAP,GAAyB0S,MAAM,CAAC1S,eAAhC;AACFoS,QAAAA,QAAQ,CAAClU,IAAT,CACEgW,SADF,EAEExB,MAAM,CAAC7T,IAFT,EAGE6T,MAAM,CAAC9U,OAHT,EAIG8U,MAAM,CAACpU,IAAP,GAAc6E,IAAI,CAAC4D,EAApB,GAA0B,GAJ5B,EAKG2L,MAAM,CAACnU,IAAP,GAAc4E,IAAI,CAAC4D,EAApB,GAA0B,GAL5B,EAMG2L,MAAM,CAACiD,OAAP,GAAiBxS,IAAI,CAAC4D,EAAvB,GAA6B,GAN/B,EAOE0e,kBAPF,EAQE/mB,MARF;;AAWA,YAAIgU,MAAM,CAAC9U,OAAP,KAAmB,IAAvB,EAA6B;AAC3B;AACAsW,UAAAA,SAAS,GAAGzX,WAAZ;AACD;AACF,OAvBD,CAuBE,OAAOsjB,KAAP,EAAc;AACd;AACA;AACA,YAAIA,KAAK,CAAClhB,IAAN,KAAe,aAAf,IAAgCkhB,KAAK,CAAClhB,IAAN,KAAe,UAAnD,EAA+D;AAC7D6b,UAAAA,OAAO;AACR,SAFD,MAEO,IAAIqF,KAAK,CAAClhB,IAAN,KAAe,kBAAnB,EAAuC;AAC5C6b,UAAAA,OAAO,CACLhI,MAAM,CAACwE,MAAP,CAAcS,gBAAd,CACGnV,OADH,CACW,IADX,EACiBud,KAAK,CAAChjB,KADvB,EAEGyF,OAFH,CAEW,IAFX,EAEiBud,KAAK,CAAC/c,QAFvB,CADK,CAAP;AAKD,SANM,MAMA;AACL0X,UAAAA,OAAO,CAAChI,MAAM,CAACwE,MAAP,CAAcU,YAAf,CAAP;AACA,gBAAMmI,KAAN;AACD;AACF;AACF;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAAS0F,kBAAT,GAA8B;AAC5B;AACA,UAAI/S,MAAM,CAACgT,iBAAP,IAA4BtT,QAAQ,CAACuT,OAAT,KAAqBlpB,WAArD,EAAkE;AAChE2V,QAAAA,QAAQ,CAACuT,OAAT,CAAiB7oB,KAAjB,CAAuByjB,OAAvB,GAAiC,CAAjC,CADgE,CAC5B;;AAEpC,YAAIoF,OAAO,GAAGvT,QAAQ,CAACuT,OAAvB;AACA,eAAOvT,QAAQ,CAACuT,OAAhB;AACAlY,QAAAA,UAAU,CAAC,YAAY;AACrByK,UAAAA,eAAe,CAAClX,WAAhB,CAA4B2kB,OAA5B;AACA9F,UAAAA,SAAS,CAAC,qBAAD,CAAT;AACD,SAHS,EAGPnN,MAAM,CAACgT,iBAHA,CAAV;AAID,OAX2B,CAW1B;;;AAEF,UAAIhT,MAAM,CAAC2H,OAAX,EAAoB;AAClBA,QAAAA,OAAO,CAACvd,KAAR,CAAc6d,OAAd,GAAwB,QAAxB;AACD,OAFD,MAEO;AACLN,QAAAA,OAAO,CAACvd,KAAR,CAAc6d,OAAd,GAAwB,MAAxB;AACD,OAjB2B,CAiB1B;;;AAEFiL,MAAAA,cAAc,GAnBc,CAmBV;;AAElBrN,MAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,CAAqB/b,KAArB,CAA2B6d,OAA3B,GAAqC,MAArC;;AAEA,UAAI7H,OAAO,KAAKrW,WAAhB,EAA6B;AAC3Byb,QAAAA,eAAe,CAAClX,WAAhB,CAA4B8R,OAA5B;AACAA,QAAAA,OAAO,GAAGrW,WAAV;AACD;;AAED6E,MAAAA,MAAM,GAAG,IAAT;AACA6f,MAAAA,WAAW;AACXtB,MAAAA,SAAS,CAAC,MAAD,CAAT;AACD;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASgG,aAAT,CAAuBC,EAAvB,EAA2B;AACzB;AACAA,MAAAA,EAAE,CAAC/b,KAAH,GAAWmV,MAAM,CAAC4G,EAAE,CAAC/b,KAAJ,CAAN,IAAoB,CAA/B;AACA+b,MAAAA,EAAE,CAAC9b,GAAH,GAASkV,MAAM,CAAC4G,EAAE,CAAC9b,GAAJ,CAAN,IAAkB,CAA3B;AACA,UAAIwQ,GAAG,GAAGhe,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAV;AACA2d,MAAAA,GAAG,CAACvZ,SAAJ,GAAgB,mBAAhB;AACA,UAAI6kB,EAAE,CAACC,QAAP,EAAiBvL,GAAG,CAACvZ,SAAJ,IAAiB,MAAM6kB,EAAE,CAACC,QAA1B,CAAjB,KAEEvL,GAAG,CAACvZ,SAAJ,IACE,oCAAoC+kB,UAAU,CAACF,EAAE,CAACjnB,IAAJ,CADhD;AAEF,UAAIonB,IAAI,GAAGzpB,QAAQ,CAACK,aAAT,CAAuB,MAAvB,CAAX;AACA,UAAIipB,EAAE,CAACI,IAAP,EAAaD,IAAI,CAAC5N,SAAL,GAAiB2N,UAAU,CAACF,EAAE,CAACI,IAAJ,CAA3B;AACb,UAAIjY,CAAJ;;AAEA,UAAI6X,EAAE,CAACK,KAAP,EAAc;AACZ,YAAIA,KAAK,GAAG3pB,QAAQ,CAACK,aAAT,CAAuB,OAAvB,CAAZ;AAAA,YACEupB,IAAI,GAAGN,EAAE,CAACK,KADZ;AAEA,YAAIzT,MAAM,CAACvR,QAAP,IAAmB,CAACqa,WAAW,CAAC4K,IAAD,CAAnC,EACEA,IAAI,GAAG1T,MAAM,CAACvR,QAAP,GAAkBilB,IAAzB;AACFD,QAAAA,KAAK,CAAC5jB,GAAN,GAAYkZ,WAAW,CAAC2K,IAAD,CAAvB;AACAD,QAAAA,KAAK,CAAC/M,QAAN,GAAiB,IAAjB;AACA+M,QAAAA,KAAK,CAACrpB,KAAN,CAAYC,KAAZ,GAAoB+oB,EAAE,CAAC/oB,KAAH,GAAW,IAA/B;AACAmb,QAAAA,eAAe,CAACjb,WAAhB,CAA4Bud,GAA5B;AACAyL,QAAAA,IAAI,CAAChpB,WAAL,CAAiBkpB,KAAjB;AACD,OAVD,MAUO,IAAIL,EAAE,CAACpoB,KAAP,EAAc;AACnB,YAAI2oB,IAAI,GAAGP,EAAE,CAACpoB,KAAd;AACA,YAAIgV,MAAM,CAACvR,QAAP,IAAmB,CAACqa,WAAW,CAAC6K,IAAD,CAAnC,EACEA,IAAI,GAAG3T,MAAM,CAACvR,QAAP,GAAkBklB,IAAzB;AACFpY,QAAAA,CAAC,GAAGzR,QAAQ,CAACK,aAAT,CAAuB,GAAvB,CAAJ;AACAoR,QAAAA,CAAC,CAACoN,IAAF,GAASI,WAAW,CAACqK,EAAE,CAACpK,GAAH,GAASoK,EAAE,CAACpK,GAAZ,GAAkB2K,IAAnB,CAApB;AACApY,QAAAA,CAAC,CAAC7V,MAAF,GAAW,QAAX;AACA6tB,QAAAA,IAAI,CAAChpB,WAAL,CAAiBgR,CAAjB;AACA,YAAIvQ,KAAK,GAAGlB,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAZ;AACAa,QAAAA,KAAK,CAAC6E,GAAN,GAAYkZ,WAAW,CAAC4K,IAAD,CAAvB;AACA3oB,QAAAA,KAAK,CAACZ,KAAN,CAAYC,KAAZ,GAAoB+oB,EAAE,CAAC/oB,KAAH,GAAW,IAA/B;AACAW,QAAAA,KAAK,CAACZ,KAAN,CAAYwpB,UAAZ,GAAyB,KAAzB;AACApO,QAAAA,eAAe,CAACjb,WAAhB,CAA4Bud,GAA5B;AACAvM,QAAAA,CAAC,CAAChR,WAAF,CAAcS,KAAd;AACAuoB,QAAAA,IAAI,CAACnpB,KAAL,CAAWkG,QAAX,GAAsB,SAAtB;AACD,OAfM,MAeA,IAAI8iB,EAAE,CAACpK,GAAP,EAAY;AACjBzN,QAAAA,CAAC,GAAGzR,QAAQ,CAACK,aAAT,CAAuB,GAAvB,CAAJ;AACAoR,QAAAA,CAAC,CAACoN,IAAF,GAASI,WAAW,CAACqK,EAAE,CAACpK,GAAJ,CAApB;;AAEA,YAAIoK,EAAE,CAACS,UAAP,EAAmB;AACjB,eAAK,IAAIztB,GAAT,IAAgBgtB,EAAE,CAACS,UAAnB,EAA+B;AAC7BtY,YAAAA,CAAC,CAACuY,YAAF,CAAe1tB,GAAf,EAAoBgtB,EAAE,CAACS,UAAH,CAAcztB,GAAd,CAApB;AACD;AACF,SAJD,MAIO;AACLmV,UAAAA,CAAC,CAAC7V,MAAF,GAAW,QAAX;AACD;;AAED8f,QAAAA,eAAe,CAACjb,WAAhB,CAA4BgR,CAA5B;AACAuM,QAAAA,GAAG,CAACvZ,SAAJ,IAAiB,eAAjB;AACAglB,QAAAA,IAAI,CAAChlB,SAAL,IAAkB,eAAlB;AACAgN,QAAAA,CAAC,CAAChR,WAAF,CAAcud,GAAd;AACD,OAhBM,MAgBA;AACL,YAAIsL,EAAE,CAACW,OAAP,EAAgB;AACdjM,UAAAA,GAAG,CAACkM,OAAJ,GAAclM,GAAG,CAACmM,UAAJ,GAAiB,YAAY;AACzC,gBAAI,CAACnM,GAAG,CAACoM,OAAT,EAAkB;AAChBpM,cAAAA,GAAG,CAACoM,OAAJ,GAAc,IAAd;AACAjU,cAAAA,UAAU,GAAGmT,EAAE,CAAC/b,KAAhB;AACA6I,cAAAA,QAAQ,GAAGkT,EAAE,CAAC9b,GAAd;AACA6I,cAAAA,SAAS,GAAGJ,KAAK,CAAC0R,OAAN,EAAZ;AACA1W,cAAAA,UAAU,CAAC,YAAY;AACrBoZ,gBAAAA,WAAW,CAACpU,KAAK,CAAC0R,OAAN,EAAD,EAAkBnR,kBAAlB,CAAX;AACD,eAFS,EAEP,EAFO,CAAV,CALgB,CAOR;;AACR6T,cAAAA,WAAW,CAAC,EAAD,EAAK5T,kBAAL,CAAX,CARgB,CAQqB;;AACrCxF,cAAAA,UAAU,CAAC,YAAY;AACrBgF,gBAAAA,KAAK,CAACqU,SAAN,CAAgBhB,EAAE,CAACW,OAAnB,EAA4B9T,UAA5B,EAAwCC,QAAxC,EAAkD,GAAlD;AACD,eAFS,EAEPO,WAFO,CAAV,CATgB,CAWC;AACjB;AACA;AACA;AACA;AACA;AACA;AACD;;AAED,mBAAO,KAAP;AACD,WAtBD;;AAwBAqH,UAAAA,GAAG,CAACvZ,SAAJ,IAAiB,eAAjB;AACAglB,UAAAA,IAAI,CAAChlB,SAAL,IAAkB,eAAlB;AACD;;AAEDiX,QAAAA,eAAe,CAACjb,WAAhB,CAA4Bud,GAA5B;AACD;;AAED,UAAIsL,EAAE,CAACiB,iBAAP,EAA0B;AACxBjB,QAAAA,EAAE,CAACiB,iBAAH,CAAqBvM,GAArB,EAA0BsL,EAAE,CAACkB,iBAA7B;AACD,OAFD,MAEO,IAAIlB,EAAE,CAACI,IAAH,IAAWJ,EAAE,CAACK,KAAd,IAAuBL,EAAE,CAACpoB,KAA9B,EAAqC;AAC1C8c,QAAAA,GAAG,CAAC1C,SAAJ,CAAcC,GAAd,CAAkB,cAAlB;AACAyC,QAAAA,GAAG,CAACvd,WAAJ,CAAgBgpB,IAAhB;AACAA,QAAAA,IAAI,CAACnpB,KAAL,CAAWmqB,SAAX,GAAuB,YAAvB;AACAhB,QAAAA,IAAI,CAACnpB,KAAL,CAAWC,KAAX,GAAmBkpB,IAAI,CAACiB,WAAL,GAAmB,EAAnB,GAAwB,IAA3C;AACAjB,QAAAA,IAAI,CAACnpB,KAAL,CAAWqqB,UAAX,GACE,EAAElB,IAAI,CAACiB,WAAL,GAAmB1M,GAAG,CAAC4M,WAAzB,IAAwC,CAAxC,GAA4C,IAD9C;AAEAnB,QAAAA,IAAI,CAACnpB,KAAL,CAAWuqB,SAAX,GAAuB,CAACpB,IAAI,CAACqB,YAAN,GAAqB,EAArB,GAA0B,IAAjD;AACD;;AAED,UAAIxB,EAAE,CAACyB,gBAAP,EAAyB;AACvB/M,QAAAA,GAAG,CAAC3J,gBAAJ,CACE,OADF,EAEE,UAAUlZ,CAAV,EAAa;AACXmuB,UAAAA,EAAE,CAACyB,gBAAH,CAAoB5vB,CAApB,EAAuBmuB,EAAE,CAAC0B,gBAA1B;AACD,SAJH,EAKE,OALF;AAOAhN,QAAAA,GAAG,CAACvZ,SAAJ,IAAiB,eAAjB;AACAglB,QAAAA,IAAI,CAAChlB,SAAL,IAAkB,eAAlB;AACD;;AAED6kB,MAAAA,EAAE,CAACtL,GAAH,GAASA,GAAT;AACD;;AAED,aAASqM,WAAT,CAAqBY,KAArB,EAA4BC,KAA5B,EAAmC;AACjC;AACA,UAAIC,EAAE,GAAGhV,UAAT,CAFiC,CAEZ;;AACrB,UAAIiV,EAAE,GAAGhV,QAAT,CAHiC,CAGd;;AACnB,UAAIiV,EAAE,GAAGJ,KAAT,CAJiC,CAIjB;;AAChB,UAAIK,EAAE,GAAGJ,KAAT,CALiC,CAKjB;;AAChBjV,MAAAA,KAAK,CAAC2O,MAAN,CAAauG,EAAb,EAAiBC,EAAjB,EAAqBC,EAArB,EAAyBC,EAAzB;;AACAra,MAAAA,UAAU,CAAC,YAAY;AACrBsa,QAAAA,WAAW,CAACpV,UAAD,EAAaC,QAAb,EAAuBiV,EAAvB,CAAX;AACD,OAFS,EAEP,IAFO,CAAV;AAGD;;AAED,aAASE,WAAT,CAAqBC,MAArB,EAA6BC,IAA7B,EAAmCR,KAAnC,EAA0C;AACxC,UAAIS,IAAI,GAAG,CAAX;AACA,UAAIC,EAAE,GAAGhlB,IAAI,CAAC+O,KAAL,CAAWO,KAAK,CAACwR,QAAN,EAAX,CAAT,CAFwC,CAED;;AACvC,UAAImE,EAAE,GAAGjlB,IAAI,CAAC+O,KAAL,CAAWO,KAAK,CAACyR,MAAN,EAAX,CAAT,CAHwC,CAGH;;AACrC,UAAImE,EAAE,GAAGllB,IAAI,CAAC+O,KAAL,CAAWO,KAAK,CAAC0R,OAAN,EAAX,CAAT,CAJwC,CAIF;;AAEtC,UAAIiE,EAAE,GAAG,GAAT,EAAc;AACZA,QAAAA,EAAE,GAAGA,EAAE,GAAG,GAAV;;AACA3V,QAAAA,KAAK,CAAC6V,MAAN,CAAaF,EAAb,EAAiB,CAAjB;AACD;;AACD,UAAIA,EAAE,GAAG,CAAC,GAAV,EAAe;AACbA,QAAAA,EAAE,GAAGA,EAAE,GAAG,GAAV;;AACA3V,QAAAA,KAAK,CAAC6V,MAAN,CAAaF,EAAb,EAAiB,CAAjB;AACD;;AAED,UAAID,EAAE,KAAKH,MAAP,IAAiBI,EAAE,KAAKH,IAAxB,IAAgCI,EAAE,KAAKZ,KAA3C,EAAkD;AAChD;AACA,eAAO,IAAP;AACD,OAHD,MAGO;AACLha,QAAAA,UAAU,CAAC,YAAY;AACrBsa,UAAAA,WAAW,CAACC,MAAD,EAASC,IAAT,EAAeR,KAAf,CAAX;AACD,SAFS,EAEP,EAFO,CAAV;AAGD;AACF;;AAED,aAASc,iBAAT,GAA6B;AAC3B;AACA1B,MAAAA,WAAW,CAAC,GAAD,EAAM3T,oBAAN,CAAX;AACD;AACD;AACJ;AACA;AACA;;;AAEI,aAAS0S,cAAT,GAA0B;AACxB,UAAI3Q,eAAJ,EAAqB;;AAErB,UAAI,CAACvC,MAAM,CAAC8V,QAAZ,EAAsB;AACpB9V,QAAAA,MAAM,CAAC8V,QAAP,GAAkB,EAAlB;AACD,OAFD,MAEO;AACL;AACA9V,QAAAA,MAAM,CAAC8V,QAAP,GAAkB9V,MAAM,CAAC8V,QAAP,CAAgB1b,IAAhB,CAAqB,UAAUmB,CAAV,EAAa9C,CAAb,EAAgB;AACrD,iBAAO8C,CAAC,CAAClE,KAAF,GAAUoB,CAAC,CAACpB,KAAnB;AACD,SAFiB,CAAlB;AAGA2I,QAAAA,MAAM,CAAC8V,QAAP,CAAgBpuB,OAAhB,CAAwByrB,aAAxB;AACD;;AAED5Q,MAAAA,eAAe,GAAG,IAAlB;AACA4P,MAAAA,cAAc;AACf;AACD;AACJ;AACA;AACA;;;AAEI,aAAS4D,eAAT,GAA2B;AACzB,UAAI3C,EAAE,GAAGpT,MAAM,CAAC8V,QAAhB;AACAvT,MAAAA,eAAe,GAAG,KAAlB;AACA,aAAOvC,MAAM,CAAC8V,QAAd;;AAEA,UAAI1C,EAAJ,EAAQ;AACN,aAAK,IAAIxtB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwtB,EAAE,CAACvtB,MAAvB,EAA+BD,CAAC,EAAhC,EAAoC;AAClC,cAAIowB,OAAO,GAAG5C,EAAE,CAACxtB,CAAD,CAAF,CAAMkiB,GAApB;;AAEA,cAAIkO,OAAJ,EAAa;AACX,mBACEA,OAAO,CAACC,UAAR,IACAD,OAAO,CAACC,UAAR,IAAsBzQ,eAFxB,EAGE;AACAwQ,cAAAA,OAAO,GAAGA,OAAO,CAACC,UAAlB;AACD;;AAEDzQ,YAAAA,eAAe,CAAClX,WAAhB,CAA4B0nB,OAA5B;AACD;;AAED,iBAAO5C,EAAE,CAACxtB,CAAD,CAAF,CAAMkiB,GAAb;AACD;AACF;AACF;AACD;AACJ;AACA;AACA;;;AAEI,aAASoO,aAAT,CAAuB9C,EAAvB,EAA2B;AACzB,UAAI+C,UAAU,GAAG1lB,IAAI,CAACqH,GAAL,CAAUsb,EAAE,CAAC/b,KAAH,GAAW5G,IAAI,CAAC4D,EAAjB,GAAuB,GAAhC,CAAjB;AAAA,UACE+hB,UAAU,GAAG3lB,IAAI,CAACoH,GAAL,CAAUub,EAAE,CAAC/b,KAAH,GAAW5G,IAAI,CAAC4D,EAAjB,GAAuB,GAAhC,CADf;AAAA,UAEEgiB,cAAc,GAAG5lB,IAAI,CAACqH,GAAL,CAAUkI,MAAM,CAAC3I,KAAP,GAAe5G,IAAI,CAAC4D,EAArB,GAA2B,GAApC,CAFnB;AAAA,UAGEiiB,cAAc,GAAG7lB,IAAI,CAACoH,GAAL,CAAUmI,MAAM,CAAC3I,KAAP,GAAe5G,IAAI,CAAC4D,EAArB,GAA2B,GAApC,CAHnB;AAAA,UAIEkiB,MAAM,GAAG9lB,IAAI,CAACoH,GAAL,CAAU,CAAC,CAACub,EAAE,CAAC9b,GAAJ,GAAU0I,MAAM,CAAC1I,GAAlB,IAAyB7G,IAAI,CAAC4D,EAA/B,GAAqC,GAA9C,CAJX;AAKA,UAAI2D,CAAC,GACHme,UAAU,GAAGE,cAAb,GAA8BD,UAAU,GAAGG,MAAb,GAAsBD,cADtD;;AAGA,UACGlD,EAAE,CAAC9b,GAAH,IAAU,EAAV,IAAgB8b,EAAE,CAAC9b,GAAH,GAAS,CAAC,EAA1B,IAAgCU,CAAC,IAAI,CAAtC,IACC,CAACob,EAAE,CAAC9b,GAAH,GAAS,EAAT,IAAe8b,EAAE,CAAC9b,GAAH,IAAU,CAAC,EAA3B,KAAkCU,CAAC,IAAI,CAF1C,EAGE;AACAob,QAAAA,EAAE,CAACtL,GAAH,CAAO1d,KAAP,CAAaosB,UAAb,GAA0B,QAA1B;AACD,OALD,MAKO;AACL,YAAIC,MAAM,GAAGhmB,IAAI,CAACqH,GAAL,CAAU,CAAC,CAACsb,EAAE,CAAC9b,GAAJ,GAAU0I,MAAM,CAAC1I,GAAlB,IAAyB7G,IAAI,CAAC4D,EAA/B,GAAqC,GAA9C,CAAb;AAAA,YACEqiB,OAAO,GAAGjmB,IAAI,CAACqI,GAAL,CAAUkH,MAAM,CAACzI,IAAP,GAAc9G,IAAI,CAAC4D,EAApB,GAA0B,GAAnC,CADZ;AAEA+e,QAAAA,EAAE,CAACtL,GAAH,CAAO1d,KAAP,CAAaosB,UAAb,GAA0B,SAA1B,CAHK,CAGgC;AACrC;;AAEA,YAAItsB,MAAM,GAAGwV,QAAQ,CAACpE,SAAT,EAAb;AAAA,YACEwT,WAAW,GAAG5kB,MAAM,CAAC+M,WADvB;AAAA,YAEE8X,YAAY,GAAG7kB,MAAM,CAACgN,YAFxB;AAGA,YAAIyf,KAAK,GAAG,CACR,CAAC7H,WAAD,GAAe4H,OAAhB,GAA2BD,MAA3B,GAAoCL,UAArC,GAAmDpe,CAAnD,GAAuD,CAD7C,EAER,CAAC8W,WAAD,GAAe4H,OAAhB,IACEP,UAAU,GAAGG,cAAb,GACCF,UAAU,GAAGG,MAAb,GAAsBF,cAFzB,CAAD,GAGEre,CAHF,GAIE,CANQ,CAAZ,CATK,CAgBF;;AAEH,YAAI4e,OAAO,GAAGnmB,IAAI,CAACqH,GAAL,CAAUkI,MAAM,CAACvI,IAAP,GAAchH,IAAI,CAAC4D,EAApB,GAA0B,GAAnC,CAAd;AAAA,YACEwiB,OAAO,GAAGpmB,IAAI,CAACoH,GAAL,CAAUmI,MAAM,CAACvI,IAAP,GAAchH,IAAI,CAAC4D,EAApB,GAA0B,GAAnC,CADZ;AAEAsiB,QAAAA,KAAK,GAAG,CACNA,KAAK,CAAC,CAAD,CAAL,GAAWE,OAAX,GAAqBF,KAAK,CAAC,CAAD,CAAL,GAAWC,OAD1B,EAEND,KAAK,CAAC,CAAD,CAAL,GAAWC,OAAX,GAAqBD,KAAK,CAAC,CAAD,CAAL,GAAWE,OAF1B,CAAR,CApBK,CAuBF;;AAEHF,QAAAA,KAAK,CAAC,CAAD,CAAL,IAAY,CAAC7H,WAAW,GAAGsE,EAAE,CAACtL,GAAH,CAAO4M,WAAtB,IAAqC,CAAjD;AACAiC,QAAAA,KAAK,CAAC,CAAD,CAAL,IAAY,CAAC5H,YAAY,GAAGqE,EAAE,CAACtL,GAAH,CAAOgP,YAAvB,IAAuC,CAAnD;AACA,YAAI9d,SAAS,GACX,eACA2d,KAAK,CAAC,CAAD,CADL,GAEA,MAFA,GAGAA,KAAK,CAAC,CAAD,CAHL,GAIA,gCAJA,GAKA3W,MAAM,CAACvI,IALP,GAMA,MAPF;;AASA,YAAI2b,EAAE,CAAC2D,KAAP,EAAc;AACZ/d,UAAAA,SAAS,IAAI,YAAYgJ,QAAQ,GAAGhC,MAAM,CAACzI,IAAlB,GAAyBS,CAArC,GAAyC,GAAtD;AACD;;AAEDob,QAAAA,EAAE,CAACtL,GAAH,CAAO1d,KAAP,CAAagP,eAAb,GAA+BJ,SAA/B;AACAoa,QAAAA,EAAE,CAACtL,GAAH,CAAO1d,KAAP,CAAa4sB,YAAb,GAA4Bhe,SAA5B;AACAoa,QAAAA,EAAE,CAACtL,GAAH,CAAO1d,KAAP,CAAa4O,SAAb,GAAyBA,SAAzB;AACD;AACF;AACD;AACJ;AACA;AACA;;;AAEI,aAASmZ,cAAT,GAA0B;AACxBnS,MAAAA,MAAM,CAAC8V,QAAP,CAAgBpuB,OAAhB,CAAwBwuB,aAAxB;AACD;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAASrO,WAAT,CAAqBkM,OAArB,EAA8B;AAC5B/T,MAAAA,MAAM,GAAG,EAAT;AACA,UAAI/D,CAAJ,EAAOpP,CAAP;AACA,UAAIoqB,mBAAmB,GAAG,CACxB,MADwB,EAExB,MAFwB,EAGxB,SAHwB,EAIxB,aAJwB,EAKxB,cALwB,EAMxB,aANwB,CAA1B;AAQA7U,MAAAA,4BAA4B,GAAG,EAA/B,CAX4B,CAWO;;AAEnC,WAAKnG,CAAL,IAAUwG,aAAV,EAAyB;AACvB,YAAIA,aAAa,CAACvU,cAAd,CAA6B+N,CAA7B,CAAJ,EAAqC;AACnC+D,UAAAA,MAAM,CAAC/D,CAAD,CAAN,GAAYwG,aAAa,CAACxG,CAAD,CAAzB;AACD;AACF,OAjB2B,CAiB1B;;;AAEF,WAAKA,CAAL,IAAU6D,aAAa,CAAC,SAAD,CAAvB,EAAoC;AAClC,YAAIA,aAAa,CAAC,SAAD,CAAb,CAAyB5R,cAAzB,CAAwC+N,CAAxC,CAAJ,EAAgD;AAC9C,cAAIA,CAAC,KAAK,QAAV,EAAoB;AAClB,iBAAKpP,CAAL,IAAUiT,aAAa,CAAC,SAAD,CAAb,CAAyB0E,MAAnC,EAA2C;AACzC,kBAAI1E,aAAa,CAAC,SAAD,CAAb,CAAyB0E,MAAzB,CAAgCtW,cAAhC,CAA+CrB,CAA/C,CAAJ,EAAuD;AACrDmT,gBAAAA,MAAM,CAACwE,MAAP,CAAc3X,CAAd,IAAmBymB,UAAU,CAC3BxT,aAAa,CAAC,SAAD,CAAb,CAAyB0E,MAAzB,CAAgC3X,CAAhC,CAD2B,CAA7B;AAGD;AACF;AACF,WARD,MAQO;AACLmT,YAAAA,MAAM,CAAC/D,CAAD,CAAN,GAAY6D,aAAa,CAAC,SAAD,CAAb,CAAyB7D,CAAzB,CAAZ;;AAEA,gBAAIgb,mBAAmB,CAAC5oB,OAApB,CAA4B4N,CAA5B,KAAkC,CAAtC,EAAyC;AACvCmG,cAAAA,4BAA4B,CAAC/a,IAA7B,CAAkC4U,CAAlC;AACD;AACF;AACF;AACF,OArC2B,CAqC1B;;;AAEF,UACE8X,OAAO,KAAK,IAAZ,IACAA,OAAO,KAAK,EADZ,IAEAjU,aAAa,CAACoX,MAFd,IAGApX,aAAa,CAACoX,MAAd,CAAqBnD,OAArB,CAJF,EAKE;AACA,YAAIoD,KAAK,GAAGrX,aAAa,CAACoX,MAAd,CAAqBnD,OAArB,CAAZ;;AAEA,aAAK9X,CAAL,IAAUkb,KAAV,EAAiB;AACf,cAAIA,KAAK,CAACjpB,cAAN,CAAqB+N,CAArB,CAAJ,EAA6B;AAC3B,gBAAIA,CAAC,KAAK,QAAV,EAAoB;AAClB,mBAAKpP,CAAL,IAAUsqB,KAAK,CAAC3S,MAAhB,EAAwB;AACtB,oBAAI2S,KAAK,CAAC3S,MAAN,CAAatW,cAAb,CAA4BrB,CAA5B,CAAJ,EAAoC;AAClCmT,kBAAAA,MAAM,CAACwE,MAAP,CAAc3X,CAAd,IAAmBymB,UAAU,CAAC6D,KAAK,CAAC3S,MAAN,CAAa3X,CAAb,CAAD,CAA7B;AACD;AACF;AACF,aAND,MAMO;AACLmT,cAAAA,MAAM,CAAC/D,CAAD,CAAN,GAAYkb,KAAK,CAAClb,CAAD,CAAjB;;AAEA,kBAAIgb,mBAAmB,CAAC5oB,OAApB,CAA4B4N,CAA5B,KAAkC,CAAtC,EAAyC;AACvCmG,gBAAAA,4BAA4B,CAAC/a,IAA7B,CAAkC4U,CAAlC;AACD;AACF;AACF;AACF;;AAED+D,QAAAA,MAAM,CAACmX,KAAP,GAAepD,OAAf;AACD,OAlE2B,CAkE1B;;;AAEF,WAAK9X,CAAL,IAAU6D,aAAV,EAAyB;AACvB,YAAIA,aAAa,CAAC5R,cAAd,CAA6B+N,CAA7B,CAAJ,EAAqC;AACnC,cAAIA,CAAC,KAAK,QAAV,EAAoB;AAClB,iBAAKpP,CAAL,IAAUiT,aAAa,CAAC0E,MAAxB,EAAgC;AAC9B,kBAAI1E,aAAa,CAAC0E,MAAd,CAAqBtW,cAArB,CAAoCrB,CAApC,CAAJ,EAA4C;AAC1CmT,gBAAAA,MAAM,CAACwE,MAAP,CAAc3X,CAAd,IAAmBymB,UAAU,CAACxT,aAAa,CAAC0E,MAAd,CAAqB3X,CAArB,CAAD,CAA7B;AACD;AACF;AACF,WAND,MAMO;AACLmT,YAAAA,MAAM,CAAC/D,CAAD,CAAN,GAAY6D,aAAa,CAAC7D,CAAD,CAAzB;;AAEA,gBAAIgb,mBAAmB,CAAC5oB,OAApB,CAA4B4N,CAA5B,KAAkC,CAAtC,EAAyC;AACvCmG,cAAAA,4BAA4B,CAAC/a,IAA7B,CAAkC4U,CAAlC;AACD;AACF;AACF;AACF;AACF;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAAS0K,cAAT,CAAwByQ,SAAxB,EAAmC;AACjCA,MAAAA,SAAS,GAAGA,SAAS,GAAGA,SAAH,GAAe,KAApC,CADiC,CACU;AAC3C;AACA;;AAEA,UAAIA,SAAS,IAAI,aAAapX,MAA9B,EAAsC;AACpC,YAAIxX,CAAC,GAAGwX,MAAM,CAACI,OAAf;AACA,YAAIJ,MAAM,CAACvR,QAAP,IAAmB,CAACqa,WAAW,CAACtgB,CAAD,CAAnC,EAAwCA,CAAC,GAAGwX,MAAM,CAACvR,QAAP,GAAkBjG,CAAtB;AACxC4X,QAAAA,OAAO,GAAGtW,QAAQ,CAACK,aAAT,CAAuB,KAAvB,CAAV;AACAiW,QAAAA,OAAO,CAAC7R,SAAR,GAAoB,kBAApB;AACA6R,QAAAA,OAAO,CAAChW,KAAR,CAAcitB,eAAd,GAAgC,UAAUC,iBAAiB,CAAC9uB,CAAD,CAA3B,GAAiC,IAAjE;AACAgd,QAAAA,eAAe,CAACjb,WAAhB,CAA4B6V,OAA5B;AACD,OAZgC,CAY/B;;;AAEF,UAAI2F,KAAK,GAAG/F,MAAM,CAAC+F,KAAnB;AAAA,UACEE,MAAM,GAAGjG,MAAM,CAACiG,MADlB;AAAA,UAEED,WAAW,GAAGhG,MAAM,CAACgG,WAFvB;;AAIA,UAAIoR,SAAJ,EAAe;AACb,YAAI,kBAAkBpX,MAAtB,EAA8BA,MAAM,CAAC+F,KAAP,GAAe/F,MAAM,CAACuX,YAAtB;AAC9B,YAAI,wBAAwBvX,MAA5B,EACEA,MAAM,CAACgG,WAAP,GAAqBhG,MAAM,CAACwX,kBAA5B;AACF,YAAI,mBAAmBxX,MAAvB,EAA+BA,MAAM,CAACiG,MAAP,GAAgBjG,MAAM,CAACyX,aAAvB;AAChC,OAvBgC,CAuB/B;;;AAEF,UAAI,CAACzX,MAAM,CAAC9R,cAAP,CAAsB,OAAtB,CAAL,EAAqC2X,WAAW,CAACE,KAAZ,CAAkBJ,SAAlB,GAA8B,EAA9B;AACrC,UAAI,CAAC3F,MAAM,CAAC9R,cAAP,CAAsB,aAAtB,CAAL,EACE2X,WAAW,CAACG,WAAZ,CAAwBL,SAAxB,GAAoC,EAApC;AACF,UAAI,CAAC3F,MAAM,CAAC9R,cAAP,CAAsB,QAAtB,CAAL,EAAsC2X,WAAW,CAACI,MAAZ,CAAmBN,SAAnB,GAA+B,EAA/B;AACtC,UACE,CAAC3F,MAAM,CAAC9R,cAAP,CAAsB,OAAtB,CAAD,IACA,CAAC8R,MAAM,CAAC9R,cAAP,CAAsB,aAAtB,CADD,IAEA,CAAC8R,MAAM,CAAC9R,cAAP,CAAsB,QAAtB,CAHH,EAKE2X,WAAW,CAAC5b,SAAZ,CAAsBG,KAAtB,CAA4B6d,OAA5B,GAAsC,MAAtC,CAlC+B,CAkCe;;AAEhDvB,MAAAA,QAAQ,CAACR,IAAT,CAAcP,SAAd,GAA0B,QAAQ3F,MAAM,CAACwE,MAAP,CAAcC,eAAtB,GAAwC,MAAlE;AACAoB,MAAAA,WAAW,CAACK,IAAZ,CAAiBE,IAAjB,CAAsBT,SAAtB,GAAkC3F,MAAM,CAACwE,MAAP,CAAcE,YAAhD,CArCiC,CAqC6B;;AAE9D,WAAK,IAAIte,GAAT,IAAgB4Z,MAAhB,EAAwB;AACtB,YAAIA,MAAM,CAAC9R,cAAP,CAAsB9H,GAAtB,CAAJ,EAAgC;AAC9B,kBAAQA,GAAR;AACE,iBAAK,OAAL;AACEyf,cAAAA,WAAW,CAACE,KAAZ,CAAkBJ,SAAlB,GAA8B2N,UAAU,CAACtT,MAAM,CAAC5Z,GAAD,CAAP,CAAxC;AACAyf,cAAAA,WAAW,CAAC5b,SAAZ,CAAsBG,KAAtB,CAA4B6d,OAA5B,GAAsC,QAAtC;AACA;;AAEF,iBAAK,aAAL;AACEpC,cAAAA,WAAW,CAACG,WAAZ,CAAwBL,SAAxB,GAAoC2N,UAAU,CAACtT,MAAM,CAAC5Z,GAAD,CAAP,CAA9C;AACAyf,cAAAA,WAAW,CAAC5b,SAAZ,CAAsBG,KAAtB,CAA4B6d,OAA5B,GAAsC,QAAtC;AACA;;AAEF,iBAAK,QAAL;AACE,kBAAIyP,UAAU,GAAGpE,UAAU,CAACtT,MAAM,CAAC5Z,GAAD,CAAP,CAA3B;;AAEA,kBAAI4Z,MAAM,CAAC2X,SAAX,EAAsB;AACpB,oBAAIC,UAAU,GAAG9tB,QAAQ,CAACK,aAAT,CAAuB,GAAvB,CAAjB;AACAytB,gBAAAA,UAAU,CAACjP,IAAX,GAAkBI,WAAW,CAAC/I,MAAM,CAAC,WAAD,CAAP,CAA7B;AACA4X,gBAAAA,UAAU,CAAClyB,MAAX,GAAoB,QAApB;AACAkyB,gBAAAA,UAAU,CAACjS,SAAX,GAAuB2N,UAAU,CAACtT,MAAM,CAAC5Z,GAAD,CAAP,CAAjC;AACAsxB,gBAAAA,UAAU,GAAGE,UAAU,CAAChP,SAAxB;AACD;;AAED/C,cAAAA,WAAW,CAACI,MAAZ,CAAmBN,SAAnB,GAA+B3F,MAAM,CAACwE,MAAP,CAAcG,WAAd,CAA0B7U,OAA1B,CAC7B,IAD6B,EAE7B4nB,UAF6B,CAA/B;AAIA7R,cAAAA,WAAW,CAAC5b,SAAZ,CAAsBG,KAAtB,CAA4B6d,OAA5B,GAAsC,QAAtC;AACA;;AAEF,iBAAK,UAAL;AACE,kBAAI4P,IAAI,GAAG/tB,QAAQ,CAACK,aAAT,CAAuB,GAAvB,CAAX;AACA0tB,cAAAA,IAAI,CAAClP,IAAL,GAAYI,WAAW,CAAC/I,MAAM,CAAC5Z,GAAD,CAAP,CAAvB;AACAyxB,cAAAA,IAAI,CAACnyB,MAAL,GAAc,QAAd;AACAmyB,cAAAA,IAAI,CAACvO,WAAL,GACE,4DADF;AAEA,kBAAIwO,OAAO,GAAGhuB,QAAQ,CAACK,aAAT,CAAuB,GAAvB,CAAd;AACA2tB,cAAAA,OAAO,CAACxO,WAAR,GAAsB,sCAAtB;AACAwO,cAAAA,OAAO,CAACvtB,WAAR,CAAoBT,QAAQ,CAACK,aAAT,CAAuB,IAAvB,CAApB;AACA2tB,cAAAA,OAAO,CAACvtB,WAAR,CAAoBstB,IAApB;AACAhS,cAAAA,WAAW,CAACY,QAAZ,CAAqBd,SAArB,GAAiC,EAAjC,CAVF,CAUuC;;AAErCE,cAAAA,WAAW,CAACY,QAAZ,CAAqBlc,WAArB,CAAiCutB,OAAjC;AACA;;AAEF,iBAAK,MAAL;AACEhM,cAAAA,OAAO,CAACU,MAAM,CAACxM,MAAM,CAAC5Z,GAAD,CAAP,CAAP,CAAP;AACA;;AAEF,iBAAK,UAAL;AACE,kBAAI4Z,MAAM,CAAC5Z,GAAD,CAAN,KAAgB,IAAhB,IAAwBsZ,QAAQ,KAAK3V,WAAzC,EAAsD;AACpD;AACA8b,gBAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,CAAqB/b,KAArB,CAA2B6d,OAA3B,GAAqC,QAArC,CAFoD,CAEL;;AAE/CvB,gBAAAA,QAAQ,CAACR,IAAT,CAAc9b,KAAd,CAAoB6d,OAApB,GAA8B,MAA9B,CAJoD,CAId;;AAEtCzc,gBAAAA,IAAI;AACL;;AAED;;AAEF,iBAAK,cAAL;AACE,kBAAIwU,MAAM,CAAC5Z,GAAD,CAAN,IAAe4Z,MAAM,CAAC6D,YAAP,IAAuB,KAA1C,EAAiD;AAC/C;AACA6C,gBAAAA,QAAQ,CAAC3N,IAAT,CAAc3O,KAAd,CAAoB6d,OAApB,GAA8B,OAA9B;AACD,eAHD,MAGO;AACL;AACAvB,gBAAAA,QAAQ,CAAC3N,IAAT,CAAc3O,KAAd,CAAoB6d,OAApB,GAA8B,MAA9B;AACD;;AAED;;AAEF,iBAAK,oBAAL;AACE,kBACEjI,MAAM,CAAC5Z,GAAD,CAAN,IACA4Z,MAAM,CAAC6D,YAAP,IAAuB,KADvB,KAEC,gBAAgB/Z,QAAhB,IACC,mBAAmBA,QADpB,IAEC,wBAAwBA,QAFzB,IAGC,yBAAyBA,QAL3B,CADF,EAOE;AACA;AACA4c,gBAAAA,QAAQ,CAACI,UAAT,CAAoB1c,KAApB,CAA0B6d,OAA1B,GAAoC,OAApC;AACD,eAVD,MAUO;AACL;AACAvB,gBAAAA,QAAQ,CAACI,UAAT,CAAoB1c,KAApB,CAA0B6d,OAA1B,GAAoC,MAApC;AACD;;AAED;;AAEF,iBAAK,cAAL;AACE,kBAAIjI,MAAM,CAAC5Z,GAAD,CAAV,EAAiB0f,qBAAqB,CAAC1b,KAAtB,CAA4B6d,OAA5B,GAAsC,OAAtC,CAAjB,KACKnC,qBAAqB,CAAC1b,KAAtB,CAA4B6d,OAA5B,GAAsC,MAAtC;AACL;;AAEF,iBAAK,cAAL;AACE,kBAAI,CAACjI,MAAM,CAAC5Z,GAAD,CAAX,EAAkB;AAChBsgB,gBAAAA,QAAQ,CAAC9E,WAAT,CAAqBxX,KAArB,CAA2B6d,OAA3B,GAAqC,MAArC;AACAvB,gBAAAA,QAAQ,CAAC3N,IAAT,CAAc3O,KAAd,CAAoB6d,OAApB,GAA8B,MAA9B;AACAvB,gBAAAA,QAAQ,CAACI,UAAT,CAAoB1c,KAApB,CAA0B6d,OAA1B,GAAoC,MAApC;AACD;;AAED;;AAEF,iBAAK,wBAAL;AACE,kBAAIjI,MAAM,CAAC5Z,GAAD,CAAV,EAAiB;AACfihB,gBAAAA,gBAAgB;AAChB;AACD;;AA3GL;AA6GD;AACF;;AAED,UAAI+P,SAAJ,EAAe;AACb;AACA,YAAIrR,KAAJ,EAAW/F,MAAM,CAAC+F,KAAP,GAAeA,KAAf,CAAX,KACK,OAAO/F,MAAM,CAAC+F,KAAd;AACL,YAAIC,WAAJ,EAAiBhG,MAAM,CAACgG,WAAP,GAAqBA,WAArB,CAAjB,KACK,OAAOhG,MAAM,CAACgG,WAAd;AACL,YAAIC,MAAJ,EAAYjG,MAAM,CAACiG,MAAP,GAAgBA,MAAhB,CAAZ,KACK,OAAOjG,MAAM,CAACiG,MAAd;AACN;AACF;AACD;AACJ;AACA;AACA;;;AAEI,aAASc,gBAAT,GAA4B;AAC1B,UAAInY,MAAM,IAAI,CAAC0S,KAAf,EAAsB;AACpB,YAAI,CAACD,gBAAL,EAAuB;AACrB,cAAI;AACF,gBAAIpX,SAAS,CAAC8tB,iBAAd,EAAiC;AAC/B9tB,cAAAA,SAAS,CAAC8tB,iBAAV;AACD,aAFD,MAEO,IAAI9tB,SAAS,CAAC+tB,oBAAd,EAAoC;AACzC/tB,cAAAA,SAAS,CAAC+tB,oBAAV;AACD,aAFM,MAEA,IAAI/tB,SAAS,CAACguB,mBAAd,EAAmC;AACxChuB,cAAAA,SAAS,CAACguB,mBAAV;AACD,aAFM,MAEA;AACLhuB,cAAAA,SAAS,CAACiuB,uBAAV;AACD;AACF,WAVD,CAUE,OAAO7K,KAAP,EAAc,CACd;AACD;AACF,SAdD,MAcO;AACL,cAAIvjB,QAAQ,CAACquB,cAAb,EAA6B;AAC3BruB,YAAAA,QAAQ,CAACquB,cAAT;AACD,WAFD,MAEO,IAAIruB,QAAQ,CAACsuB,mBAAb,EAAkC;AACvCtuB,YAAAA,QAAQ,CAACsuB,mBAAT;AACD,WAFM,MAEA,IAAItuB,QAAQ,CAACuuB,sBAAb,EAAqC;AAC1CvuB,YAAAA,QAAQ,CAACuuB,sBAAT;AACD,WAFM,MAEA,IAAIvuB,QAAQ,CAACwuB,gBAAb,EAA+B;AACpCxuB,YAAAA,QAAQ,CAACwuB,gBAAT;AACD;AACF;AACF;AACF;AACD;AACJ;AACA;AACA;;;AAEI,aAASvN,kBAAT,CAA4BjU,MAA5B,EAAoC;AAClC,UACEhN,QAAQ,CAACyuB,iBAAT,IACAzuB,QAAQ,CAACgd,UADT,IAEAhd,QAAQ,CAAC0uB,aAFT,IAGA1uB,QAAQ,CAAC2uB,kBAHT,IAIA3uB,QAAQ,CAAC4uB,mBALX,EAME;AACAhS,QAAAA,QAAQ,CAACI,UAAT,CAAoB1B,SAApB,CAA8BC,GAA9B,CACE,sCADF;AAGAhE,QAAAA,gBAAgB,GAAG,IAAnB;AACD,OAXD,MAWO;AACLqF,QAAAA,QAAQ,CAACI,UAAT,CAAoB1B,SAApB,CAA8BkF,MAA9B,CACE,sCADF;AAGAjJ,QAAAA,gBAAgB,GAAG,KAAnB;AACD;;AAED,UAAIvK,MAAM,KAAK,QAAf,EAAyBqW,SAAS,CAAC,kBAAD,EAAqB9L,gBAArB,CAAT,CAnBS,CAmBwC;;AAE1E3B,MAAAA,QAAQ,CAAC5I,MAAT;AACAgV,MAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAR,CAAP;AACAkX,MAAAA,WAAW;AACZ;AACD;AACJ;AACA;AACA;;;AAEI,aAAS7H,MAAT,GAAkB;AAChB,UAAIhY,MAAJ,EAAY;AACVkd,QAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAP,GAAc,CAAf,CAAP;AACAkX,QAAAA,WAAW;AACZ;AACF;AACD;AACJ;AACA;AACA;;;AAEI,aAAS5H,OAAT,GAAmB;AACjB,UAAIjY,MAAJ,EAAY;AACVkd,QAAAA,OAAO,CAAC9L,MAAM,CAACzI,IAAP,GAAc,CAAf,CAAP;AACAkX,QAAAA,WAAW;AACZ;AACF;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASkK,aAAT,CAAuBphB,IAAvB,EAA6B;AAC3B;AACA,UAAImL,OAAO,GAAG1C,MAAM,CAAC0C,OAArB;;AAEA,UAAI1C,MAAM,CAAC7T,IAAP,KAAgB,UAAhB,IAA8BuT,QAA9B,IAA0C,CAACM,MAAM,CAAC2C,eAAtD,EAAuE;AACrED,QAAAA,OAAO,GAAGjS,IAAI,CAACyH,GAAL,CACRwK,OADQ,EAERhD,QAAQ,CAACpE,SAAT,GAAqBjR,KAArB,IACI2V,MAAM,CAACqI,QAAP,CAAgBlM,cAAhB,GAAiC,EAAlC,GAAwC,GAD3C,CAFQ,CAAV;AAKD;;AAED,UAAIuG,OAAO,GAAG1C,MAAM,CAAC4C,OAArB,EAA8B;AAC5B;AACA3W,QAAAA,OAAO,CAACC,GAAR,CAAY,oDAAZ;AACA,eAAO8T,MAAM,CAACzI,IAAd;AACD;;AAED,UAAIqhB,OAAO,GAAG5Y,MAAM,CAACzI,IAArB;;AAEA,UAAIA,IAAI,GAAGmL,OAAX,EAAoB;AAClBkW,QAAAA,OAAO,GAAGlW,OAAV;AACD,OAFD,MAEO,IAAInL,IAAI,GAAGyI,MAAM,CAAC4C,OAAlB,EAA2B;AAChCgW,QAAAA,OAAO,GAAG5Y,MAAM,CAAC4C,OAAjB;AACD,OAFM,MAEA;AACLgW,QAAAA,OAAO,GAAGrhB,IAAV;AACD,OA1B0B,CA0BzB;;;AAEF,UAAIyI,MAAM,CAACgE,sBAAP,IAAiCtE,QAArC,EAA+C;AAC7C,YAAIxV,MAAM,GAAGwV,QAAQ,CAACpE,SAAT,EAAb;AACAsd,QAAAA,OAAO,GAAGnoB,IAAI,CAACyH,GAAL,CACR0gB,OADQ,EAEPnoB,IAAI,CAAC6I,IAAL,CACE7I,IAAI,CAACqI,GAAL,CAAU,CAACkH,MAAM,CAAC8C,QAAP,GAAkB9C,MAAM,CAAC6C,QAA1B,IAAsC,GAAvC,GAA8CpS,IAAI,CAAC4D,EAA5D,IACCnK,MAAM,CAACI,MADT,GAEEJ,MAAM,CAACG,KAHV,IAKC,GALF,GAMEoG,IAAI,CAAC4D,EARC,CAAV;AAUD;;AAED,aAAOukB,OAAP;AACD;AACD;AACJ;AACA;AACA;AACA;;;AAEI,aAAS9M,OAAT,CAAiBvU,IAAjB,EAAuB;AACrByI,MAAAA,MAAM,CAACzI,IAAP,GAAcohB,aAAa,CAACphB,IAAD,CAA3B;AACA4V,MAAAA,SAAS,CAAC,YAAD,EAAenN,MAAM,CAACzI,IAAtB,CAAT;AACD;AACD;AACJ;AACA;AACA;;;AAEI,aAASiX,aAAT,GAAyB;AACvBtM,MAAAA,YAAY,GAAG,EAAf;AACAH,MAAAA,eAAe,GAAG/B,MAAM,CAACkD,UAAP,GAAoBlD,MAAM,CAACkD,UAA3B,GAAwCnB,eAA1D;AACA/B,MAAAA,MAAM,CAACkD,UAAP,GAAoB,KAApB;AACD;AACD;AACJ;AACA;AACA;;;AAEI,aAASgD,IAAT,GAAgB;AACd;AACA;AACA;AACAkH,MAAAA,UAAU;AACVxe,MAAAA,MAAM,GAAG,KAAT;AACA8X,MAAAA,QAAQ,CAACR,IAAT,CAAc9b,KAAd,CAAoB6d,OAApB,GAA8B,MAA9B;AACApC,MAAAA,WAAW,CAACK,IAAZ,CAAiBC,GAAjB,CAAqB/b,KAArB,CAA2B6d,OAA3B,GAAqC,QAArC;AACAzc,MAAAA,IAAI;AACL;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAAS4oB,SAAT,CAAmBL,OAAnB,EAA4B8E,WAA5B,EAAyCC,SAAzC,EAAoDC,UAApD,EAAgEC,QAAhE,EAA0E;AACxE,UAAI,CAACpqB,MAAL,EAAaoqB,QAAQ,GAAG,IAAX,CAD2D,CAC1C;;AAE9BpqB,MAAAA,MAAM,GAAG,KAAT;AACAsT,MAAAA,YAAY,GAAG,EAAf,CAJwE,CAIrD;;AAEnB,UAAI+Q,OAAJ,EAAagG,YAAb,EAA2BC,UAA3B,EAAuCC,WAAvC;;AAEA,UAAInZ,MAAM,CAACgT,iBAAP,IAA4B,CAACgG,QAAjC,EAA2C;AACzC,YAAI5pB,IAAI,GAAGsQ,QAAQ,CAACtI,MAAT,CACR4I,MAAM,CAAC3I,KAAP,GAAe5G,IAAI,CAAC4D,EAArB,GAA2B,GADlB,EAER2L,MAAM,CAAC1I,GAAP,GAAa7G,IAAI,CAAC4D,EAAnB,GAAyB,GAFhB,EAGR2L,MAAM,CAACzI,IAAP,GAAc9G,IAAI,CAAC4D,EAApB,GAA0B,GAHjB,EAIT;AACE6G,UAAAA,WAAW,EAAE;AADf,SAJS,CAAX;;AASA,YAAI9L,IAAI,KAAKrF,WAAb,EAA0B;AACxBkpB,UAAAA,OAAO,GAAG,IAAIxjB,KAAJ,EAAV;AACAwjB,UAAAA,OAAO,CAAC1kB,SAAR,GAAoB,eAApB;AACA0kB,UAAAA,OAAO,CAAC7oB,KAAR,CAAcgvB,UAAd,GACE,aAAapZ,MAAM,CAACgT,iBAAP,GAA2B,IAAxC,GAA+C,GADjD;AAEAC,UAAAA,OAAO,CAAC7oB,KAAR,CAAcC,KAAd,GAAsB,MAAtB;AACA4oB,UAAAA,OAAO,CAAC7oB,KAAR,CAAcE,MAAd,GAAuB,MAAvB;;AAEA2oB,UAAAA,OAAO,CAACtjB,MAAR,GAAiB,YAAY;AAC3BykB,YAAAA,SAAS,CAACL,OAAD,EAAU8E,WAAV,EAAuBC,SAAvB,EAAkCC,UAAlC,EAA8C,IAA9C,CAAT;AACD,WAFD;;AAIA9F,UAAAA,OAAO,CAACpjB,GAAR,GAAcT,IAAd;AACAoW,UAAAA,eAAe,CAACjb,WAAhB,CAA4B0oB,OAA5B;AACAvT,UAAAA,QAAQ,CAACuT,OAAT,GAAmBA,OAAnB;AACA;AACD;AACF,OAnCuE,CAmCtE;;;AAEF,UAAI4F,WAAW,KAAK,MAApB,EAA4B;AAC1BI,QAAAA,YAAY,GAAGjZ,MAAM,CAAC3I,KAAtB;AACD,OAFD,MAEO;AACL4hB,QAAAA,YAAY,GAAGJ,WAAf;AACD;;AAED,UAAIC,SAAS,KAAK,MAAlB,EAA0B;AACxBI,QAAAA,UAAU,GAAGlZ,MAAM,CAAC1I,GAApB;AACD,OAFD,MAEO,IAAIwhB,SAAS,KAAK,aAAlB,EAAiC;AACtCI,QAAAA,UAAU,GACRlZ,MAAM,CAAC1I,GAAP,IACC0I,MAAM,CAACqD,WAAP,IAAsB,CADvB,KAECvD,aAAa,CAACoX,MAAd,CAAqBnD,OAArB,EAA8B1Q,WAA9B,IAA6C,CAF9C,CADF;AAID,OALM,MAKA;AACL6V,QAAAA,UAAU,GAAGJ,SAAb;AACD;;AAED,UAAIC,UAAU,KAAK,MAAnB,EAA2B;AACzBI,QAAAA,WAAW,GAAGnZ,MAAM,CAACzI,IAArB;AACD,OAFD,MAEO;AACL4hB,QAAAA,WAAW,GAAGJ,UAAd;AACD,OA1DuE,CA0DtE;;;AAEFhD,MAAAA,eAAe,GA5DyD,CA4DrD;;AAEnBlO,MAAAA,WAAW,CAACkM,OAAD,CAAX,CA9DwE,CA8DlD;;AAEtBrS,MAAAA,KAAK,CAACpK,GAAN,GAAYoK,KAAK,CAACrK,KAAN,GAAcqK,KAAK,CAACnK,IAAN,GAAa,CAAvC,CAhEwE,CAgE9B;;AAE1CoP,MAAAA,cAAc;;AAEd,UAAIsS,YAAY,KAAKlvB,WAArB,EAAkC;AAChCiW,QAAAA,MAAM,CAAC3I,KAAP,GAAe4hB,YAAf;AACD;;AAED,UAAIC,UAAU,KAAKnvB,WAAnB,EAAgC;AAC9BiW,QAAAA,MAAM,CAAC1I,GAAP,GAAa4hB,UAAb;AACD;;AAED,UAAIC,WAAW,KAAKpvB,WAApB,EAAiC;AAC/BiW,QAAAA,MAAM,CAACzI,IAAP,GAAc4hB,WAAd;AACD;;AAEDhM,MAAAA,SAAS,CAAC,aAAD,EAAgB4G,OAAhB,CAAT;AACA7N,MAAAA,IAAI;AACL;AACD;AACJ;AACA;AACA;;;AAEI,aAASkB,eAAT,GAA2B;AACzBvd,MAAAA,MAAM,CAACwvB,mBAAP,CAA2B,mBAA3B,EAAgDxG,mBAAhD;AACAnM,MAAAA,QAAQ,CAAC9E,WAAT,CAAqBwD,SAArB,CAA+BkF,MAA/B,CAAsC,gCAAtC;AACA1I,MAAAA,WAAW,GAAG,KAAd;AACD;AACD;AACJ;AACA;AACA;;;AAEI,aAASyF,gBAAT,GAA4B;AAC1BzF,MAAAA,WAAW,GAAG,CAAd,CAD0B,CACT;;AAEjB,UACE4F,sBAAsB,IACtB,OAAOA,sBAAsB,CAACsL,iBAA9B,KAAoD,UAFtD,EAGE;AACAtL,QAAAA,sBAAsB,CAACsL,iBAAvB,GACGwG,IADH,CACQ,UAAU/P,QAAV,EAAoB;AACxB,cAAIA,QAAQ,KAAK,SAAjB,EAA4B;AAC1B1f,YAAAA,MAAM,CAACsU,gBAAP,CAAwB,mBAAxB,EAA6C0U,mBAA7C;AACD;AACF,SALH,EAMG,OANH,EAMY5mB,OAAO,CAACqV,KANpB;AAOD,OAXD,MAWO;AACLzX,QAAAA,MAAM,CAACsU,gBAAP,CAAwB,mBAAxB,EAA6C0U,mBAA7C;AACD,OAhByB,CAgBxB;;;AAEFnM,MAAAA,QAAQ,CAAC9E,WAAT,CAAqBwD,SAArB,CAA+BC,GAA/B,CAAmC,gCAAnC;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,aAASiO,UAAT,CAAoBzmB,CAApB,EAAuB;AACrB,UAAI,CAACiT,aAAa,CAACwT,UAAnB,EAA+B,OAAOiG,MAAM,CAAC1sB,CAAD,CAAN,CAAU2sB,KAAV,CAAgB,IAAhB,EAAsB/Z,IAAtB,CAA2B,MAA3B,CAAP;AAC/B,aAAO8Z,MAAM,CAAC1sB,CAAD,CAAN,CACJ2sB,KADI,CACE,IADF,EAEJ/Z,IAFI,CAEC,OAFD,EAGJ+Z,KAHI,CAGE,GAHF,EAIJ/Z,IAJI,CAIC,QAJD,EAKJ+Z,KALI,CAKE,GALF,EAMJ/Z,IANI,CAMC,OAND,EAOJ+Z,KAPI,CAOE,GAPF,EAQJ/Z,IARI,CAQC,MARD,EASJ+Z,KATI,CASE,GATF,EAUJ/Z,IAVI,CAUC,MAVD,EAWJ+Z,KAXI,CAWE,GAXF,EAYJ/Z,IAZI,CAYC,QAZD,EAaJ+Z,KAbI,CAaE,IAbF,EAcJ/Z,IAdI,CAcC,MAdD,CAAP,CAFqB,CAgBJ;AAClB;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAASsJ,WAAT,CAAqByB,GAArB,EAA0B;AACxB,UAAIA,GAAG,CAACiP,IAAJ,GAAW9rB,WAAX,GAAyBU,OAAzB,CAAiC,aAAjC,MAAoD,CAAxD,EAA2D;AACzD,eAAO,aAAP;AACD;;AAED,aAAOmc,GAAP;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,aAAS8M,iBAAT,CAA2B9M,GAA3B,EAAgC;AAC9B,aAAOzB,WAAW,CAACyB,GAAD,CAAX,CAAiB1a,OAAjB,CAAyB,IAAzB,EAA+B,KAA/B,EAAsCA,OAAtC,CAA8C,IAA9C,EAAoD,KAApD,CAAP;AACD;AACD;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAK4pB,QAAL,GAAgB,YAAY;AAC1B,aAAO5wB,OAAO,CAAC8F,MAAD,CAAd;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAK2iB,QAAL,GAAgB,YAAY;AAC1B,aAAOvR,MAAM,CAAC3I,KAAd;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKsiB,QAAL,GAAgB,UAAUtiB,KAAV,EAAiBuiB,QAAjB,EAA2B7tB,QAA3B,EAAqC8tB,YAArC,EAAmD;AACjElZ,MAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;;AAEA,UAAIpQ,IAAI,CAACsL,GAAL,CAAS1E,KAAK,GAAG2I,MAAM,CAAC3I,KAAxB,KAAkCiL,GAAtC,EAA2C;AACzC,YAAI,OAAOvW,QAAP,KAAoB,UAAxB,EAAoCA,QAAQ,CAAC8tB,YAAD,CAAR;AACpC,eAAO,IAAP;AACD;;AAEDD,MAAAA,QAAQ,GAAGA,QAAQ,KAAK7vB,WAAb,GAA2B,IAA3B,GAAkCyiB,MAAM,CAACoN,QAAD,CAAnD;;AAEA,UAAIA,QAAJ,EAAc;AACZ1X,QAAAA,YAAY,CAAC7K,KAAb,GAAqB;AACnB4Z,UAAAA,SAAS,EAAErQ,IAAI,CAACC,GAAL,EADQ;AAEnBsQ,UAAAA,aAAa,EAAEnR,MAAM,CAAC3I,KAFH;AAGnB+Z,UAAAA,WAAW,EAAE/Z,KAHM;AAInB6Z,UAAAA,QAAQ,EAAE0I;AAJS,SAArB;AAMA,YAAI,OAAO7tB,QAAP,KAAoB,UAAxB,EACEgP,UAAU,CAAC,YAAY;AACrBhP,UAAAA,QAAQ,CAAC8tB,YAAD,CAAR;AACD,SAFS,EAEPD,QAFO,CAAV;AAGH,OAXD,MAWO;AACL5Z,QAAAA,MAAM,CAAC3I,KAAP,GAAeA,KAAf;AACD;;AAEDoX,MAAAA,WAAW;AACX,aAAO,IAAP;AACD,KA3BD;AA4BA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKqL,cAAL,GAAsB,YAAY;AAChC,aAAO,CAAC9Z,MAAM,CAAC6C,QAAR,EAAkB7C,MAAM,CAAC8C,QAAzB,CAAP;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKiX,cAAL,GAAsB,UAAUhM,MAAV,EAAkB;AACtC/N,MAAAA,MAAM,CAAC6C,QAAP,GAAkBpS,IAAI,CAACC,GAAL,CAAS,CAAC,EAAV,EAAcD,IAAI,CAACyH,GAAL,CAAS6V,MAAM,CAAC,CAAD,CAAf,EAAoB,EAApB,CAAd,CAAlB;AACA/N,MAAAA,MAAM,CAAC8C,QAAP,GAAkBrS,IAAI,CAACC,GAAL,CAAS,CAAC,EAAV,EAAcD,IAAI,CAACyH,GAAL,CAAS6V,MAAM,CAAC,CAAD,CAAf,EAAoB,EAApB,CAAd,CAAlB;AACA,aAAO,IAAP;AACD,KAJD;AAKA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKyD,MAAL,GAAc,YAAY;AACxB,aAAOxR,MAAM,CAAC1I,GAAd;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKse,MAAL,GAAc,UAAUte,GAAV,EAAesiB,QAAf,EAAyB7tB,QAAzB,EAAmC8tB,YAAnC,EAAiD;AAC7DlZ,MAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;;AAEA,UAAIpQ,IAAI,CAACsL,GAAL,CAASzE,GAAG,GAAG0I,MAAM,CAAC1I,GAAtB,KAA8BgL,GAAlC,EAAuC;AACrC,YAAI,OAAOvW,QAAP,KAAoB,UAAxB,EAAoCA,QAAQ,CAAC8tB,YAAD,CAAR;AACpC,eAAO,IAAP;AACD;;AAEDD,MAAAA,QAAQ,GAAGA,QAAQ,KAAK7vB,WAAb,GAA2B,IAA3B,GAAkCyiB,MAAM,CAACoN,QAAD,CAAnD;AACAtiB,MAAAA,GAAG,GAAI,CAACA,GAAG,GAAG,GAAP,IAAc,GAAf,GAAsB,GAA5B,CAT6D,CAS5B;;AAEjC,UAAIsiB,QAAJ,EAAc;AACZ;AACA,YAAI5Z,MAAM,CAAC1I,GAAP,GAAaA,GAAb,GAAmB,GAAvB,EAA4BA,GAAG,IAAI,GAAP,CAA5B,KACK,IAAIA,GAAG,GAAG0I,MAAM,CAAC1I,GAAb,GAAmB,GAAvB,EAA4BA,GAAG,IAAI,GAAP;AACjC4K,QAAAA,YAAY,CAAC5K,GAAb,GAAmB;AACjB2Z,UAAAA,SAAS,EAAErQ,IAAI,CAACC,GAAL,EADM;AAEjBsQ,UAAAA,aAAa,EAAEnR,MAAM,CAAC1I,GAFL;AAGjB8Z,UAAAA,WAAW,EAAE9Z,GAHI;AAIjB4Z,UAAAA,QAAQ,EAAE0I;AAJO,SAAnB;AAMA,YAAI,OAAO7tB,QAAP,KAAoB,UAAxB,EACEgP,UAAU,CAAC,YAAY;AACrBhP,UAAAA,QAAQ,CAAC8tB,YAAD,CAAR;AACD,SAFS,EAEPD,QAFO,CAAV;AAGH,OAdD,MAcO;AACL5Z,QAAAA,MAAM,CAAC1I,GAAP,GAAaA,GAAb;AACD;;AAEDmX,MAAAA,WAAW;AACX,aAAO,IAAP;AACD,KA/BD;AAgCA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKuL,YAAL,GAAoB,YAAY;AAC9B,aAAO,CAACha,MAAM,CAAC+C,MAAR,EAAgB/C,MAAM,CAACgD,MAAvB,CAAP;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKiX,YAAL,GAAoB,UAAUlM,MAAV,EAAkB;AACpC/N,MAAAA,MAAM,CAAC+C,MAAP,GAAgBtS,IAAI,CAACC,GAAL,CAAS,CAAC,GAAV,EAAeD,IAAI,CAACyH,GAAL,CAAS6V,MAAM,CAAC,CAAD,CAAf,EAAoB,GAApB,CAAf,CAAhB;AACA/N,MAAAA,MAAM,CAACgD,MAAP,GAAgBvS,IAAI,CAACC,GAAL,CAAS,CAAC,GAAV,EAAeD,IAAI,CAACyH,GAAL,CAAS6V,MAAM,CAAC,CAAD,CAAf,EAAoB,GAApB,CAAf,CAAhB;AACA,aAAO,IAAP;AACD,KAJD;AAKA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAK0D,OAAL,GAAe,YAAY;AACzB,aAAOzR,MAAM,CAACzI,IAAd;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKuU,OAAL,GAAe,UAAUvU,IAAV,EAAgBqiB,QAAhB,EAA0B7tB,QAA1B,EAAoC8tB,YAApC,EAAkD;AAC/DlZ,MAAAA,iBAAiB,GAAGC,IAAI,CAACC,GAAL,EAApB;;AAEA,UAAIpQ,IAAI,CAACsL,GAAL,CAASxE,IAAI,GAAGyI,MAAM,CAACzI,IAAvB,KAAgC+K,GAApC,EAAyC;AACvC,YAAI,OAAOvW,QAAP,KAAoB,UAAxB,EAAoCA,QAAQ,CAAC8tB,YAAD,CAAR;AACpC,eAAO,IAAP;AACD;;AAEDD,MAAAA,QAAQ,GAAGA,QAAQ,KAAK7vB,WAAb,GAA2B,IAA3B,GAAkCyiB,MAAM,CAACoN,QAAD,CAAnD;;AAEA,UAAIA,QAAJ,EAAc;AACZ1X,QAAAA,YAAY,CAAC3K,IAAb,GAAoB;AAClB0Z,UAAAA,SAAS,EAAErQ,IAAI,CAACC,GAAL,EADO;AAElBsQ,UAAAA,aAAa,EAAEnR,MAAM,CAACzI,IAFJ;AAGlB6Z,UAAAA,WAAW,EAAEuH,aAAa,CAACphB,IAAD,CAHR;AAIlB2Z,UAAAA,QAAQ,EAAE0I;AAJQ,SAApB;AAMA,YAAI,OAAO7tB,QAAP,KAAoB,UAAxB,EACEgP,UAAU,CAAC,YAAY;AACrBhP,UAAAA,QAAQ,CAAC8tB,YAAD,CAAR;AACD,SAFS,EAEPD,QAFO,CAAV;AAGH,OAXD,MAWO;AACL9N,QAAAA,OAAO,CAACvU,IAAD,CAAP;AACD;;AAEDkX,MAAAA,WAAW;AACX,aAAO,IAAP;AACD,KA3BD;AA4BA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKyL,aAAL,GAAqB,YAAY;AAC/B,aAAO,CAACla,MAAM,CAAC0C,OAAR,EAAiB1C,MAAM,CAAC4C,OAAxB,CAAP;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKuX,aAAL,GAAqB,UAAUpM,MAAV,EAAkB;AACrC/N,MAAAA,MAAM,CAAC0C,OAAP,GAAiBjS,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYqd,MAAM,CAAC,CAAD,CAAlB,CAAjB;AACA/N,MAAAA,MAAM,CAAC4C,OAAP,GAAiBnS,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYqd,MAAM,CAAC,CAAD,CAAlB,CAAjB;AACA,aAAO,IAAP;AACD,KAJD;AAKA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKW,MAAL,GAAc,UACZrX,KADY,EAEZC,GAFY,EAGZC,IAHY,EAIZqiB,QAJY,EAKZ7tB,QALY,EAMZ8tB,YANY,EAOZ;AACAD,MAAAA,QAAQ,GAAGA,QAAQ,KAAK7vB,WAAb,GAA2B,IAA3B,GAAkCyiB,MAAM,CAACoN,QAAD,CAAnD;;AAEA,UAAIviB,KAAK,KAAKtN,WAAV,IAAyB0G,IAAI,CAACsL,GAAL,CAAS1E,KAAK,GAAG2I,MAAM,CAAC3I,KAAxB,IAAiCiL,GAA9D,EAAmE;AACjE,aAAKqX,QAAL,CAActiB,KAAd,EAAqBuiB,QAArB,EAA+B7tB,QAA/B,EAAyC8tB,YAAzC;AACA9tB,QAAAA,QAAQ,GAAGhC,WAAX;AACD;;AAED,UAAIuN,GAAG,KAAKvN,WAAR,IAAuB0G,IAAI,CAACsL,GAAL,CAASzE,GAAG,GAAG0I,MAAM,CAAC1I,GAAtB,IAA6BgL,GAAxD,EAA6D;AAC3D,aAAKsT,MAAL,CAAYte,GAAZ,EAAiBsiB,QAAjB,EAA2B7tB,QAA3B,EAAqC8tB,YAArC;AACA9tB,QAAAA,QAAQ,GAAGhC,WAAX;AACD;;AAED,UAAIwN,IAAI,KAAKxN,WAAT,IAAwB0G,IAAI,CAACsL,GAAL,CAASxE,IAAI,GAAGyI,MAAM,CAACzI,IAAvB,IAA+B+K,GAA3D,EAAgE;AAC9D,aAAKwJ,OAAL,CAAavU,IAAb,EAAmBqiB,QAAnB,EAA6B7tB,QAA7B,EAAuC8tB,YAAvC;AACA9tB,QAAAA,QAAQ,GAAGhC,WAAX;AACD;;AAED,UAAI,OAAOgC,QAAP,KAAoB,UAAxB,EAAoCA,QAAQ,CAAC8tB,YAAD,CAAR;AACpC,aAAO,IAAP;AACD,KA3BD;AA4BA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKO,cAAL,GAAsB,YAAY;AAChC,aAAOpa,MAAM,CAACqD,WAAd;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKgX,cAAL,GAAsB,UAAUtN,OAAV,EAAmB;AACvC/M,MAAAA,MAAM,CAACqD,WAAP,GAAqB5S,IAAI,CAACyH,GAAL,CAAS,GAAT,EAAczH,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYqc,OAAZ,CAAd,CAArB;AACA0B,MAAAA,WAAW;AACX,aAAO,IAAP;AACD,KAJD;AAKA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAK6L,cAAL,GAAsB,YAAY;AAChC,aAAOta,MAAM,CAACnP,WAAd;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAK0pB,cAAL,GAAsB,UAAU9iB,IAAV,EAAgB;AACpCuI,MAAAA,MAAM,CAACnP,WAAP,GAAqBJ,IAAI,CAACyH,GAAL,CAAS,EAAT,EAAazH,IAAI,CAACC,GAAL,CAAS,CAAC,EAAV,EAAc+G,IAAd,CAAb,CAArB;AACAiI,MAAAA,QAAQ,CAACvI,OAAT,CACG6I,MAAM,CAACpP,YAAP,GAAsBH,IAAI,CAAC4D,EAA5B,GAAkC,GADpC,EAEG2L,MAAM,CAACnP,WAAP,GAAqBJ,IAAI,CAAC4D,EAA3B,GAAiC,GAFnC;AAIAoa,MAAAA,WAAW;AACX,aAAO,IAAP;AACD,KARD;AASA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAK+L,eAAL,GAAuB,YAAY;AACjC,aAAOxa,MAAM,CAACpP,YAAd;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAK6pB,eAAL,GAAuB,UAAUpjB,KAAV,EAAiB;AACtC2I,MAAAA,MAAM,CAACpP,YAAP,GAAsBH,IAAI,CAACyH,GAAL,CAAS,EAAT,EAAazH,IAAI,CAACC,GAAL,CAAS,CAAC,EAAV,EAAc2G,KAAd,CAAb,CAAtB;AACAqI,MAAAA,QAAQ,CAACvI,OAAT,CACG6I,MAAM,CAACpP,YAAP,GAAsBH,IAAI,CAAC4D,EAA5B,GAAkC,GADpC,EAEG2L,MAAM,CAACnP,WAAP,GAAqBJ,IAAI,CAAC4D,EAA3B,GAAiC,GAFnC;AAIAoa,MAAAA,WAAW;AACX,aAAO,IAAP;AACD,KARD;AASA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKiM,eAAL,GAAuB,UAAUhZ,KAAV,EAAiBrK,KAAjB,EAAwB;AAC7CqK,MAAAA,KAAK,GAAGA,KAAK,IAAIK,eAAT,IAA4B,CAApC;AACA1K,MAAAA,KAAK,GAAGA,KAAK,KAAKtN,WAAV,GAAwBkY,SAAxB,GAAoC5K,KAA5C;AACA2I,MAAAA,MAAM,CAACkD,UAAP,GAAoBxB,KAApB;;AAEA3B,MAAAA,KAAK,CAAC2O,MAAN,CAAarX,KAAb,EAAoBtN,WAApB,EAAiCiY,QAAjC,EAA2C,IAA3C;;AAEAyM,MAAAA,WAAW;AACX,aAAO,IAAP;AACD,KATD;AAUA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKkM,cAAL,GAAsB,YAAY;AAChC5Y,MAAAA,eAAe,GAAG/B,MAAM,CAACkD,UAAP,GAAoBlD,MAAM,CAACkD,UAA3B,GAAwCnB,eAA1D;AACA/B,MAAAA,MAAM,CAACkD,UAAP,GAAoB,KAApB;AACAlD,MAAAA,MAAM,CAACmD,yBAAP,GAAmC,CAAC,CAApC;AACA,aAAO,IAAP;AACD,KALD;;AAOA,SAAKyX,WAAL,GAAmB,UAAUj0B,KAAV,EAAiB;AAClCqZ,MAAAA,MAAM,CAAC2H,OAAP,GAAiBhhB,KAAjB;AACAosB,MAAAA,kBAAkB;AAClB9mB,MAAAA,OAAO,CAACC,GAAR,CAAY8T,MAAZ;AACA,aAAO,IAAP;AACD,KALD;AAMA;AACJ;AACA;AACA;AACA;;;AAEI,SAAK6a,YAAL,GAAoB,YAAY;AAC9BrM,MAAAA,aAAa;AACb9M,MAAAA,KAAK,GAAG;AACNpK,QAAAA,GAAG,EAAE,CADC;AAEND,QAAAA,KAAK,EAAE,CAFD;AAGNE,QAAAA,IAAI,EAAE;AAHA,OAAR;AAKD,KAPD;AAQA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKujB,WAAL,GAAmB,YAAY;AAC7B,aAAOpb,QAAP;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKqb,SAAL,GAAiB,UAAUC,IAAV,EAAgB;AAC/B3Y,MAAAA,MAAM,GAAG2Y,IAAI,KAAK,IAAlB;AACA,UAAItb,QAAQ,KAAK3V,WAAjB,EAA8B0e,WAAW,GAAzC,KACKgG,WAAW;AAChB,aAAO,IAAP;AACD,KALD;;AAOA,SAAKE,iBAAL,GAAyB,UAAUtB,KAAV,EAAiB;AACxC,aAAOsB,iBAAiB,CAACtB,KAAD,CAAxB;AACD,KAFD;;AAIA,SAAKwI,iBAAL,GAAyB,YAAY;AACnC,aAAOA,iBAAiB,EAAxB;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKtH,kBAAL,GAA0B,UAAUlB,KAAV,EAAiB;AACzC,aAAOkB,kBAAkB,CAAClB,KAAD,CAAzB;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAK+G,SAAL,GAAiB,UAAUL,OAAV,EAAmB1c,KAAnB,EAA0BC,GAA1B,EAA+BC,IAA/B,EAAqC;AACpD,UAAI3I,MAAM,KAAK,KAAf,EAAsBwlB,SAAS,CAACL,OAAD,EAAU1c,KAAV,EAAiBC,GAAjB,EAAsBC,IAAtB,CAAT;AACtB,aAAO,IAAP;AACD,KAHD;AAIA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAK0jB,QAAL,GAAgB,YAAY;AAC1B,aAAOjb,MAAM,CAACmX,KAAd;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAK+D,YAAL,GAAoB,YAAY;AAC9B,UAAIC,SAAS,GAAG,EAAhB;AACAj1B,MAAAA,MAAM,CAACa,IAAP,CAAY+Y,aAAa,CAACoX,MAA1B,EAAkCxvB,OAAlC,CAA0C,UAAUyvB,KAAV,EAAiB;AACzDgE,QAAAA,SAAS,CAAC9zB,IAAV,CAAeZ,eAAe,CAAC,EAAD,EAAK0wB,KAAL,EAAYrX,aAAa,CAACoX,MAAd,CAAqBC,KAArB,CAAZ,CAA9B;AACD,OAFD;AAGA,aAAOgE,SAAP;AACD,KAND;AAOA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKC,QAAL,GAAgB,UAAUrH,OAAV,EAAmB/T,MAAnB,EAA2B;AACzCF,MAAAA,aAAa,CAACoX,MAAd,CAAqBnD,OAArB,IAAgC/T,MAAhC;AACA,aAAO,IAAP;AACD,KAHD;AAIA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKqb,WAAL,GAAmB,UAAUtH,OAAV,EAAmB;AACpC,UACE/T,MAAM,CAACmX,KAAP,KAAiBpD,OAAjB,IACA,CAACjU,aAAa,CAACoX,MAAd,CAAqBhpB,cAArB,CAAoC6lB,OAApC,CAFH,EAIE,OAAO,KAAP;AACF,aAAOjU,aAAa,CAACoX,MAAd,CAAqBnD,OAArB,CAAP;AACA,aAAO,IAAP;AACD,KARD;AASA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKhN,gBAAL,GAAwB,YAAY;AAClCA,MAAAA,gBAAgB;AAChB,aAAO,IAAP;AACD,KAHD;AAIA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKuU,SAAL,GAAiB,YAAY;AAC3B,aAAOtb,MAAP;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKub,YAAL,GAAoB,YAAY;AAC9B,aAAOtxB,SAAP;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKuxB,UAAL,GAAkB,UAAUpI,EAAV,EAAcW,OAAd,EAAuB;AACvC,UAAIA,OAAO,KAAKhqB,WAAZ,IAA2BiW,MAAM,CAACmX,KAAP,KAAiBptB,WAAhD,EAA6D;AAC3D;AACAiW,QAAAA,MAAM,CAAC8V,QAAP,CAAgBzuB,IAAhB,CAAqB+rB,EAArB;AACD,OAHD,MAGO;AACL;AACA,YAAIqI,EAAE,GAAG1H,OAAO,KAAKhqB,WAAZ,GAA0BgqB,OAA1B,GAAoC/T,MAAM,CAACmX,KAApD;;AAEA,YAAIrX,aAAa,CAACoX,MAAd,CAAqBhpB,cAArB,CAAoCutB,EAApC,CAAJ,EAA6C;AAC3C,cAAI,CAAC3b,aAAa,CAACoX,MAAd,CAAqBuE,EAArB,EAAyBvtB,cAAzB,CAAwC,UAAxC,CAAL,EAA0D;AACxD4R,YAAAA,aAAa,CAACoX,MAAd,CAAqBuE,EAArB,EAAyB3F,QAAzB,GAAoC,EAApC,CADwD,CAChB;;AAExC,gBAAI2F,EAAE,KAAKzb,MAAM,CAACmX,KAAlB,EACEnX,MAAM,CAAC8V,QAAP,GAAkBhW,aAAa,CAACoX,MAAd,CAAqBuE,EAArB,EAAyB3F,QAA3C,CAJsD,CAID;AACxD;;AAEDhW,UAAAA,aAAa,CAACoX,MAAd,CAAqBuE,EAArB,EAAyB3F,QAAzB,CAAkCzuB,IAAlC,CAAuC+rB,EAAvC,EAR2C,CAQC;AAC7C,SATD,MASO;AACL,gBAAM,mBAAN;AACD;AACF;;AAED,UAAIW,OAAO,KAAKhqB,WAAZ,IAA2BiW,MAAM,CAACmX,KAAP,KAAiBpD,OAAhD,EAAyD;AACvD;AACAZ,QAAAA,aAAa,CAACC,EAAD,CAAb;AACA,YAAIxkB,MAAJ,EAAYsnB,aAAa,CAAC9C,EAAD,CAAb;AACb;;AAED,aAAO,IAAP;AACD,KA7BD;AA8BA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKsI,aAAL,GAAqB,UAAUC,SAAV,EAAqB5H,OAArB,EAA8B;AACjD,UAAIA,OAAO,KAAKhqB,WAAZ,IAA2BiW,MAAM,CAACmX,KAAP,KAAiBpD,OAAhD,EAAyD;AACvD,YAAI,CAAC/T,MAAM,CAAC8V,QAAZ,EAAsB,OAAO,KAAP;;AAEtB,aAAK,IAAIlwB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoa,MAAM,CAAC8V,QAAP,CAAgBjwB,MAApC,EAA4CD,CAAC,EAA7C,EAAiD;AAC/C,cACEoa,MAAM,CAAC8V,QAAP,CAAgBlwB,CAAhB,EAAmBsI,cAAnB,CAAkC,IAAlC,KACA8R,MAAM,CAAC8V,QAAP,CAAgBlwB,CAAhB,EAAmB61B,EAAnB,KAA0BE,SAF5B,EAGE;AACA;AACA,gBAAI3F,OAAO,GAAGhW,MAAM,CAAC8V,QAAP,CAAgBlwB,CAAhB,EAAmBkiB,GAAjC;;AAEA,mBAAOkO,OAAO,CAACC,UAAR,IAAsBzQ,eAA7B,EAA8C;AAC5CwQ,cAAAA,OAAO,GAAGA,OAAO,CAACC,UAAlB;AACD;;AAEDzQ,YAAAA,eAAe,CAAClX,WAAhB,CAA4B0nB,OAA5B;AACA,mBAAOhW,MAAM,CAAC8V,QAAP,CAAgBlwB,CAAhB,EAAmBkiB,GAA1B,CATA,CAS+B;;AAE/B9H,YAAAA,MAAM,CAAC8V,QAAP,CAAgBvb,MAAhB,CAAuB3U,CAAvB,EAA0B,CAA1B;AACA,mBAAO,IAAP;AACD;AACF;AACF,OAtBD,MAsBO;AACL,YAAIka,aAAa,CAACoX,MAAd,CAAqBhpB,cAArB,CAAoC6lB,OAApC,CAAJ,EAAkD;AAChD,cAAI,CAACjU,aAAa,CAACoX,MAAd,CAAqBnD,OAArB,EAA8B7lB,cAA9B,CAA6C,UAA7C,CAAL,EACE,OAAO,KAAP;;AAEF,eACE,IAAImB,CAAC,GAAG,CADV,EAEEA,CAAC,GAAGyQ,aAAa,CAACoX,MAAd,CAAqBnD,OAArB,EAA8B+B,QAA9B,CAAuCjwB,MAF7C,EAGEwJ,CAAC,EAHH,EAIE;AACA,gBACEyQ,aAAa,CAACoX,MAAd,CAAqBnD,OAArB,EAA8B+B,QAA9B,CAAuCzmB,CAAvC,EAA0CnB,cAA1C,CAAyD,IAAzD,KACA4R,aAAa,CAACoX,MAAd,CAAqBnD,OAArB,EAA8B+B,QAA9B,CAAuCzmB,CAAvC,EAA0CosB,EAA1C,KAAiDE,SAFnD,EAGE;AACA;AACA7b,cAAAA,aAAa,CAACoX,MAAd,CAAqBnD,OAArB,EAA8B+B,QAA9B,CAAuCvb,MAAvC,CAA8ClL,CAA9C,EAAiD,CAAjD;AACA,qBAAO,IAAP;AACD;AACF;AACF,SAlBD,MAkBO;AACL,iBAAO,KAAP;AACD;AACF;AACF,KA9CD;AA+CA;AACJ;AACA;AACA;AACA;;;AAEI,SAAKyH,MAAL,GAAc,YAAY;AACxB,UAAI4I,QAAJ,EAAcsL,gBAAgB;AAC/B,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAK0O,QAAL,GAAgB,YAAY;AAC1B,aAAO9qB,MAAP;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKgtB,sBAAL,GAA8B,YAAY;AACxC,aAAOrU,kBAAkB,IAAI,KAA7B;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;;;AAEI,SAAKH,eAAL,GAAuB,YAAY;AACjCA,MAAAA,eAAe;AAChB,KAFD;AAGA;AACJ;AACA;AACA;AACA;;;AAEI,SAAKC,gBAAL,GAAwB,YAAY;AAClC,UAAIE,kBAAJ,EAAwBF,gBAAgB;AACzC,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;;;AAEI,SAAKwU,mBAAL,GAA2B,YAAY;AACrC,aAAO/yB,OAAO,CAAC8Y,WAAD,CAAd;AACD,KAFD;AAGA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKka,EAAL,GAAU,UAAU3vB,IAAV,EAAgB4vB,QAAhB,EAA0B;AAClC5Z,MAAAA,sBAAsB,CAAChW,IAAD,CAAtB,GAA+BgW,sBAAsB,CAAChW,IAAD,CAAtB,IAAgC,EAA/D;AACAgW,MAAAA,sBAAsB,CAAChW,IAAD,CAAtB,CAA6B9E,IAA7B,CAAkC00B,QAAlC;AACA,aAAO,IAAP;AACD,KAJD;AAKA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI,SAAKC,GAAL,GAAW,UAAU7vB,IAAV,EAAgB4vB,QAAhB,EAA0B;AACnC,UAAI,CAAC5vB,IAAL,EAAW;AACT;AACAgW,QAAAA,sBAAsB,GAAG,EAAzB;AACA,eAAO,IAAP;AACD;;AAED,UAAI4Z,QAAJ,EAAc;AACZ,YAAIn2B,CAAC,GAAGuc,sBAAsB,CAAChW,IAAD,CAAtB,CAA6BkC,OAA7B,CAAqC0tB,QAArC,CAAR;;AAEA,YAAIn2B,CAAC,IAAI,CAAT,EAAY;AACV;AACAuc,UAAAA,sBAAsB,CAAChW,IAAD,CAAtB,CAA6BoO,MAA7B,CAAoC3U,CAApC,EAAuC,CAAvC;AACD;;AAED,YAAIuc,sBAAsB,CAAChW,IAAD,CAAtB,CAA6BtG,MAA7B,KAAwC,CAA5C,EAA+C;AAC7C;AACA,iBAAOsc,sBAAsB,CAAChW,IAAD,CAA7B;AACD;AACF,OAZD,MAYO;AACL;AACA,eAAOgW,sBAAsB,CAAChW,IAAD,CAA7B;AACD;;AAED,aAAO,IAAP;AACD,KAzBD;AA0BA;AACJ;AACA;AACA;AACA;;;AAEI,aAASghB,SAAT,CAAmBhhB,IAAnB,EAAyB;AACvB,UAAIA,IAAI,IAAIgW,sBAAZ,EAAoC;AAClC;AACA,aAAK,IAAIvc,CAAC,GAAGuc,sBAAsB,CAAChW,IAAD,CAAtB,CAA6BtG,MAA1C,EAAkDD,CAAC,GAAG,CAAtD,EAAyDA,CAAC,EAA1D,EAA8D;AAC5Duc,UAAAA,sBAAsB,CAAChW,IAAD,CAAtB,CACEgW,sBAAsB,CAAChW,IAAD,CAAtB,CAA6BtG,MAA7B,GAAsCD,CADxC,EAEE0B,KAFF,CAEQ,IAFR,EAEc,GAAG+I,KAAH,CAASrH,IAAT,CAAcxB,SAAd,EAAyB,CAAzB,CAFd;AAGD;AACF;AACF;AACD;AACJ;AACA;AACA;AACA;;;AAEI,SAAKkP,OAAL,GAAe,YAAY;AACzB8L,MAAAA,SAAS,GAAG,IAAZ;AACAkL,MAAAA,YAAY,CAAC5L,eAAD,CAAZ;AACA,UAAIpC,QAAJ,EAAcA,QAAQ,CAAChJ,OAAT;;AAEd,UAAI6K,cAAJ,EAAoB;AAClBzX,QAAAA,QAAQ,CAACuvB,mBAAT,CAA6B,WAA7B,EAA0C1O,mBAA1C,EAA+D,KAA/D;AACA7gB,QAAAA,QAAQ,CAACuvB,mBAAT,CAA6B,SAA7B,EAAwCzO,iBAAxC,EAA2D,KAA3D;AACA3gB,QAAAA,SAAS,CAACovB,mBAAV,CACE,qBADF,EAEEtO,kBAFF,EAGE,KAHF;AAKA9gB,QAAAA,SAAS,CAACovB,mBAAV,CACE,wBADF,EAEEtO,kBAFF,EAGE,KAHF;AAKA9gB,QAAAA,SAAS,CAACovB,mBAAV,CACE,oBADF,EAEEtO,kBAFF,EAGE,KAHF;AAKA9gB,QAAAA,SAAS,CAACovB,mBAAV,CACE,kBADF,EAEEtO,kBAFF,EAGE,KAHF;AAKAlhB,QAAAA,MAAM,CAACwvB,mBAAP,CAA2B,QAA3B,EAAqCrO,gBAArC,EAAuD,KAAvD;AACAnhB,QAAAA,MAAM,CAACwvB,mBAAP,CACE,mBADF,EAEErO,gBAFF,EAGE,KAHF;AAKA/gB,QAAAA,SAAS,CAACovB,mBAAV,CAA8B,SAA9B,EAAyCpO,kBAAzC,EAA6D,KAA7D;AACAhhB,QAAAA,SAAS,CAACovB,mBAAV,CAA8B,OAA9B,EAAuCnO,eAAvC,EAAwD,KAAxD;AACAjhB,QAAAA,SAAS,CAACovB,mBAAV,CAA8B,MAA9B,EAAsClO,SAAtC,EAAiD,KAAjD;AACArhB,QAAAA,QAAQ,CAACuvB,mBAAT,CAA6B,YAA7B,EAA2CzO,iBAA3C,EAA8D,KAA9D;AACD;;AAED3gB,MAAAA,SAAS,CAAC0b,SAAV,GAAsB,EAAtB;AACA1b,MAAAA,SAAS,CAACmb,SAAV,CAAoBkF,MAApB,CAA2B,gBAA3B;AACD,KA1CD;AA2CD;;AAED,SAAO;AACL2R,IAAAA,MAAM,EAAE,SAASA,MAAT,CAAgBhyB,SAAhB,EAA2B+V,MAA3B,EAAmC;AACzC,aAAO,IAAIH,MAAJ,CAAW5V,SAAX,EAAsB+V,MAAtB,CAAP;AACD;AAHI,GAAP;AAKD,CA9kHe,CA+kHd,OAAOnW,MAAP,KAAkB,WAAlB,GAAgC,IAAhC,GAAuCA,MA/kHzB,EAglHd,OAAOC,QAAP,KAAoB,WAApB,GAAkC,IAAlC,GAAyCA,QAhlH3B,CAAhB;;AAmlHA,IAAIoyB,SAAS,GAAG,SAASA,SAAT,CAAmBC,SAAnB,EAA8B;AAC5C,OACE,IAAIC,IAAI,GAAG50B,SAAS,CAAC3B,MAArB,EACEw2B,IAAI,GAAG,IAAIjb,KAAJ,CAAUgb,IAAI,GAAG,CAAP,GAAWA,IAAI,GAAG,CAAlB,GAAsB,CAAhC,CADT,EAEEE,IAAI,GAAG,CAHX,EAIEA,IAAI,GAAGF,IAJT,EAKEE,IAAI,EALN,EAME;AACAD,IAAAA,IAAI,CAACC,IAAI,GAAG,CAAR,CAAJ,GAAiB90B,SAAS,CAAC80B,IAAD,CAA1B;AACD;;AAED,MAAIC,OAAO,GAAG,IAAIC,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AACnD,QAAIP,SAAJ,EAAe;AACb,UAAIE,IAAI,KAAK,EAAb,EAAiB;AACfI,QAAAA,OAAO,CAACn1B,KAAR,CAAc,KAAK,CAAnB,EAAsB+0B,IAAtB;AACD,OAFD,MAEO;AACLK,QAAAA,MAAM,CAAC,4BAAD,CAAN;AACD;AACF,KAND,MAMO;AACLA,MAAAA,MAAM,CAAC,yBAAD,CAAN;AACD;AACF,GAVa,CAAd;AAWA,SAAOH,OAAP;AACD,CAvBD;;AAyBA,IAAII,OAAO,GAAG;AACZnY,EAAAA,MAAM,EAAE;AACNC,IAAAA,eAAe,EAAE,8BADX;AAENC,IAAAA,YAAY,EAAE,YAFR;AAGNC,IAAAA,WAAW,EAAE,OAHP;AAINC,IAAAA,eAAe,EAAE,kCAJX;AAKNC,IAAAA,eAAe,EAAE,oCALX;AAMNC,IAAAA,iBAAiB,EAAE,iDANb;AAONC,IAAAA,cAAc,EACZ,yIARI;AASNC,IAAAA,iBAAiB,EACf,kFAVI;AAWNC,IAAAA,gBAAgB,EACd,yLAZI;AAaNC,IAAAA,YAAY,EAAE;AAbR,GADI;AAgBZ0X,EAAAA,MAAM,EAAE;AACNvyB,IAAAA,KAAK,EAAE,MADD;AAENC,IAAAA,MAAM,EAAE,KAFF;AAGNuyB,IAAAA,UAAU,EAAE;AAHN,GAhBI;AAqBZC,EAAAA,sBAAsB,EAAE;AACtBlxB,IAAAA,IAAI,EAAE,GADgB;AAEtBC,IAAAA,IAAI,EAAE,GAFgB;AAGtBoX,IAAAA,OAAO,EAAE,CAHa;AAItBkJ,IAAAA,cAAc,EAAE;AAJM,GArBZ;AA2BZ4Q,EAAAA,eAAe,EAAE;AACfhX,IAAAA,KAAK,EAAE,EADQ;AAEfE,IAAAA,MAAM,EAAE,EAFO;AAGfD,IAAAA,WAAW,EAAE,EAHE;AAIfpC,IAAAA,QAAQ,EAAE,KAJK;AAKfV,IAAAA,UAAU,EAAE,CALG;AAMfC,IAAAA,yBAAyB,EAAE,CANZ;AAOfC,IAAAA,mBAAmB,EAAE,CAPN;AAQfhD,IAAAA,OAAO,EAAE,EARM;AASfuD,IAAAA,YAAY,EAAE,IATC;AAUfF,IAAAA,YAAY,EAAE,IAVC;AAWfC,IAAAA,SAAS,EAAE,IAXI;AAYfF,IAAAA,eAAe,EAAE,KAZF;AAafW,IAAAA,SAAS,EAAE,IAbI;AAcfI,IAAAA,QAAQ,EAAE,IAdK;AAefH,IAAAA,mBAAmB,EAAE,KAfN;AAgBfd,IAAAA,kBAAkB,EAAE,IAhBL;AAiBfO,IAAAA,YAAY,EAAE,IAjBC;AAkBfQ,IAAAA,wBAAwB,EAAE,CAlBX;AAmBf/M,IAAAA,GAAG,EAAE,CAnBU;AAoBfD,IAAAA,KAAK,EAAE,CApBQ;AAqBfyL,IAAAA,QAAQ,EAAE,EArBK;AAsBfD,IAAAA,QAAQ,EAAE,CAAC,EAtBI;AAuBfG,IAAAA,MAAM,EAAE,GAvBO;AAwBfD,IAAAA,MAAM,EAAE,CAAC,GAxBM;AAyBfxL,IAAAA,IAAI,EAAE,GAzBS;AA0BfmL,IAAAA,OAAO,EAAE,EA1BM;AA2BfE,IAAAA,OAAO,EAAE,GA3BM;AA4BfD,IAAAA,eAAe,EAAE,KA5BF;AA6BfrV,IAAAA,eAAe,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CA7BF;AA8Bf0W,IAAAA,sBAAsB,EAAE,KA9BT;AA+Bf2D,IAAAA,OAAO,EAAE,KA/BM;AAgCftE,IAAAA,WAAW,EAAE,CAhCE;AAiCfyS,IAAAA,QAAQ,EAAE,EAjCK;AAkCf/R,IAAAA,YAAY,EAAE;AAlCC;AA3BL,CAAd;;AAiEA,SAASiZ,WAAT,CAAqBC,GAArB,EAA0BC,GAA1B,EAA+B;AAC7B,MAAIA,GAAG,KAAK,KAAK,CAAjB,EAAoBA,GAAG,GAAG,EAAN;AACpB,MAAIC,QAAQ,GAAGD,GAAG,CAACC,QAAnB;;AAEA,MAAI,CAACF,GAAD,IAAQ,OAAOnzB,QAAP,KAAoB,WAAhC,EAA6C;AAC3C;AACD;;AAED,MAAIszB,IAAI,GAAGtzB,QAAQ,CAACszB,IAAT,IAAiBtzB,QAAQ,CAACie,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAA5B;AACA,MAAI3d,KAAK,GAAGN,QAAQ,CAACK,aAAT,CAAuB,OAAvB,CAAZ;AACAC,EAAAA,KAAK,CAAC+B,IAAN,GAAa,UAAb;;AAEA,MAAIgxB,QAAQ,KAAK,KAAjB,EAAwB;AACtB,QAAIC,IAAI,CAACC,UAAT,EAAqB;AACnBD,MAAAA,IAAI,CAACE,YAAL,CAAkBlzB,KAAlB,EAAyBgzB,IAAI,CAACC,UAA9B;AACD,KAFD,MAEO;AACLD,MAAAA,IAAI,CAAC7yB,WAAL,CAAiBH,KAAjB;AACD;AACF,GAND,MAMO;AACLgzB,IAAAA,IAAI,CAAC7yB,WAAL,CAAiBH,KAAjB;AACD;;AAED,MAAIA,KAAK,CAACmzB,UAAV,EAAsB;AACpBnzB,IAAAA,KAAK,CAACmzB,UAAN,CAAiBC,OAAjB,GAA2BP,GAA3B;AACD,GAFD,MAEO;AACL7yB,IAAAA,KAAK,CAACG,WAAN,CAAkBT,QAAQ,CAAC2zB,cAAT,CAAwBR,GAAxB,CAAlB;AACD;AACF;;AAED,IAAIS,QAAQ,GAAI,w4NAAu4N,ilBAAklB,o/VAAz+O;AACAV,WAAW,CAACU,QAAD,CAAX;AAEA,IAAIC,WAAW,GAAG,IAAlB;;AAEA,IAAIC,cAAc,GAAG,aAAe,UAAUC,gBAAV,EAA4B;AAC9Dh2B,EAAAA,SAAS,CAAC+1B,cAAD,EAAiBC,gBAAjB,CAAT;;AAEA,MAAIC,MAAM,GAAGz0B,YAAY,CAACu0B,cAAD,CAAzB;;AAEA,WAASA,cAAT,GAA0B;AACxB,QAAI7d,KAAJ;;AAEA1a,IAAAA,eAAe,CAAC,IAAD,EAAOu4B,cAAP,CAAf;;AAEA,SACE,IAAIxB,IAAI,GAAG50B,SAAS,CAAC3B,MAArB,EAA6Bw2B,IAAI,GAAG,IAAIjb,KAAJ,CAAUgb,IAAV,CAApC,EAAqDE,IAAI,GAAG,CAD9D,EAEEA,IAAI,GAAGF,IAFT,EAGEE,IAAI,EAHN,EAIE;AACAD,MAAAA,IAAI,CAACC,IAAD,CAAJ,GAAa90B,SAAS,CAAC80B,IAAD,CAAtB;AACD;;AAEDvc,IAAAA,KAAK,GAAG+d,MAAM,CAAC90B,IAAP,CAAY1B,KAAZ,CAAkBw2B,MAAlB,EAA0B,CAAC,IAAD,EAAOvpB,MAAP,CAAc8nB,IAAd,CAA1B,CAAR;AACAtc,IAAAA,KAAK,CAACge,KAAN,GAAc;AACZxV,MAAAA,WAAW,EAAE,EADD;AAEZuU,MAAAA,sBAAsB,EAAE,EAFZ;AAGZjU,MAAAA,OAAO,EAAE,EAHG;AAIZR,MAAAA,QAAQ,EAAE;AAJE,KAAd;;AAOAtI,IAAAA,KAAK,CAACvU,IAAN,GAAa,YAAY;AACvB,UAAIwyB,WAAW,GAAGje,KAAK,CAACge,KAAxB;AAAA,UACExV,WAAW,GAAGyV,WAAW,CAACzV,WAD5B;AAAA,UAEEuU,sBAAsB,GAAGkB,WAAW,CAAClB,sBAFvC;AAAA,UAGEjU,OAAO,GAAGmV,WAAW,CAACnV,OAHxB;AAAA,UAIER,QAAQ,GAAG2V,WAAW,CAAC3V,QAJzB;AAKA,UAAI4V,WAAW,GAAGle,KAAK,CAACpa,KAAxB;AAAA,UACEouB,OAAO,GAAGkK,WAAW,CAAClK,OADxB;AAAA,UAEE/T,MAAM,GAAGie,WAAW,CAACje,MAFvB;AAAA,UAGE7T,IAAI,GAAG8xB,WAAW,CAAC9xB,IAHrB;AAIAwxB,MAAAA,WAAW,GAAG/d,SAAS,CAACqc,MAAV,CAAiBlc,KAAK,CAACpa,KAAN,CAAY81B,EAA7B,EAAiC;AAC7Cv2B,QAAAA,OAAO,EAAE;AACP0iB,UAAAA,UAAU,EAAEmM;AADL,SADoC;AAI7CmD,QAAAA,MAAM,EAAEzwB,eAAe,CACrB,EADqB,EAErBstB,OAFqB,EAGrBxsB,cAAc,CACZA,cAAc,CACZA,cAAc,CACZA,cAAc,CACZA,cAAc,CACZA,cAAc,CAAC,EAAD,EAAKo1B,OAAO,CAACI,eAAb,CADF,EAEZJ,OAAO,CAACG,sBAFI,CADF,EAKZH,OAAO,CAACnY,MALI,CADF,EAQZxE,MARY,CADF,EAWZ,EAXY,EAYZ;AACE7T,UAAAA,IAAI,EAAEA,IADR;AAEEoc,UAAAA,WAAW,EAAEA;AAFf,SAZY,EAgBZuU,sBAhBY,CADF,EAmBZ,EAnBY,EAoBZ;AACEjU,UAAAA,OAAO,EAAEA,OADX;AAEER,UAAAA,QAAQ,EAAEA;AAFZ,SApBY,CAHO;AAJsB,OAAjC,CAAd;AAmCAsV,MAAAA,WAAW,IACTA,WAAW,CAAC7B,EAAZ,CAAe,WAAf,EAA4B,UAAUzO,KAAV,EAAiB;AAC3C,eAAOtN,KAAK,CAACpa,KAAN,CAAYu4B,WAAZ,CAAwB7Q,KAAxB,CAAP;AACD,OAFD,CADF;AAKAsQ,MAAAA,WAAW,IACTA,WAAW,CAAC7B,EAAZ,CAAe,SAAf,EAA0B,UAAUzO,KAAV,EAAiB;AACzC,eAAOtN,KAAK,CAACpa,KAAN,CAAYw4B,SAAZ,CAAsB9Q,KAAtB,CAAP;AACD,OAFD,CADF;AAKAsQ,MAAAA,WAAW,IACTA,WAAW,CAAC7B,EAAZ,CAAe,WAAf,EAA4B,UAAUzO,KAAV,EAAiB;AAC3C,eAAOtN,KAAK,CAACpa,KAAN,CAAYy4B,WAAZ,CAAwB/Q,KAAxB,CAAP;AACD,OAFD,CADF;AAKAsQ,MAAAA,WAAW,IACTA,WAAW,CAAC7B,EAAZ,CAAe,MAAf,EAAuB,YAAY;AACjC,eAAO6B,WAAW,CAAC9H,iBAAZ,EAAP;AACD,OAFD,CADF,CA5DuB,CAiEvB;AACA;AACA;AACA;AACD,KArED;;AAuEA,WAAO9V,KAAP;AACD;;AAED1Z,EAAAA,YAAY,CACVu3B,cADU,EAEV,CACE;AACEx3B,IAAAA,GAAG,EAAE,eADP;AAEEO,IAAAA,KAAK,EAAE,SAAS03B,aAAT,GAAyB;AAC9B,UAAIC,MAAM,GAAG,IAAb;;AAEA,UAAIC,YAAY,GAAG,KAAK54B,KAAxB;AAAA,UACE4iB,WAAW,GAAGgW,YAAY,CAAChW,WAD7B;AAAA,UAEEpc,IAAI,GAAGoyB,YAAY,CAACpyB,IAFtB;AAAA,UAGE0c,OAAO,GAAG0V,YAAY,CAAC1V,OAHzB;AAAA,UAIER,QAAQ,GAAGkW,YAAY,CAAClW,QAJ1B;AAAA,UAKEyU,sBAAsB,GAAGyB,YAAY,CAACzB,sBALxC;;AAOA,cAAQ3wB,IAAR;AACE,aAAK,iBAAL;AACE,eAAKqyB,QAAL,CACE;AACEjW,YAAAA,WAAW,EAAEA,WADf;AAEEuU,YAAAA,sBAAsB,EAAEA,sBAF1B;AAGEjU,YAAAA,OAAO,EAAE;AAHX,WADF,EAME,YAAY;AACV,mBAAOyV,MAAM,CAAC9yB,IAAP,EAAP;AACD,WARH;AAUA;;AAEF,aAAK,SAAL;AACE,eAAKgzB,QAAL,CACE;AACE3V,YAAAA,OAAO,EAAEA,OADX;AAEEN,YAAAA,WAAW,EAAE;AAFf,WADF,EAKE,YAAY;AACV,mBAAO+V,MAAM,CAAC9yB,IAAP,EAAP;AACD,WAPH;AASA;;AAEF,aAAK,UAAL;AACE,eAAKgzB,QAAL,CACE;AACE3V,YAAAA,OAAO,EAAE,EADX;AAEEN,YAAAA,WAAW,EAAE,EAFf;AAGEF,YAAAA,QAAQ,EAAEA;AAHZ,WADF,EAME,YAAY;AACV,mBAAOiW,MAAM,CAAC9yB,IAAP,EAAP;AACD,WARH;AAUA;AArCJ;AAuCD;AAnDH,GADF,EAsDE;AACEpF,IAAAA,GAAG,EAAE,mBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS83B,iBAAT,GAA6B;AAClC,WAAKJ,aAAL;AACD;AAJH,GAtDF,EA4DE;AACEj4B,IAAAA,GAAG,EAAE,sBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS+3B,oBAAT,GAAgC;AACrCf,MAAAA,WAAW,IACT,KAAKh4B,KAAL,CAAWg5B,gBADb,IAEEhB,WAAW,CAAC3B,GAAZ,CAAgB,MAAhB,EAAwB,KAAKr2B,KAAL,CAAWg5B,gBAAnC,CAFF;AAGD;AANH,GA5DF,EAoEE;AACEv4B,IAAAA,GAAG,EAAE,QADP;AAEEO,IAAAA,KAAK,EAAE,SAASyQ,MAAT,GAAkB;AACvB,UAAIwnB,YAAY,GAAG,KAAKj5B,KAAxB;AAAA,UACEyE,KAAK,GAAGw0B,YAAY,CAACx0B,KADvB;AAAA,UAEEmE,SAAS,GAAGqwB,YAAY,CAACrwB,SAF3B;AAAA,UAGEktB,EAAE,GAAGmD,YAAY,CAACnD,EAHpB;AAAA,UAIE/e,QAAQ,GAAGkiB,YAAY,CAACliB,QAJ1B;AAKA,aAAO,aAAcvX,cAAc,CAAC,SAAD,CAAd,CAA0BgF,aAA1B,CAAwC,KAAxC,EAA+C;AAClEsxB,QAAAA,EAAE,EAAEA,EAD8D;AAElErxB,QAAAA,KAAK,EAAEA,KAF2D;AAGlEmE,QAAAA,SAAS,EAAEA,SAHuD;AAIlEmO,QAAAA,QAAQ,EAAEA;AAJwD,OAA/C,CAArB;AAMD;AAdH,GApEF,CAFU,EAuFV,CACE;AACEtW,IAAAA,GAAG,EAAE,UADP;AAEEO,IAAAA,KAAK,EAAE,SAAS+yB,QAAT,GAAoB;AACzB,aAAOiE,WAAW,IAAIA,WAAW,CAACjE,QAAZ,EAAtB;AACD;AAJH,GADF,EAOE;AACEtzB,IAAAA,GAAG,EAAE,UADP;AAEEO,IAAAA,KAAK,EAAE,SAAS4qB,QAAT,GAAoB;AACzB,aAAOoM,WAAW,IAAIA,WAAW,CAACpM,QAAZ,EAAtB;AACD;AAJH,GAPF,EAaE;AACEnrB,IAAAA,GAAG,EAAE,UADP;AAEEO,IAAAA,KAAK,EAAE,SAASgzB,QAAT,CAAkBtiB,KAAlB,EAAyB;AAC9B,UAAIuiB,QAAQ,GACVpyB,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,IAAwB2B,SAAS,CAAC,CAAD,CAAT,KAAiBq3B,SAAzC,GACIr3B,SAAS,CAAC,CAAD,CADb,GAEI,IAHN;AAIA,UAAIuE,QAAQ,GAAGvE,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,GAAuB2B,SAAS,CAAC,CAAD,CAAhC,GAAsCq3B,SAArD;AACA,UAAIhF,YAAY,GAAGryB,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,GAAuB2B,SAAS,CAAC,CAAD,CAAhC,GAAsCq3B,SAAzD;;AAEA,UAAIlB,WAAJ,EAAiB;AACfA,QAAAA,WAAW,CAAChE,QAAZ,CAAqBtiB,KAArB,EAA4BuiB,QAA5B,EAAsC7tB,QAAtC,EAAgD8tB,YAAhD;AACD;AACF;AAbH,GAbF,EA4BE;AACEzzB,IAAAA,GAAG,EAAE,gBADP;AAEEO,IAAAA,KAAK,EAAE,SAASmzB,cAAT,GAA0B;AAC/B,aAAO6D,WAAW,IAAIA,WAAW,CAAC7D,cAAZ,EAAtB;AACD;AAJH,GA5BF,EAkCE;AACE1zB,IAAAA,GAAG,EAAE,gBADP;AAEEO,IAAAA,KAAK,EAAE,SAASozB,cAAT,CAAwBhM,MAAxB,EAAgC;AACrC,UAAI4P,WAAJ,EAAiB;AACfA,QAAAA,WAAW,CAAC5D,cAAZ,CAA2BhM,MAA3B;AACD;AACF;AANH,GAlCF,EA0CE;AACE3nB,IAAAA,GAAG,EAAE,QADP;AAEEO,IAAAA,KAAK,EAAE,SAAS6qB,MAAT,GAAkB;AACvB,aAAOmM,WAAW,IAAIA,WAAW,CAACnM,MAAZ,EAAtB;AACD;AAJH,GA1CF,EAgDE;AACEprB,IAAAA,GAAG,EAAE,QADP;AAEEO,IAAAA,KAAK,EAAE,SAASivB,MAAT,CAAgBte,GAAhB,EAAqB;AAC1B,UAAIsiB,QAAQ,GACVpyB,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,IAAwB2B,SAAS,CAAC,CAAD,CAAT,KAAiBq3B,SAAzC,GACIr3B,SAAS,CAAC,CAAD,CADb,GAEI,IAHN;AAIA,UAAIuE,QAAQ,GAAGvE,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,GAAuB2B,SAAS,CAAC,CAAD,CAAhC,GAAsCq3B,SAArD;AACA,UAAIhF,YAAY,GAAGryB,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,GAAuB2B,SAAS,CAAC,CAAD,CAAhC,GAAsCq3B,SAAzD;;AAEA,UAAIlB,WAAJ,EAAiB;AACfA,QAAAA,WAAW,CAAC/H,MAAZ,CAAmBte,GAAnB,EAAwBsiB,QAAxB,EAAkC7tB,QAAlC,EAA4C8tB,YAA5C;AACD;AACF;AAbH,GAhDF,EA+DE;AACEzzB,IAAAA,GAAG,EAAE,cADP;AAEEO,IAAAA,KAAK,EAAE,SAASqzB,YAAT,GAAwB;AAC7B,aAAO2D,WAAW,IAAIA,WAAW,CAAC3D,YAAZ,EAAtB;AACD;AAJH,GA/DF,EAqEE;AACE5zB,IAAAA,GAAG,EAAE,cADP;AAEEO,IAAAA,KAAK,EAAE,SAASszB,YAAT,CAAsBlM,MAAtB,EAA8B;AACnCmO,MAAAA,SAAS,CAACyB,WAAD,EAAc;AACrB5P,QAAAA,MAAM,EAAEA;AADa,OAAd,CAAT,CAGGuL,IAHH,CAGQ,UAAUwF,IAAV,EAAgB;AACpB,YAAI/Q,MAAM,GAAG+Q,IAAI,CAAC/Q,MAAlB;AACA4P,QAAAA,WAAW,CAAC1D,YAAZ,CAAyBlM,MAAzB;AACD,OANH,EAOG,OAPH,EAOY,UAAUtX,GAAV,EAAe;AACvBxK,QAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,OATH;AAUD;AAbH,GArEF,EAoFE;AACErQ,IAAAA,GAAG,EAAE,SADP;AAEEO,IAAAA,KAAK,EAAE,SAAS8qB,OAAT,GAAmB;AACxB,aAAOkM,WAAW,IAAIA,WAAW,CAAClM,OAAZ,EAAtB;AACD;AAJH,GApFF,EA0FE;AACErrB,IAAAA,GAAG,EAAE,SADP;AAEEO,IAAAA,KAAK,EAAE,SAASmlB,OAAT,CAAiBvU,IAAjB,EAAuB;AAC5B,UAAIqiB,QAAQ,GACVpyB,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,IAAwB2B,SAAS,CAAC,CAAD,CAAT,KAAiBq3B,SAAzC,GACIr3B,SAAS,CAAC,CAAD,CADb,GAEI,IAHN;AAIA,UAAIuE,QAAQ,GAAGvE,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,GAAuB2B,SAAS,CAAC,CAAD,CAAhC,GAAsCq3B,SAArD;AACA,UAAIhF,YAAY,GAAGryB,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,GAAuB2B,SAAS,CAAC,CAAD,CAAhC,GAAsCq3B,SAAzD;;AAEA,UAAIlB,WAAJ,EAAiB;AACfA,QAAAA,WAAW,CAAC7R,OAAZ,CAAoBvU,IAApB,EAA0BqiB,QAA1B,EAAoC7tB,QAApC,EAA8C8tB,YAA9C;AACD;AACF;AAbH,GA1FF,EAyGE;AACEzzB,IAAAA,GAAG,EAAE,eADP;AAEEO,IAAAA,KAAK,EAAE,SAASuzB,aAAT,GAAyB;AAC9B,aAAOyD,WAAW,IAAIA,WAAW,CAACzD,aAAZ,EAAtB;AACD;AAJH,GAzGF,EA+GE;AACE9zB,IAAAA,GAAG,EAAE,eADP;AAEEO,IAAAA,KAAK,EAAE,SAASwzB,aAAT,CAAuBpM,MAAvB,EAA+B;AACpCmO,MAAAA,SAAS,CAACyB,WAAD,EAAc;AACrB5P,QAAAA,MAAM,EAAEA;AADa,OAAd,CAAT,CAGGuL,IAHH,CAGQ,UAAUyF,KAAV,EAAiB;AACrB,YAAIhR,MAAM,GAAGgR,KAAK,CAAChR,MAAnB;AACA4P,QAAAA,WAAW,CAACxD,aAAZ,CAA0BpM,MAA1B;AACD,OANH,EAOG,OAPH,EAOY,UAAUtX,GAAV,EAAe;AACvBxK,QAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,OATH;AAUD;AAbH,GA/GF,EA8HE;AACErQ,IAAAA,GAAG,EAAE,QADP;AAEEO,IAAAA,KAAK,EAAE,SAAS+nB,MAAT,CAAgBrX,KAAhB,EAAuBC,GAAvB,EAA4BC,IAA5B,EAAkC;AACvC,UAAIqiB,QAAQ,GACVpyB,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,IAAwB2B,SAAS,CAAC,CAAD,CAAT,KAAiBq3B,SAAzC,GACIr3B,SAAS,CAAC,CAAD,CADb,GAEI,IAHN;AAIA,UAAIuE,QAAQ,GAAGvE,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,GAAuB2B,SAAS,CAAC,CAAD,CAAhC,GAAsCq3B,SAArD;AACA,UAAIhF,YAAY,GAAGryB,SAAS,CAAC3B,MAAV,GAAmB,CAAnB,GAAuB2B,SAAS,CAAC,CAAD,CAAhC,GAAsCq3B,SAAzD;;AAEA,UAAIlB,WAAJ,EAAiB;AACfA,QAAAA,WAAW,CAACjP,MAAZ,CACErX,KADF,EAEEC,GAFF,EAGEC,IAHF,EAIEqiB,QAJF,EAKE7tB,QALF,EAME8tB,YANF;AAQD;AACF;AApBH,GA9HF,EAoJE;AACEzzB,IAAAA,GAAG,EAAE,gBADP;AAEEO,IAAAA,KAAK,EAAE,SAASyzB,cAAT,GAA0B;AAC/B,aAAOuD,WAAW,IAAIA,WAAW,CAACvD,cAAZ,EAAtB;AACD;AAJH,GApJF,EA0JE;AACEh0B,IAAAA,GAAG,EAAE,gBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS0zB,cAAT,CAAwBtN,OAAxB,EAAiC;AACtCmP,MAAAA,SAAS,CAACyB,WAAD,EAAc;AACrB5Q,QAAAA,OAAO,EAAEA;AADY,OAAd,CAAT,CAGGuM,IAHH,CAGQ,UAAU0F,KAAV,EAAiB;AACrB,YAAIjS,OAAO,GAAGiS,KAAK,CAACjS,OAApB;AACA4Q,QAAAA,WAAW,CAACtD,cAAZ,CAA2BtN,OAA3B;AACD,OANH,EAOG,OAPH,EAOY,UAAUtW,GAAV,EAAe;AACvBxK,QAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,OATH;AAUD;AAbH,GA1JF,EAyKE;AACErQ,IAAAA,GAAG,EAAE,gBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS2zB,cAAT,GAA0B;AAC/B,aAAOqD,WAAW,IAAIA,WAAW,CAACrD,cAAZ,EAAtB;AACD;AAJH,GAzKF,EA+KE;AACEl0B,IAAAA,GAAG,EAAE,gBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS4zB,cAAT,CAAwB9iB,IAAxB,EAA8B;AACnCykB,MAAAA,SAAS,CAACyB,WAAD,EAAc;AACrBlmB,QAAAA,IAAI,EAAEA;AADe,OAAd,CAAT,CAGG6hB,IAHH,CAGQ,UAAU2F,KAAV,EAAiB;AACrB,YAAIxnB,IAAI,GAAGwnB,KAAK,CAACxnB,IAAjB;AACAkmB,QAAAA,WAAW,CAACpD,cAAZ,CAA2B9iB,IAA3B;AACD,OANH,EAOG,OAPH,EAOY,UAAUhB,GAAV,EAAe;AACvBxK,QAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,OATH;AAUD;AAbH,GA/KF,EA8LE;AACErQ,IAAAA,GAAG,EAAE,iBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS6zB,eAAT,GAA2B;AAChC,aAAOmD,WAAW,IAAIA,WAAW,CAACnD,eAAZ,EAAtB;AACD;AAJH,GA9LF,EAoME;AACEp0B,IAAAA,GAAG,EAAE,iBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS8zB,eAAT,CAAyBpjB,KAAzB,EAAgC;AACrC6kB,MAAAA,SAAS,CAACyB,WAAD,EAAc;AACrBtmB,QAAAA,KAAK,EAAEA;AADc,OAAd,CAAT,CAGGiiB,IAHH,CAGQ,UAAU4F,KAAV,EAAiB;AACrB,YAAI7nB,KAAK,GAAG6nB,KAAK,CAAC7nB,KAAlB;AACAsmB,QAAAA,WAAW,CAAClD,eAAZ,CAA4BpjB,KAA5B;AACD,OANH,EAOG,OAPH,EAOY,UAAUZ,GAAV,EAAe;AACvBxK,QAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,OATH;AAUD;AAbH,GApMF,EAmNE;AACErQ,IAAAA,GAAG,EAAE,iBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS+zB,eAAT,CAAyBhZ,KAAzB,EAAgCrK,KAAhC,EAAuC;AAC5C6kB,MAAAA,SAAS,CAACyB,WAAD,EAAc;AACrBtmB,QAAAA,KAAK,EAAEA;AADc,OAAd,CAAT,CAGGiiB,IAHH,CAGQ,UAAU6F,KAAV,EAAiB;AACrB,YAAI9nB,KAAK,GAAG8nB,KAAK,CAAC9nB,KAAlB;AACAsmB,QAAAA,WAAW,CAACjD,eAAZ,CAA4BhZ,KAA5B,EAAmCrK,KAAnC;AACD,OANH,EAOG,OAPH,EAOY,UAAUZ,GAAV,EAAe;AACvBxK,QAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,OATH;AAUD;AAbH,GAnNF,EAkOE;AACErQ,IAAAA,GAAG,EAAE,gBADP;AAEEO,IAAAA,KAAK,EAAE,SAASg0B,cAAT,GAA0B;AAC/B,UAAIgD,WAAJ,EAAiB;AACfA,QAAAA,WAAW,CAAChD,cAAZ;AACD;AACF;AANH,GAlOF,EA0OE;AACEv0B,IAAAA,GAAG,EAAE,aADP;AAEEO,IAAAA,KAAK,EAAE,SAASi0B,WAAT,CAAqBj0B,KAArB,EAA4B;AACjCu1B,MAAAA,SAAS,CAACyB,WAAD,EAAc,EAAd,CAAT,CACGrE,IADH,CACQ,YAAY;AAChBqE,QAAAA,WAAW,CAAC/C,WAAZ,CAAwBj0B,KAAxB;AACD,OAHH,EAIG,OAJH,EAIY,UAAU8P,GAAV,EAAe;AACvBxK,QAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,OANH;AAOD;AAVH,GA1OF,EAsPE;AACErQ,IAAAA,GAAG,EAAE,mBADP;AAEEO,IAAAA,KAAK,EAAE,SAASgoB,iBAAT,CAA2BtB,KAA3B,EAAkC;AACvC,aAAOsQ,WAAW,IAAIA,WAAW,CAAChP,iBAAZ,CAA8BtB,KAA9B,CAAtB;AACD;AAJH,GAtPF,EA4PE;AACEjnB,IAAAA,GAAG,EAAE,oBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS4nB,kBAAT,CAA4BlB,KAA5B,EAAmC;AACxC,aAAOsQ,WAAW,IAAIA,WAAW,CAACpP,kBAAZ,CAA+BlB,KAA/B,CAAtB;AACD;AAJH,GA5PF,EAkQE;AACEjnB,IAAAA,GAAG,EAAE,UADP;AAEEO,IAAAA,KAAK,EAAE,SAASy0B,QAAT,CAAkBrH,OAAlB,EAA2B/T,MAA3B,EAAmCjU,QAAnC,EAA6C;AAClD,UAAIgoB,OAAO,IAAIA,OAAO,KAAK,EAAvB,IAA6B/T,MAA7B,IAAuCA,MAAM,KAAK,EAAtD,EAA0D;AACxDkc,QAAAA,SAAS,CAACyB,WAAD,EAAc;AACrB5J,UAAAA,OAAO,EAAEA,OADY;AAErB/T,UAAAA,MAAM,EAAEA,MAFa;AAGrBjU,UAAAA,QAAQ,EAAEA;AAHW,SAAd,CAAT,CAKGutB,IALH,CAKQ,UAAU8F,KAAV,EAAiB;AACrB,cAAIrL,OAAO,GAAGqL,KAAK,CAACrL,OAApB;AAAA,cACE/T,MAAM,GAAGof,KAAK,CAACpf,MADjB;AAAA,cAEEjU,QAAQ,GAAGqzB,KAAK,CAACrzB,QAFnB;AAGA4xB,UAAAA,WAAW,CAACvC,QAAZ,CAAqBrH,OAArB,EAA8B/T,MAA9B;AACAjU,UAAAA,QAAQ,IAAIA,QAAQ,EAApB;AACD,SAXH,EAYG,OAZH,EAYY,UAAU0K,GAAV,EAAe;AACvBxK,UAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,SAdH;AAeD,OAhBD,MAgBO;AACLxK,QAAAA,OAAO,CAACC,GAAR,CACE,kEADF;AAGD;AACF;AAxBH,GAlQF,EA4RE;AACE9F,IAAAA,GAAG,EAAE,iBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS04B,eAAT,GAA2B;AAChC,aAAO1B,WAAW,IAAIA,WAAW,CAAC1C,QAAZ,EAAtB;AACD;AAJH,GA5RF,EAkSE;AACE70B,IAAAA,GAAG,EAAE,cADP;AAEEO,IAAAA,KAAK,EAAE,SAASu0B,YAAT,GAAwB;AAC7B,aAAOyC,WAAW,IAAIA,WAAW,CAACzC,YAAZ,EAAtB;AACD;AAJH,GAlSF,EAwSE;AACE90B,IAAAA,GAAG,EAAE,aADP;AAEEO,IAAAA,KAAK,EAAE,SAAS00B,WAAT,CAAqBtH,OAArB,EAA8BhoB,QAA9B,EAAwC;AAC7C,UAAIgoB,OAAO,IAAIA,OAAO,KAAK,EAA3B,EAA+B;AAC7BmI,QAAAA,SAAS,CAACyB,WAAD,EAAc;AACrB5J,UAAAA,OAAO,EAAEA;AADY,SAAd,CAAT,CAGGuF,IAHH,CAGQ,UAAUgG,KAAV,EAAiB;AACrB,cAAIvL,OAAO,GAAGuL,KAAK,CAACvL,OAApB;AACA4J,UAAAA,WAAW,CAACtC,WAAZ,CAAwBtH,OAAxB;AACAhoB,UAAAA,QAAQ,IAAIA,QAAQ,EAApB;AACD,SAPH,EAQG,OARH,EAQY,UAAU0K,GAAV,EAAe;AACvBxK,UAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,SAVH;AAWD,OAZD,MAYO;AACLxK,QAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACD;AACF;AAlBH,GAxSF,EA4TE;AACE9F,IAAAA,GAAG,EAAE,WADP;AAEEO,IAAAA,KAAK,EAAE,SAASytB,SAAT,CACLL,OADK,EAEL8E,WAFK,EAGLC,SAHK,EAILC,UAJK,EAKLC,QALK,EAML;AACA,UAAI2E,WAAW,IAAI5J,OAAf,IAA0BA,OAAO,KAAK,EAA1C,EAA8C;AAC5C4J,QAAAA,WAAW,CAACvJ,SAAZ,CACEL,OADF,EAEE8E,WAFF,EAGEC,SAHF,EAIEC,UAJF,EAKEC,QALF;AAOD;AACF;AAlBH,GA5TF,EAgVE;AACE5yB,IAAAA,GAAG,EAAE,kBADP;AAEEO,IAAAA,KAAK,EAAE,SAASogB,gBAAT,GAA4B;AACjC,aAAO4W,WAAW,IAAIA,WAAW,CAAC5W,gBAAZ,EAAtB;AACD;AAJH,GAhVF,EAsVE;AACE3gB,IAAAA,GAAG,EAAE,WADP;AAEEO,IAAAA,KAAK,EAAE,SAAS20B,SAAT,GAAqB;AAC1B,aAAOqC,WAAW,IAAIA,WAAW,CAACrC,SAAZ,EAAtB;AACD;AAJH,GAtVF,EA4VE;AACEl1B,IAAAA,GAAG,EAAE,cADP;AAEEO,IAAAA,KAAK,EAAE,SAAS40B,YAAT,GAAwB;AAC7B,aAAOoC,WAAW,IAAIA,WAAW,CAACpC,YAAZ,EAAtB;AACD;AAJH,GA5VF,EAkWE;AACEn1B,IAAAA,GAAG,EAAE,YADP;AAEEO,IAAAA,KAAK,EAAE,SAAS60B,UAAT,CAAoB+D,OAApB,EAA6BxL,OAA7B,EAAsC;AAC3C,UAAIwL,OAAO,KAAK,EAAhB,EAAoB;AAClBrD,QAAAA,SAAS,CAACyB,WAAD,EAAc;AACrB4B,UAAAA,OAAO,EAAEA,OADY;AAErBxL,UAAAA,OAAO,EAAEA;AAFY,SAAd,CAAT,CAIGuF,IAJH,CAIQ,UAAUkG,KAAV,EAAiB;AACrB,cAAID,OAAO,GAAGC,KAAK,CAACD,OAApB;AAAA,cACExL,OAAO,GAAGyL,KAAK,CAACzL,OADlB;AAEA4J,UAAAA,WAAW,CAACnC,UAAZ,CAAuB+D,OAAvB,EAAgCxL,OAAhC;AACD,SARH,EASG,OATH,EASY,UAAUtd,GAAV,EAAe;AACvBxK,UAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,SAXH;AAYD,OAbD,MAaO;AACLxK,QAAAA,OAAO,CAACC,GAAR,CACE,qGADF;AAGD;AACF;AArBH,GAlWF,EAyXE;AACE9F,IAAAA,GAAG,EAAE,eADP;AAEEO,IAAAA,KAAK,EAAE,SAAS+0B,aAAT,CAAuBC,SAAvB,EAAkC5H,OAAlC,EAA2C;AAChD,UAAI4H,SAAS,KAAK,EAAlB,EAAsB;AACpBO,QAAAA,SAAS,CAACyB,WAAD,EAAc;AACrBhC,UAAAA,SAAS,EAAEA,SADU;AAErB5H,UAAAA,OAAO,EAAEA;AAFY,SAAd,CAAT,CAIGuF,IAJH,CAIQ,UAAUmG,MAAV,EAAkB;AACtB,cAAI9D,SAAS,GAAG8D,MAAM,CAAC9D,SAAvB;AAAA,cACE5H,OAAO,GAAG0L,MAAM,CAAC1L,OADnB;AAEA4J,UAAAA,WAAW,CAACjC,aAAZ,CAA0BC,SAA1B,EAAqC5H,OAArC;AACD,SARH,EASG,OATH,EASY,UAAUtd,GAAV,EAAe;AACvBxK,UAAAA,OAAO,CAACC,GAAR,CAAYuK,GAAZ;AACD,SAXH;AAYD,OAbD,MAaO;AACLxK,QAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ;AACD;AACF;AAnBH,GAzXF,EA8YE;AACE9F,IAAAA,GAAG,EAAE,SADP;AAEEO,IAAAA,KAAK,EAAE,SAAS+P,OAAT,GAAmB;AACxB,aAAOinB,WAAW,IAAIA,WAAW,CAACjnB,OAAZ,EAAtB;AACD;AAJH,GA9YF,EAoZE;AACEtQ,IAAAA,GAAG,EAAE,cADP;AAEEO,IAAAA,KAAK,EAAE,SAASk0B,YAAT,GAAwB;AAC7B,aAAO8C,WAAW,IAAIA,WAAW,CAAC9C,YAAZ,EAAtB;AACD;AAJH,GApZF,EA0ZE;AACEz0B,IAAAA,GAAG,EAAE,QADP;AAEEO,IAAAA,KAAK,EAAE,SAASmQ,MAAT,GAAkB;AACvB,aAAO6mB,WAAW,IAAIA,WAAW,CAAC7mB,MAAZ,EAAtB;AACD;AAJH,GA1ZF,EAgaE;AACE1Q,IAAAA,GAAG,EAAE,wBADP;AAEEO,IAAAA,KAAK,EAAE,SAASi1B,sBAAT,GAAkC;AACvC,aAAO+B,WAAW,IAAIA,WAAW,CAAC/B,sBAAZ,EAAtB;AACD;AAJH,GAhaF,EAsaE;AACEx1B,IAAAA,GAAG,EAAE,iBADP;AAEEO,IAAAA,KAAK,EAAE,SAASygB,eAAT,GAA2B;AAChC,aAAOuW,WAAW,IAAIA,WAAW,CAACvW,eAAZ,EAAtB;AACD;AAJH,GAtaF,EA4aE;AACEhhB,IAAAA,GAAG,EAAE,kBADP;AAEEO,IAAAA,KAAK,EAAE,SAAS0gB,gBAAT,GAA4B;AACjC,aAAOsW,WAAW,IAAIA,WAAW,CAACtW,gBAAZ,EAAtB;AACD;AAJH,GA5aF,EAkbE;AACEjhB,IAAAA,GAAG,EAAE,qBADP;AAEEO,IAAAA,KAAK,EAAE,SAASk1B,mBAAT,GAA+B;AACpC,aAAO8B,WAAW,IAAIA,WAAW,CAAC9B,mBAAZ,EAAtB;AACD;AAJH,GAlbF,EAwbE;AACEz1B,IAAAA,GAAG,EAAE,WADP;AAEEO,IAAAA,KAAK,EAAE,SAAS+4B,SAAT,GAAqB;AAC1B,aAAO/B,WAAP;AACD;AAJH,GAxbF,CAvFU,CAAZ;;AAwhBA,SAAOC,cAAP;AACD,CA7nBkC,CA6nBhCz4B,cAAc,CAAC,SAAD,CAAd,CAA0Bw6B,SA7nBM,CAAnC;;AA+nBA/B,cAAc,CAACgC,SAAf,GAA2B;AACzBnE,EAAAA,EAAE,EAAEr2B,kBAAkB,CAAC,SAAD,CAAlB,CAA8By6B,MAA9B,CAAqCC,UADhB;AAEzB/L,EAAAA,OAAO,EAAE3uB,kBAAkB,CAAC,SAAD,CAAlB,CAA8By6B,MAA9B,CAAqCC,UAFrB;AAGzBpjB,EAAAA,QAAQ,EAAEtX,kBAAkB,CAAC,SAAD,CAAlB,CAA8B26B,GAHf;AAIzB5zB,EAAAA,IAAI,EAAE/G,kBAAkB,CAAC,SAAD,CAAlB,CAA8By6B,MAJX;AAKzBtX,EAAAA,WAAW,EAAEnjB,kBAAkB,CAAC,SAAD,CAAlB,CAA8By6B,MALlB;AAMzB/C,EAAAA,sBAAsB,EAAE13B,kBAAkB,CAAC,SAAD,CAAlB,CAA8B46B,KAA9B,CAAoC,EAApC,CANC;AAOzBnX,EAAAA,OAAO,EAAEzjB,kBAAkB,CAAC,SAAD,CAAlB,CAA8B66B,OAA9B,CACP76B,kBAAkB,CAAC,SAAD,CAAlB,CAA8By6B,MADvB,CAPgB;AAUzBxX,EAAAA,QAAQ,EAAEjjB,kBAAkB,CAAC,SAAD,CAAlB,CAA8B46B,KAA9B,CAAoC;AAC5CvxB,IAAAA,QAAQ,EAAErJ,kBAAkB,CAAC,SAAD,CAAlB,CAA8By6B,MADI;AAE5CrxB,IAAAA,IAAI,EAAEpJ,kBAAkB,CAAC,SAAD,CAAlB,CAA8By6B,MAFQ;AAG5CnxB,IAAAA,YAAY,EAAEtJ,kBAAkB,CAAC,SAAD,CAAlB,CAA8By6B,MAHA;AAI5C9vB,IAAAA,SAAS,EAAE3K,kBAAkB,CAAC,SAAD,CAAlB,CAA8By6B,MAJG;AAK5C3vB,IAAAA,cAAc,EAAE9K,kBAAkB,CAAC,SAAD,CAAlB,CAA8B86B,MALF;AAM5C7jB,IAAAA,QAAQ,EAAEjX,kBAAkB,CAAC,SAAD,CAAlB,CAA8B86B,MANI;AAO5C/jB,IAAAA,cAAc,EAAE/W,kBAAkB,CAAC,SAAD,CAAlB,CAA8B86B;AAPF,GAApC,CAVe;AAmBzBlgB,EAAAA,MAAM,EAAE5a,kBAAkB,CAAC,SAAD,CAAlB,CAA8B46B,KAA9B,CAAoC,EAApC,CAnBiB;AAoBzBzxB,EAAAA,SAAS,EAAEnJ,kBAAkB,CAAC,SAAD,CAAlB,CAA8By6B,MApBhB;AAqBzBz1B,EAAAA,KAAK,EAAEhF,kBAAkB,CAAC,SAAD,CAAlB,CAA8B46B,KAA9B,CAAoC,EAApC,CArBkB;AAsBzBrB,EAAAA,gBAAgB,EAAEv5B,kBAAkB,CAAC,SAAD,CAAlB,CAA8B+6B,IAtBvB;AAuBzBjC,EAAAA,WAAW,EAAE94B,kBAAkB,CAAC,SAAD,CAAlB,CAA8B+6B,IAvBlB;AAwBzBhC,EAAAA,SAAS,EAAE/4B,kBAAkB,CAAC,SAAD,CAAlB,CAA8B+6B,IAxBhB;AAyBzB/B,EAAAA,WAAW,EAAEh5B,kBAAkB,CAAC,SAAD,CAAlB,CAA8B+6B;AAzBlB,CAA3B;AA2BAvC,cAAc,CAACwC,YAAf,GAA8B;AAC5Bj0B,EAAAA,IAAI,EAAE,iBADsB;AAE5Boc,EAAAA,WAAW,EAAE,EAFe;AAG5BuU,EAAAA,sBAAsB,EAAE,EAHI;AAI5BjU,EAAAA,OAAO,EAAE,EAJmB;AAK5BR,EAAAA,QAAQ,EAAE,EALkB;AAM5B9Z,EAAAA,SAAS,EAAE,EANiB;AAO5BnE,EAAAA,KAAK,EAAEuyB,OAAO,CAACC,MAPa;AAQ5B5c,EAAAA,MAAM,EAAE,EARoB;AAS5Bke,EAAAA,WAAW,EAAE,MAAM,CAAE,CATO;AAU5BC,EAAAA,SAAS,EAAE,MAAM,CAAE,CAVS;AAW5BC,EAAAA,WAAW,EAAE,MAAM,CAAE;AAXO,CAA9B;AAcA,OAAO,MAAMhD,QAAQ,GAAGwC,cAAc,CAACxC,QAAhC;AACP,OAAO,MAAMiE,eAAe,GAAGzB,cAAc,CAACyB,eAAvC;AACP,OAAO,MAAMnE,YAAY,GAAG0C,cAAc,CAAC1C,YAApC;AACP,OAAO,MAAMG,WAAW,GAAGuC,cAAc,CAACvC,WAAnC;AACP,OAAO,MAAMjH,SAAS,GAAGwJ,cAAc,CAACxJ,SAAjC;AACP,OAAO,MAAMsF,QAAQ,GAAGkE,cAAc,CAAClE,QAAhC;AACP,OAAO,MAAMnI,QAAQ,GAAGqM,cAAc,CAACrM,QAAhC;AACP,OAAO,MAAMoI,QAAQ,GAAGiE,cAAc,CAACjE,QAAhC;AACP,OAAO,MAAMG,cAAc,GAAG8D,cAAc,CAAC9D,cAAtC;AACP,OAAO,MAAMC,cAAc,GAAG6D,cAAc,CAAC7D,cAAtC;AACP,OAAO,MAAMvI,MAAM,GAAGoM,cAAc,CAACpM,MAA9B;AACP,OAAO,MAAMoE,MAAM,GAAGgI,cAAc,CAAChI,MAA9B;AACP,OAAO,MAAMoE,YAAY,GAAG4D,cAAc,CAAC5D,YAApC;AACP,OAAO,MAAMC,YAAY,GAAG2D,cAAc,CAAC3D,YAApC;AACP,OAAO,MAAMxI,OAAO,GAAGmM,cAAc,CAACnM,OAA/B;AACP,OAAO,MAAM3F,OAAO,GAAG8R,cAAc,CAAC9R,OAA/B;AACP,OAAO,MAAMoO,aAAa,GAAG0D,cAAc,CAAC1D,aAArC;AACP,OAAO,MAAMC,aAAa,GAAGyD,cAAc,CAACzD,aAArC;AACP,OAAO,MAAMzL,MAAM,GAAGkP,cAAc,CAAClP,MAA9B;AACP,OAAO,MAAM0L,cAAc,GAAGwD,cAAc,CAACxD,cAAtC;AACP,OAAO,MAAMC,cAAc,GAAGuD,cAAc,CAACvD,cAAtC;AACP,OAAO,MAAMC,cAAc,GAAGsD,cAAc,CAACtD,cAAtC;AACP,OAAO,MAAMC,cAAc,GAAGqD,cAAc,CAACrD,cAAtC;AACP,OAAO,MAAMC,eAAe,GAAGoD,cAAc,CAACpD,eAAvC;AACP,OAAO,MAAMC,eAAe,GAAGmD,cAAc,CAACnD,eAAvC;AACP,OAAO,MAAMC,eAAe,GAAGkD,cAAc,CAAClD,eAAvC;AACP,OAAO,MAAMC,cAAc,GAAGiD,cAAc,CAACjD,cAAtC;AACP,OAAO,MAAMpM,kBAAkB,GAAGqP,cAAc,CAACrP,kBAA1C;AACP,OAAO,MAAMI,iBAAiB,GAAGiP,cAAc,CAACjP,iBAAzC;AACP,OAAO,MAAMiM,WAAW,GAAGgD,cAAc,CAAChD,WAAnC;AACP,OAAO,MAAM7T,gBAAgB,GAAG6W,cAAc,CAAC7W,gBAAxC;AACP,OAAO,MAAMuU,SAAS,GAAGsC,cAAc,CAACtC,SAAjC;AACP,OAAO,MAAMC,YAAY,GAAGqC,cAAc,CAACrC,YAApC;AACP,OAAO,MAAMC,UAAU,GAAGoC,cAAc,CAACpC,UAAlC;AACP,OAAO,MAAME,aAAa,GAAGkC,cAAc,CAAClC,aAArC;AACP,OAAO,MAAMhlB,OAAO,GAAGknB,cAAc,CAAClnB,OAA/B;AACP,OAAO,MAAMmkB,YAAY,GAAG+C,cAAc,CAAC/C,YAApC;AACP,OAAO,MAAM/jB,MAAM,GAAG8mB,cAAc,CAAC9mB,MAA9B;AACP,OAAO,MAAM8kB,sBAAsB,GAAGgC,cAAc,CAAChC,sBAA9C;AACP,OAAO,MAAMxU,eAAe,GAAGwW,cAAc,CAACxW,eAAvC;AACP,OAAO,MAAMC,gBAAgB,GAAGuW,cAAc,CAACvW,gBAAxC;AACP,OAAO,MAAMwU,mBAAmB,GAAG+B,cAAc,CAAC/B,mBAA3C;AACP,OAAO,MAAM6D,SAAS,GAAG9B,cAAc,CAAC8B,SAAjC;AACP,eAAe9B,cAAf,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["(\"use strict\");\r\n\r\n// Object.defineProperty(exports, \"__esModule\", { value: true });\r\n\r\nvar React = require(\"react\");\r\nvar PropTypes = require(\"prop-types\");\r\n\r\nfunction _interopDefaultLegacy(e) {\r\n  return e && typeof e === \"object\" && \"default\" in e ? e : { default: e };\r\n}\r\n\r\nvar React__default = /*#__PURE__*/ _interopDefaultLegacy(React);\r\nvar PropTypes__default = /*#__PURE__*/ _interopDefaultLegacy(PropTypes);\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n  for (var i = 0; i < props.length; i++) {\r\n    var descriptor = props[i];\r\n    descriptor.enumerable = descriptor.enumerable || false;\r\n    descriptor.configurable = true;\r\n    if (\"value\" in descriptor) descriptor.writable = true;\r\n    Object.defineProperty(target, descriptor.key, descriptor);\r\n  }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\r\n  if (staticProps) _defineProperties(Constructor, staticProps);\r\n  return Constructor;\r\n}\r\n\r\nfunction _defineProperty(obj, key, value) {\r\n  if (key in obj) {\r\n    Object.defineProperty(obj, key, {\r\n      value: value,\r\n      enumerable: true,\r\n      configurable: true,\r\n      writable: true,\r\n    });\r\n  } else {\r\n    obj[key] = value;\r\n  }\r\n\r\n  return obj;\r\n}\r\n\r\nfunction ownKeys(object, enumerableOnly) {\r\n  var keys = Object.keys(object);\r\n\r\n  if (Object.getOwnPropertySymbols) {\r\n    var symbols = Object.getOwnPropertySymbols(object);\r\n    if (enumerableOnly)\r\n      symbols = symbols.filter(function (sym) {\r\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\r\n      });\r\n    keys.push.apply(keys, symbols);\r\n  }\r\n\r\n  return keys;\r\n}\r\n\r\nfunction _objectSpread2(target) {\r\n  for (var i = 1; i < arguments.length; i++) {\r\n    var source = arguments[i] != null ? arguments[i] : {};\r\n\r\n    if (i % 2) {\r\n      ownKeys(Object(source), true).forEach(function (key) {\r\n        _defineProperty(target, key, source[key]);\r\n      });\r\n    } else if (Object.getOwnPropertyDescriptors) {\r\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\r\n    } else {\r\n      ownKeys(Object(source)).forEach(function (key) {\r\n        Object.defineProperty(\r\n          target,\r\n          key,\r\n          Object.getOwnPropertyDescriptor(source, key)\r\n        );\r\n      });\r\n    }\r\n  }\r\n\r\n  return target;\r\n}\r\n\r\nfunction _inherits(subClass, superClass) {\r\n  if (typeof superClass !== \"function\" && superClass !== null) {\r\n    throw new TypeError(\"Super expression must either be null or a function\");\r\n  }\r\n\r\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n    constructor: {\r\n      value: subClass,\r\n      writable: true,\r\n      configurable: true,\r\n    },\r\n  });\r\n  if (superClass) _setPrototypeOf(subClass, superClass);\r\n}\r\n\r\nfunction _getPrototypeOf(o) {\r\n  _getPrototypeOf = Object.setPrototypeOf\r\n    ? Object.getPrototypeOf\r\n    : function _getPrototypeOf(o) {\r\n        return o.__proto__ || Object.getPrototypeOf(o);\r\n      };\r\n  return _getPrototypeOf(o);\r\n}\r\n\r\nfunction _setPrototypeOf(o, p) {\r\n  _setPrototypeOf =\r\n    Object.setPrototypeOf ||\r\n    function _setPrototypeOf(o, p) {\r\n      o.__proto__ = p;\r\n      return o;\r\n    };\r\n\r\n  return _setPrototypeOf(o, p);\r\n}\r\n\r\nfunction _isNativeReflectConstruct() {\r\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\r\n  if (Reflect.construct.sham) return false;\r\n  if (typeof Proxy === \"function\") return true;\r\n\r\n  try {\r\n    Boolean.prototype.valueOf.call(\r\n      Reflect.construct(Boolean, [], function () {})\r\n    );\r\n    return true;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction _assertThisInitialized(self) {\r\n  if (self === void 0) {\r\n    throw new ReferenceError(\r\n      \"this hasn't been initialised - super() hasn't been called\"\r\n    );\r\n  }\r\n\r\n  return self;\r\n}\r\n\r\nfunction _possibleConstructorReturn(self, call) {\r\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\r\n    return call;\r\n  }\r\n\r\n  return _assertThisInitialized(self);\r\n}\r\n\r\nfunction _createSuper(Derived) {\r\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\r\n\r\n  return function _createSuperInternal() {\r\n    var Super = _getPrototypeOf(Derived),\r\n      result;\r\n\r\n    if (hasNativeReflectConstruct) {\r\n      var NewTarget = _getPrototypeOf(this).constructor;\r\n\r\n      result = Reflect.construct(Super, arguments, NewTarget);\r\n    } else {\r\n      result = Super.apply(this, arguments);\r\n    }\r\n\r\n    return _possibleConstructorReturn(this, result);\r\n  };\r\n}\r\n\r\n/*eslint-disable*/\r\nvar libpannellum = (function (window, document, undefined$1) {\r\n  if (!window || !document) return;\r\n\r\n  function Renderer(container) {\r\n    var canvas = document.createElement(\"canvas\");\r\n    canvas.style.width = canvas.style.height = \"100%\";\r\n    container.appendChild(canvas);\r\n    var program, gl, vs, fs;\r\n    var fallbackImgSize;\r\n    var world;\r\n    var vtmps;\r\n    var pose;\r\n    var image, imageType, dynamic;\r\n    var texCoordBuffer, cubeVertBuf, cubeVertTexCoordBuf, cubeVertIndBuf;\r\n    var globalParams;\r\n    /**\r\n     * Initialize renderer.\r\n     * @memberof Renderer\r\n     * @instance\r\n     * @param {Image|Array|Object} image - Input image; format varies based on\r\n     *      `imageType`. For `equirectangular`, this is an image; for\r\n     *      `cubemap`, this is an array of images for the cube faces in the\r\n     *      order [+z, +x, -z, -x, +y, -y]; for `multires`, this is a\r\n     *      configuration object.\r\n     * @param {string} imageType - The type of the image: `equirectangular`,\r\n     *      `cubemap`, or `multires`.\r\n     * @param {boolean} dynamic - Whether or not the image is dynamic (e.g. video).\r\n     * @param {number} haov - Initial horizontal angle of view.\r\n     * @param {number} vaov - Initial vertical angle of view.\r\n     * @param {number} voffset - Initial vertical offset angle.\r\n     * @param {function} callback - Load callback function.\r\n     * @param {Object} [params] - Other configuration parameters (`horizonPitch`, `horizonRoll`, `backgroundColor`).\r\n     */\r\n\r\n    this.init = function (\r\n      _image,\r\n      _imageType,\r\n      _dynamic,\r\n      haov,\r\n      vaov,\r\n      voffset,\r\n      callback,\r\n      params\r\n    ) {\r\n      // Default argument for image type\r\n      if (_imageType === undefined$1) _imageType = \"equirectangular\";\r\n\r\n      if (\r\n        _imageType != \"equirectangular\" &&\r\n        _imageType != \"cubemap\" &&\r\n        _imageType != \"multires\"\r\n      ) {\r\n        console.log(\"Error: invalid image type specified!\");\r\n        throw {\r\n          type: \"config error\",\r\n        };\r\n      }\r\n\r\n      imageType = _imageType;\r\n      image = _image;\r\n      dynamic = _dynamic;\r\n      globalParams = params || {}; // Clear old data\r\n\r\n      if (program) {\r\n        if (vs) {\r\n          gl.detachShader(program, vs);\r\n          gl.deleteShader(vs);\r\n        }\r\n\r\n        if (fs) {\r\n          gl.detachShader(program, fs);\r\n          gl.deleteShader(fs);\r\n        }\r\n\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\r\n        if (program.texture) gl.deleteTexture(program.texture);\r\n        if (program.nodeCache)\r\n          for (var i = 0; i < program.nodeCache.length; i++) {\r\n            gl.deleteTexture(program.nodeCache[i].texture);\r\n          }\r\n        gl.deleteProgram(program);\r\n        program = undefined$1;\r\n      }\r\n\r\n      pose = undefined$1;\r\n      var s;\r\n      var faceMissing = false;\r\n      var cubeImgWidth;\r\n\r\n      if (imageType == \"cubemap\") {\r\n        for (s = 0; s < 6; s++) {\r\n          if (image[s].width > 0) {\r\n            if (cubeImgWidth === undefined$1) cubeImgWidth = image[s].width;\r\n            if (cubeImgWidth != image[s].width)\r\n              console.log(\r\n                \"Cube faces have inconsistent widths: \" +\r\n                  cubeImgWidth +\r\n                  \" vs. \" +\r\n                  image[s].width\r\n              );\r\n          } else faceMissing = true;\r\n        }\r\n      }\r\n\r\n      function fillMissingFaces(imgSize) {\r\n        if (faceMissing) {\r\n          // Fill any missing fallback/cubemap faces with background\r\n          var nbytes = imgSize * imgSize * 4; // RGB, plus non-functional alpha\r\n\r\n          var imageArray = new Uint8ClampedArray(nbytes);\r\n          var rgb = params.backgroundColor ? params.backgroundColor : [0, 0, 0];\r\n          rgb[0] *= 255;\r\n          rgb[1] *= 255;\r\n          rgb[2] *= 255; // Maybe filling could be done faster, see e.g. https://stackoverflow.com/questions/1295584/most-efficient-way-to-create-a-zero-filled-javascript-array\r\n\r\n          for (var i = 0; i < nbytes; i++) {\r\n            imageArray[i++] = rgb[0];\r\n            imageArray[i++] = rgb[1];\r\n            imageArray[i++] = rgb[2];\r\n          }\r\n\r\n          var backgroundSquare = new ImageData(imageArray, imgSize, imgSize);\r\n\r\n          for (s = 0; s < 6; s++) {\r\n            if (image[s].width == 0) image[s] = backgroundSquare;\r\n          }\r\n        }\r\n      } // This awful browser specific test exists because iOS 8/9 and IE 11\r\n      // don't display non-power-of-two cubemap textures but also don't\r\n      // throw an error (tested on an iPhone 5c / iOS 8.1.3 / iOS 9.2 /\r\n      // iOS 10.3.1).\r\n      // Therefore, the WebGL context is never created for these browsers for\r\n      // NPOT cubemaps, and the CSS 3D transform fallback renderer is used\r\n      // instead.\r\n\r\n      if (\r\n        !(\r\n          imageType == \"cubemap\" &&\r\n          (cubeImgWidth & (cubeImgWidth - 1)) !== 0 &&\r\n          (navigator.userAgent\r\n            .toLowerCase()\r\n            .match(/(iphone|ipod|ipad).* os 8_/) ||\r\n            navigator.userAgent\r\n              .toLowerCase()\r\n              .match(/(iphone|ipod|ipad).* os 9_/) ||\r\n            navigator.userAgent\r\n              .toLowerCase()\r\n              .match(/(iphone|ipod|ipad).* os 10_/) ||\r\n            navigator.userAgent.match(/Trident.*rv[ :]*11\\./))\r\n        )\r\n      ) {\r\n        // Enable WebGL on canvas\r\n        if (!gl)\r\n          gl = canvas.getContext(\"experimental-webgl\", {\r\n            alpha: false,\r\n            depth: false,\r\n          });\r\n        if (gl && gl.getError() == 1286) handleWebGLError1286();\r\n      } // If there is no WebGL, fall back to CSS 3D transform renderer.\r\n      // This will discard the image loaded so far and load the fallback image.\r\n      // While browser specific tests are usually frowned upon, the\r\n      // fallback viewer only really works with WebKit/Blink and IE 10/11\r\n      // (it doesn't work properly in Firefox).\r\n\r\n      if (\r\n        !gl &&\r\n        ((imageType == \"multires\" && image.hasOwnProperty(\"fallbackPath\")) ||\r\n          imageType == \"cubemap\") &&\r\n        (\"WebkitAppearance\" in document.documentElement.style ||\r\n          navigator.userAgent.match(/Trident.*rv[ :]*11\\./) ||\r\n          navigator.appVersion.indexOf(\"MSIE 10\") !== -1)\r\n      ) {\r\n        // Remove old world if it exists\r\n        if (world) {\r\n          container.removeChild(world);\r\n        } // Initialize renderer\r\n\r\n        world = document.createElement(\"div\");\r\n        world.className = \"pnlm-world\"; // Add images\r\n\r\n        var path;\r\n\r\n        if (image.basePath) {\r\n          path = image.basePath + image.fallbackPath;\r\n        } else {\r\n          path = image.fallbackPath;\r\n        }\r\n\r\n        var sides = [\"f\", \"r\", \"b\", \"l\", \"u\", \"d\"];\r\n        var loaded = 0;\r\n\r\n        var onLoad = function onLoad() {\r\n          // Draw image on canvas\r\n          var faceCanvas = document.createElement(\"canvas\");\r\n          faceCanvas.className = \"pnlm-face pnlm-\" + sides[this.side] + \"face\";\r\n          world.appendChild(faceCanvas);\r\n          var faceContext = faceCanvas.getContext(\"2d\");\r\n          faceCanvas.style.width = this.width + 4 + \"px\";\r\n          faceCanvas.style.height = this.height + 4 + \"px\";\r\n          faceCanvas.width = this.width + 4;\r\n          faceCanvas.height = this.height + 4;\r\n          faceContext.drawImage(this, 2, 2);\r\n          var imgData = faceContext.getImageData(\r\n            0,\r\n            0,\r\n            faceCanvas.width,\r\n            faceCanvas.height\r\n          );\r\n          var data = imgData.data; // Duplicate edge pixels\r\n\r\n          var i;\r\n          var j;\r\n\r\n          for (i = 2; i < faceCanvas.width - 2; i++) {\r\n            for (j = 0; j < 4; j++) {\r\n              data[(i + faceCanvas.width) * 4 + j] =\r\n                data[(i + faceCanvas.width * 2) * 4 + j];\r\n              data[(i + faceCanvas.width * (faceCanvas.height - 2)) * 4 + j] =\r\n                data[(i + faceCanvas.width * (faceCanvas.height - 3)) * 4 + j];\r\n            }\r\n          }\r\n\r\n          for (i = 2; i < faceCanvas.height - 2; i++) {\r\n            for (j = 0; j < 4; j++) {\r\n              data[(i * faceCanvas.width + 1) * 4 + j] =\r\n                data[(i * faceCanvas.width + 2) * 4 + j];\r\n              data[((i + 1) * faceCanvas.width - 2) * 4 + j] =\r\n                data[((i + 1) * faceCanvas.width - 3) * 4 + j];\r\n            }\r\n          }\r\n\r\n          for (j = 0; j < 4; j++) {\r\n            data[(faceCanvas.width + 1) * 4 + j] =\r\n              data[(faceCanvas.width * 2 + 2) * 4 + j];\r\n            data[(faceCanvas.width * 2 - 2) * 4 + j] =\r\n              data[(faceCanvas.width * 3 - 3) * 4 + j];\r\n            data[(faceCanvas.width * (faceCanvas.height - 2) + 1) * 4 + j] =\r\n              data[(faceCanvas.width * (faceCanvas.height - 3) + 2) * 4 + j];\r\n            data[(faceCanvas.width * (faceCanvas.height - 1) - 2) * 4 + j] =\r\n              data[(faceCanvas.width * (faceCanvas.height - 2) - 3) * 4 + j];\r\n          }\r\n\r\n          for (i = 1; i < faceCanvas.width - 1; i++) {\r\n            for (j = 0; j < 4; j++) {\r\n              data[i * 4 + j] = data[(i + faceCanvas.width) * 4 + j];\r\n              data[(i + faceCanvas.width * (faceCanvas.height - 1)) * 4 + j] =\r\n                data[(i + faceCanvas.width * (faceCanvas.height - 2)) * 4 + j];\r\n            }\r\n          }\r\n\r\n          for (i = 1; i < faceCanvas.height - 1; i++) {\r\n            for (j = 0; j < 4; j++) {\r\n              data[i * faceCanvas.width * 4 + j] =\r\n                data[(i * faceCanvas.width + 1) * 4 + j];\r\n              data[((i + 1) * faceCanvas.width - 1) * 4 + j] =\r\n                data[((i + 1) * faceCanvas.width - 2) * 4 + j];\r\n            }\r\n          }\r\n\r\n          for (j = 0; j < 4; j++) {\r\n            data[j] = data[(faceCanvas.width + 1) * 4 + j];\r\n            data[(faceCanvas.width - 1) * 4 + j] =\r\n              data[(faceCanvas.width * 2 - 2) * 4 + j];\r\n            data[faceCanvas.width * (faceCanvas.height - 1) * 4 + j] =\r\n              data[(faceCanvas.width * (faceCanvas.height - 2) + 1) * 4 + j];\r\n            data[(faceCanvas.width * faceCanvas.height - 1) * 4 + j] =\r\n              data[(faceCanvas.width * (faceCanvas.height - 1) - 2) * 4 + j];\r\n          } // Draw image width duplicated edge pixels on canvas\r\n\r\n          faceContext.putImageData(imgData, 0, 0);\r\n          incLoaded.call(this);\r\n        };\r\n\r\n        var incLoaded = function incLoaded() {\r\n          if (this.width > 0) {\r\n            if (fallbackImgSize === undefined$1) fallbackImgSize = this.width;\r\n            if (fallbackImgSize != this.width)\r\n              console.log(\r\n                \"Fallback faces have inconsistent widths: \" +\r\n                  fallbackImgSize +\r\n                  \" vs. \" +\r\n                  this.width\r\n              );\r\n          } else faceMissing = true;\r\n\r\n          loaded++;\r\n\r\n          if (loaded == 6) {\r\n            fallbackImgSize = this.width;\r\n            container.appendChild(world);\r\n            callback();\r\n          }\r\n        };\r\n\r\n        faceMissing = false;\r\n\r\n        for (s = 0; s < 6; s++) {\r\n          var faceImg = new Image();\r\n          faceImg.crossOrigin = globalParams.crossOrigin\r\n            ? globalParams.crossOrigin\r\n            : \"anonymous\";\r\n          faceImg.side = s;\r\n          faceImg.onload = onLoad;\r\n          faceImg.onerror = incLoaded; // ignore missing face to support partial fallback image\r\n\r\n          if (imageType == \"multires\") {\r\n            faceImg.src = path.replace(\"%s\", sides[s]) + \".\" + image.extension;\r\n          } else {\r\n            faceImg.src = image[s].src;\r\n          }\r\n        }\r\n\r\n        fillMissingFaces(fallbackImgSize);\r\n        return;\r\n      } else if (!gl) {\r\n        console.log(\"Error: no WebGL support detected!\");\r\n        throw {\r\n          type: \"no webgl\",\r\n        };\r\n      }\r\n\r\n      if (imageType == \"cubemap\") fillMissingFaces(cubeImgWidth);\r\n\r\n      if (image.basePath) {\r\n        image.fullpath = image.basePath + image.path;\r\n      } else {\r\n        image.fullpath = image.path;\r\n      }\r\n\r\n      image.invTileResolution = 1 / image.tileResolution;\r\n      var vertices = createCube();\r\n      vtmps = [];\r\n\r\n      for (s = 0; s < 6; s++) {\r\n        vtmps[s] = vertices.slice(s * 12, s * 12 + 12);\r\n        vertices = createCube();\r\n      } // Make sure image isn't too big\r\n\r\n      var maxWidth = 0;\r\n\r\n      if (imageType == \"equirectangular\") {\r\n        maxWidth = gl.getParameter(gl.MAX_TEXTURE_SIZE);\r\n\r\n        if (Math.max(image.width / 2, image.height) > maxWidth) {\r\n          console.log(\r\n            \"Error: The image is too big; it's \" +\r\n              image.width +\r\n              \"px wide, \" +\r\n              \"but this device's maximum supported size is \" +\r\n              maxWidth * 2 +\r\n              \"px.\"\r\n          );\r\n          throw {\r\n            type: \"webgl size error\",\r\n            width: image.width,\r\n            maxWidth: maxWidth * 2,\r\n          };\r\n        }\r\n      } else if (imageType == \"cubemap\") {\r\n        if (cubeImgWidth > gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE)) {\r\n          console.log(\r\n            \"Error: The image is too big; it's \" +\r\n              cubeImgWidth +\r\n              \"px wide, \" +\r\n              \"but this device's maximum supported size is \" +\r\n              maxWidth +\r\n              \"px.\"\r\n          );\r\n          throw {\r\n            type: \"webgl size error\",\r\n            width: cubeImgWidth,\r\n            maxWidth: maxWidth,\r\n          };\r\n        }\r\n      } // Store horizon pitch and roll if applicable\r\n\r\n      if (\r\n        params !== undefined$1 &&\r\n        (params.horizonPitch !== undefined$1 ||\r\n          params.horizonRoll !== undefined$1)\r\n      )\r\n        pose = [\r\n          params.horizonPitch == undefined$1 ? 0 : params.horizonPitch,\r\n          params.horizonRoll == undefined$1 ? 0 : params.horizonRoll,\r\n        ]; // Set 2d texture binding\r\n\r\n      var glBindType = gl.TEXTURE_2D; // Create viewport for entire canvas\r\n\r\n      gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight); // Check precision support\r\n\r\n      if (gl.getShaderPrecisionFormat) {\r\n        var precision = gl.getShaderPrecisionFormat(\r\n          gl.FRAGMENT_SHADER,\r\n          gl.HIGH_FLOAT\r\n        );\r\n\r\n        if (precision && precision.precision < 1) {\r\n          // `highp` precision not supported; https://stackoverflow.com/a/33308927\r\n          fragEquiCubeBase = fragEquiCubeBase.replace(\"highp\", \"mediump\");\r\n        }\r\n      } // Create vertex shader\r\n\r\n      vs = gl.createShader(gl.VERTEX_SHADER);\r\n      var vertexSrc = v;\r\n\r\n      if (imageType == \"multires\") {\r\n        vertexSrc = vMulti;\r\n      }\r\n\r\n      gl.shaderSource(vs, vertexSrc);\r\n      gl.compileShader(vs); // Create fragment shader\r\n\r\n      fs = gl.createShader(gl.FRAGMENT_SHADER);\r\n      var fragmentSrc = fragEquirectangular;\r\n\r\n      if (imageType == \"cubemap\") {\r\n        glBindType = gl.TEXTURE_CUBE_MAP;\r\n        fragmentSrc = fragCube;\r\n      } else if (imageType == \"multires\") {\r\n        fragmentSrc = fragMulti;\r\n      }\r\n\r\n      gl.shaderSource(fs, fragmentSrc);\r\n      gl.compileShader(fs); // Link WebGL program\r\n\r\n      program = gl.createProgram();\r\n      gl.attachShader(program, vs);\r\n      gl.attachShader(program, fs);\r\n      gl.linkProgram(program); // Log errors\r\n\r\n      if (!gl.getShaderParameter(vs, gl.COMPILE_STATUS))\r\n        console.log(gl.getShaderInfoLog(vs));\r\n      if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS))\r\n        console.log(gl.getShaderInfoLog(fs));\r\n      if (!gl.getProgramParameter(program, gl.LINK_STATUS))\r\n        console.log(gl.getProgramInfoLog(program)); // Use WebGL program\r\n\r\n      gl.useProgram(program);\r\n      program.drawInProgress = false; // Set background clear color (does not apply to cubemap/fallback image)\r\n\r\n      var color = params.backgroundColor ? params.backgroundColor : [0, 0, 0];\r\n      gl.clearColor(color[0], color[1], color[2], 1.0);\r\n      gl.clear(gl.COLOR_BUFFER_BIT); // Look up texture coordinates location\r\n\r\n      program.texCoordLocation = gl.getAttribLocation(program, \"a_texCoord\");\r\n      gl.enableVertexAttribArray(program.texCoordLocation);\r\n\r\n      if (imageType != \"multires\") {\r\n        // Provide texture coordinates for rectangle\r\n        if (!texCoordBuffer) texCoordBuffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, texCoordBuffer);\r\n        gl.bufferData(\r\n          gl.ARRAY_BUFFER,\r\n          new Float32Array([-1, 1, 1, 1, 1, -1, -1, 1, 1, -1, -1, -1]),\r\n          gl.STATIC_DRAW\r\n        );\r\n        gl.vertexAttribPointer(\r\n          program.texCoordLocation,\r\n          2,\r\n          gl.FLOAT,\r\n          false,\r\n          0,\r\n          0\r\n        ); // Pass aspect ratio\r\n\r\n        program.aspectRatio = gl.getUniformLocation(program, \"u_aspectRatio\");\r\n        gl.uniform1f(\r\n          program.aspectRatio,\r\n          gl.drawingBufferWidth / gl.drawingBufferHeight\r\n        ); // Locate psi, theta, focal length, horizontal extent, vertical extent, and vertical offset\r\n\r\n        program.psi = gl.getUniformLocation(program, \"u_psi\");\r\n        program.theta = gl.getUniformLocation(program, \"u_theta\");\r\n        program.f = gl.getUniformLocation(program, \"u_f\");\r\n        program.h = gl.getUniformLocation(program, \"u_h\");\r\n        program.v = gl.getUniformLocation(program, \"u_v\");\r\n        program.vo = gl.getUniformLocation(program, \"u_vo\");\r\n        program.rot = gl.getUniformLocation(program, \"u_rot\"); // Pass horizontal extent, vertical extent, and vertical offset\r\n\r\n        gl.uniform1f(program.h, haov / (Math.PI * 2.0));\r\n        gl.uniform1f(program.v, vaov / Math.PI);\r\n        gl.uniform1f(program.vo, (voffset / Math.PI) * 2); // Set background color\r\n\r\n        if (imageType == \"equirectangular\") {\r\n          program.backgroundColor = gl.getUniformLocation(\r\n            program,\r\n            \"u_backgroundColor\"\r\n          );\r\n          gl.uniform4fv(program.backgroundColor, color.concat([1]));\r\n        } // Create texture\r\n\r\n        program.texture = gl.createTexture();\r\n        gl.bindTexture(glBindType, program.texture); // Upload images to texture depending on type\r\n\r\n        if (imageType == \"cubemap\") {\r\n          // Load all six sides of the cube map\r\n          gl.texImage2D(\r\n            gl.TEXTURE_CUBE_MAP_POSITIVE_X,\r\n            0,\r\n            gl.RGB,\r\n            gl.RGB,\r\n            gl.UNSIGNED_BYTE,\r\n            image[1]\r\n          );\r\n          gl.texImage2D(\r\n            gl.TEXTURE_CUBE_MAP_NEGATIVE_X,\r\n            0,\r\n            gl.RGB,\r\n            gl.RGB,\r\n            gl.UNSIGNED_BYTE,\r\n            image[3]\r\n          );\r\n          gl.texImage2D(\r\n            gl.TEXTURE_CUBE_MAP_POSITIVE_Y,\r\n            0,\r\n            gl.RGB,\r\n            gl.RGB,\r\n            gl.UNSIGNED_BYTE,\r\n            image[4]\r\n          );\r\n          gl.texImage2D(\r\n            gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,\r\n            0,\r\n            gl.RGB,\r\n            gl.RGB,\r\n            gl.UNSIGNED_BYTE,\r\n            image[5]\r\n          );\r\n          gl.texImage2D(\r\n            gl.TEXTURE_CUBE_MAP_POSITIVE_Z,\r\n            0,\r\n            gl.RGB,\r\n            gl.RGB,\r\n            gl.UNSIGNED_BYTE,\r\n            image[0]\r\n          );\r\n          gl.texImage2D(\r\n            gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,\r\n            0,\r\n            gl.RGB,\r\n            gl.RGB,\r\n            gl.UNSIGNED_BYTE,\r\n            image[2]\r\n          );\r\n        } else {\r\n          if (image.width <= maxWidth) {\r\n            gl.uniform1i(gl.getUniformLocation(program, \"u_splitImage\"), 0); // Upload image to the texture\r\n\r\n            gl.texImage2D(\r\n              glBindType,\r\n              0,\r\n              gl.RGB,\r\n              gl.RGB,\r\n              gl.UNSIGNED_BYTE,\r\n              image\r\n            );\r\n          } else {\r\n            // Image needs to be split into two parts due to texture size limits\r\n            gl.uniform1i(gl.getUniformLocation(program, \"u_splitImage\"), 1); // Draw image on canvas\r\n\r\n            var cropCanvas = document.createElement(\"canvas\");\r\n            cropCanvas.width = image.width / 2;\r\n            cropCanvas.height = image.height;\r\n            var cropContext = cropCanvas.getContext(\"2d\");\r\n            cropContext.drawImage(image, 0, 0); // Upload first half of image to the texture\r\n\r\n            var cropImage = cropContext.getImageData(\r\n              0,\r\n              0,\r\n              image.width / 2,\r\n              image.height\r\n            );\r\n            gl.texImage2D(\r\n              glBindType,\r\n              0,\r\n              gl.RGB,\r\n              gl.RGB,\r\n              gl.UNSIGNED_BYTE,\r\n              cropImage\r\n            ); // Create and bind texture for second half of image\r\n\r\n            program.texture2 = gl.createTexture();\r\n            gl.activeTexture(gl.TEXTURE1);\r\n            gl.bindTexture(glBindType, program.texture2);\r\n            gl.uniform1i(gl.getUniformLocation(program, \"u_image1\"), 1); // Upload second half of image to the texture\r\n\r\n            cropContext.drawImage(image, -image.width / 2, 0);\r\n            cropImage = cropContext.getImageData(\r\n              0,\r\n              0,\r\n              image.width / 2,\r\n              image.height\r\n            );\r\n            gl.texImage2D(\r\n              glBindType,\r\n              0,\r\n              gl.RGB,\r\n              gl.RGB,\r\n              gl.UNSIGNED_BYTE,\r\n              cropImage\r\n            ); // Set parameters for rendering any size\r\n\r\n            gl.texParameteri(glBindType, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n            gl.texParameteri(glBindType, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n            gl.texParameteri(glBindType, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n            gl.texParameteri(glBindType, gl.TEXTURE_MAG_FILTER, gl.LINEAR); // Reactivate first texture unit\r\n\r\n            gl.activeTexture(gl.TEXTURE0);\r\n          }\r\n        } // Set parameters for rendering any size\r\n\r\n        gl.texParameteri(glBindType, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(glBindType, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(glBindType, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n        gl.texParameteri(glBindType, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n      } else {\r\n        // Look up vertex coordinates location\r\n        program.vertPosLocation = gl.getAttribLocation(program, \"a_vertCoord\");\r\n        gl.enableVertexAttribArray(program.vertPosLocation); // Create buffers\r\n\r\n        if (!cubeVertBuf) cubeVertBuf = gl.createBuffer();\r\n        if (!cubeVertTexCoordBuf) cubeVertTexCoordBuf = gl.createBuffer();\r\n        if (!cubeVertIndBuf) cubeVertIndBuf = gl.createBuffer(); // Bind texture coordinate buffer and pass coordinates to WebGL\r\n\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, cubeVertTexCoordBuf);\r\n        gl.bufferData(\r\n          gl.ARRAY_BUFFER,\r\n          new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),\r\n          gl.STATIC_DRAW\r\n        ); // Bind square index buffer and pass indicies to WebGL\r\n\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, cubeVertIndBuf);\r\n        gl.bufferData(\r\n          gl.ELEMENT_ARRAY_BUFFER,\r\n          new Uint16Array([0, 1, 2, 0, 2, 3]),\r\n          gl.STATIC_DRAW\r\n        ); // Find uniforms\r\n\r\n        program.perspUniform = gl.getUniformLocation(program, \"u_perspMatrix\");\r\n        program.cubeUniform = gl.getUniformLocation(program, \"u_cubeMatrix\"); //program.colorUniform = gl.getUniformLocation(program, 'u_color');\r\n\r\n        program.level = -1;\r\n        program.currentNodes = [];\r\n        program.nodeCache = [];\r\n        program.nodeCacheTimestamp = 0;\r\n      } // Check if there was an error\r\n\r\n      var err = gl.getError();\r\n\r\n      if (err !== 0) {\r\n        console.log(\"Error: Something went wrong with WebGL!\", err);\r\n        throw {\r\n          type: \"webgl error\",\r\n        };\r\n      }\r\n\r\n      callback();\r\n    };\r\n    /**\r\n     * Destroy renderer.\r\n     * @memberof Renderer\r\n     * @instance\r\n     */\r\n\r\n    this.destroy = function () {\r\n      if (container !== undefined$1) {\r\n        if (canvas !== undefined$1 && container.contains(canvas)) {\r\n          container.removeChild(canvas);\r\n        }\r\n\r\n        if (world !== undefined$1 && container.contains(world)) {\r\n          container.removeChild(world);\r\n        }\r\n      }\r\n\r\n      if (gl) {\r\n        // The spec says this is only supposed to simulate losing the WebGL\r\n        // context, but in practice it tends to actually free the memory.\r\n        var extension = gl.getExtension(\"WEBGL_lose_context\");\r\n        if (extension) extension.loseContext();\r\n      }\r\n    };\r\n    /**\r\n     * Resize renderer (call after resizing container).\r\n     * @memberof Renderer\r\n     * @instance\r\n     */\r\n\r\n    this.resize = function () {\r\n      var pixelRatio = window.devicePixelRatio || 1;\r\n      canvas.width = canvas.clientWidth * pixelRatio;\r\n      canvas.height = canvas.clientHeight * pixelRatio;\r\n\r\n      if (gl) {\r\n        if (gl.getError() == 1286) handleWebGLError1286();\r\n        gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\r\n\r\n        if (imageType != \"multires\") {\r\n          gl.uniform1f(\r\n            program.aspectRatio,\r\n            canvas.clientWidth / canvas.clientHeight\r\n          );\r\n        }\r\n      }\r\n    }; // Initialize canvas size\r\n\r\n    this.resize();\r\n    /**\r\n     * Set renderer horizon pitch and roll.\r\n     * @memberof Renderer\r\n     * @instance\r\n     */\r\n\r\n    this.setPose = function (horizonPitch, horizonRoll) {\r\n      pose = [horizonPitch, horizonRoll];\r\n    };\r\n    /**\r\n     * Render new view of panorama.\r\n     * @memberof Renderer\r\n     * @instance\r\n     * @param {number} pitch - Pitch to render at (in radians).\r\n     * @param {number} yaw - Yaw to render at (in radians).\r\n     * @param {number} hfov - Horizontal field of view to render with (in radians).\r\n     * @param {Object} [params] - Extra configuration parameters.\r\n     * @param {number} [params.roll] - Camera roll (in radians).\r\n     * @param {boolean} [params.returnImage] - Return rendered image?\r\n     */\r\n\r\n    this.render = function (pitch, yaw, hfov, params) {\r\n      var focal,\r\n        i,\r\n        s,\r\n        roll = 0;\r\n      if (params === undefined$1) params = {};\r\n      if (params.roll) roll = params.roll; // Apply pitch and roll transformation if applicable\r\n\r\n      if (pose !== undefined$1) {\r\n        var horizonPitch = pose[0],\r\n          horizonRoll = pose[1]; // Calculate new pitch and yaw\r\n\r\n        var orig_pitch = pitch,\r\n          orig_yaw = yaw,\r\n          x =\r\n            Math.cos(horizonRoll) * Math.sin(pitch) * Math.sin(horizonPitch) +\r\n            Math.cos(pitch) *\r\n              (Math.cos(horizonPitch) * Math.cos(yaw) +\r\n                Math.sin(horizonRoll) * Math.sin(horizonPitch) * Math.sin(yaw)),\r\n          y =\r\n            -Math.sin(pitch) * Math.sin(horizonRoll) +\r\n            Math.cos(pitch) * Math.cos(horizonRoll) * Math.sin(yaw),\r\n          z =\r\n            Math.cos(horizonRoll) * Math.cos(horizonPitch) * Math.sin(pitch) +\r\n            Math.cos(pitch) *\r\n              (-Math.cos(yaw) * Math.sin(horizonPitch) +\r\n                Math.cos(horizonPitch) * Math.sin(horizonRoll) * Math.sin(yaw));\r\n        pitch = Math.asin(Math.max(Math.min(z, 1), -1));\r\n        yaw = Math.atan2(y, x); // Calculate roll\r\n\r\n        var v = [\r\n            Math.cos(orig_pitch) *\r\n              (Math.sin(horizonRoll) *\r\n                Math.sin(horizonPitch) *\r\n                Math.cos(orig_yaw) -\r\n                Math.cos(horizonPitch) * Math.sin(orig_yaw)),\r\n            Math.cos(orig_pitch) * Math.cos(horizonRoll) * Math.cos(orig_yaw),\r\n            Math.cos(orig_pitch) *\r\n              (Math.cos(horizonPitch) *\r\n                Math.sin(horizonRoll) *\r\n                Math.cos(orig_yaw) +\r\n                Math.sin(orig_yaw) * Math.sin(horizonPitch)),\r\n          ],\r\n          w = [\r\n            -Math.cos(pitch) * Math.sin(yaw),\r\n            Math.cos(pitch) * Math.cos(yaw),\r\n          ];\r\n        var roll_adj = Math.acos(\r\n          Math.max(\r\n            Math.min(\r\n              (v[0] * w[0] + v[1] * w[1]) /\r\n                (Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]) *\r\n                  Math.sqrt(w[0] * w[0] + w[1] * w[1])),\r\n              1\r\n            ),\r\n            -1\r\n          )\r\n        );\r\n        if (v[2] < 0) roll_adj = 2 * Math.PI - roll_adj;\r\n        roll += roll_adj;\r\n      } // If no WebGL\r\n\r\n      if (!gl && (imageType == \"multires\" || imageType == \"cubemap\")) {\r\n        // Determine face transforms\r\n        s = fallbackImgSize / 2;\r\n        var transforms = {\r\n          f:\r\n            \"translate3d(-\" + (s + 2) + \"px, -\" + (s + 2) + \"px, -\" + s + \"px)\",\r\n          b:\r\n            \"translate3d(\" +\r\n            (s + 2) +\r\n            \"px, -\" +\r\n            (s + 2) +\r\n            \"px, \" +\r\n            s +\r\n            \"px) rotateX(180deg) rotateZ(180deg)\",\r\n          u:\r\n            \"translate3d(-\" +\r\n            (s + 2) +\r\n            \"px, -\" +\r\n            s +\r\n            \"px, \" +\r\n            (s + 2) +\r\n            \"px) rotateX(270deg)\",\r\n          d:\r\n            \"translate3d(-\" +\r\n            (s + 2) +\r\n            \"px, \" +\r\n            s +\r\n            \"px, -\" +\r\n            (s + 2) +\r\n            \"px) rotateX(90deg)\",\r\n          l:\r\n            \"translate3d(-\" +\r\n            s +\r\n            \"px, -\" +\r\n            (s + 2) +\r\n            \"px, \" +\r\n            (s + 2) +\r\n            \"px) rotateX(180deg) rotateY(90deg) rotateZ(180deg)\",\r\n          r:\r\n            \"translate3d(\" +\r\n            s +\r\n            \"px, -\" +\r\n            (s + 2) +\r\n            \"px, -\" +\r\n            (s + 2) +\r\n            \"px) rotateY(270deg)\",\r\n        };\r\n        focal = 1 / Math.tan(hfov / 2);\r\n        var zoom = (focal * canvas.clientWidth) / 2 + \"px\";\r\n        var transform =\r\n          \"perspective(\" +\r\n          zoom +\r\n          \") translateZ(\" +\r\n          zoom +\r\n          \") rotateX(\" +\r\n          pitch +\r\n          \"rad) rotateY(\" +\r\n          yaw +\r\n          \"rad) \"; // Apply face transforms\r\n\r\n        var faces = Object.keys(transforms);\r\n\r\n        for (i = 0; i < 6; i++) {\r\n          var face = world.querySelector(\".pnlm-\" + faces[i] + \"face\");\r\n          if (!face) continue; // ignore missing face to support partial cubemap/fallback image\r\n\r\n          face.style.webkitTransform = transform + transforms[faces[i]];\r\n          face.style.transform = transform + transforms[faces[i]];\r\n        }\r\n\r\n        return;\r\n      }\r\n\r\n      if (imageType != \"multires\") {\r\n        // Calculate focal length from vertical field of view\r\n        var vfov =\r\n          2 *\r\n          Math.atan(\r\n            Math.tan(hfov * 0.5) /\r\n              (gl.drawingBufferWidth / gl.drawingBufferHeight)\r\n          );\r\n        focal = 1 / Math.tan(vfov * 0.5); // Pass psi, theta, roll, and focal length\r\n\r\n        gl.uniform1f(program.psi, yaw);\r\n        gl.uniform1f(program.theta, pitch);\r\n        gl.uniform1f(program.rot, roll);\r\n        gl.uniform1f(program.f, focal);\r\n\r\n        if (dynamic === true) {\r\n          // Update texture if dynamic\r\n          if (imageType == \"equirectangular\") {\r\n            gl.bindTexture(gl.TEXTURE_2D, program.texture);\r\n            gl.texImage2D(\r\n              gl.TEXTURE_2D,\r\n              0,\r\n              gl.RGB,\r\n              gl.RGB,\r\n              gl.UNSIGNED_BYTE,\r\n              image\r\n            );\r\n          }\r\n        } // Draw using current buffer\r\n\r\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n      } else {\r\n        // Create perspective matrix\r\n        var perspMatrix = makePersp(\r\n          hfov,\r\n          gl.drawingBufferWidth / gl.drawingBufferHeight,\r\n          0.1,\r\n          100.0\r\n        ); // Find correct zoom level\r\n\r\n        checkZoom(hfov); // Create rotation matrix\r\n\r\n        var matrix = identityMatrix3();\r\n        matrix = rotateMatrix(matrix, -roll, \"z\");\r\n        matrix = rotateMatrix(matrix, -pitch, \"x\");\r\n        matrix = rotateMatrix(matrix, yaw, \"y\");\r\n        matrix = makeMatrix4(matrix); // Set matrix uniforms\r\n\r\n        gl.uniformMatrix4fv(\r\n          program.perspUniform,\r\n          false,\r\n          new Float32Array(transposeMatrix4(perspMatrix))\r\n        );\r\n        gl.uniformMatrix4fv(\r\n          program.cubeUniform,\r\n          false,\r\n          new Float32Array(transposeMatrix4(matrix))\r\n        ); // Find current nodes\r\n\r\n        var rotPersp = rotatePersp(perspMatrix, matrix);\r\n        program.nodeCache.sort(multiresNodeSort);\r\n\r\n        if (\r\n          program.nodeCache.length > 200 &&\r\n          program.nodeCache.length > program.currentNodes.length + 50\r\n        ) {\r\n          // Remove older nodes from cache\r\n          var removed = program.nodeCache.splice(\r\n            200,\r\n            program.nodeCache.length - 200\r\n          );\r\n\r\n          for (var j = 0; j < removed.length; j++) {\r\n            // Explicitly delete textures\r\n            gl.deleteTexture(removed[j].texture);\r\n          }\r\n        }\r\n\r\n        program.currentNodes = [];\r\n        var sides = [\"f\", \"b\", \"u\", \"d\", \"l\", \"r\"];\r\n\r\n        for (s = 0; s < 6; s++) {\r\n          var ntmp = new MultiresNode(\r\n            vtmps[s],\r\n            sides[s],\r\n            1,\r\n            0,\r\n            0,\r\n            image.fullpath\r\n          );\r\n          testMultiresNode(rotPersp, ntmp, pitch, yaw);\r\n        }\r\n\r\n        program.currentNodes.sort(multiresNodeRenderSort); // Unqueue any pending requests for nodes that are no longer visible\r\n\r\n        for (i = pendingTextureRequests.length - 1; i >= 0; i--) {\r\n          if (\r\n            program.currentNodes.indexOf(pendingTextureRequests[i].node) === -1\r\n          ) {\r\n            pendingTextureRequests[i].node.textureLoad = false;\r\n            pendingTextureRequests.splice(i, 1);\r\n          }\r\n        } // Allow one request to be pending, so that we can create a texture buffer for that in advance of loading actually beginning\r\n\r\n        if (pendingTextureRequests.length === 0) {\r\n          for (i = 0; i < program.currentNodes.length; i++) {\r\n            var node = program.currentNodes[i];\r\n\r\n            if (!node.texture && !node.textureLoad) {\r\n              node.textureLoad = true;\r\n              setTimeout(processNextTile, 0, node); // Only process one tile per frame to improve responsiveness\r\n\r\n              break;\r\n            }\r\n          }\r\n        } // Draw tiles\r\n\r\n        multiresDraw();\r\n      }\r\n\r\n      if (params.returnImage !== undefined$1) {\r\n        return canvas.toDataURL(\"image/png\");\r\n      }\r\n    };\r\n    /**\r\n     * Check if images are loading.\r\n     * @memberof Renderer\r\n     * @instance\r\n     * @returns {boolean} Whether or not images are loading.\r\n     */\r\n\r\n    this.isLoading = function () {\r\n      if (gl && imageType == \"multires\") {\r\n        for (var i = 0; i < program.currentNodes.length; i++) {\r\n          if (!program.currentNodes[i].textureLoaded) {\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n\r\n      return false;\r\n    };\r\n    /**\r\n     * Retrieve renderer's canvas.\r\n     * @memberof Renderer\r\n     * @instance\r\n     * @returns {HTMLElement} Renderer's canvas.\r\n     */\r\n\r\n    this.getCanvas = function () {\r\n      return canvas;\r\n    };\r\n    /**\r\n     * Sorting method for multires nodes.\r\n     * @private\r\n     * @param {MultiresNode} a - First node.\r\n     * @param {MultiresNode} b - Second node.\r\n     * @returns {number} Base tiles first, then higher timestamp first.\r\n     */\r\n\r\n    function multiresNodeSort(a, b) {\r\n      // Base tiles are always first\r\n      if (a.level == 1 && b.level != 1) {\r\n        return -1;\r\n      }\r\n\r\n      if (b.level == 1 && a.level != 1) {\r\n        return 1;\r\n      } // Higher timestamp first\r\n\r\n      return b.timestamp - a.timestamp;\r\n    }\r\n    /**\r\n     * Sorting method for multires node rendering.\r\n     * @private\r\n     * @param {MultiresNode} a - First node.\r\n     * @param {MultiresNode} b - Second node.\r\n     * @returns {number} Lower zoom levels first, then closest to center first.\r\n     */\r\n\r\n    function multiresNodeRenderSort(a, b) {\r\n      // Lower zoom levels first\r\n      if (a.level != b.level) {\r\n        return a.level - b.level;\r\n      } // Lower distance from center first\r\n\r\n      return a.diff - b.diff;\r\n    }\r\n    /**\r\n     * Draws multires nodes.\r\n     * @private\r\n     */\r\n\r\n    function multiresDraw() {\r\n      if (!program.drawInProgress) {\r\n        program.drawInProgress = true;\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n\r\n        for (var i = 0; i < program.currentNodes.length; i++) {\r\n          if (program.currentNodes[i].textureLoaded > 1) {\r\n            //var color = program.currentNodes[i].color;\r\n            //gl.uniform4f(program.colorUniform, color[0], color[1], color[2], 1.0);\r\n            // Bind vertex buffer and pass vertices to WebGL\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, cubeVertBuf);\r\n            gl.bufferData(\r\n              gl.ARRAY_BUFFER,\r\n              new Float32Array(program.currentNodes[i].vertices),\r\n              gl.STATIC_DRAW\r\n            );\r\n            gl.vertexAttribPointer(\r\n              program.vertPosLocation,\r\n              3,\r\n              gl.FLOAT,\r\n              false,\r\n              0,\r\n              0\r\n            ); // Prep for texture\r\n\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, cubeVertTexCoordBuf);\r\n            gl.vertexAttribPointer(\r\n              program.texCoordLocation,\r\n              2,\r\n              gl.FLOAT,\r\n              false,\r\n              0,\r\n              0\r\n            ); // Bind texture and draw tile\r\n\r\n            gl.bindTexture(gl.TEXTURE_2D, program.currentNodes[i].texture); // Bind program.currentNodes[i].texture to TEXTURE0\r\n\r\n            gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n          }\r\n        }\r\n\r\n        program.drawInProgress = false;\r\n      }\r\n    }\r\n    /**\r\n     * Creates new multires node.\r\n     * @constructor\r\n     * @private\r\n     * @param {number[]} vertices - Node's verticies.\r\n     * @param {string} side - Node's cube face.\r\n     * @param {number} level - Node's zoom level.\r\n     * @param {number} x - Node's x position.\r\n     * @param {number} y - Node's y position.\r\n     * @param {string} path - Node's path.\r\n     */\r\n\r\n    function MultiresNode(vertices, side, level, x, y, path) {\r\n      this.vertices = vertices;\r\n      this.side = side;\r\n      this.level = level;\r\n      this.x = x;\r\n      this.y = y;\r\n      this.path = path\r\n        .replace(\"%s\", side)\r\n        .replace(\"%l\", level)\r\n        .replace(\"%x\", x)\r\n        .replace(\"%y\", y);\r\n    }\r\n    /**\r\n     * Test if multires node is visible. If it is, add it to current nodes,\r\n     * load its texture, and load appropriate child nodes.\r\n     * @private\r\n     * @param {number[]} rotPersp - Rotated perspective matrix.\r\n     * @param {MultiresNode} node - Multires node to check.\r\n     * @param {number} pitch - Pitch to check at.\r\n     * @param {number} yaw - Yaw to check at.\r\n     * @param {number} hfov - Horizontal field of view to check at.\r\n     */\r\n\r\n    function testMultiresNode(rotPersp, node, pitch, yaw, hfov) {\r\n      if (checkSquareInView(rotPersp, node.vertices)) {\r\n        // Calculate central angle between center of view and center of tile\r\n        var v = node.vertices;\r\n        var x = v[0] + v[3] + v[6] + v[9];\r\n        var y = v[1] + v[4] + v[7] + v[10];\r\n        var z = v[2] + v[5] + v[8] + v[11];\r\n        var r = Math.sqrt(x * x + y * y + z * z);\r\n        var theta = Math.asin(z / r);\r\n        var phi = Math.atan2(y, x);\r\n        var ydiff = phi - yaw;\r\n        ydiff +=\r\n          ydiff > Math.PI ? -2 * Math.PI : ydiff < -Math.PI ? 2 * Math.PI : 0;\r\n        ydiff = Math.abs(ydiff);\r\n        node.diff = Math.acos(\r\n          Math.sin(pitch) * Math.sin(theta) +\r\n            Math.cos(pitch) * Math.cos(theta) * Math.cos(ydiff)\r\n        ); // Add node to current nodes and load texture if needed\r\n\r\n        var inCurrent = false;\r\n\r\n        for (var k = 0; k < program.nodeCache.length; k++) {\r\n          if (program.nodeCache[k].path == node.path) {\r\n            inCurrent = true;\r\n            program.nodeCache[k].timestamp = program.nodeCacheTimestamp++;\r\n            program.nodeCache[k].diff = node.diff;\r\n            program.currentNodes.push(program.nodeCache[k]);\r\n            break;\r\n          }\r\n        }\r\n\r\n        if (!inCurrent) {\r\n          //node.color = [Math.random(), Math.random(), Math.random()];\r\n          node.timestamp = program.nodeCacheTimestamp++;\r\n          program.currentNodes.push(node);\r\n          program.nodeCache.push(node);\r\n        } // TODO: Test error\r\n        // Create child nodes\r\n\r\n        if (node.level < program.level) {\r\n          var cubeSize =\r\n            image.cubeResolution * Math.pow(2, node.level - image.maxLevel);\r\n          var numTiles = Math.ceil(cubeSize * image.invTileResolution) - 1;\r\n          var doubleTileSize = (cubeSize % image.tileResolution) * 2;\r\n          var lastTileSize = (cubeSize * 2) % image.tileResolution;\r\n\r\n          if (lastTileSize === 0) {\r\n            lastTileSize = image.tileResolution;\r\n          }\r\n\r\n          if (doubleTileSize === 0) {\r\n            doubleTileSize = image.tileResolution * 2;\r\n          }\r\n\r\n          var f = 0.5;\r\n\r\n          if (node.x == numTiles || node.y == numTiles) {\r\n            f =\r\n              1.0 -\r\n              image.tileResolution / (image.tileResolution + lastTileSize);\r\n          }\r\n\r\n          var i = 1.0 - f;\r\n          var children = [];\r\n          var vtmp, ntmp;\r\n          var f1 = f,\r\n            f2 = f,\r\n            f3 = f,\r\n            i1 = i,\r\n            i2 = i,\r\n            i3 = i; // Handle non-symmetric tiles\r\n\r\n          if (lastTileSize < image.tileResolution) {\r\n            if (node.x == numTiles && node.y != numTiles) {\r\n              f2 = 0.5;\r\n              i2 = 0.5;\r\n\r\n              if (node.side == \"d\" || node.side == \"u\") {\r\n                f3 = 0.5;\r\n                i3 = 0.5;\r\n              }\r\n            } else if (node.x != numTiles && node.y == numTiles) {\r\n              f1 = 0.5;\r\n              i1 = 0.5;\r\n\r\n              if (node.side == \"l\" || node.side == \"r\") {\r\n                f3 = 0.5;\r\n                i3 = 0.5;\r\n              }\r\n            }\r\n          } // Handle small tiles that have fewer than four children\r\n\r\n          if (doubleTileSize <= image.tileResolution) {\r\n            if (node.x == numTiles) {\r\n              f1 = 0;\r\n              i1 = 1;\r\n\r\n              if (node.side == \"l\" || node.side == \"r\") {\r\n                f3 = 0;\r\n                i3 = 1;\r\n              }\r\n            }\r\n\r\n            if (node.y == numTiles) {\r\n              f2 = 0;\r\n              i2 = 1;\r\n\r\n              if (node.side == \"d\" || node.side == \"u\") {\r\n                f3 = 0;\r\n                i3 = 1;\r\n              }\r\n            }\r\n          }\r\n\r\n          vtmp = [\r\n            v[0],\r\n            v[1],\r\n            v[2],\r\n            v[0] * f1 + v[3] * i1,\r\n            v[1] * f + v[4] * i,\r\n            v[2] * f3 + v[5] * i3,\r\n            v[0] * f1 + v[6] * i1,\r\n            v[1] * f2 + v[7] * i2,\r\n            v[2] * f3 + v[8] * i3,\r\n            v[0] * f + v[9] * i,\r\n            v[1] * f2 + v[10] * i2,\r\n            v[2] * f3 + v[11] * i3,\r\n          ];\r\n          ntmp = new MultiresNode(\r\n            vtmp,\r\n            node.side,\r\n            node.level + 1,\r\n            node.x * 2,\r\n            node.y * 2,\r\n            image.fullpath\r\n          );\r\n          children.push(ntmp);\r\n\r\n          if (!(node.x == numTiles && doubleTileSize <= image.tileResolution)) {\r\n            vtmp = [\r\n              v[0] * f1 + v[3] * i1,\r\n              v[1] * f + v[4] * i,\r\n              v[2] * f3 + v[5] * i3,\r\n              v[3],\r\n              v[4],\r\n              v[5],\r\n              v[3] * f + v[6] * i,\r\n              v[4] * f2 + v[7] * i2,\r\n              v[5] * f3 + v[8] * i3,\r\n              v[0] * f1 + v[6] * i1,\r\n              v[1] * f2 + v[7] * i2,\r\n              v[2] * f3 + v[8] * i3,\r\n            ];\r\n            ntmp = new MultiresNode(\r\n              vtmp,\r\n              node.side,\r\n              node.level + 1,\r\n              node.x * 2 + 1,\r\n              node.y * 2,\r\n              image.fullpath\r\n            );\r\n            children.push(ntmp);\r\n          }\r\n\r\n          if (\r\n            !(node.x == numTiles && doubleTileSize <= image.tileResolution) &&\r\n            !(node.y == numTiles && doubleTileSize <= image.tileResolution)\r\n          ) {\r\n            vtmp = [\r\n              v[0] * f1 + v[6] * i1,\r\n              v[1] * f2 + v[7] * i2,\r\n              v[2] * f3 + v[8] * i3,\r\n              v[3] * f + v[6] * i,\r\n              v[4] * f2 + v[7] * i2,\r\n              v[5] * f3 + v[8] * i3,\r\n              v[6],\r\n              v[7],\r\n              v[8],\r\n              v[9] * f1 + v[6] * i1,\r\n              v[10] * f + v[7] * i,\r\n              v[11] * f3 + v[8] * i3,\r\n            ];\r\n            ntmp = new MultiresNode(\r\n              vtmp,\r\n              node.side,\r\n              node.level + 1,\r\n              node.x * 2 + 1,\r\n              node.y * 2 + 1,\r\n              image.fullpath\r\n            );\r\n            children.push(ntmp);\r\n          }\r\n\r\n          if (!(node.y == numTiles && doubleTileSize <= image.tileResolution)) {\r\n            vtmp = [\r\n              v[0] * f + v[9] * i,\r\n              v[1] * f2 + v[10] * i2,\r\n              v[2] * f3 + v[11] * i3,\r\n              v[0] * f1 + v[6] * i1,\r\n              v[1] * f2 + v[7] * i2,\r\n              v[2] * f3 + v[8] * i3,\r\n              v[9] * f1 + v[6] * i1,\r\n              v[10] * f + v[7] * i,\r\n              v[11] * f3 + v[8] * i3,\r\n              v[9],\r\n              v[10],\r\n              v[11],\r\n            ];\r\n            ntmp = new MultiresNode(\r\n              vtmp,\r\n              node.side,\r\n              node.level + 1,\r\n              node.x * 2,\r\n              node.y * 2 + 1,\r\n              image.fullpath\r\n            );\r\n            children.push(ntmp);\r\n          }\r\n\r\n          for (var j = 0; j < children.length; j++) {\r\n            testMultiresNode(rotPersp, children[j], pitch, yaw);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Creates cube vertex array.\r\n     * @private\r\n     * @returns {number[]} Cube vertex array.\r\n     */\r\n\r\n    function createCube() {\r\n      return [\r\n        -1,\r\n        1,\r\n        -1,\r\n        1,\r\n        1,\r\n        -1,\r\n        1,\r\n        -1,\r\n        -1,\r\n        -1,\r\n        -1,\r\n        -1, // Front face\r\n        1,\r\n        1,\r\n        1,\r\n        -1,\r\n        1,\r\n        1,\r\n        -1,\r\n        -1,\r\n        1,\r\n        1,\r\n        -1,\r\n        1, // Back face\r\n        -1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        -1,\r\n        -1,\r\n        1,\r\n        -1, // Up face\r\n        -1,\r\n        -1,\r\n        -1,\r\n        1,\r\n        -1,\r\n        -1,\r\n        1,\r\n        -1,\r\n        1,\r\n        -1,\r\n        -1,\r\n        1, // Down face\r\n        -1,\r\n        1,\r\n        1,\r\n        -1,\r\n        1,\r\n        -1,\r\n        -1,\r\n        -1,\r\n        -1,\r\n        -1,\r\n        -1,\r\n        1, // Left face\r\n        1,\r\n        1,\r\n        -1,\r\n        1,\r\n        1,\r\n        1,\r\n        1,\r\n        -1,\r\n        1,\r\n        1,\r\n        -1,\r\n        -1, // Right face\r\n      ];\r\n    }\r\n    /**\r\n     * Creates 3x3 identity matrix.\r\n     * @private\r\n     * @returns {number[]} Identity matrix.\r\n     */\r\n\r\n    function identityMatrix3() {\r\n      return [1, 0, 0, 0, 1, 0, 0, 0, 1];\r\n    }\r\n    /**\r\n     * Rotates a 3x3 matrix.\r\n     * @private\r\n     * @param {number[]} m - Matrix to rotate.\r\n     * @param {number[]} angle - Angle to rotate by in radians.\r\n     * @param {string} axis - Axis to rotate about (`x`, `y`, or `z`).\r\n     * @returns {number[]} Rotated matrix.\r\n     */\r\n\r\n    function rotateMatrix(m, angle, axis) {\r\n      var s = Math.sin(angle);\r\n      var c = Math.cos(angle);\r\n\r\n      if (axis == \"x\") {\r\n        return [\r\n          m[0],\r\n          c * m[1] + s * m[2],\r\n          c * m[2] - s * m[1],\r\n          m[3],\r\n          c * m[4] + s * m[5],\r\n          c * m[5] - s * m[4],\r\n          m[6],\r\n          c * m[7] + s * m[8],\r\n          c * m[8] - s * m[7],\r\n        ];\r\n      }\r\n\r\n      if (axis == \"y\") {\r\n        return [\r\n          c * m[0] - s * m[2],\r\n          m[1],\r\n          c * m[2] + s * m[0],\r\n          c * m[3] - s * m[5],\r\n          m[4],\r\n          c * m[5] + s * m[3],\r\n          c * m[6] - s * m[8],\r\n          m[7],\r\n          c * m[8] + s * m[6],\r\n        ];\r\n      }\r\n\r\n      if (axis == \"z\") {\r\n        return [\r\n          c * m[0] + s * m[1],\r\n          c * m[1] - s * m[0],\r\n          m[2],\r\n          c * m[3] + s * m[4],\r\n          c * m[4] - s * m[3],\r\n          m[5],\r\n          c * m[6] + s * m[7],\r\n          c * m[7] - s * m[6],\r\n          m[8],\r\n        ];\r\n      }\r\n    }\r\n    /**\r\n     * Turns a 3x3 matrix into a 4x4 matrix.\r\n     * @private\r\n     * @param {number[]} m - Input matrix.\r\n     * @returns {number[]} Expanded matrix.\r\n     */\r\n\r\n    function makeMatrix4(m) {\r\n      return [\r\n        m[0],\r\n        m[1],\r\n        m[2],\r\n        0,\r\n        m[3],\r\n        m[4],\r\n        m[5],\r\n        0,\r\n        m[6],\r\n        m[7],\r\n        m[8],\r\n        0,\r\n        0,\r\n        0,\r\n        0,\r\n        1,\r\n      ];\r\n    }\r\n    /**\r\n     * Transposes a 4x4 matrix.\r\n     * @private\r\n     * @param {number[]} m - Input matrix.\r\n     * @returns {number[]} Transposed matrix.\r\n     */\r\n\r\n    function transposeMatrix4(m) {\r\n      return [\r\n        m[0],\r\n        m[4],\r\n        m[8],\r\n        m[12],\r\n        m[1],\r\n        m[5],\r\n        m[9],\r\n        m[13],\r\n        m[2],\r\n        m[6],\r\n        m[10],\r\n        m[14],\r\n        m[3],\r\n        m[7],\r\n        m[11],\r\n        m[15],\r\n      ];\r\n    }\r\n    /**\r\n     * Creates a perspective matrix.\r\n     * @private\r\n     * @param {number} hfov - Desired horizontal field of view.\r\n     * @param {number} aspect - Desired aspect ratio.\r\n     * @param {number} znear - Near distance.\r\n     * @param {number} zfar - Far distance.\r\n     * @returns {number[]} Generated perspective matrix.\r\n     */\r\n\r\n    function makePersp(hfov, aspect, znear, zfar) {\r\n      var fovy =\r\n        2 *\r\n        Math.atan(\r\n          (Math.tan(hfov / 2) * gl.drawingBufferHeight) / gl.drawingBufferWidth\r\n        );\r\n      var f = 1 / Math.tan(fovy / 2);\r\n      return [\r\n        f / aspect,\r\n        0,\r\n        0,\r\n        0,\r\n        0,\r\n        f,\r\n        0,\r\n        0,\r\n        0,\r\n        0,\r\n        (zfar + znear) / (znear - zfar),\r\n        (2 * zfar * znear) / (znear - zfar),\r\n        0,\r\n        0,\r\n        -1,\r\n        0,\r\n      ];\r\n    }\r\n    /**\r\n     * Processes a loaded texture image into a WebGL texture.\r\n     * @private\r\n     * @param {Image} img - Input image.\r\n     * @param {WebGLTexture} tex - Texture to bind image to.\r\n     */\r\n\r\n    function processLoadedTexture(img, tex) {\r\n      gl.bindTexture(gl.TEXTURE_2D, tex);\r\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, img);\r\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n      gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n\r\n    var pendingTextureRequests = []; // Based on http://blog.tojicode.com/2012/03/javascript-memory-optimization-and.html\r\n\r\n    var loadTexture = (function () {\r\n      var cacheTop = 4; // Maximum number of concurrents loads\r\n\r\n      var textureImageCache = {};\r\n      var crossOrigin;\r\n\r\n      function TextureImageLoader() {\r\n        var self = this;\r\n        this.texture = this.callback = null;\r\n        this.image = new Image();\r\n        this.image.crossOrigin = crossOrigin ? crossOrigin : \"anonymous\";\r\n\r\n        var loadFn = function loadFn() {\r\n          if (self.image.width > 0 && self.image.height > 0) {\r\n            // ignore missing tile to supporting partial image\r\n            processLoadedTexture(self.image, self.texture);\r\n            self.callback(self.texture, true);\r\n          } else {\r\n            self.callback(self.texture, false);\r\n          }\r\n\r\n          releaseTextureImageLoader(self);\r\n        };\r\n\r\n        this.image.addEventListener(\"load\", loadFn);\r\n        this.image.addEventListener(\"error\", loadFn); // ignore missing tile file to support partial image, otherwise retry loop causes high CPU load\r\n      }\r\n\r\n      TextureImageLoader.prototype.loadTexture = function (\r\n        src,\r\n        texture,\r\n        callback\r\n      ) {\r\n        this.texture = texture;\r\n        this.callback = callback;\r\n        this.image.src = src;\r\n      };\r\n\r\n      function PendingTextureRequest(node, src, texture, callback) {\r\n        this.node = node;\r\n        this.src = src;\r\n        this.texture = texture;\r\n        this.callback = callback;\r\n      }\r\n\r\n      function releaseTextureImageLoader(til) {\r\n        if (pendingTextureRequests.length) {\r\n          var req = pendingTextureRequests.shift();\r\n          til.loadTexture(req.src, req.texture, req.callback);\r\n        } else textureImageCache[cacheTop++] = til;\r\n      }\r\n\r\n      for (var i = 0; i < cacheTop; i++) {\r\n        textureImageCache[i] = new TextureImageLoader();\r\n      }\r\n\r\n      return function (node, src, callback, _crossOrigin) {\r\n        crossOrigin = _crossOrigin;\r\n        var texture = gl.createTexture();\r\n        if (cacheTop)\r\n          textureImageCache[--cacheTop].loadTexture(src, texture, callback);\r\n        else\r\n          pendingTextureRequests.push(\r\n            new PendingTextureRequest(node, src, texture, callback)\r\n          );\r\n        return texture;\r\n      };\r\n    })();\r\n    /**\r\n     * Loads image and creates texture for a multires node / tile.\r\n     * @private\r\n     * @param {MultiresNode} node - Input node.\r\n     */\r\n\r\n    function processNextTile(node) {\r\n      loadTexture(\r\n        node,\r\n        node.path + \".\" + image.extension,\r\n        function (texture, loaded) {\r\n          node.texture = texture;\r\n          node.textureLoaded = loaded ? 2 : 1;\r\n        },\r\n        globalParams.crossOrigin\r\n      );\r\n    }\r\n    /**\r\n     * Finds and applies optimal multires zoom level.\r\n     * @private\r\n     * @param {number} hfov - Horizontal field of view to check at.\r\n     */\r\n\r\n    function checkZoom(hfov) {\r\n      // Find optimal level\r\n      var newLevel = 1;\r\n\r\n      while (\r\n        newLevel < image.maxLevel &&\r\n        gl.drawingBufferWidth >\r\n          image.tileResolution *\r\n            Math.pow(2, newLevel - 1) *\r\n            Math.tan(hfov / 2) *\r\n            0.707\r\n      ) {\r\n        newLevel++;\r\n      } // Apply change\r\n\r\n      program.level = newLevel;\r\n    }\r\n    /**\r\n     * Rotates perspective matrix.\r\n     * @private\r\n     * @param {number[]} p - Perspective matrix.\r\n     * @param {number[]} r - Rotation matrix.\r\n     * @returns {number[]} Rotated matrix.\r\n     */\r\n\r\n    function rotatePersp(p, r) {\r\n      return [\r\n        p[0] * r[0],\r\n        p[0] * r[1],\r\n        p[0] * r[2],\r\n        0,\r\n        p[5] * r[4],\r\n        p[5] * r[5],\r\n        p[5] * r[6],\r\n        0,\r\n        p[10] * r[8],\r\n        p[10] * r[9],\r\n        p[10] * r[10],\r\n        p[11],\r\n        -r[8],\r\n        -r[9],\r\n        -r[10],\r\n        0,\r\n      ];\r\n    }\r\n    /**\r\n     * Applies rotated perspective matrix to a 3-vector\r\n     * (last element is inverted).\r\n     * @private\r\n     * @param {number[]} m - Rotated perspective matrix.\r\n     * @param {number[]} v - Input 3-vector.\r\n     * @returns {number[]} Resulting 4-vector.\r\n     */\r\n\r\n    function applyRotPerspToVec(m, v) {\r\n      return [\r\n        m[0] * v[0] + m[1] * v[1] + m[2] * v[2],\r\n        m[4] * v[0] + m[5] * v[1] + m[6] * v[2],\r\n        m[11] + m[8] * v[0] + m[9] * v[1] + m[10] * v[2],\r\n        1 / (m[12] * v[0] + m[13] * v[1] + m[14] * v[2]),\r\n      ];\r\n    }\r\n    /**\r\n     * Checks if a vertex is visible.\r\n     * @private\r\n     * @param {number[]} m - Rotated perspective matrix.\r\n     * @param {number[]} v - Input vertex.\r\n     * @returns {number} 1 or -1 if the vertex is or is not visible,\r\n     *      respectively.\r\n     */\r\n\r\n    function checkInView(m, v) {\r\n      var vpp = applyRotPerspToVec(m, v);\r\n      var winX = vpp[0] * vpp[3];\r\n      var winY = vpp[1] * vpp[3];\r\n      var winZ = vpp[2] * vpp[3];\r\n      var ret = [0, 0, 0];\r\n      if (winX < -1) ret[0] = -1;\r\n      if (winX > 1) ret[0] = 1;\r\n      if (winY < -1) ret[1] = -1;\r\n      if (winY > 1) ret[1] = 1;\r\n      if (winZ < -1 || winZ > 1) ret[2] = 1;\r\n      return ret;\r\n    }\r\n    /**\r\n     * Checks if a square (tile) is visible.\r\n     * @private\r\n     * @param {number[]} m - Rotated perspective matrix.\r\n     * @param {number[]} v - Square's vertex array.\r\n     * @returns {boolean} Whether or not the square is visible.\r\n     */\r\n\r\n    function checkSquareInView(m, v) {\r\n      var check1 = checkInView(m, v.slice(0, 3));\r\n      var check2 = checkInView(m, v.slice(3, 6));\r\n      var check3 = checkInView(m, v.slice(6, 9));\r\n      var check4 = checkInView(m, v.slice(9, 12));\r\n      var testX = check1[0] + check2[0] + check3[0] + check4[0];\r\n      if (testX == -4 || testX == 4) return false;\r\n      var testY = check1[1] + check2[1] + check3[1] + check4[1];\r\n      if (testY == -4 || testY == 4) return false;\r\n      var testZ = check1[2] + check2[2] + check3[2] + check4[2];\r\n      return testZ != 4;\r\n    }\r\n    /**\r\n     * On iOS (iPhone 5c, iOS 10.3), this WebGL error occurs when the canvas is\r\n     * too big. Unfortuately, there's no way to test for this beforehand, so we\r\n     * reduce the canvas size if this error is thrown.\r\n     * @private\r\n     */\r\n\r\n    function handleWebGLError1286() {\r\n      console.log(\"Reducing canvas size due to error 1286!\");\r\n      canvas.width = Math.round(canvas.width / 2);\r\n      canvas.height = Math.round(canvas.height / 2);\r\n    }\r\n  } // Vertex shader for equirectangular and cube\r\n\r\n  var v = [\r\n    \"attribute vec2 a_texCoord;\",\r\n    \"varying vec2 v_texCoord;\",\r\n    \"void main() {\", // Set position\r\n    \"gl_Position = vec4(a_texCoord, 0.0, 1.0);\", // Pass the coordinates to the fragment shader\r\n    \"v_texCoord = a_texCoord;\",\r\n    \"}\",\r\n  ].join(\"\"); // Vertex shader for multires\r\n\r\n  var vMulti = [\r\n    \"attribute vec3 a_vertCoord;\",\r\n    \"attribute vec2 a_texCoord;\",\r\n    \"uniform mat4 u_cubeMatrix;\",\r\n    \"uniform mat4 u_perspMatrix;\",\r\n    \"varying mediump vec2 v_texCoord;\",\r\n    \"void main(void) {\", // Set position\r\n    \"gl_Position = u_perspMatrix * u_cubeMatrix * vec4(a_vertCoord, 1.0);\", // Pass the coordinates to the fragment shader\r\n    \"v_texCoord = a_texCoord;\",\r\n    \"}\",\r\n  ].join(\"\"); // Fragment shader\r\n\r\n  var fragEquiCubeBase = [\r\n    \"precision highp float;\", // mediump looks bad on some mobile devices\r\n    \"uniform float u_aspectRatio;\",\r\n    \"uniform float u_psi;\",\r\n    \"uniform float u_theta;\",\r\n    \"uniform float u_f;\",\r\n    \"uniform float u_h;\",\r\n    \"uniform float u_v;\",\r\n    \"uniform float u_vo;\",\r\n    \"uniform float u_rot;\",\r\n    \"const float PI = 3.14159265358979323846264;\", // Texture\r\n    \"uniform sampler2D u_image0;\",\r\n    \"uniform sampler2D u_image1;\",\r\n    \"uniform bool u_splitImage;\",\r\n    \"uniform samplerCube u_imageCube;\", // Coordinates passed in from vertex shader\r\n    \"varying vec2 v_texCoord;\", // Background color (display for partial panoramas)\r\n    \"uniform vec4 u_backgroundColor;\",\r\n    \"void main() {\", // Map canvas/camera to sphere\r\n    \"float x = v_texCoord.x * u_aspectRatio;\",\r\n    \"float y = v_texCoord.y;\",\r\n    \"float sinrot = sin(u_rot);\",\r\n    \"float cosrot = cos(u_rot);\",\r\n    \"float rot_x = x * cosrot - y * sinrot;\",\r\n    \"float rot_y = x * sinrot + y * cosrot;\",\r\n    \"float sintheta = sin(u_theta);\",\r\n    \"float costheta = cos(u_theta);\",\r\n    \"float a = u_f * costheta - rot_y * sintheta;\",\r\n    \"float root = sqrt(rot_x * rot_x + a * a);\",\r\n    \"float lambda = atan(rot_x / root, a / root) + u_psi;\",\r\n    \"float phi = atan((rot_y * costheta + u_f * sintheta) / root);\",\r\n  ].join(\"\\n\"); // Fragment shader\r\n\r\n  var fragCube =\r\n    fragEquiCubeBase +\r\n    [\r\n      // Look up color from texture\r\n      \"float cosphi = cos(phi);\",\r\n      \"gl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));\",\r\n      \"}\",\r\n    ].join(\"\\n\"); // Fragment shader\r\n\r\n  var fragEquirectangular =\r\n    fragEquiCubeBase +\r\n    [\r\n      // Wrap image\r\n      \"lambda = mod(lambda + PI, PI * 2.0) - PI;\", // Map texture to sphere\r\n      \"vec2 coord = vec2(lambda / PI, phi / (PI / 2.0));\", // Look up color from texture\r\n      // Map from [-1,1] to [0,1] and flip y-axis\r\n      \"if(coord.x < -u_h || coord.x > u_h || coord.y < -u_v + u_vo || coord.y > u_v + u_vo)\",\r\n      \"gl_FragColor = u_backgroundColor;\",\r\n      \"else {\",\r\n      \"if(u_splitImage) {\", // Image was split into two textures to work around texture size limits\r\n      \"if(coord.x < 0.0)\",\r\n      \"gl_FragColor = texture2D(u_image0, vec2((coord.x + u_h) / u_h, (-coord.y + u_v + u_vo) / (u_v * 2.0)));\",\r\n      \"else\",\r\n      \"gl_FragColor = texture2D(u_image1, vec2((coord.x + u_h) / u_h - 1.0, (-coord.y + u_v + u_vo) / (u_v * 2.0)));\",\r\n      \"} else {\",\r\n      \"gl_FragColor = texture2D(u_image0, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));\",\r\n      \"}\",\r\n      \"}\",\r\n      \"}\",\r\n    ].join(\"\\n\"); // Fragment shader\r\n\r\n  var fragMulti = [\r\n    \"varying mediump vec2 v_texCoord;\",\r\n    \"uniform sampler2D u_sampler;\", //'uniform mediump vec4 u_color;',\r\n    \"void main(void) {\", // Look up color from texture\r\n    \"gl_FragColor = texture2D(u_sampler, v_texCoord);\", //    'gl_FragColor = u_color;',\r\n    \"}\",\r\n  ].join(\"\");\r\n  return {\r\n    renderer: function renderer(container, image, imagetype, dynamic) {\r\n      return new Renderer(container, image, imagetype, dynamic);\r\n    },\r\n  };\r\n})(\r\n  typeof window === \"undefined\" ? null : window,\r\n  typeof document === \"undefined\" ? null : document\r\n);\r\n\r\nvar pannellum = (function (window, document, undefined$1) {\r\n  function Viewer(container, initialConfig) {\r\n    var _this = this; // Declare variables\r\n\r\n    let config,\r\n      renderer,\r\n      dLastPitch,\r\n      dLastYaw,\r\n      dLastHfov,\r\n      preview,\r\n      isAdd = {},\r\n      dTimeLookAtHotSpot = 600,\r\n      dTimeZoomInHotSpot = 1500,\r\n      dTimeZoomInAfterLoad = 500,\r\n      dTimeToLoad = 1500,\r\n      isUserInteracting = false,\r\n      latestInteraction = Date.now(),\r\n      onPointerDownPointerX = 0,\r\n      onPointerDownPointerY = 0,\r\n      onPointerDownPointerDist = -1,\r\n      onPointerDownYaw = 0,\r\n      onPointerDownPitch = 0,\r\n      keysDown = new Array(10),\r\n      fullscreenActive = false,\r\n      loaded,\r\n      error = false,\r\n      listenersAdded = false,\r\n      panoImage,\r\n      prevTime,\r\n      speed = {\r\n        yaw: 0,\r\n        pitch: 0,\r\n        hfov: 0,\r\n      },\r\n      animating = false,\r\n      orientation = false,\r\n      orientationYawOffset = 0,\r\n      autoRotateStart,\r\n      autoRotateSpeed = 0,\r\n      origHfov,\r\n      origPitch,\r\n      animatedMove = {},\r\n      externalEventListeners = {},\r\n      specifiedPhotoSphereExcludes = [],\r\n      update = false,\r\n      // Should we update when still to render dynamic content\r\n      eps = 1e-6,\r\n      hotspotsCreated = false,\r\n      destroyed = false;\r\n    var defaultConfig = {\r\n      hfov: 100,\r\n      minHfov: 50,\r\n      multiResMinHfov: false,\r\n      maxHfov: 120,\r\n      pitch: 0,\r\n      minPitch: -90,\r\n      maxPitch: 90,\r\n      yaw: 0,\r\n      minYaw: -180,\r\n      maxYaw: 180,\r\n      roll: 0,\r\n      haov: 360,\r\n      vaov: 180,\r\n      vOffset: 0,\r\n      autoRotate: false,\r\n      autoRotateInactivityDelay: -1,\r\n      autoRotateStopDelay: 0,\r\n      type: \"equirectangular\",\r\n      northOffset: 0,\r\n      showFullscreenCtrl: true,\r\n      dynamic: false,\r\n      dynamicUpdate: false,\r\n      doubleClickZoom: true,\r\n      keyboardZoom: true,\r\n      mouseZoom: true,\r\n      showZoomCtrl: true,\r\n      autoLoad: false,\r\n      showControls: true,\r\n      orientationOnByDefault: false,\r\n      hotSpotDebug: false,\r\n      backgroundColor: [0, 0, 0],\r\n      avoidShowingBackground: false,\r\n      animationTimingFunction: timingFunction,\r\n      draggable: true,\r\n      disableKeyboardCtrl: false,\r\n      crossOrigin: \"anonymous\",\r\n      touchPanSpeedCoeffFactor: 1,\r\n      capturedKeyNumbers: [\r\n        16, 17, 27, 37, 38, 39, 40, 61, 65, 68, 83, 87, 107, 109, 173, 187, 189,\r\n      ],\r\n      friction: 0.15,\r\n    }; // Translatable / configurable strings\r\n    // Some strings contain '%s', which is a placeholder for inserted values\r\n    // When setting strings in external configuration, `\\n` should be used instead of `<br>` to insert line breaks\r\n\r\n    defaultConfig.uiText = {\r\n      // Labels\r\n      loadButtonLabel: \"Click to<br>Load<br>Panorama\",\r\n      loadingLabel: \"Loading...\",\r\n      bylineLabel: \"by %s\",\r\n      // One substitution: author\r\n      // Errors\r\n      noPanoramaError: \"No panorama image was specified.\",\r\n      fileAccessError: \"The file %s could not be accessed.\",\r\n      // One substitution: file URL\r\n      malformedURLError: \"There is something wrong with the panorama URL.\",\r\n      iOS8WebGLError:\r\n        \"Due to iOS 8's broken WebGL implementation, only \" +\r\n        \"progressive encoded JPEGs work for your device (this \" +\r\n        \"panorama uses standard encoding).\",\r\n      genericWebGLError:\r\n        \"Your browser does not have the necessary WebGL support to display this panorama.\",\r\n      textureSizeError:\r\n        \"This panorama is too big for your device! It's \" +\r\n        \"%spx wide, but your device only supports images up to \" +\r\n        \"%spx wide. Try another device.\" +\r\n        \" (If you're the author, try scaling down the image.)\",\r\n      // Two substitutions: image width, max image width\r\n      unknownError: \"Unknown error. Check developer console.\",\r\n    }; // Initialize container\r\n\r\n    container =\r\n      typeof container === \"string\"\r\n        ? document.getElementById(container)\r\n        : container;\r\n    container.classList.add(\"pnlm-container\");\r\n    container.tabIndex = 0; // Create container for ui\r\n\r\n    var uiContainer = document.createElement(\"div\");\r\n    uiContainer.className = \"pnlm-ui\";\r\n    container.appendChild(uiContainer); // Create container for renderer\r\n\r\n    var renderContainer = document.createElement(\"div\");\r\n    renderContainer.className = \"pnlm-render-container\";\r\n    container.appendChild(renderContainer);\r\n    var dragFix = document.createElement(\"div\");\r\n    dragFix.className = \"pnlm-dragfix\";\r\n    uiContainer.appendChild(dragFix); // Display about information on right click\r\n\r\n    var aboutMsg = document.createElement(\"span\");\r\n    aboutMsg.className = \"pnlm-about-msg\";\r\n    aboutMsg.innerHTML =\r\n      '<a href=\"https://solutions.viettel.vn/vi\" target=\"_blank\">Viettel Solution</a>';\r\n    uiContainer.appendChild(aboutMsg);\r\n    dragFix.addEventListener(\"contextmenu\", aboutMessage); // Create info display\r\n\r\n    var infoDisplay = {}; // Hot spot debug indicator\r\n\r\n    var hotSpotDebugIndicator = document.createElement(\"div\");\r\n    hotSpotDebugIndicator.className =\r\n      \"pnlm-sprite pnlm-hot-spot-debug-indicator\";\r\n    uiContainer.appendChild(hotSpotDebugIndicator); // Panorama info\r\n\r\n    infoDisplay.container = document.createElement(\"div\");\r\n    infoDisplay.container.className = \"pnlm-panorama-info\";\r\n    infoDisplay.title = document.createElement(\"div\");\r\n    infoDisplay.title.className = \"pnlm-title-box\";\r\n    infoDisplay.container.appendChild(infoDisplay.title);\r\n    infoDisplay.description = document.createElement(\"div\");\r\n    infoDisplay.description.className = \"pnlm-description-box\";\r\n    infoDisplay.container.appendChild(infoDisplay.description);\r\n    infoDisplay.author = document.createElement(\"div\");\r\n    infoDisplay.author.className = \"pnlm-author-box\";\r\n    infoDisplay.container.appendChild(infoDisplay.author);\r\n    uiContainer.appendChild(infoDisplay.container); // Load box\r\n\r\n    infoDisplay.load = {};\r\n    infoDisplay.load.box = document.createElement(\"div\");\r\n    infoDisplay.load.box.className = \"pnlm-load-box\";\r\n    infoDisplay.load.boxp = document.createElement(\"p\");\r\n    infoDisplay.load.box.appendChild(infoDisplay.load.boxp);\r\n    infoDisplay.load.lbox = document.createElement(\"div\");\r\n    infoDisplay.load.lbox.className = \"pnlm-lbox\";\r\n    infoDisplay.load.lbox.innerHTML = '<div class=\"pnlm-loading\"></div>';\r\n    infoDisplay.load.box.appendChild(infoDisplay.load.lbox);\r\n    infoDisplay.load.lbar = document.createElement(\"div\");\r\n    infoDisplay.load.lbar.className = \"pnlm-lbar\";\r\n    infoDisplay.load.lbarFill = document.createElement(\"div\");\r\n    infoDisplay.load.lbarFill.className = \"pnlm-lbar-fill\";\r\n    infoDisplay.load.lbar.appendChild(infoDisplay.load.lbarFill);\r\n    infoDisplay.load.box.appendChild(infoDisplay.load.lbar);\r\n    infoDisplay.load.msg = document.createElement(\"p\");\r\n    infoDisplay.load.msg.className = \"pnlm-lmsg\";\r\n    infoDisplay.load.box.appendChild(infoDisplay.load.msg);\r\n    uiContainer.appendChild(infoDisplay.load.box); // Error message\r\n\r\n    infoDisplay.errorMsg = document.createElement(\"div\");\r\n    infoDisplay.errorMsg.className = \"pnlm-error-msg pnlm-info-box\";\r\n    uiContainer.appendChild(infoDisplay.errorMsg); // Create controls\r\n\r\n    var controls = {};\r\n    controls.container = document.createElement(\"div\");\r\n    controls.container.className = \"pnlm-controls-container\";\r\n    uiContainer.appendChild(controls.container); // Load button\r\n\r\n    controls.load = document.createElement(\"div\");\r\n    controls.load.className = \"pnlm-load-button\";\r\n    controls.load.addEventListener(\"click\", function () {\r\n      processOptions();\r\n      load();\r\n    });\r\n    uiContainer.appendChild(controls.load); // Zoom controls\r\n\r\n    controls.zoom = document.createElement(\"div\");\r\n    controls.zoom.className = \"pnlm-zoom-controls pnlm-controls\";\r\n    controls.zoomIn = document.createElement(\"div\");\r\n    controls.zoomIn.className = \"pnlm-zoom-in pnlm-sprite pnlm-control\";\r\n    controls.zoomIn.addEventListener(\"click\", zoomIn);\r\n    controls.zoom.appendChild(controls.zoomIn);\r\n    controls.zoomOut = document.createElement(\"div\");\r\n    controls.zoomOut.className = \"pnlm-zoom-out pnlm-sprite pnlm-control\";\r\n    controls.zoomOut.addEventListener(\"click\", zoomOut);\r\n    controls.zoom.appendChild(controls.zoomOut);\r\n    controls.container.appendChild(controls.zoom); // Fullscreen toggle\r\n\r\n    controls.fullscreen = document.createElement(\"div\");\r\n    controls.fullscreen.addEventListener(\"click\", toggleFullscreen);\r\n    controls.fullscreen.className =\r\n      \"pnlm-fullscreen-toggle-button pnlm-sprite pnlm-fullscreen-toggle-button-inactive pnlm-controls pnlm-control\";\r\n    if (\r\n      document.fullscreenEnabled ||\r\n      document.mozFullScreenEnabled ||\r\n      document.webkitFullscreenEnabled ||\r\n      document.msFullscreenEnabled\r\n    )\r\n      controls.container.appendChild(controls.fullscreen); // Device orientation toggle\r\n\r\n    controls.orientation = document.createElement(\"div\");\r\n    controls.orientation.addEventListener(\"click\", function (e) {\r\n      if (orientation) stopOrientation();\r\n      else startOrientation();\r\n    });\r\n    controls.orientation.addEventListener(\"mousedown\", function (e) {\r\n      e.stopPropagation();\r\n    });\r\n    controls.orientation.addEventListener(\"touchstart\", function (e) {\r\n      e.stopPropagation();\r\n    });\r\n    controls.orientation.addEventListener(\"pointerdown\", function (e) {\r\n      e.stopPropagation();\r\n    });\r\n    controls.orientation.className =\r\n      \"pnlm-orientation-button pnlm-orientation-button-inactive pnlm-sprite pnlm-controls pnlm-control\";\r\n    var orientationSupport = false;\r\n\r\n    if (\r\n      window.DeviceOrientationEvent &&\r\n      location.protocol === \"https:\" &&\r\n      navigator.userAgent.toLowerCase().indexOf(\"mobi\") >= 0\r\n    ) {\r\n      // This user agent check is here because there's no way to check if a\r\n      // device has an inertia measurement unit. We used to be able to check if a\r\n      // DeviceOrientationEvent had non-null values, but with iOS 13 requiring a\r\n      // permission prompt to access such events, this is no longer possible.\r\n      controls.container.appendChild(controls.orientation);\r\n      orientationSupport = true;\r\n    } // Compass\r\n\r\n    var compass = document.createElement(\"div\");\r\n    compass.className = \"pnlm-compass pnlm-controls pnlm-control\";\r\n    uiContainer.appendChild(compass); // Load and process configuration\r\n\r\n    if (initialConfig.firstScene) {\r\n      // Activate first scene if specified in URL\r\n      mergeConfig(initialConfig.firstScene);\r\n    } else if (\r\n      initialConfig[\"default\"] &&\r\n      initialConfig[\"default\"].firstScene\r\n    ) {\r\n      // Activate first scene if specified in file\r\n      mergeConfig(initialConfig[\"default\"].firstScene);\r\n    } else {\r\n      mergeConfig(null);\r\n    }\r\n\r\n    processOptions(true);\r\n    /**\r\n     * Initializes viewer.\r\n     * @private\r\n     */\r\n\r\n    function init() {\r\n      // Display an error for IE 9 as it doesn't work but also doesn't otherwise\r\n      // show an error (older versions don't work at all)\r\n      // Based on: http://stackoverflow.com/a/10965203\r\n      var div = document.createElement(\"div\");\r\n      div.innerHTML = \"<!--[if lte IE 9]><i></i><![endif]-->\";\r\n\r\n      if (div.getElementsByTagName(\"i\").length === 1) {\r\n        anError();\r\n        return;\r\n      }\r\n\r\n      origHfov = config.hfov;\r\n      origPitch = config.pitch;\r\n      var i, p;\r\n\r\n      if (config.type === \"cubemap\") {\r\n        panoImage = [];\r\n\r\n        for (i = 0; i < 6; i++) {\r\n          panoImage.push(new Image());\r\n          panoImage[i].crossOrigin = config.crossOrigin;\r\n        }\r\n\r\n        infoDisplay.load.lbox.style.display = \"block\";\r\n        infoDisplay.load.lbar.style.display = \"none\";\r\n      } else if (config.type === \"multires\") {\r\n        var c = JSON.parse(JSON.stringify(config.multiRes)); // Deep copy\r\n        // Avoid \"undefined\" in path, check (optional) multiRes.basePath, too\r\n        // Use only multiRes.basePath if it's an absolute URL\r\n\r\n        if (\r\n          config.basePath &&\r\n          config.multiRes.basePath &&\r\n          !/^(?:[a-z]+:)?\\/\\//i.test(config.multiRes.basePath)\r\n        ) {\r\n          c.basePath = config.basePath + config.multiRes.basePath;\r\n        } else if (config.multiRes.basePath) {\r\n          c.basePath = config.multiRes.basePath;\r\n        } else if (config.basePath) {\r\n          c.basePath = config.basePath;\r\n        }\r\n\r\n        panoImage = c;\r\n      } else {\r\n        if (config.dynamic === true) {\r\n          panoImage = config.imageSource;\r\n        } else {\r\n          if (config.imageSource === undefined$1) {\r\n            anError(config.uiText.noPanoramaError);\r\n            return;\r\n          }\r\n\r\n          panoImage = new Image();\r\n        }\r\n      } // Configure image loading\r\n\r\n      if (config.type === \"cubemap\") {\r\n        // Quick loading counter for synchronous loading\r\n        var itemsToLoad = 6;\r\n\r\n        var onLoad = function onLoad() {\r\n          itemsToLoad--;\r\n\r\n          if (itemsToLoad === 0) {\r\n            onImageLoad();\r\n          }\r\n        };\r\n\r\n        var onError = function onError(e) {\r\n          var a = document.createElement(\"a\");\r\n          a.href = e.target.src;\r\n          a.innerHTML = a.href;\r\n          anError(config.uiText.fileAccessError.replace(\"%s\", a.outerHTML));\r\n        };\r\n\r\n        for (i = 0; i < panoImage.length; i++) {\r\n          panoImage[i].onload = onLoad;\r\n          panoImage[i].onerror = onError;\r\n          p = config.cubeMap[i];\r\n\r\n          if (p === \"null\") {\r\n            // support partial cubemap image with explicitly empty faces\r\n            console.log(\r\n              \"Will use background instead of missing cubemap face \" + i\r\n            );\r\n            onLoad();\r\n          } else {\r\n            if (config.basePath && !absoluteURL(p)) {\r\n              p = config.basePath + p;\r\n            }\r\n\r\n            panoImage[i].onload = onLoad;\r\n            panoImage[i].onerror = onError;\r\n            panoImage[i].src = sanitizeURL(p); //panoImage[i].src = encodeURI(p);\r\n          }\r\n        }\r\n      } else if (config.type === \"multires\") {\r\n        onImageLoad();\r\n      } else {\r\n        p = \"\";\r\n\r\n        if (config.basePath) {\r\n          p = config.basePath;\r\n        }\r\n\r\n        if (config.dynamic !== true) {\r\n          // Still image\r\n          p = absoluteURL(config.imageSource)\r\n            ? config.imageSource\r\n            : p + config.imageSource;\r\n\r\n          panoImage.onload = function () {\r\n            window.URL.revokeObjectURL(this.src); // Clean up\r\n\r\n            onImageLoad();\r\n          };\r\n\r\n          var xhr = new XMLHttpRequest();\r\n\r\n          xhr.onloadend = function () {\r\n            if (xhr.status != 200) {\r\n              // Display error if image can't be loaded\r\n              var a = document.createElement(\"a\");\r\n              a.href = p;\r\n              a.textContent = a.href;\r\n              anError(config.uiText.fileAccessError.replace(\"%s\", a.outerHTML));\r\n            }\r\n\r\n            var img = this.response;\r\n            parseGPanoXMP(img);\r\n            infoDisplay.load.msg.innerHTML = \"\";\r\n          };\r\n\r\n          xhr.onprogress = function (e) {\r\n            if (e.lengthComputable) {\r\n              // Display progress\r\n              var percent = (e.loaded / e.total) * 100;\r\n              infoDisplay.load.lbarFill.style.width = percent + \"%\";\r\n              var unit, numerator, denominator;\r\n\r\n              if (e.total > 1e6) {\r\n                unit = \"MB\";\r\n                numerator = (e.loaded / 1e6).toFixed(2);\r\n                denominator = (e.total / 1e6).toFixed(2);\r\n              } else if (e.total > 1e3) {\r\n                unit = \"kB\";\r\n                numerator = (e.loaded / 1e3).toFixed(1);\r\n                denominator = (e.total / 1e3).toFixed(1);\r\n              } else {\r\n                unit = \"B\";\r\n                numerator = e.loaded;\r\n                denominator = e.total;\r\n              }\r\n\r\n              infoDisplay.load.msg.innerHTML =\r\n                numerator + \" / \" + denominator + \" \" + unit;\r\n            } else {\r\n              // Display loading spinner\r\n              infoDisplay.load.lbox.style.display = \"block\";\r\n              infoDisplay.load.lbar.style.display = \"none\";\r\n            }\r\n          };\r\n\r\n          try {\r\n            xhr.open(\"GET\", p, true);\r\n          } catch (e) {\r\n            // Malformed URL\r\n            anError(config.uiText.malformedURLError);\r\n          }\r\n\r\n          xhr.responseType = \"blob\";\r\n          xhr.setRequestHeader(\"Accept\", \"image/*,*/*;q=0.9\");\r\n          xhr.withCredentials = config.crossOrigin === \"use-credentials\";\r\n          xhr.send();\r\n        }\r\n      }\r\n\r\n      if (config.draggable) uiContainer.classList.add(\"pnlm-grab\");\r\n      uiContainer.classList.remove(\"pnlm-grabbing\"); // Properly handle switching to dynamic scenes\r\n\r\n      update = config.dynamicUpdate === true;\r\n\r\n      if (config.dynamic && update) {\r\n        panoImage = config.panorama;\r\n        onImageLoad();\r\n      }\r\n    }\r\n    /**\r\n     * Test if URL is absolute or relative.\r\n     * @private\r\n     * @param {string} url - URL to test\r\n     * @returns {boolean} True if absolute, else false\r\n     */\r\n\r\n    function absoluteURL(url) {\r\n      // From http://stackoverflow.com/a/19709846\r\n      return (\r\n        new RegExp(\"^(?:[a-z]+:)?//\", \"i\").test(url) ||\r\n        url[0] === \"/\" ||\r\n        url.slice(0, 5) === \"blob:\"\r\n      );\r\n    }\r\n    /**\r\n     * Create renderer and initialize event listeners once image is loaded.\r\n     * @private\r\n     */\r\n\r\n    function onImageLoad() {\r\n      if (!renderer) renderer = new libpannellum.renderer(renderContainer); // Only add event listeners once\r\n\r\n      if (!listenersAdded) {\r\n        listenersAdded = true;\r\n        dragFix.addEventListener(\"mousedown\", onDocumentMouseDown, false);\r\n        document.addEventListener(\"mousemove\", onDocumentMouseMove, false);\r\n        document.addEventListener(\"mouseup\", onDocumentMouseUp, false);\r\n\r\n        if (config.mouseZoom) {\r\n          uiContainer.addEventListener(\r\n            \"mousewheel\",\r\n            onDocumentMouseWheel,\r\n            false\r\n          );\r\n          uiContainer.addEventListener(\r\n            \"DOMMouseScroll\",\r\n            onDocumentMouseWheel,\r\n            false\r\n          );\r\n        }\r\n\r\n        if (config.doubleClickZoom) {\r\n          dragFix.addEventListener(\"dblclick\", onDocumentDoubleClick, false);\r\n        }\r\n\r\n        container.addEventListener(\r\n          \"mozfullscreenchange\",\r\n          onFullScreenChange,\r\n          false\r\n        );\r\n        container.addEventListener(\r\n          \"webkitfullscreenchange\",\r\n          onFullScreenChange,\r\n          false\r\n        );\r\n        container.addEventListener(\r\n          \"msfullscreenchange\",\r\n          onFullScreenChange,\r\n          false\r\n        );\r\n        container.addEventListener(\r\n          \"fullscreenchange\",\r\n          onFullScreenChange,\r\n          false\r\n        );\r\n        window.addEventListener(\"resize\", onDocumentResize, false);\r\n        window.addEventListener(\"orientationchange\", onDocumentResize, false);\r\n\r\n        if (!config.disableKeyboardCtrl) {\r\n          container.addEventListener(\"keydown\", onDocumentKeyPress, false);\r\n          container.addEventListener(\"keyup\", onDocumentKeyUp, false);\r\n          container.addEventListener(\"blur\", clearKeys, false);\r\n        }\r\n\r\n        document.addEventListener(\"mouseleave\", onDocumentMouseUp, false);\r\n\r\n        if (\r\n          document.documentElement.style.pointerAction === \"\" &&\r\n          document.documentElement.style.touchAction === \"\"\r\n        ) {\r\n          dragFix.addEventListener(\"pointerdown\", onDocumentPointerDown, false);\r\n          dragFix.addEventListener(\"pointermove\", onDocumentPointerMove, false);\r\n          dragFix.addEventListener(\"pointerup\", onDocumentPointerUp, false);\r\n          dragFix.addEventListener(\"pointerleave\", onDocumentPointerUp, false);\r\n        } else {\r\n          dragFix.addEventListener(\"touchstart\", onDocumentTouchStart, false);\r\n          dragFix.addEventListener(\"touchmove\", onDocumentTouchMove, false);\r\n          dragFix.addEventListener(\"touchend\", onDocumentTouchEnd, false);\r\n        } // Deal with MS pointer events\r\n\r\n        if (window.navigator.pointerEnabled)\r\n          container.style.touchAction = \"none\";\r\n      }\r\n\r\n      renderInit();\r\n      setHfov(config.hfov); // possibly adapt hfov after configuration and canvas is complete; prevents empty space on top or bottom by zomming out too much\r\n\r\n      setTimeout(function () {}, 500);\r\n    }\r\n    /**\r\n     * Parses Google Photo Sphere XMP Metadata.\r\n     * https://developers.google.com/photo-sphere/metadata/\r\n     * @private\r\n     * @param {Image} image - Image to read XMP metadata from.\r\n     */\r\n\r\n    function parseGPanoXMP(image) {\r\n      var reader = new FileReader();\r\n      reader.addEventListener(\"loadend\", function () {\r\n        var img = reader.result; // This awful browser specific test exists because iOS 8 does not work\r\n        // with non-progressive encoded JPEGs.\r\n\r\n        if (\r\n          navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)\r\n        ) {\r\n          var flagIndex = img.indexOf(\"\\xff\\xc2\");\r\n          if (flagIndex < 0 || flagIndex > 65536)\r\n            anError(config.uiText.iOS8WebGLError);\r\n        }\r\n\r\n        var start = img.indexOf(\"<x:xmpmeta\");\r\n\r\n        if (start > -1 && config.ignoreGPanoXMP !== true) {\r\n          var xmpData = img.substring(start, img.indexOf(\"</x:xmpmeta>\") + 12); // Extract the requested tag from the XMP data\r\n\r\n          var getTag = function getTag(tag) {\r\n            var result;\r\n\r\n            if (xmpData.indexOf(tag + '=\"') >= 0) {\r\n              result = xmpData.substring(\r\n                xmpData.indexOf(tag + '=\"') + tag.length + 2\r\n              );\r\n              result = result.substring(0, result.indexOf('\"'));\r\n            } else if (xmpData.indexOf(tag + \">\") >= 0) {\r\n              result = xmpData.substring(\r\n                xmpData.indexOf(tag + \">\") + tag.length + 1\r\n              );\r\n              result = result.substring(0, result.indexOf(\"<\"));\r\n            }\r\n\r\n            if (result !== undefined$1) {\r\n              return Number(result);\r\n            }\r\n\r\n            return null;\r\n          }; // Relevant XMP data\r\n\r\n          var xmp = {\r\n            fullWidth: getTag(\"GPano:FullPanoWidthPixels\"),\r\n            croppedWidth: getTag(\"GPano:CroppedAreaImageWidthPixels\"),\r\n            fullHeight: getTag(\"GPano:FullPanoHeightPixels\"),\r\n            croppedHeight: getTag(\"GPano:CroppedAreaImageHeightPixels\"),\r\n            topPixels: getTag(\"GPano:CroppedAreaTopPixels\"),\r\n            heading: getTag(\"GPano:PoseHeadingDegrees\"),\r\n            horizonPitch: getTag(\"GPano:PosePitchDegrees\"),\r\n            horizonRoll: getTag(\"GPano:PoseRollDegrees\"),\r\n          };\r\n\r\n          if (\r\n            xmp.fullWidth !== null &&\r\n            xmp.croppedWidth !== null &&\r\n            xmp.fullHeight !== null &&\r\n            xmp.croppedHeight !== null &&\r\n            xmp.topPixels !== null\r\n          ) {\r\n            // Set up viewer using GPano XMP data\r\n            if (specifiedPhotoSphereExcludes.indexOf(\"haov\") < 0)\r\n              config.haov = (xmp.croppedWidth / xmp.fullWidth) * 360;\r\n            if (specifiedPhotoSphereExcludes.indexOf(\"vaov\") < 0)\r\n              config.vaov = (xmp.croppedHeight / xmp.fullHeight) * 180;\r\n            if (specifiedPhotoSphereExcludes.indexOf(\"vOffset\") < 0)\r\n              config.vOffset =\r\n                ((xmp.topPixels + xmp.croppedHeight / 2) / xmp.fullHeight -\r\n                  0.5) *\r\n                -180;\r\n\r\n            if (\r\n              xmp.heading !== null &&\r\n              specifiedPhotoSphereExcludes.indexOf(\"northOffset\") < 0\r\n            ) {\r\n              // TODO: make sure this works correctly for partial panoramas\r\n              config.northOffset = xmp.heading;\r\n\r\n              if (config.compass !== false) {\r\n                config.compass = true;\r\n              }\r\n            }\r\n\r\n            if (xmp.horizonPitch !== null && xmp.horizonRoll !== null) {\r\n              if (specifiedPhotoSphereExcludes.indexOf(\"horizonPitch\") < 0)\r\n                config.horizonPitch = xmp.horizonPitch;\r\n              if (specifiedPhotoSphereExcludes.indexOf(\"horizonRoll\") < 0)\r\n                config.horizonRoll = xmp.horizonRoll;\r\n            } // TODO: add support for initial view settings\r\n          }\r\n        } // Load panorama\r\n\r\n        panoImage.src = window.URL.createObjectURL(image);\r\n      });\r\n      if (reader.readAsBinaryString !== undefined$1)\r\n        reader.readAsBinaryString(image);\r\n      else reader.readAsText(image);\r\n    }\r\n    /**\r\n     * Displays an error message.\r\n     * @private\r\n     * @param {string} errorMsg - Error message to display. If not specified, a\r\n     *      generic WebGL error is displayed.\r\n     */\r\n\r\n    function anError(errorMsg) {\r\n      if (errorMsg === undefined$1) errorMsg = config.uiText.genericWebGLError;\r\n      infoDisplay.errorMsg.innerHTML = \"<p>\" + errorMsg + \"</p>\";\r\n      controls.load.style.display = \"none\";\r\n      infoDisplay.load.box.style.display = \"none\";\r\n      infoDisplay.errorMsg.style.display = \"table\";\r\n      error = true;\r\n      loaded = undefined$1;\r\n      renderContainer.style.display = \"none\";\r\n      fireEvent(\"error\", errorMsg);\r\n    }\r\n    /**\r\n     * Hides error message display.\r\n     * @private\r\n     */\r\n\r\n    function clearError() {\r\n      if (error) {\r\n        infoDisplay.load.box.style.display = \"none\";\r\n        infoDisplay.errorMsg.style.display = \"none\";\r\n        error = false;\r\n        renderContainer.style.display = \"block\";\r\n        fireEvent(\"errorcleared\");\r\n      }\r\n    }\r\n    /**\r\n     * Displays about message.\r\n     * @private\r\n     * @param {MouseEvent} event - Right click location\r\n     */\r\n\r\n    function aboutMessage(event) {\r\n      var pos = mousePosition(event);\r\n      aboutMsg.style.left = pos.x + \"px\";\r\n      aboutMsg.style.top = pos.y + \"px\";\r\n      clearTimeout(aboutMessage.t1);\r\n      clearTimeout(aboutMessage.t2);\r\n      aboutMsg.style.display = \"block\";\r\n      aboutMsg.style.opacity = 1;\r\n      aboutMessage.t1 = setTimeout(function () {\r\n        aboutMsg.style.opacity = 0;\r\n      }, 2000);\r\n      aboutMessage.t2 = setTimeout(function () {\r\n        aboutMsg.style.display = \"none\";\r\n      }, 2500);\r\n      event.preventDefault();\r\n    }\r\n    /**\r\n     * Calculate mouse position relative to top left of viewer container.\r\n     * @private\r\n     * @param {MouseEvent} event - Mouse event to use in calculation\r\n     * @returns {Object} Calculated X and Y coordinates\r\n     */\r\n\r\n    function mousePosition(event) {\r\n      var bounds = container.getBoundingClientRect();\r\n      var pos = {}; // pageX / pageY needed for iOS\r\n\r\n      pos.x = (event.clientX || event.pageX) - bounds.left;\r\n      pos.y = (event.clientY || event.pageY) - bounds.top;\r\n      return pos;\r\n    }\r\n    /**\r\n     * Event handler for mouse clicks. Initializes panning. Prints center and click\r\n     * location coordinates when hot spot debugging is enabled.\r\n     * @private\r\n     * @param {MouseEvent} event - Document mouse down event.\r\n     */\r\n\r\n    function onDocumentMouseDown(event) {\r\n      // Override default action\r\n      event.preventDefault(); // But not all of it\r\n\r\n      container.focus(); // Only do something if the panorama is loaded\r\n\r\n      if (!loaded || !config.draggable) {\r\n        fireEvent(\"mousedown\", event);\r\n        return;\r\n      } // Calculate mouse position relative to top left of viewer container\r\n\r\n      var pos = mousePosition(event); // Log pitch / yaw of mouse click when debugging / placing hot spots\r\n\r\n      if (config.hotSpotDebug) {\r\n        var coords = mouseEventToCoords(event);\r\n        console.log(\r\n          \"Pitch: \" +\r\n            coords[0] +\r\n            \", Yaw: \" +\r\n            coords[1] +\r\n            \", Center Pitch: \" +\r\n            config.pitch +\r\n            \", Center Yaw: \" +\r\n            config.yaw +\r\n            \", HFOV: \" +\r\n            config.hfov\r\n        );\r\n      } // Turn off auto-rotation if enabled\r\n\r\n      stopAnimation();\r\n      stopOrientation();\r\n      config.roll = 0;\r\n      speed.hfov = 0;\r\n      isUserInteracting = true;\r\n      latestInteraction = Date.now();\r\n      onPointerDownPointerX = pos.x;\r\n      onPointerDownPointerY = pos.y;\r\n      onPointerDownYaw = config.yaw;\r\n      onPointerDownPitch = config.pitch;\r\n      uiContainer.classList.add(\"pnlm-grabbing\");\r\n      uiContainer.classList.remove(\"pnlm-grab\");\r\n      fireEvent(\"mousedown\", event);\r\n      animateInit();\r\n    }\r\n    /**\r\n     * Event handler for double clicks. Zooms in at clicked location\r\n     * @private\r\n     * @param {MouseEvent} event - Document mouse down event.\r\n     */\r\n\r\n    function onDocumentDoubleClick(event) {\r\n      if (config.minHfov === config.hfov) {\r\n        _this.setHfov(origHfov, 1000);\r\n      } else {\r\n        var coords = mouseEventToCoords(event);\r\n\r\n        _this.lookAt(coords[0], coords[1], config.minHfov, 1000);\r\n      }\r\n    }\r\n\r\n    function changeMouseCursor(event) {\r\n      isAdd = { ...event };\r\n      if (isAdd.isAddInfo === true || isAdd.isAddScene === true) {\r\n        config.draggable = false;\r\n        uiContainer.classList.remove(\"pnlm-grab\");\r\n        uiContainer.classList.add(\"pnlm-custom\");\r\n      } else {\r\n        config.draggable = true;\r\n        uiContainer.classList.add(\"pnlm-grab\");\r\n        uiContainer.classList.remove(\"pnlm-custom\");\r\n      }\r\n    }\r\n    /**\r\n     * Calculate panorama pitch and yaw from location of mouse event.\r\n     * @private\r\n     * @param {MouseEvent} event - Document mouse down event.\r\n     * @returns {number[]} [pitch, yaw]\r\n     */\r\n\r\n    function mouseEventToCoords(event) {\r\n      var pos = mousePosition(event);\r\n      var canvas = renderer.getCanvas();\r\n      var canvasWidth = canvas.clientWidth,\r\n        canvasHeight = canvas.clientHeight;\r\n      var x = (pos.x / canvasWidth) * 2 - 1;\r\n      var y = ((1 - (pos.y / canvasHeight) * 2) * canvasHeight) / canvasWidth;\r\n      var focal = 1 / Math.tan((config.hfov * Math.PI) / 360);\r\n      var s = Math.sin((config.pitch * Math.PI) / 180);\r\n      var c = Math.cos((config.pitch * Math.PI) / 180);\r\n      var a = focal * c - y * s;\r\n      var root = Math.sqrt(x * x + a * a);\r\n      var pitch = (Math.atan((y * c + focal * s) / root) * 180) / Math.PI;\r\n      var yaw = (Math.atan2(x / root, a / root) * 180) / Math.PI + config.yaw;\r\n      if (yaw < -180) yaw += 360;\r\n      if (yaw > 180) yaw -= 360;\r\n      return [pitch, yaw];\r\n    }\r\n    /**\r\n     * Event handler for mouse moves. Pans center of view.\r\n     * @private\r\n     * @param {MouseEvent} event - Document mouse move event.\r\n     */\r\n\r\n    function onDocumentMouseMove(event) {\r\n      if (isUserInteracting && loaded) {\r\n        latestInteraction = Date.now();\r\n        var canvas = renderer.getCanvas();\r\n        var canvasWidth = canvas.clientWidth,\r\n          canvasHeight = canvas.clientHeight;\r\n        var pos = mousePosition(event); //TODO: This still isn't quite right\r\n\r\n        var yaw =\r\n          ((((Math.atan((onPointerDownPointerX / canvasWidth) * 2 - 1) -\r\n            Math.atan((pos.x / canvasWidth) * 2 - 1)) *\r\n            180) /\r\n            Math.PI) *\r\n            config.hfov) /\r\n            90 +\r\n          onPointerDownYaw;\r\n        speed.yaw = ((yaw - config.yaw) % 360) * 0.2;\r\n        config.yaw = yaw;\r\n        var vfov =\r\n          (2 *\r\n            Math.atan(\r\n              (Math.tan((config.hfov / 360) * Math.PI) * canvasHeight) /\r\n                canvasWidth\r\n            ) *\r\n            180) /\r\n          Math.PI;\r\n        var pitch =\r\n          ((((Math.atan((pos.y / canvasHeight) * 2 - 1) -\r\n            Math.atan((onPointerDownPointerY / canvasHeight) * 2 - 1)) *\r\n            180) /\r\n            Math.PI) *\r\n            vfov) /\r\n            90 +\r\n          onPointerDownPitch;\r\n        speed.pitch = (pitch - config.pitch) * 0.2;\r\n        config.pitch = pitch;\r\n      }\r\n    }\r\n    /**\r\n     * Event handler for mouse up events. Stops panning.\r\n     * @private\r\n     */\r\n\r\n    function onDocumentMouseUp(event) {\r\n      if (!isUserInteracting) {\r\n        return;\r\n      }\r\n\r\n      isUserInteracting = false;\r\n\r\n      if (Date.now() - latestInteraction > 15) {\r\n        // Prevents jump when user rapidly moves mouse, stops, and then\r\n        // releases the mouse button\r\n        speed.pitch = speed.yaw = 0;\r\n      }\r\n\r\n      uiContainer.classList.add(\"pnlm-grab\");\r\n      uiContainer.classList.remove(\"pnlm-grabbing\");\r\n      latestInteraction = Date.now();\r\n      fireEvent(\"mouseup\", event);\r\n    }\r\n    /**\r\n     * Event handler for touches. Initializes panning if one touch or zooming if\r\n     * two touches.\r\n     * @private\r\n     * @param {TouchEvent} event - Document touch start event.\r\n     */\r\n\r\n    function onDocumentTouchStart(event) {\r\n      // Only do something if the panorama is loaded\r\n      if (!loaded || !config.draggable) {\r\n        return;\r\n      } // Turn off auto-rotation if enabled\r\n\r\n      stopAnimation();\r\n      stopOrientation();\r\n      config.roll = 0;\r\n      speed.hfov = 0; // Calculate touch position relative to top left of viewer container\r\n\r\n      var pos0 = mousePosition(event.targetTouches[0]);\r\n      onPointerDownPointerX = pos0.x;\r\n      onPointerDownPointerY = pos0.y;\r\n\r\n      if (event.targetTouches.length === 2) {\r\n        // Down pointer is the center of the two fingers\r\n        var pos1 = mousePosition(event.targetTouches[1]);\r\n        onPointerDownPointerX += (pos1.x - pos0.x) * 0.5;\r\n        onPointerDownPointerY += (pos1.y - pos0.y) * 0.5;\r\n        onPointerDownPointerDist = Math.sqrt(\r\n          (pos0.x - pos1.x) * (pos0.x - pos1.x) +\r\n            (pos0.y - pos1.y) * (pos0.y - pos1.y)\r\n        );\r\n      }\r\n\r\n      isUserInteracting = true;\r\n      latestInteraction = Date.now();\r\n      onPointerDownYaw = config.yaw;\r\n      onPointerDownPitch = config.pitch;\r\n      fireEvent(\"touchstart\", event);\r\n      animateInit();\r\n    }\r\n    /**\r\n     * Event handler for touch movements. Pans center of view if one touch or\r\n     * adjusts zoom if two touches.\r\n     * @private\r\n     * @param {TouchEvent} event - Document touch move event.\r\n     */\r\n\r\n    function onDocumentTouchMove(event) {\r\n      if (!config.draggable) {\r\n        return;\r\n      } // Override default action\r\n\r\n      event.preventDefault();\r\n\r\n      if (loaded) {\r\n        latestInteraction = Date.now();\r\n      }\r\n\r\n      if (isUserInteracting && loaded) {\r\n        var pos0 = mousePosition(event.targetTouches[0]);\r\n        var clientX = pos0.x;\r\n        var clientY = pos0.y;\r\n\r\n        if (\r\n          event.targetTouches.length === 2 &&\r\n          onPointerDownPointerDist != -1\r\n        ) {\r\n          var pos1 = mousePosition(event.targetTouches[1]);\r\n          clientX += (pos1.x - pos0.x) * 0.5;\r\n          clientY += (pos1.y - pos0.y) * 0.5;\r\n          var clientDist = Math.sqrt(\r\n            (pos0.x - pos1.x) * (pos0.x - pos1.x) +\r\n              (pos0.y - pos1.y) * (pos0.y - pos1.y)\r\n          );\r\n          setHfov(config.hfov + (onPointerDownPointerDist - clientDist) * 0.1);\r\n          onPointerDownPointerDist = clientDist;\r\n        } // The smaller the config.hfov value (the more zoomed-in the user is), the faster\r\n        // yaw/pitch are perceived to change on one-finger touchmove (panning) events and vice versa.\r\n        // To improve usability at both small and large zoom levels (config.hfov values)\r\n        // we introduce a dynamic pan speed coefficient.\r\n        //\r\n        // Currently this seems to *roughly* keep initial drag/pan start position close to\r\n        // the user's finger while panning regardless of zoom level / config.hfov value.\r\n\r\n        var touchmovePanSpeedCoeff =\r\n          (config.hfov / 360) * config.touchPanSpeedCoeffFactor;\r\n        var yaw =\r\n          (onPointerDownPointerX - clientX) * touchmovePanSpeedCoeff +\r\n          onPointerDownYaw;\r\n        speed.yaw = ((yaw - config.yaw) % 360) * 0.2;\r\n        config.yaw = yaw;\r\n        var pitch =\r\n          (clientY - onPointerDownPointerY) * touchmovePanSpeedCoeff +\r\n          onPointerDownPitch;\r\n        speed.pitch = (pitch - config.pitch) * 0.2;\r\n        config.pitch = pitch;\r\n      }\r\n    }\r\n    /**\r\n     * Event handler for end of touches. Stops panning and/or zooming.\r\n     * @private\r\n     */\r\n\r\n    function onDocumentTouchEnd() {\r\n      isUserInteracting = false;\r\n\r\n      if (Date.now() - latestInteraction > 150) {\r\n        speed.pitch = speed.yaw = 0;\r\n      }\r\n\r\n      onPointerDownPointerDist = -1;\r\n      latestInteraction = Date.now();\r\n      fireEvent(\"touchend\", event);\r\n    }\r\n\r\n    var pointerIDs = [],\r\n      pointerCoordinates = [];\r\n    /**\r\n     * Event handler for touch starts in IE / Edge.\r\n     * @private\r\n     * @param {PointerEvent} event - Document pointer down event.\r\n     */\r\n\r\n    function onDocumentPointerDown(event) {\r\n      if (event.pointerType === \"touch\") {\r\n        // Only do something if the panorama is loaded\r\n        if (!loaded || !config.draggable) return;\r\n        pointerIDs.push(event.pointerId);\r\n        pointerCoordinates.push({\r\n          clientX: event.clientX,\r\n          clientY: event.clientY,\r\n        });\r\n        event.targetTouches = pointerCoordinates;\r\n        onDocumentTouchStart(event);\r\n        event.preventDefault();\r\n      }\r\n    }\r\n    /**\r\n     * Event handler for touch moves in IE / Edge.\r\n     * @private\r\n     * @param {PointerEvent} event - Document pointer move event.\r\n     */\r\n\r\n    function onDocumentPointerMove(event) {\r\n      if (event.pointerType === \"touch\") {\r\n        if (!config.draggable) return;\r\n\r\n        for (var i = 0; i < pointerIDs.length; i++) {\r\n          if (event.pointerId === pointerIDs[i]) {\r\n            pointerCoordinates[i].clientX = event.clientX;\r\n            pointerCoordinates[i].clientY = event.clientY;\r\n            event.targetTouches = pointerCoordinates;\r\n            onDocumentTouchMove(event);\r\n            event.preventDefault();\r\n            return;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Event handler for touch ends in IE / Edge.\r\n     * @private\r\n     * @param {PointerEvent} event - Document pointer up event.\r\n     */\r\n\r\n    function onDocumentPointerUp(event) {\r\n      if (event.pointerType === \"touch\") {\r\n        var defined = false;\r\n\r\n        for (var i = 0; i < pointerIDs.length; i++) {\r\n          if (event.pointerId === pointerIDs[i]) pointerIDs[i] = undefined$1;\r\n          if (pointerIDs[i]) defined = true;\r\n        }\r\n\r\n        if (!defined) {\r\n          pointerIDs = [];\r\n          pointerCoordinates = [];\r\n          onDocumentTouchEnd();\r\n        }\r\n\r\n        event.preventDefault();\r\n      }\r\n    }\r\n    /**\r\n     * Event handler for mouse wheel. Changes zoom.\r\n     * @private\r\n     * @param {WheelEvent} event - Document mouse wheel event.\r\n     */\r\n\r\n    function onDocumentMouseWheel(event) {\r\n      // Only do something if the panorama is loaded and mouse wheel zoom is enabled\r\n      if (\r\n        !loaded ||\r\n        (config.mouseZoom === \"fullscreenonly\" && !fullscreenActive)\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      event.preventDefault(); // Turn off auto-rotation if enabled\r\n\r\n      stopAnimation();\r\n      latestInteraction = Date.now();\r\n\r\n      if (event.wheelDeltaY) {\r\n        // WebKit\r\n        setHfov(config.hfov - event.wheelDeltaY * 0.05);\r\n        speed.hfov = event.wheelDelta < 0 ? 1 : -1;\r\n      } else if (event.wheelDelta) {\r\n        // Opera / Explorer 9\r\n        setHfov(config.hfov - event.wheelDelta * 0.05);\r\n        speed.hfov = event.wheelDelta < 0 ? 1 : -1;\r\n      } else if (event.detail) {\r\n        // Firefox\r\n        setHfov(config.hfov + event.detail * 1.5);\r\n        speed.hfov = event.detail > 0 ? 1 : -1;\r\n      }\r\n\r\n      animateInit();\r\n    }\r\n    /**\r\n     * Event handler for key presses. Updates list of currently pressed keys.\r\n     * @private\r\n     * @param {KeyboardEvent} event - Document key press event.\r\n     */\r\n\r\n    function onDocumentKeyPress(event) {\r\n      // Turn off auto-rotation if enabled\r\n      stopAnimation();\r\n      latestInteraction = Date.now();\r\n      stopOrientation();\r\n      config.roll = 0; // Record key pressed\r\n\r\n      var keynumber = event.which || event.keycode; // Override default action for keys that are used\r\n\r\n      if (config.capturedKeyNumbers.indexOf(keynumber) < 0) return;\r\n      event.preventDefault(); // If escape key is pressed\r\n\r\n      if (keynumber === 27) {\r\n        // If in fullscreen mode\r\n        if (fullscreenActive) {\r\n          toggleFullscreen();\r\n        }\r\n      } else {\r\n        // Change key\r\n        changeKey(keynumber, true);\r\n      }\r\n    }\r\n    /**\r\n     * Clears list of currently pressed keys.\r\n     * @private\r\n     */\r\n\r\n    function clearKeys() {\r\n      for (var i = 0; i < 10; i++) {\r\n        keysDown[i] = false;\r\n      }\r\n    }\r\n    /**\r\n     * Event handler for key releases. Updates list of currently pressed keys.\r\n     * @private\r\n     * @param {KeyboardEvent} event - Document key up event.\r\n     */\r\n\r\n    function onDocumentKeyUp(event) {\r\n      // Record key pressed\r\n      var keynumber = event.which || event.keycode; // Override default action for keys that are used\r\n\r\n      if (config.capturedKeyNumbers.indexOf(keynumber) < 0) return;\r\n      event.preventDefault(); // Change key\r\n\r\n      changeKey(keynumber, false);\r\n    }\r\n    /**\r\n     * Updates list of currently pressed keys.\r\n     * @private\r\n     * @param {number} keynumber - Key number.\r\n     * @param {boolean} value - Whether or not key is pressed.\r\n     */\r\n\r\n    function changeKey(keynumber, value) {\r\n      var keyChanged = false;\r\n\r\n      switch (keynumber) {\r\n        // If minus key is released\r\n        case 109:\r\n        case 189:\r\n        case 17:\r\n        case 173:\r\n          if (keysDown[0] != value) {\r\n            keyChanged = true;\r\n          }\r\n\r\n          keysDown[0] = value;\r\n          break;\r\n        // If plus key is released\r\n\r\n        case 107:\r\n        case 187:\r\n        case 16:\r\n        case 61:\r\n          if (keysDown[1] != value) {\r\n            keyChanged = true;\r\n          }\r\n\r\n          keysDown[1] = value;\r\n          break;\r\n        // If up arrow is released\r\n\r\n        case 38:\r\n          if (keysDown[2] != value) {\r\n            keyChanged = true;\r\n          }\r\n\r\n          keysDown[2] = value;\r\n          break;\r\n        // If \"w\" is released\r\n\r\n        case 87:\r\n          if (keysDown[6] != value) {\r\n            keyChanged = true;\r\n          }\r\n\r\n          keysDown[6] = value;\r\n          break;\r\n        // If down arrow is released\r\n\r\n        case 40:\r\n          if (keysDown[3] != value) {\r\n            keyChanged = true;\r\n          }\r\n\r\n          keysDown[3] = value;\r\n          break;\r\n        // If \"s\" is released\r\n\r\n        case 83:\r\n          if (keysDown[7] != value) {\r\n            keyChanged = true;\r\n          }\r\n\r\n          keysDown[7] = value;\r\n          break;\r\n        // If left arrow is released\r\n\r\n        case 37:\r\n          if (keysDown[4] != value) {\r\n            keyChanged = true;\r\n          }\r\n\r\n          keysDown[4] = value;\r\n          break;\r\n        // If \"a\" is released\r\n\r\n        case 65:\r\n          if (keysDown[8] != value) {\r\n            keyChanged = true;\r\n          }\r\n\r\n          keysDown[8] = value;\r\n          break;\r\n        // If right arrow is released\r\n\r\n        case 39:\r\n          if (keysDown[5] != value) {\r\n            keyChanged = true;\r\n          }\r\n\r\n          keysDown[5] = value;\r\n          break;\r\n        // If \"d\" is released\r\n\r\n        case 68:\r\n          if (keysDown[9] != value) {\r\n            keyChanged = true;\r\n          }\r\n\r\n          keysDown[9] = value;\r\n      }\r\n\r\n      if (keyChanged && value) {\r\n        if (typeof performance !== \"undefined\" && performance.now()) {\r\n          prevTime = performance.now();\r\n        } else {\r\n          prevTime = Date.now();\r\n        }\r\n\r\n        animateInit();\r\n      }\r\n    }\r\n    /**\r\n     * Pans and/or zooms panorama based on currently pressed keys. Also handles\r\n     * panorama \"inertia\" and auto rotation.\r\n     * @private\r\n     */\r\n\r\n    function keyRepeat() {\r\n      // Only do something if the panorama is loaded\r\n      if (!loaded) {\r\n        return;\r\n      }\r\n\r\n      var isKeyDown = false;\r\n      var prevPitch = config.pitch;\r\n      var prevYaw = config.yaw;\r\n      var prevZoom = config.hfov;\r\n      var newTime;\r\n\r\n      if (typeof performance !== \"undefined\" && performance.now()) {\r\n        newTime = performance.now();\r\n      } else {\r\n        newTime = Date.now();\r\n      }\r\n\r\n      if (prevTime === undefined$1) {\r\n        prevTime = newTime;\r\n      }\r\n\r\n      var diff = ((newTime - prevTime) * config.hfov) / 1700;\r\n      diff = Math.min(diff, 1.0); // If minus key is down\r\n\r\n      if (keysDown[0] && config.keyboardZoom === true) {\r\n        setHfov(config.hfov + (speed.hfov * 0.8 + 0.5) * diff);\r\n        isKeyDown = true;\r\n      } // If plus key is down\r\n\r\n      if (keysDown[1] && config.keyboardZoom === true) {\r\n        setHfov(config.hfov + (speed.hfov * 0.8 - 0.2) * diff);\r\n        isKeyDown = true;\r\n      } // If up arrow or \"w\" is down\r\n\r\n      if (keysDown[2] || keysDown[6]) {\r\n        // Pan up\r\n        config.pitch += (speed.pitch * 0.8 + 0.2) * diff;\r\n        isKeyDown = true;\r\n      } // If down arrow or \"s\" is down\r\n\r\n      if (keysDown[3] || keysDown[7]) {\r\n        // Pan down\r\n        config.pitch += (speed.pitch * 0.8 - 0.2) * diff;\r\n        isKeyDown = true;\r\n      } // If left arrow or \"a\" is down\r\n\r\n      if (keysDown[4] || keysDown[8]) {\r\n        // Pan left\r\n        config.yaw += (speed.yaw * 0.8 - 0.2) * diff;\r\n        isKeyDown = true;\r\n      } // If right arrow or \"d\" is down\r\n\r\n      if (keysDown[5] || keysDown[9]) {\r\n        // Pan right\r\n        config.yaw += (speed.yaw * 0.8 + 0.2) * diff;\r\n        isKeyDown = true;\r\n      }\r\n\r\n      if (isKeyDown) latestInteraction = Date.now(); // If auto-rotate\r\n\r\n      if (config.autoRotate) {\r\n        // Pan\r\n        if (newTime - prevTime > 0.001) {\r\n          var timeDiff = (newTime - prevTime) / 1000;\r\n          var yawDiff =\r\n            ((speed.yaw / timeDiff) * diff - config.autoRotate * 0.2) *\r\n            timeDiff;\r\n          yawDiff =\r\n            (-config.autoRotate > 0 ? 1 : -1) *\r\n            Math.min(Math.abs(config.autoRotate * timeDiff), Math.abs(yawDiff));\r\n          config.yaw += yawDiff;\r\n        } // Deal with stopping auto rotation after a set delay\r\n\r\n        if (config.autoRotateStopDelay) {\r\n          config.autoRotateStopDelay -= newTime - prevTime;\r\n\r\n          if (config.autoRotateStopDelay <= 0) {\r\n            config.autoRotateStopDelay = false;\r\n            autoRotateSpeed = config.autoRotate;\r\n            config.autoRotate = 0;\r\n          }\r\n        }\r\n      } // Animated moves\r\n\r\n      if (animatedMove.pitch) {\r\n        animateMove(\"pitch\");\r\n        prevPitch = config.pitch;\r\n      }\r\n\r\n      if (animatedMove.yaw) {\r\n        animateMove(\"yaw\");\r\n        prevYaw = config.yaw;\r\n      }\r\n\r\n      if (animatedMove.hfov) {\r\n        animateMove(\"hfov\");\r\n        prevZoom = config.hfov;\r\n      } // \"Inertia\"\r\n\r\n      if (diff > 0 && !config.autoRotate) {\r\n        // \"Friction\"\r\n        var slowDownFactor = 1 - config.friction; // Yaw\r\n\r\n        if (\r\n          !keysDown[4] &&\r\n          !keysDown[5] &&\r\n          !keysDown[8] &&\r\n          !keysDown[9] &&\r\n          !animatedMove.yaw\r\n        ) {\r\n          config.yaw += speed.yaw * diff * slowDownFactor;\r\n        } // Pitch\r\n\r\n        if (\r\n          !keysDown[2] &&\r\n          !keysDown[3] &&\r\n          !keysDown[6] &&\r\n          !keysDown[7] &&\r\n          !animatedMove.pitch\r\n        ) {\r\n          config.pitch += speed.pitch * diff * slowDownFactor;\r\n        } // Zoom\r\n\r\n        if (!keysDown[0] && !keysDown[1] && !animatedMove.hfov) {\r\n          setHfov(config.hfov + speed.hfov * diff * slowDownFactor);\r\n        }\r\n      }\r\n\r\n      prevTime = newTime;\r\n\r\n      if (diff > 0) {\r\n        speed.yaw = speed.yaw * 0.8 + ((config.yaw - prevYaw) / diff) * 0.2;\r\n        speed.pitch =\r\n          speed.pitch * 0.8 + ((config.pitch - prevPitch) / diff) * 0.2;\r\n        speed.hfov = speed.hfov * 0.8 + ((config.hfov - prevZoom) / diff) * 0.2; // Limit speed\r\n\r\n        var maxSpeed = config.autoRotate ? Math.abs(config.autoRotate) : 5;\r\n        speed.yaw = Math.min(maxSpeed, Math.max(speed.yaw, -maxSpeed));\r\n        speed.pitch = Math.min(maxSpeed, Math.max(speed.pitch, -maxSpeed));\r\n        speed.hfov = Math.min(maxSpeed, Math.max(speed.hfov, -maxSpeed));\r\n      } // Stop movement if opposite controls are pressed\r\n\r\n      if (keysDown[0] && keysDown[1]) {\r\n        speed.hfov = 0;\r\n      }\r\n\r\n      if ((keysDown[2] || keysDown[6]) && (keysDown[3] || keysDown[7])) {\r\n        speed.pitch = 0;\r\n      }\r\n\r\n      if ((keysDown[4] || keysDown[8]) && (keysDown[5] || keysDown[9])) {\r\n        speed.yaw = 0;\r\n      }\r\n    }\r\n    /**\r\n     * Animates moves.\r\n     * @param {string} axis - Axis to animate\r\n     * @private\r\n     */\r\n\r\n    function animateMove(axis) {\r\n      var t = animatedMove[axis];\r\n      var normTime = Math.min(\r\n        1,\r\n        Math.max((Date.now() - t.startTime) / 1000 / (t.duration / 1000), 0)\r\n      );\r\n      var result =\r\n        t.startPosition +\r\n        config.animationTimingFunction(normTime) *\r\n          (t.endPosition - t.startPosition);\r\n\r\n      if (\r\n        (t.endPosition > t.startPosition && result >= t.endPosition) ||\r\n        (t.endPosition < t.startPosition && result <= t.endPosition) ||\r\n        t.endPosition === t.startPosition\r\n      ) {\r\n        result = t.endPosition;\r\n        speed[axis] = 0;\r\n        delete animatedMove[axis];\r\n      }\r\n\r\n      config[axis] = result;\r\n    }\r\n    /**\r\n     * @param {number} t - Normalized time in animation\r\n     * @return {number} Position in animation\r\n     * @private\r\n     */\r\n\r\n    function timingFunction(t) {\r\n      // easeInOutQuad from https://gist.github.com/gre/1650294\r\n      return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n    }\r\n    /**\r\n     * Event handler for document resizes. Updates viewer size and rerenders view.\r\n     * @private\r\n     */\r\n\r\n    function onDocumentResize() {\r\n      // Resize panorama renderer (moved to onFullScreenChange)\r\n      //renderer.resize();\r\n      //animateInit();\r\n      // Kludge to deal with WebKit regression: https://bugs.webkit.org/show_bug.cgi?id=93525\r\n      onFullScreenChange(\"resize\");\r\n    }\r\n    /**\r\n     * Initializes animation.\r\n     * @private\r\n     */\r\n\r\n    function animateInit() {\r\n      if (animating) {\r\n        return;\r\n      }\r\n\r\n      animating = true;\r\n      animate();\r\n    }\r\n    /**\r\n     * Animates view, using requestAnimationFrame to trigger rendering.\r\n     * @private\r\n     */\r\n\r\n    function animate() {\r\n      if (destroyed) {\r\n        return;\r\n      }\r\n\r\n      render();\r\n      if (autoRotateStart) clearTimeout(autoRotateStart);\r\n\r\n      if (isUserInteracting || orientation === true) {\r\n        requestAnimationFrame(animate);\r\n      } else if (\r\n        keysDown[0] ||\r\n        keysDown[1] ||\r\n        keysDown[2] ||\r\n        keysDown[3] ||\r\n        keysDown[4] ||\r\n        keysDown[5] ||\r\n        keysDown[6] ||\r\n        keysDown[7] ||\r\n        keysDown[8] ||\r\n        keysDown[9] ||\r\n        config.autoRotate ||\r\n        animatedMove.pitch ||\r\n        animatedMove.yaw ||\r\n        animatedMove.hfov ||\r\n        Math.abs(speed.yaw) > 0.01 ||\r\n        Math.abs(speed.pitch) > 0.01 ||\r\n        Math.abs(speed.hfov) > 0.01\r\n      ) {\r\n        keyRepeat();\r\n\r\n        if (\r\n          config.autoRotateInactivityDelay >= 0 &&\r\n          autoRotateSpeed &&\r\n          Date.now() - latestInteraction > config.autoRotateInactivityDelay &&\r\n          !config.autoRotate\r\n        ) {\r\n          config.autoRotate = autoRotateSpeed;\r\n\r\n          _this.lookAt(origPitch, undefined$1, origHfov, 3000);\r\n        }\r\n\r\n        requestAnimationFrame(animate);\r\n      } else if (\r\n        renderer &&\r\n        (renderer.isLoading() || (config.dynamic === true && update))\r\n      ) {\r\n        requestAnimationFrame(animate);\r\n      } else {\r\n        fireEvent(\"animatefinished\", {\r\n          pitch: _this.getPitch(),\r\n          yaw: _this.getYaw(),\r\n          hfov: _this.getHfov(),\r\n        });\r\n        animating = false;\r\n        prevTime = undefined$1;\r\n        var autoRotateStartTime =\r\n          config.autoRotateInactivityDelay - (Date.now() - latestInteraction);\r\n\r\n        if (autoRotateStartTime > 0) {\r\n          autoRotateStart = setTimeout(function () {\r\n            config.autoRotate = autoRotateSpeed;\r\n\r\n            _this.lookAt(origPitch, undefined$1, origHfov, 3000);\r\n\r\n            animateInit();\r\n          }, autoRotateStartTime);\r\n        } else if (config.autoRotateInactivityDelay >= 0 && autoRotateSpeed) {\r\n          config.autoRotate = autoRotateSpeed;\r\n\r\n          _this.lookAt(origPitch, undefined$1, origHfov, 3000);\r\n\r\n          animateInit();\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Renders panorama view.\r\n     * @private\r\n     */\r\n\r\n    function render() {\r\n      var tmpyaw;\r\n\r\n      if (loaded) {\r\n        var canvas = renderer.getCanvas();\r\n\r\n        if (config.autoRotate !== false) {\r\n          // When auto-rotating this check needs to happen first (see issue #764)\r\n          if (config.yaw > 180) {\r\n            config.yaw -= 360;\r\n          } else if (config.yaw < -180) {\r\n            config.yaw += 360;\r\n          }\r\n        } // Keep a tmp value of yaw for autoRotate comparison later\r\n\r\n        tmpyaw = config.yaw; // Optionally avoid showing background (empty space) on left or right by adapting min/max yaw\r\n\r\n        var hoffcut = 0;\r\n\r\n        if (config.avoidShowingBackground) {\r\n          var hfov2 = config.hfov / 2,\r\n            vfov2 =\r\n              (Math.atan2(\r\n                Math.tan((hfov2 / 180) * Math.PI),\r\n                canvas.width / canvas.height\r\n              ) *\r\n                180) /\r\n              Math.PI,\r\n            transposed = config.vaov > config.haov;\r\n\r\n          if (transposed) {\r\n            vfov2 *\r\n              (1 -\r\n                Math.min(\r\n                  Math.cos(((config.pitch - hfov2) / 180) * Math.PI),\r\n                  Math.cos(((config.pitch + hfov2) / 180) * Math.PI)\r\n                ));\r\n          } else {\r\n            hoffcut =\r\n              hfov2 *\r\n              (1 -\r\n                Math.min(\r\n                  Math.cos(((config.pitch - vfov2) / 180) * Math.PI),\r\n                  Math.cos(((config.pitch + vfov2) / 180) * Math.PI)\r\n                ));\r\n          }\r\n        } // Ensure the yaw is within min and max allowed\r\n\r\n        var yawRange = config.maxYaw - config.minYaw,\r\n          minYaw = -180,\r\n          maxYaw = 180;\r\n\r\n        if (yawRange < 360) {\r\n          minYaw = config.minYaw + config.hfov / 2 + hoffcut;\r\n          maxYaw = config.maxYaw - config.hfov / 2 - hoffcut;\r\n\r\n          if (yawRange < config.hfov) {\r\n            // Lock yaw to average of min and max yaw when both can be seen at once\r\n            minYaw = maxYaw = (minYaw + maxYaw) / 2;\r\n          }\r\n\r\n          config.yaw = Math.max(minYaw, Math.min(maxYaw, config.yaw));\r\n        }\r\n\r\n        if (!(config.autoRotate !== false)) {\r\n          // When not auto-rotating, this check needs to happen after the\r\n          // previous check (see issue #698)\r\n          if (config.yaw > 180) {\r\n            config.yaw -= 360;\r\n          } else if (config.yaw < -180) {\r\n            config.yaw += 360;\r\n          }\r\n        } // Check if we autoRotate in a limited by min and max yaw\r\n        // If so reverse direction\r\n\r\n        if (\r\n          config.autoRotate !== false &&\r\n          tmpyaw != config.yaw &&\r\n          prevTime !== undefined$1\r\n        ) {\r\n          // this condition prevents changing the direction initially\r\n          config.autoRotate *= -1;\r\n        } // Ensure the calculated pitch is within min and max allowed\r\n\r\n        var vfov =\r\n          ((2 *\r\n            Math.atan(\r\n              Math.tan((config.hfov / 180) * Math.PI * 0.5) /\r\n                (canvas.width / canvas.height)\r\n            )) /\r\n            Math.PI) *\r\n          180;\r\n        var minPitch = config.minPitch + vfov / 2,\r\n          maxPitch = config.maxPitch - vfov / 2;\r\n        var pitchRange = config.maxPitch - config.minPitch;\r\n\r\n        if (pitchRange < vfov) {\r\n          // Lock pitch to average of min and max pitch when both can be seen at once\r\n          minPitch = maxPitch = (minPitch + maxPitch) / 2;\r\n        }\r\n\r\n        if (isNaN(minPitch)) minPitch = -90;\r\n        if (isNaN(maxPitch)) maxPitch = 90;\r\n        config.pitch = Math.max(minPitch, Math.min(maxPitch, config.pitch));\r\n        renderer.render(\r\n          (config.pitch * Math.PI) / 180,\r\n          (config.yaw * Math.PI) / 180,\r\n          (config.hfov * Math.PI) / 180,\r\n          {\r\n            roll: (config.roll * Math.PI) / 180,\r\n          }\r\n        );\r\n        renderHotSpots(); // Update compass\r\n\r\n        if (config.compass) {\r\n          compass.style.transform =\r\n            \"rotate(\" + (-config.yaw - config.northOffset) + \"deg)\";\r\n          compass.style.webkitTransform =\r\n            \"rotate(\" + (-config.yaw - config.northOffset) + \"deg)\";\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Creates a new quaternion.\r\n     * @private\r\n     * @constructor\r\n     * @param {Number} w - W value\r\n     * @param {Number} x - X value\r\n     * @param {Number} y - Y value\r\n     * @param {Number} z - Z value\r\n     */\r\n\r\n    function Quaternion(w, x, y, z) {\r\n      this.w = w;\r\n      this.x = x;\r\n      this.y = y;\r\n      this.z = z;\r\n    }\r\n    /**\r\n     * Multiplies quaternions.\r\n     * @private\r\n     * @param {Quaternion} q - Quaternion to multiply\r\n     * @returns {Quaternion} Result of multiplication\r\n     */\r\n\r\n    Quaternion.prototype.multiply = function (q) {\r\n      return new Quaternion(\r\n        this.w * q.w - this.x * q.x - this.y * q.y - this.z * q.z,\r\n        this.x * q.w + this.w * q.x + this.y * q.z - this.z * q.y,\r\n        this.y * q.w + this.w * q.y + this.z * q.x - this.x * q.z,\r\n        this.z * q.w + this.w * q.z + this.x * q.y - this.y * q.x\r\n      );\r\n    };\r\n    /**\r\n     * Converts quaternion to Euler angles.\r\n     * @private\r\n     * @returns {Number[]} [phi angle, theta angle, psi angle]\r\n     */\r\n\r\n    Quaternion.prototype.toEulerAngles = function () {\r\n      var phi = Math.atan2(\r\n          2 * (this.w * this.x + this.y * this.z),\r\n          1 - 2 * (this.x * this.x + this.y * this.y)\r\n        ),\r\n        theta = Math.asin(2 * (this.w * this.y - this.z * this.x)),\r\n        psi = Math.atan2(\r\n          2 * (this.w * this.z + this.x * this.y),\r\n          1 - 2 * (this.y * this.y + this.z * this.z)\r\n        );\r\n      return [phi, theta, psi];\r\n    };\r\n    /**\r\n     * Converts device orientation API Tait-Bryan angles to a quaternion.\r\n     * @private\r\n     * @param {Number} alpha - Alpha angle (in degrees)\r\n     * @param {Number} beta - Beta angle (in degrees)\r\n     * @param {Number} gamma - Gamma angle (in degrees)\r\n     * @returns {Quaternion} Orientation quaternion\r\n     */\r\n\r\n    function taitBryanToQuaternion(alpha, beta, gamma) {\r\n      var r = [\r\n        beta ? (beta * Math.PI) / 180 / 2 : 0,\r\n        gamma ? (gamma * Math.PI) / 180 / 2 : 0,\r\n        alpha ? (alpha * Math.PI) / 180 / 2 : 0,\r\n      ];\r\n      var c = [Math.cos(r[0]), Math.cos(r[1]), Math.cos(r[2])],\r\n        s = [Math.sin(r[0]), Math.sin(r[1]), Math.sin(r[2])];\r\n      return new Quaternion(\r\n        c[0] * c[1] * c[2] - s[0] * s[1] * s[2],\r\n        s[0] * c[1] * c[2] - c[0] * s[1] * s[2],\r\n        c[0] * s[1] * c[2] + s[0] * c[1] * s[2],\r\n        c[0] * c[1] * s[2] + s[0] * s[1] * c[2]\r\n      );\r\n    }\r\n    /**\r\n     * Computes current device orientation quaternion from device orientation API\r\n     * Tait-Bryan angles.\r\n     * @private\r\n     * @param {Number} alpha - Alpha angle (in degrees)\r\n     * @param {Number} beta - Beta angle (in degrees)\r\n     * @param {Number} gamma - Gamma angle (in degrees)\r\n     * @returns {Quaternion} Orientation quaternion\r\n     */\r\n\r\n    function computeQuaternion(alpha, beta, gamma) {\r\n      // Convert Tait-Bryan angles to quaternion\r\n      var quaternion = taitBryanToQuaternion(alpha, beta, gamma); // Apply world transform\r\n\r\n      quaternion = quaternion.multiply(\r\n        new Quaternion(Math.sqrt(0.5), -Math.sqrt(0.5), 0, 0)\r\n      ); // Apply screen transform\r\n\r\n      var angle = window.orientation\r\n        ? (-window.orientation * Math.PI) / 180 / 2\r\n        : 0;\r\n      return quaternion.multiply(\r\n        new Quaternion(Math.cos(angle), 0, -Math.sin(angle), 0)\r\n      );\r\n    }\r\n    /**\r\n     * Event handler for device orientation API. Controls pointing.\r\n     * @private\r\n     * @param {DeviceOrientationEvent} event - Device orientation event.\r\n     */\r\n\r\n    function orientationListener(e) {\r\n      if (e.hasOwnProperty(\"requestPermission\")) e.requestPermission();\r\n      var q = computeQuaternion(e.alpha, e.beta, e.gamma).toEulerAngles();\r\n\r\n      if (typeof orientation === \"number\" && orientation < 10) {\r\n        // This kludge is necessary because iOS sometimes provides a few stale\r\n        // device orientation events when the listener is removed and then\r\n        // readded. Thus, we skip the first 10 events to prevent this from\r\n        // causing problems.\r\n        orientation += 1;\r\n      } else if (orientation === 10) {\r\n        // Record starting yaw to prevent jumping\r\n        orientationYawOffset = (q[2] / Math.PI) * 180 + config.yaw;\r\n        orientation = true;\r\n        requestAnimationFrame(animate);\r\n      } else {\r\n        config.pitch = (q[0] / Math.PI) * 180;\r\n        config.roll = (-q[1] / Math.PI) * 180;\r\n        config.yaw = (-q[2] / Math.PI) * 180 + orientationYawOffset;\r\n      }\r\n    }\r\n    /**\r\n     * Initializes renderer.\r\n     * @private\r\n     */\r\n\r\n    function renderInit() {\r\n      try {\r\n        var params = {};\r\n        if (config.horizonPitch !== undefined$1)\r\n          params.horizonPitch = (config.horizonPitch * Math.PI) / 180;\r\n        if (config.horizonRoll !== undefined$1)\r\n          params.horizonRoll = (config.horizonRoll * Math.PI) / 180;\r\n        if (config.backgroundColor !== undefined$1)\r\n          params.backgroundColor = config.backgroundColor;\r\n        renderer.init(\r\n          panoImage,\r\n          config.type,\r\n          config.dynamic,\r\n          (config.haov * Math.PI) / 180,\r\n          (config.vaov * Math.PI) / 180,\r\n          (config.vOffset * Math.PI) / 180,\r\n          renderInitCallback,\r\n          params\r\n        );\r\n\r\n        if (config.dynamic !== true) {\r\n          // Allow image to be garbage collected\r\n          panoImage = undefined$1;\r\n        }\r\n      } catch (event) {\r\n        // Panorama not loaded\r\n        // Display error if there is a bad texture\r\n        if (event.type === \"webgl error\" || event.type === \"no webgl\") {\r\n          anError();\r\n        } else if (event.type === \"webgl size error\") {\r\n          anError(\r\n            config.uiText.textureSizeError\r\n              .replace(\"%s\", event.width)\r\n              .replace(\"%s\", event.maxWidth)\r\n          );\r\n        } else {\r\n          anError(config.uiText.unknownError);\r\n          throw event;\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Triggered when render initialization finishes. Handles fading between\r\n     * scenes as well as showing the compass and hotspots and hiding the loading\r\n     * display.\r\n     * @private\r\n     */\r\n\r\n    function renderInitCallback() {\r\n      // Fade if specified\r\n      if (config.sceneFadeDuration && renderer.fadeImg !== undefined$1) {\r\n        renderer.fadeImg.style.opacity = 0; // Remove image\r\n\r\n        var fadeImg = renderer.fadeImg;\r\n        delete renderer.fadeImg;\r\n        setTimeout(function () {\r\n          renderContainer.removeChild(fadeImg);\r\n          fireEvent(\"scenechangefadedone\");\r\n        }, config.sceneFadeDuration);\r\n      } // Show compass if applicable\r\n\r\n      if (config.compass) {\r\n        compass.style.display = \"inline\";\r\n      } else {\r\n        compass.style.display = \"none\";\r\n      } // Show hotspots\r\n\r\n      createHotSpots(); // Hide loading display\r\n\r\n      infoDisplay.load.box.style.display = \"none\";\r\n\r\n      if (preview !== undefined$1) {\r\n        renderContainer.removeChild(preview);\r\n        preview = undefined$1;\r\n      }\r\n\r\n      loaded = true;\r\n      animateInit();\r\n      fireEvent(\"load\");\r\n    }\r\n    /**\r\n     * Creates hot spot element for the current scene.\r\n     * @private\r\n     * @param {Object} hs - The configuration for the hotspot\r\n     */\r\n\r\n    function createHotSpot(hs) {\r\n      // Make sure hot spot pitch and yaw are numbers\r\n      hs.pitch = Number(hs.pitch) || 0;\r\n      hs.yaw = Number(hs.yaw) || 0;\r\n      var div = document.createElement(\"div\");\r\n      div.className = \"pnlm-hotspot-base\";\r\n      if (hs.cssClass) div.className += \" \" + hs.cssClass;\r\n      else\r\n        div.className +=\r\n          \" pnlm-hotspot pnlm-sprite pnlm-\" + escapeHTML(hs.type);\r\n      var span = document.createElement(\"span\");\r\n      if (hs.text) span.innerHTML = escapeHTML(hs.text);\r\n      var a;\r\n\r\n      if (hs.video) {\r\n        var video = document.createElement(\"video\"),\r\n          vidp = hs.video;\r\n        if (config.basePath && !absoluteURL(vidp))\r\n          vidp = config.basePath + vidp;\r\n        video.src = sanitizeURL(vidp);\r\n        video.controls = true;\r\n        video.style.width = hs.width + \"px\";\r\n        renderContainer.appendChild(div);\r\n        span.appendChild(video);\r\n      } else if (hs.image) {\r\n        var imgp = hs.image;\r\n        if (config.basePath && !absoluteURL(imgp))\r\n          imgp = config.basePath + imgp;\r\n        a = document.createElement(\"a\");\r\n        a.href = sanitizeURL(hs.URL ? hs.URL : imgp);\r\n        a.target = \"_blank\";\r\n        span.appendChild(a);\r\n        var image = document.createElement(\"img\");\r\n        image.src = sanitizeURL(imgp);\r\n        image.style.width = hs.width + \"px\";\r\n        image.style.paddingTop = \"5px\";\r\n        renderContainer.appendChild(div);\r\n        a.appendChild(image);\r\n        span.style.maxWidth = \"initial\";\r\n      } else if (hs.URL) {\r\n        a = document.createElement(\"a\");\r\n        a.href = sanitizeURL(hs.URL);\r\n\r\n        if (hs.attributes) {\r\n          for (var key in hs.attributes) {\r\n            a.setAttribute(key, hs.attributes[key]);\r\n          }\r\n        } else {\r\n          a.target = \"_blank\";\r\n        }\r\n\r\n        renderContainer.appendChild(a);\r\n        div.className += \" pnlm-pointer\";\r\n        span.className += \" pnlm-pointer\";\r\n        a.appendChild(div);\r\n      } else {\r\n        if (hs.sceneId) {\r\n          div.onclick = div.ontouchend = function () {\r\n            if (!div.clicked) {\r\n              div.clicked = true;\r\n              dLastPitch = hs.pitch;\r\n              dLastYaw = hs.yaw;\r\n              dLastHfov = _this.getHfov();\r\n              setTimeout(function () {\r\n                lookAndWait(_this.getHfov(), dTimeLookAtHotSpot);\r\n              }, 10); //--- first look directly at the hotspot\r\n              lookAndWait(50, dTimeZoomInHotSpot); //--- then zoom in\r\n              setTimeout(function () {\r\n                _this.loadScene(hs.sceneId, dLastPitch, dLastYaw, 120);\r\n              }, dTimeToLoad); // then load the new scene\r\n              // loadScene(\r\n              //   hs.sceneId,\r\n              //   hs.targetPitch,\r\n              //   hs.targetYaw,\r\n              //   hs.targetHfov\r\n              // );\r\n            }\r\n\r\n            return false;\r\n          };\r\n\r\n          div.className += \" pnlm-pointer\";\r\n          span.className += \" pnlm-pointer\";\r\n        }\r\n\r\n        renderContainer.appendChild(div);\r\n      }\r\n\r\n      if (hs.createTooltipFunc) {\r\n        hs.createTooltipFunc(div, hs.createTooltipArgs);\r\n      } else if (hs.text || hs.video || hs.image) {\r\n        div.classList.add(\"pnlm-tooltip\");\r\n        div.appendChild(span);\r\n        span.style.wordBreak = \"break-word\";\r\n        span.style.width = span.scrollWidth - 20 + \"px\";\r\n        span.style.marginLeft =\r\n          -(span.scrollWidth - div.offsetWidth) / 2 + \"px\";\r\n        span.style.marginTop = -span.scrollHeight - 12 + \"px\";\r\n      }\r\n\r\n      if (hs.clickHandlerFunc) {\r\n        div.addEventListener(\r\n          \"click\",\r\n          function (e) {\r\n            hs.clickHandlerFunc(e, hs.clickHandlerArgs);\r\n          },\r\n          \"false\"\r\n        );\r\n        div.className += \" pnlm-pointer\";\r\n        span.className += \" pnlm-pointer\";\r\n      }\r\n\r\n      hs.div = div;\r\n    }\r\n\r\n    function lookAndWait(dHfov, dTime) {\r\n      // Initiate LookAt / Zoom\r\n      var pZ = dLastPitch; // Or other pan angle to Zoom in on.\r\n      var yZ = dLastYaw; // Or other yaw angle to Zoom in on.\r\n      var vZ = dHfov; // Or other Hfov angle to Zoom in on.\r\n      var pS = dTime; // Or other zoom speed\r\n      _this.lookAt(pZ, yZ, vZ, pS);\r\n      setTimeout(function () {\r\n        waitForView(dLastPitch, dLastYaw, vZ);\r\n      }, 1000);\r\n    }\r\n\r\n    function waitForView(dPitch, dYaw, dHfov) {\r\n      var iCnt = 0;\r\n      let pI = Math.round(_this.getPitch()); // get actual pitch and round\r\n      let yI = Math.round(_this.getYaw()); // get actual yaw and round\r\n      let vI = Math.round(_this.getHfov()); // get actual Hfov and round\r\n\r\n      if (yI > 180) {\r\n        yI = yI - 360;\r\n        _this.setYaw(yI, 0);\r\n      }\r\n      if (yI < -180) {\r\n        yI = yI + 360;\r\n        _this.setYaw(yI, 0);\r\n      }\r\n\r\n      if (pI === dPitch && yI === dYaw && vI === dHfov) {\r\n        // Has LookAt finished\r\n        return true;\r\n      } else {\r\n        setTimeout(function () {\r\n          waitForView(dPitch, dYaw, dHfov);\r\n        }, 10);\r\n      }\r\n    }\r\n\r\n    function sceneLoadListener() {\r\n      //--- zoom a little bit into current viewing direction\r\n      lookAndWait(110, dTimeZoomInAfterLoad);\r\n    }\r\n    /**\r\n     * Creates hot spot elements for the current scene.\r\n     * @private\r\n     */\r\n\r\n    function createHotSpots() {\r\n      if (hotspotsCreated) return;\r\n\r\n      if (!config.hotSpots) {\r\n        config.hotSpots = [];\r\n      } else {\r\n        // Sort by pitch so tooltip is never obscured by another hot spot\r\n        config.hotSpots = config.hotSpots.sort(function (a, b) {\r\n          return a.pitch < b.pitch;\r\n        });\r\n        config.hotSpots.forEach(createHotSpot);\r\n      }\r\n\r\n      hotspotsCreated = true;\r\n      renderHotSpots();\r\n    }\r\n    /**\r\n     * Destroys currently created hot spot elements.\r\n     * @private\r\n     */\r\n\r\n    function destroyHotSpots() {\r\n      var hs = config.hotSpots;\r\n      hotspotsCreated = false;\r\n      delete config.hotSpots;\r\n\r\n      if (hs) {\r\n        for (var i = 0; i < hs.length; i++) {\r\n          var current = hs[i].div;\r\n\r\n          if (current) {\r\n            while (\r\n              current.parentNode &&\r\n              current.parentNode != renderContainer\r\n            ) {\r\n              current = current.parentNode;\r\n            }\r\n\r\n            renderContainer.removeChild(current);\r\n          }\r\n\r\n          delete hs[i].div;\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Renders hot spot, updating its position and visibility.\r\n     * @private\r\n     */\r\n\r\n    function renderHotSpot(hs) {\r\n      var hsPitchSin = Math.sin((hs.pitch * Math.PI) / 180),\r\n        hsPitchCos = Math.cos((hs.pitch * Math.PI) / 180),\r\n        configPitchSin = Math.sin((config.pitch * Math.PI) / 180),\r\n        configPitchCos = Math.cos((config.pitch * Math.PI) / 180),\r\n        yawCos = Math.cos(((-hs.yaw + config.yaw) * Math.PI) / 180);\r\n      var z =\r\n        hsPitchSin * configPitchSin + hsPitchCos * yawCos * configPitchCos;\r\n\r\n      if (\r\n        (hs.yaw <= 90 && hs.yaw > -90 && z <= 0) ||\r\n        ((hs.yaw > 90 || hs.yaw <= -90) && z <= 0)\r\n      ) {\r\n        hs.div.style.visibility = \"hidden\";\r\n      } else {\r\n        var yawSin = Math.sin(((-hs.yaw + config.yaw) * Math.PI) / 180),\r\n          hfovTan = Math.tan((config.hfov * Math.PI) / 360);\r\n        hs.div.style.visibility = \"visible\"; // Subpixel rendering doesn't work in Firefox\r\n        // https://bugzilla.mozilla.org/show_bug.cgi?id=739176\r\n\r\n        var canvas = renderer.getCanvas(),\r\n          canvasWidth = canvas.clientWidth,\r\n          canvasHeight = canvas.clientHeight;\r\n        var coord = [\r\n          ((-canvasWidth / hfovTan) * yawSin * hsPitchCos) / z / 2,\r\n          ((-canvasWidth / hfovTan) *\r\n            (hsPitchSin * configPitchCos -\r\n              hsPitchCos * yawCos * configPitchSin)) /\r\n            z /\r\n            2,\r\n        ]; // Apply roll\r\n\r\n        var rollSin = Math.sin((config.roll * Math.PI) / 180),\r\n          rollCos = Math.cos((config.roll * Math.PI) / 180);\r\n        coord = [\r\n          coord[0] * rollCos - coord[1] * rollSin,\r\n          coord[0] * rollSin + coord[1] * rollCos,\r\n        ]; // Apply transform\r\n\r\n        coord[0] += (canvasWidth - hs.div.offsetWidth) / 2;\r\n        coord[1] += (canvasHeight - hs.div.offsetHeight) / 2;\r\n        var transform =\r\n          \"translate(\" +\r\n          coord[0] +\r\n          \"px, \" +\r\n          coord[1] +\r\n          \"px) translateZ(9999px) rotate(\" +\r\n          config.roll +\r\n          \"deg)\";\r\n\r\n        if (hs.scale) {\r\n          transform += \" scale(\" + origHfov / config.hfov / z + \")\";\r\n        }\r\n\r\n        hs.div.style.webkitTransform = transform;\r\n        hs.div.style.MozTransform = transform;\r\n        hs.div.style.transform = transform;\r\n      }\r\n    }\r\n    /**\r\n     * Renders hot spots, updating their positions and visibility.\r\n     * @private\r\n     */\r\n\r\n    function renderHotSpots() {\r\n      config.hotSpots.forEach(renderHotSpot);\r\n    }\r\n    /**\r\n     * Merges a scene configuration into the current configuration.\r\n     * @private\r\n     * @param {string} sceneId - Identifier of scene configuration to merge in.\r\n     */\r\n\r\n    function mergeConfig(sceneId) {\r\n      config = {};\r\n      var k, s;\r\n      var photoSphereExcludes = [\r\n        \"haov\",\r\n        \"vaov\",\r\n        \"vOffset\",\r\n        \"northOffset\",\r\n        \"horizonPitch\",\r\n        \"horizonRoll\",\r\n      ];\r\n      specifiedPhotoSphereExcludes = []; // Merge default config\r\n\r\n      for (k in defaultConfig) {\r\n        if (defaultConfig.hasOwnProperty(k)) {\r\n          config[k] = defaultConfig[k];\r\n        }\r\n      } // Merge default scene config\r\n\r\n      for (k in initialConfig[\"default\"]) {\r\n        if (initialConfig[\"default\"].hasOwnProperty(k)) {\r\n          if (k === \"uiText\") {\r\n            for (s in initialConfig[\"default\"].uiText) {\r\n              if (initialConfig[\"default\"].uiText.hasOwnProperty(s)) {\r\n                config.uiText[s] = escapeHTML(\r\n                  initialConfig[\"default\"].uiText[s]\r\n                );\r\n              }\r\n            }\r\n          } else {\r\n            config[k] = initialConfig[\"default\"][k];\r\n\r\n            if (photoSphereExcludes.indexOf(k) >= 0) {\r\n              specifiedPhotoSphereExcludes.push(k);\r\n            }\r\n          }\r\n        }\r\n      } // Merge current scene config\r\n\r\n      if (\r\n        sceneId !== null &&\r\n        sceneId !== \"\" &&\r\n        initialConfig.scenes &&\r\n        initialConfig.scenes[sceneId]\r\n      ) {\r\n        var scene = initialConfig.scenes[sceneId];\r\n\r\n        for (k in scene) {\r\n          if (scene.hasOwnProperty(k)) {\r\n            if (k === \"uiText\") {\r\n              for (s in scene.uiText) {\r\n                if (scene.uiText.hasOwnProperty(s)) {\r\n                  config.uiText[s] = escapeHTML(scene.uiText[s]);\r\n                }\r\n              }\r\n            } else {\r\n              config[k] = scene[k];\r\n\r\n              if (photoSphereExcludes.indexOf(k) >= 0) {\r\n                specifiedPhotoSphereExcludes.push(k);\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        config.scene = sceneId;\r\n      } // Merge initial config\r\n\r\n      for (k in initialConfig) {\r\n        if (initialConfig.hasOwnProperty(k)) {\r\n          if (k === \"uiText\") {\r\n            for (s in initialConfig.uiText) {\r\n              if (initialConfig.uiText.hasOwnProperty(s)) {\r\n                config.uiText[s] = escapeHTML(initialConfig.uiText[s]);\r\n              }\r\n            }\r\n          } else {\r\n            config[k] = initialConfig[k];\r\n\r\n            if (photoSphereExcludes.indexOf(k) >= 0) {\r\n              specifiedPhotoSphereExcludes.push(k);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Processes configuration options.\r\n     * @param {boolean} [isPreview] - Whether or not the preview is being displayed\r\n     * @private\r\n     */\r\n\r\n    function processOptions(isPreview) {\r\n      isPreview = isPreview ? isPreview : false; // Process preview first so it always loads before the browser hits its\r\n      // maximum number of connections to a server as can happen with cubic\r\n      // panoramas\r\n\r\n      if (isPreview && \"preview\" in config) {\r\n        var p = config.preview;\r\n        if (config.basePath && !absoluteURL(p)) p = config.basePath + p;\r\n        preview = document.createElement(\"div\");\r\n        preview.className = \"pnlm-preview-img\";\r\n        preview.style.backgroundImage = \"url('\" + sanitizeURLForCss(p) + \"')\";\r\n        renderContainer.appendChild(preview);\r\n      } // Handle different preview values\r\n\r\n      var title = config.title,\r\n        author = config.author,\r\n        description = config.description;\r\n\r\n      if (isPreview) {\r\n        if (\"previewTitle\" in config) config.title = config.previewTitle;\r\n        if (\"previewDescription\" in config)\r\n          config.description = config.previewDescription;\r\n        if (\"previewAuthor\" in config) config.author = config.previewAuthor;\r\n      } // Reset title / author display\r\n\r\n      if (!config.hasOwnProperty(\"title\")) infoDisplay.title.innerHTML = \"\";\r\n      if (!config.hasOwnProperty(\"description\"))\r\n        infoDisplay.description.innerHTML = \"\";\r\n      if (!config.hasOwnProperty(\"author\")) infoDisplay.author.innerHTML = \"\";\r\n      if (\r\n        !config.hasOwnProperty(\"title\") &&\r\n        !config.hasOwnProperty(\"description\") &&\r\n        !config.hasOwnProperty(\"author\")\r\n      )\r\n        infoDisplay.container.style.display = \"none\"; // Fill in load button label and loading box text\r\n\r\n      controls.load.innerHTML = \"<p>\" + config.uiText.loadButtonLabel + \"</p>\";\r\n      infoDisplay.load.boxp.innerHTML = config.uiText.loadingLabel; // Process other options\r\n\r\n      for (var key in config) {\r\n        if (config.hasOwnProperty(key)) {\r\n          switch (key) {\r\n            case \"title\":\r\n              infoDisplay.title.innerHTML = escapeHTML(config[key]);\r\n              infoDisplay.container.style.display = \"inline\";\r\n              break;\r\n\r\n            case \"description\":\r\n              infoDisplay.description.innerHTML = escapeHTML(config[key]);\r\n              infoDisplay.container.style.display = \"inline\";\r\n              break;\r\n\r\n            case \"author\":\r\n              var authorText = escapeHTML(config[key]);\r\n\r\n              if (config.authorURL) {\r\n                var authorLink = document.createElement(\"a\");\r\n                authorLink.href = sanitizeURL(config[\"authorURL\"]);\r\n                authorLink.target = \"_blank\";\r\n                authorLink.innerHTML = escapeHTML(config[key]);\r\n                authorText = authorLink.outerHTML;\r\n              }\r\n\r\n              infoDisplay.author.innerHTML = config.uiText.bylineLabel.replace(\r\n                \"%s\",\r\n                authorText\r\n              );\r\n              infoDisplay.container.style.display = \"inline\";\r\n              break;\r\n\r\n            case \"fallback\":\r\n              var link = document.createElement(\"a\");\r\n              link.href = sanitizeURL(config[key]);\r\n              link.target = \"_blank\";\r\n              link.textContent =\r\n                \"Click here to view this panorama in an alternative viewer.\";\r\n              var message = document.createElement(\"p\");\r\n              message.textContent = \"Your browser does not support WebGL.\";\r\n              message.appendChild(document.createElement(\"br\"));\r\n              message.appendChild(link);\r\n              infoDisplay.errorMsg.innerHTML = \"\"; // Removes all children nodes\r\n\r\n              infoDisplay.errorMsg.appendChild(message);\r\n              break;\r\n\r\n            case \"hfov\":\r\n              setHfov(Number(config[key]));\r\n              break;\r\n\r\n            case \"autoLoad\":\r\n              if (config[key] === true && renderer === undefined$1) {\r\n                // Show loading box\r\n                infoDisplay.load.box.style.display = \"inline\"; // Hide load button\r\n\r\n                controls.load.style.display = \"none\"; // Initialize\r\n\r\n                init();\r\n              }\r\n\r\n              break;\r\n\r\n            case \"showZoomCtrl\":\r\n              if (config[key] && config.showControls != false) {\r\n                // Show zoom controls\r\n                controls.zoom.style.display = \"block\";\r\n              } else {\r\n                // Hide zoom controls\r\n                controls.zoom.style.display = \"none\";\r\n              }\r\n\r\n              break;\r\n\r\n            case \"showFullscreenCtrl\":\r\n              if (\r\n                config[key] &&\r\n                config.showControls != false &&\r\n                (\"fullscreen\" in document ||\r\n                  \"mozFullScreen\" in document ||\r\n                  \"webkitIsFullScreen\" in document ||\r\n                  \"msFullscreenElement\" in document)\r\n              ) {\r\n                // Show fullscreen control\r\n                controls.fullscreen.style.display = \"block\";\r\n              } else {\r\n                // Hide fullscreen control\r\n                controls.fullscreen.style.display = \"none\";\r\n              }\r\n\r\n              break;\r\n\r\n            case \"hotSpotDebug\":\r\n              if (config[key]) hotSpotDebugIndicator.style.display = \"block\";\r\n              else hotSpotDebugIndicator.style.display = \"none\";\r\n              break;\r\n\r\n            case \"showControls\":\r\n              if (!config[key]) {\r\n                controls.orientation.style.display = \"none\";\r\n                controls.zoom.style.display = \"none\";\r\n                controls.fullscreen.style.display = \"none\";\r\n              }\r\n\r\n              break;\r\n\r\n            case \"orientationOnByDefault\":\r\n              if (config[key]) {\r\n                startOrientation();\r\n                break;\r\n              }\r\n          }\r\n        }\r\n      }\r\n\r\n      if (isPreview) {\r\n        // Restore original values if changed for preview\r\n        if (title) config.title = title;\r\n        else delete config.title;\r\n        if (description) config.description = description;\r\n        else delete config.description;\r\n        if (author) config.author = author;\r\n        else delete config.author;\r\n      }\r\n    }\r\n    /**\r\n     * Toggles fullscreen mode.\r\n     * @private\r\n     */\r\n\r\n    function toggleFullscreen() {\r\n      if (loaded && !error) {\r\n        if (!fullscreenActive) {\r\n          try {\r\n            if (container.requestFullscreen) {\r\n              container.requestFullscreen();\r\n            } else if (container.mozRequestFullScreen) {\r\n              container.mozRequestFullScreen();\r\n            } else if (container.msRequestFullscreen) {\r\n              container.msRequestFullscreen();\r\n            } else {\r\n              container.webkitRequestFullScreen();\r\n            }\r\n          } catch (event) {\r\n            // Fullscreen doesn't work\r\n          }\r\n        } else {\r\n          if (document.exitFullscreen) {\r\n            document.exitFullscreen();\r\n          } else if (document.mozCancelFullScreen) {\r\n            document.mozCancelFullScreen();\r\n          } else if (document.webkitCancelFullScreen) {\r\n            document.webkitCancelFullScreen();\r\n          } else if (document.msExitFullscreen) {\r\n            document.msExitFullscreen();\r\n          }\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Event handler for fullscreen changes.\r\n     * @private\r\n     */\r\n\r\n    function onFullScreenChange(resize) {\r\n      if (\r\n        document.fullscreenElement ||\r\n        document.fullscreen ||\r\n        document.mozFullScreen ||\r\n        document.webkitIsFullScreen ||\r\n        document.msFullscreenElement\r\n      ) {\r\n        controls.fullscreen.classList.add(\r\n          \"pnlm-fullscreen-toggle-button-active\"\r\n        );\r\n        fullscreenActive = true;\r\n      } else {\r\n        controls.fullscreen.classList.remove(\r\n          \"pnlm-fullscreen-toggle-button-active\"\r\n        );\r\n        fullscreenActive = false;\r\n      }\r\n\r\n      if (resize !== \"resize\") fireEvent(\"fullscreenchange\", fullscreenActive); // Resize renderer (deal with browser quirks and fixes #155)\r\n\r\n      renderer.resize();\r\n      setHfov(config.hfov);\r\n      animateInit();\r\n    }\r\n    /**\r\n     * Increases panorama zoom. For use with zoom button.\r\n     * @private\r\n     */\r\n\r\n    function zoomIn() {\r\n      if (loaded) {\r\n        setHfov(config.hfov - 5);\r\n        animateInit();\r\n      }\r\n    }\r\n    /**\r\n     * Decreases panorama zoom. For use with zoom button.\r\n     * @private\r\n     */\r\n\r\n    function zoomOut() {\r\n      if (loaded) {\r\n        setHfov(config.hfov + 5);\r\n        animateInit();\r\n      }\r\n    }\r\n    /**\r\n     * Clamps horzontal field of view to viewer's limits.\r\n     * @private\r\n     * @param {number} hfov - Input horizontal field of view (in degrees)\r\n     * @return {number} - Clamped horizontal field of view (in degrees)\r\n     */\r\n\r\n    function constrainHfov(hfov) {\r\n      // Keep field of view within bounds\r\n      var minHfov = config.minHfov;\r\n\r\n      if (config.type === \"multires\" && renderer && !config.multiResMinHfov) {\r\n        minHfov = Math.min(\r\n          minHfov,\r\n          renderer.getCanvas().width /\r\n            ((config.multiRes.cubeResolution / 90) * 0.9)\r\n        );\r\n      }\r\n\r\n      if (minHfov > config.maxHfov) {\r\n        // Don't change view if bounds don't make sense\r\n        console.log(\"HFOV bounds do not make sense (minHfov > maxHfov).\");\r\n        return config.hfov;\r\n      }\r\n\r\n      var newHfov = config.hfov;\r\n\r\n      if (hfov < minHfov) {\r\n        newHfov = minHfov;\r\n      } else if (hfov > config.maxHfov) {\r\n        newHfov = config.maxHfov;\r\n      } else {\r\n        newHfov = hfov;\r\n      } // Optionally avoid showing background (empty space) on top or bottom by adapting newHfov\r\n\r\n      if (config.avoidShowingBackground && renderer) {\r\n        var canvas = renderer.getCanvas();\r\n        newHfov = Math.min(\r\n          newHfov,\r\n          (Math.atan(\r\n            (Math.tan(((config.maxPitch - config.minPitch) / 360) * Math.PI) /\r\n              canvas.height) *\r\n              canvas.width\r\n          ) *\r\n            360) /\r\n            Math.PI\r\n        );\r\n      }\r\n\r\n      return newHfov;\r\n    }\r\n    /**\r\n     * Sets viewer's horizontal field of view.\r\n     * @private\r\n     * @param {number} hfov - Desired horizontal field of view in degrees.\r\n     */\r\n\r\n    function setHfov(hfov) {\r\n      config.hfov = constrainHfov(hfov);\r\n      fireEvent(\"zoomchange\", config.hfov);\r\n    }\r\n    /**\r\n     * Stops auto rotation and animated moves.\r\n     * @private\r\n     */\r\n\r\n    function stopAnimation() {\r\n      animatedMove = {};\r\n      autoRotateSpeed = config.autoRotate ? config.autoRotate : autoRotateSpeed;\r\n      config.autoRotate = false;\r\n    }\r\n    /**\r\n     * Loads panorama.\r\n     * @private\r\n     */\r\n\r\n    function load() {\r\n      // Since WebGL error handling is very general, first we clear any error box\r\n      // since it is a new scene and the error from previous maybe because of lacking\r\n      // memory etc and not because of a lack of WebGL support etc\r\n      clearError();\r\n      loaded = false;\r\n      controls.load.style.display = \"none\";\r\n      infoDisplay.load.box.style.display = \"inline\";\r\n      init();\r\n    }\r\n    /**\r\n     * Loads scene.\r\n     * @private\r\n     * @param {string} sceneId - Identifier of scene configuration to merge in.\r\n     * @param {number} targetPitch - Pitch viewer should be centered on once scene loads.\r\n     * @param {number} targetYaw - Yaw viewer should be centered on once scene loads.\r\n     * @param {number} targetHfov - HFOV viewer should use once scene loads.\r\n     * @param {boolean} [fadeDone] - If `true`, fade setup is skipped.\r\n     */\r\n\r\n    function loadScene(sceneId, targetPitch, targetYaw, targetHfov, fadeDone) {\r\n      if (!loaded) fadeDone = true; // Don't try to fade when there isn't a scene loaded\r\n\r\n      loaded = false;\r\n      animatedMove = {}; // Set up fade if specified\r\n\r\n      var fadeImg, workingPitch, workingYaw, workingHfov;\r\n\r\n      if (config.sceneFadeDuration && !fadeDone) {\r\n        var data = renderer.render(\r\n          (config.pitch * Math.PI) / 180,\r\n          (config.yaw * Math.PI) / 180,\r\n          (config.hfov * Math.PI) / 180,\r\n          {\r\n            returnImage: true,\r\n          }\r\n        );\r\n\r\n        if (data !== undefined$1) {\r\n          fadeImg = new Image();\r\n          fadeImg.className = \"pnlm-fade-img\";\r\n          fadeImg.style.transition =\r\n            \"opacity \" + config.sceneFadeDuration / 1000 + \"s\";\r\n          fadeImg.style.width = \"100%\";\r\n          fadeImg.style.height = \"100%\";\r\n\r\n          fadeImg.onload = function () {\r\n            loadScene(sceneId, targetPitch, targetYaw, targetHfov, true);\r\n          };\r\n\r\n          fadeImg.src = data;\r\n          renderContainer.appendChild(fadeImg);\r\n          renderer.fadeImg = fadeImg;\r\n          return;\r\n        }\r\n      } // Set new pointing\r\n\r\n      if (targetPitch === \"same\") {\r\n        workingPitch = config.pitch;\r\n      } else {\r\n        workingPitch = targetPitch;\r\n      }\r\n\r\n      if (targetYaw === \"same\") {\r\n        workingYaw = config.yaw;\r\n      } else if (targetYaw === \"sameAzimuth\") {\r\n        workingYaw =\r\n          config.yaw +\r\n          (config.northOffset || 0) -\r\n          (initialConfig.scenes[sceneId].northOffset || 0);\r\n      } else {\r\n        workingYaw = targetYaw;\r\n      }\r\n\r\n      if (targetHfov === \"same\") {\r\n        workingHfov = config.hfov;\r\n      } else {\r\n        workingHfov = targetHfov;\r\n      } // Destroy hot spots from previous scene\r\n\r\n      destroyHotSpots(); // Create the new config for the scene\r\n\r\n      mergeConfig(sceneId); // Stop motion\r\n\r\n      speed.yaw = speed.pitch = speed.hfov = 0; // Reload scene\r\n\r\n      processOptions();\r\n\r\n      if (workingPitch !== undefined$1) {\r\n        config.pitch = workingPitch;\r\n      }\r\n\r\n      if (workingYaw !== undefined$1) {\r\n        config.yaw = workingYaw;\r\n      }\r\n\r\n      if (workingHfov !== undefined$1) {\r\n        config.hfov = workingHfov;\r\n      }\r\n\r\n      fireEvent(\"scenechange\", sceneId);\r\n      load();\r\n    }\r\n    /**\r\n     * Stop using device orientation.\r\n     * @private\r\n     */\r\n\r\n    function stopOrientation() {\r\n      window.removeEventListener(\"deviceorientation\", orientationListener);\r\n      controls.orientation.classList.remove(\"pnlm-orientation-button-active\");\r\n      orientation = false;\r\n    }\r\n    /**\r\n     * Start using device orientation.\r\n     * @private\r\n     */\r\n\r\n    function startOrientation() {\r\n      orientation = 1; // Fix for IOS 13 where the user needs to perform an action i.e click. Then we need to ask permission\r\n\r\n      if (\r\n        DeviceOrientationEvent &&\r\n        typeof DeviceOrientationEvent.requestPermission === \"function\"\r\n      ) {\r\n        DeviceOrientationEvent.requestPermission()\r\n          .then(function (response) {\r\n            if (response === \"granted\") {\r\n              window.addEventListener(\"deviceorientation\", orientationListener);\r\n            }\r\n          })\r\n          [\"catch\"](console.error);\r\n      } else {\r\n        window.addEventListener(\"deviceorientation\", orientationListener);\r\n      } // window.addEventListener('deviceorientation', orientationListener);\r\n\r\n      controls.orientation.classList.add(\"pnlm-orientation-button-active\");\r\n    }\r\n    /**\r\n     * Escapes HTML string (to mitigate possible DOM XSS attacks).\r\n     * @private\r\n     * @param {string} s - String to escape\r\n     * @returns {string} Escaped string\r\n     */\r\n\r\n    function escapeHTML(s) {\r\n      if (!initialConfig.escapeHTML) return String(s).split(\"\\n\").join(\"<br>\");\r\n      return String(s)\r\n        .split(/&/g)\r\n        .join(\"&amp;\")\r\n        .split('\"')\r\n        .join(\"&quot;\")\r\n        .split(\"'\")\r\n        .join(\"&#39;\")\r\n        .split(\"<\")\r\n        .join(\"&lt;\")\r\n        .split(\">\")\r\n        .join(\"&gt;\")\r\n        .split(\"/\")\r\n        .join(\"&#x2f;\")\r\n        .split(\"\\n\")\r\n        .join(\"<br>\"); // Allow line breaks\r\n    }\r\n    /**\r\n     * Removes possibility of XSS attacks with URLs.\r\n     * The URL cannot be of protocol 'javascript'.\r\n     * @private\r\n     * @param {string} url - URL to sanitize\r\n     * @returns {string} Sanitized URL\r\n     */\r\n\r\n    function sanitizeURL(url) {\r\n      if (url.trim().toLowerCase().indexOf(\"javascript:\") === 0) {\r\n        return \"about:blank\";\r\n      }\r\n\r\n      return url;\r\n    }\r\n    /**\r\n     * Removes possibility of XSS atacks with URLs for CSS.\r\n     * The URL will be sanitized with `sanitizeURL()` and single quotes\r\n     * and double quotes escaped.\r\n     * @private\r\n     * @param {string} url - URL to sanitize\r\n     * @returns {string} Sanitized URL\r\n     */\r\n\r\n    function sanitizeURLForCss(url) {\r\n      return sanitizeURL(url).replace(/\"/g, \"%22\").replace(/'/g, \"%27\");\r\n    }\r\n    /**\r\n     * Checks whether or not a panorama is loaded.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {boolean} `true` if a panorama is loaded, else `false`\r\n     */\r\n\r\n    this.isLoaded = function () {\r\n      return Boolean(loaded);\r\n    };\r\n    /**\r\n     * Returns the pitch of the center of the view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} Pitch in degrees\r\n     */\r\n\r\n    this.getPitch = function () {\r\n      return config.pitch;\r\n    };\r\n    /**\r\n     * Sets the pitch of the center of the view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} pitch - Pitch in degrees\r\n     * @param {boolean|number} [animated=1000] - Animation duration in milliseconds or false for no animation\r\n     * @param {function} [callback] - Function to call when animation finishes\r\n     * @param {object} [callbackArgs] - Arguments to pass to callback function\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.setPitch = function (pitch, animated, callback, callbackArgs) {\r\n      latestInteraction = Date.now();\r\n\r\n      if (Math.abs(pitch - config.pitch) <= eps) {\r\n        if (typeof callback === \"function\") callback(callbackArgs);\r\n        return this;\r\n      }\r\n\r\n      animated = animated === undefined$1 ? 1000 : Number(animated);\r\n\r\n      if (animated) {\r\n        animatedMove.pitch = {\r\n          startTime: Date.now(),\r\n          startPosition: config.pitch,\r\n          endPosition: pitch,\r\n          duration: animated,\r\n        };\r\n        if (typeof callback === \"function\")\r\n          setTimeout(function () {\r\n            callback(callbackArgs);\r\n          }, animated);\r\n      } else {\r\n        config.pitch = pitch;\r\n      }\r\n\r\n      animateInit();\r\n      return this;\r\n    };\r\n    /**\r\n     * Returns the minimum and maximum allowed pitches (in degrees).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number[]} [minimum pitch, maximum pitch]\r\n     */\r\n\r\n    this.getPitchBounds = function () {\r\n      return [config.minPitch, config.maxPitch];\r\n    };\r\n    /**\r\n     * Set the minimum and maximum allowed pitches (in degrees).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number[]} bounds - [minimum pitch, maximum pitch]\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.setPitchBounds = function (bounds) {\r\n      config.minPitch = Math.max(-90, Math.min(bounds[0], 90));\r\n      config.maxPitch = Math.max(-90, Math.min(bounds[1], 90));\r\n      return this;\r\n    };\r\n    /**\r\n     * Returns the yaw of the center of the view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} Yaw in degrees\r\n     */\r\n\r\n    this.getYaw = function () {\r\n      return config.yaw;\r\n    };\r\n    /**\r\n     * Sets the yaw of the center of the view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} yaw - Yaw in degrees [-180, 180]\r\n     * @param {boolean|number} [animated=1000] - Animation duration in milliseconds or false for no animation\r\n     * @param {function} [callback] - Function to call when animation finishes\r\n     * @param {object} [callbackArgs] - Arguments to pass to callback function\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.setYaw = function (yaw, animated, callback, callbackArgs) {\r\n      latestInteraction = Date.now();\r\n\r\n      if (Math.abs(yaw - config.yaw) <= eps) {\r\n        if (typeof callback === \"function\") callback(callbackArgs);\r\n        return this;\r\n      }\r\n\r\n      animated = animated === undefined$1 ? 1000 : Number(animated);\r\n      yaw = ((yaw + 180) % 360) - 180; // Keep in bounds\r\n\r\n      if (animated) {\r\n        // Animate in shortest direction\r\n        if (config.yaw - yaw > 180) yaw += 360;\r\n        else if (yaw - config.yaw > 180) yaw -= 360;\r\n        animatedMove.yaw = {\r\n          startTime: Date.now(),\r\n          startPosition: config.yaw,\r\n          endPosition: yaw,\r\n          duration: animated,\r\n        };\r\n        if (typeof callback === \"function\")\r\n          setTimeout(function () {\r\n            callback(callbackArgs);\r\n          }, animated);\r\n      } else {\r\n        config.yaw = yaw;\r\n      }\r\n\r\n      animateInit();\r\n      return this;\r\n    };\r\n    /**\r\n     * Returns the minimum and maximum allowed pitches (in degrees).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number[]} [yaw pitch, maximum yaw]\r\n     */\r\n\r\n    this.getYawBounds = function () {\r\n      return [config.minYaw, config.maxYaw];\r\n    };\r\n    /**\r\n     * Set the minimum and maximum allowed yaws (in degrees [-180, 180]).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number[]} bounds - [minimum yaw, maximum yaw]\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.setYawBounds = function (bounds) {\r\n      config.minYaw = Math.max(-180, Math.min(bounds[0], 180));\r\n      config.maxYaw = Math.max(-180, Math.min(bounds[1], 180));\r\n      return this;\r\n    };\r\n    /**\r\n     * Returns the horizontal field of view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} Horizontal field of view in degrees\r\n     */\r\n\r\n    this.getHfov = function () {\r\n      return config.hfov;\r\n    };\r\n    /**\r\n     * Sets the horizontal field of view.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} hfov - Horizontal field of view in degrees\r\n     * @param {boolean|number} [animated=1000] - Animation duration in milliseconds or false for no animation\r\n     * @param {function} [callback] - Function to call when animation finishes\r\n     * @param {object} [callbackArgs] - Arguments to pass to callback function\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.setHfov = function (hfov, animated, callback, callbackArgs) {\r\n      latestInteraction = Date.now();\r\n\r\n      if (Math.abs(hfov - config.hfov) <= eps) {\r\n        if (typeof callback === \"function\") callback(callbackArgs);\r\n        return this;\r\n      }\r\n\r\n      animated = animated === undefined$1 ? 1000 : Number(animated);\r\n\r\n      if (animated) {\r\n        animatedMove.hfov = {\r\n          startTime: Date.now(),\r\n          startPosition: config.hfov,\r\n          endPosition: constrainHfov(hfov),\r\n          duration: animated,\r\n        };\r\n        if (typeof callback === \"function\")\r\n          setTimeout(function () {\r\n            callback(callbackArgs);\r\n          }, animated);\r\n      } else {\r\n        setHfov(hfov);\r\n      }\r\n\r\n      animateInit();\r\n      return this;\r\n    };\r\n    /**\r\n     * Returns the minimum and maximum allowed horizontal fields of view\r\n     * (in degrees).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number[]} [minimum hfov, maximum hfov]\r\n     */\r\n\r\n    this.getHfovBounds = function () {\r\n      return [config.minHfov, config.maxHfov];\r\n    };\r\n    /**\r\n     * Set the minimum and maximum allowed horizontal fields of view (in degrees).\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number[]} bounds - [minimum hfov, maximum hfov]\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.setHfovBounds = function (bounds) {\r\n      config.minHfov = Math.max(0, bounds[0]);\r\n      config.maxHfov = Math.max(0, bounds[1]);\r\n      return this;\r\n    };\r\n    /**\r\n     * Set a new view. Any parameters not specified remain the same.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} [pitch] - Target pitch\r\n     * @param {number} [yaw] - Target yaw\r\n     * @param {number} [hfov] - Target hfov\r\n     * @param {boolean|number} [animated=1000] - Animation duration in milliseconds or false for no animation\r\n     * @param {function} [callback] - Function to call when animation finishes\r\n     * @param {object} [callbackArgs] - Arguments to pass to callback function\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.lookAt = function (\r\n      pitch,\r\n      yaw,\r\n      hfov,\r\n      animated,\r\n      callback,\r\n      callbackArgs\r\n    ) {\r\n      animated = animated === undefined$1 ? 1000 : Number(animated);\r\n\r\n      if (pitch !== undefined$1 && Math.abs(pitch - config.pitch) > eps) {\r\n        this.setPitch(pitch, animated, callback, callbackArgs);\r\n        callback = undefined$1;\r\n      }\r\n\r\n      if (yaw !== undefined$1 && Math.abs(yaw - config.yaw) > eps) {\r\n        this.setYaw(yaw, animated, callback, callbackArgs);\r\n        callback = undefined$1;\r\n      }\r\n\r\n      if (hfov !== undefined$1 && Math.abs(hfov - config.hfov) > eps) {\r\n        this.setHfov(hfov, animated, callback, callbackArgs);\r\n        callback = undefined$1;\r\n      }\r\n\r\n      if (typeof callback === \"function\") callback(callbackArgs);\r\n      return this;\r\n    };\r\n    /**\r\n     * Returns the panorama's north offset.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} North offset in degrees\r\n     */\r\n\r\n    this.getNorthOffset = function () {\r\n      return config.northOffset;\r\n    };\r\n    /**\r\n     * Sets the panorama's north offset.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} heading - North offset in degrees\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.setNorthOffset = function (heading) {\r\n      config.northOffset = Math.min(360, Math.max(0, heading));\r\n      animateInit();\r\n      return this;\r\n    };\r\n    /**\r\n     * Returns the panorama's horizon roll.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} Horizon roll in degrees\r\n     */\r\n\r\n    this.getHorizonRoll = function () {\r\n      return config.horizonRoll;\r\n    };\r\n    /**\r\n     * Sets the panorama's horizon roll.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} roll - Horizon roll in degrees [-90, 90]\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.setHorizonRoll = function (roll) {\r\n      config.horizonRoll = Math.min(90, Math.max(-90, roll));\r\n      renderer.setPose(\r\n        (config.horizonPitch * Math.PI) / 180,\r\n        (config.horizonRoll * Math.PI) / 180\r\n      );\r\n      animateInit();\r\n      return this;\r\n    };\r\n    /**\r\n     * Returns the panorama's horizon pitch.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {number} Horizon pitch in degrees\r\n     */\r\n\r\n    this.getHorizonPitch = function () {\r\n      return config.horizonPitch;\r\n    };\r\n    /**\r\n     * Sets the panorama's horizon pitch.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} pitch - Horizon pitch in degrees [-90, 90]\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.setHorizonPitch = function (pitch) {\r\n      config.horizonPitch = Math.min(90, Math.max(-90, pitch));\r\n      renderer.setPose(\r\n        (config.horizonPitch * Math.PI) / 180,\r\n        (config.horizonRoll * Math.PI) / 180\r\n      );\r\n      animateInit();\r\n      return this;\r\n    };\r\n    /**\r\n     * Start auto rotation.\r\n     *\r\n     * Before starting rotation, the viewer is panned to `pitch`.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {number} [speed] - Auto rotation speed / direction. If not specified, previous value is used.\r\n     * @param {number} [pitch] - The pitch to rotate at. If not specified, inital pitch is used.\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.startAutoRotate = function (speed, pitch) {\r\n      speed = speed || autoRotateSpeed || 1;\r\n      pitch = pitch === undefined$1 ? origPitch : pitch;\r\n      config.autoRotate = speed;\r\n\r\n      _this.lookAt(pitch, undefined$1, origHfov, 3000);\r\n\r\n      animateInit();\r\n      return this;\r\n    };\r\n    /**\r\n     * Stop auto rotation.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.stopAutoRotate = function () {\r\n      autoRotateSpeed = config.autoRotate ? config.autoRotate : autoRotateSpeed;\r\n      config.autoRotate = false;\r\n      config.autoRotateInactivityDelay = -1;\r\n      return this;\r\n    };\r\n\r\n    this.showCompass = function (value) {\r\n      config.compass = value;\r\n      renderInitCallback();\r\n      console.log(config);\r\n      return this;\r\n    };\r\n    /**\r\n     * Stops all movement.\r\n     * @memberof Viewer\r\n     * @instance\r\n     */\r\n\r\n    this.stopMovement = function () {\r\n      stopAnimation();\r\n      speed = {\r\n        yaw: 0,\r\n        pitch: 0,\r\n        hfov: 0,\r\n      };\r\n    };\r\n    /**\r\n     * Returns the panorama renderer.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {Renderer}\r\n     */\r\n\r\n    this.getRenderer = function () {\r\n      return renderer;\r\n    };\r\n    /**\r\n     * Sets update flag for dynamic content.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {boolean} bool - Whether or not viewer should update even when still\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.setUpdate = function (bool) {\r\n      update = bool === true;\r\n      if (renderer === undefined$1) onImageLoad();\r\n      else animateInit();\r\n      return this;\r\n    };\r\n\r\n    this.changeMouseCursor = function (event) {\r\n      return changeMouseCursor(event);\r\n    };\r\n\r\n    this.sceneLoadListener = function () {\r\n      return sceneLoadListener();\r\n    };\r\n    /**\r\n     * Calculate panorama pitch and yaw from location of mouse event.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {MouseEvent} event - Document mouse down event.\r\n     * @returns {number[]} [pitch, yaw]\r\n     */\r\n\r\n    this.mouseEventToCoords = function (event) {\r\n      return mouseEventToCoords(event);\r\n    };\r\n    /**\r\n     * Change scene being viewed.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {string} sceneId - Identifier of scene to switch to.\r\n     * @param {number} [pitch] - Pitch to use with new scene\r\n     * @param {number} [yaw] - Yaw to use with new scene\r\n     * @param {number} [hfov] - HFOV to use with new scene\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.loadScene = function (sceneId, pitch, yaw, hfov) {\r\n      if (loaded !== false) loadScene(sceneId, pitch, yaw, hfov);\r\n      return this;\r\n    };\r\n    /**\r\n     * Get ID of current scene.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {string} ID of current scene\r\n     */\r\n\r\n    this.getScene = function () {\r\n      return config.scene;\r\n    };\r\n    /**\r\n     * Get ID of all scenes.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns [Object] ID of all scenes\r\n     */\r\n\r\n    this.getAllScenes = function () {\r\n      var allScenes = [];\r\n      Object.keys(initialConfig.scenes).forEach(function (scene) {\r\n        allScenes.push(_defineProperty({}, scene, initialConfig.scenes[scene]));\r\n      });\r\n      return allScenes;\r\n    };\r\n    /**\r\n     * Add a new scene.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {string} sceneId - The ID of the new scene\r\n     * @param {string} config - The configuration of the new scene\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.addScene = function (sceneId, config) {\r\n      initialConfig.scenes[sceneId] = config;\r\n      return this;\r\n    };\r\n    /**\r\n     * Remove a scene.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {string} sceneId - The ID of the scene\r\n     * @returns {boolean} False if the scene is the current scene or if the scene doesn't exists, else true\r\n     */\r\n\r\n    this.removeScene = function (sceneId) {\r\n      if (\r\n        config.scene === sceneId ||\r\n        !initialConfig.scenes.hasOwnProperty(sceneId)\r\n      )\r\n        return false;\r\n      delete initialConfig.scenes[sceneId];\r\n      return true;\r\n    };\r\n    /**\r\n     * Toggle fullscreen.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.toggleFullscreen = function () {\r\n      toggleFullscreen();\r\n      return this;\r\n    };\r\n    /**\r\n     * Get configuration of current scene.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {Object} Configuration of current scene\r\n     */\r\n\r\n    this.getConfig = function () {\r\n      return config;\r\n    };\r\n    /**\r\n     * Get viewer's container element.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {HTMLElement} Container `div` element\r\n     */\r\n\r\n    this.getContainer = function () {\r\n      return container;\r\n    };\r\n    /**\r\n     * Add a new hot spot.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {Object} hs - The configuration for the hot spot\r\n     * @param {string} [sceneId] - Adds hot spot to specified scene if provided, else to current scene\r\n     * @returns {Viewer} `this`\r\n     * @throws Throws an error if the scene ID is provided but invalid\r\n     */\r\n\r\n    this.addHotSpot = function (hs, sceneId) {\r\n      if (sceneId === undefined$1 && config.scene === undefined$1) {\r\n        // Not a tour\r\n        config.hotSpots.push(hs);\r\n      } else {\r\n        // Tour\r\n        var id = sceneId !== undefined$1 ? sceneId : config.scene;\r\n\r\n        if (initialConfig.scenes.hasOwnProperty(id)) {\r\n          if (!initialConfig.scenes[id].hasOwnProperty(\"hotSpots\")) {\r\n            initialConfig.scenes[id].hotSpots = []; // Create hot spots array if needed\r\n\r\n            if (id === config.scene)\r\n              config.hotSpots = initialConfig.scenes[id].hotSpots; // Link to current config\r\n          }\r\n\r\n          initialConfig.scenes[id].hotSpots.push(hs); // Add hot spot to config\r\n        } else {\r\n          throw \"Invalid scene ID!\";\r\n        }\r\n      }\r\n\r\n      if (sceneId === undefined$1 || config.scene === sceneId) {\r\n        // Add to current scene\r\n        createHotSpot(hs);\r\n        if (loaded) renderHotSpot(hs);\r\n      }\r\n\r\n      return this;\r\n    };\r\n    /**\r\n     * Remove a hot spot.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {string} hotSpotId - The ID of the hot spot\r\n     * @param {string} [sceneId] - Removes hot spot from specified scene if provided, else from current scene\r\n     * @returns {boolean} True if deletion is successful, else false\r\n     */\r\n\r\n    this.removeHotSpot = function (hotSpotId, sceneId) {\r\n      if (sceneId === undefined$1 || config.scene === sceneId) {\r\n        if (!config.hotSpots) return false;\r\n\r\n        for (var i = 0; i < config.hotSpots.length; i++) {\r\n          if (\r\n            config.hotSpots[i].hasOwnProperty(\"id\") &&\r\n            config.hotSpots[i].id === hotSpotId\r\n          ) {\r\n            // Delete hot spot DOM elements\r\n            var current = config.hotSpots[i].div;\r\n\r\n            while (current.parentNode != renderContainer) {\r\n              current = current.parentNode;\r\n            }\r\n\r\n            renderContainer.removeChild(current);\r\n            delete config.hotSpots[i].div; // Remove hot spot from configuration\r\n\r\n            config.hotSpots.splice(i, 1);\r\n            return true;\r\n          }\r\n        }\r\n      } else {\r\n        if (initialConfig.scenes.hasOwnProperty(sceneId)) {\r\n          if (!initialConfig.scenes[sceneId].hasOwnProperty(\"hotSpots\"))\r\n            return false;\r\n\r\n          for (\r\n            var j = 0;\r\n            j < initialConfig.scenes[sceneId].hotSpots.length;\r\n            j++\r\n          ) {\r\n            if (\r\n              initialConfig.scenes[sceneId].hotSpots[j].hasOwnProperty(\"id\") &&\r\n              initialConfig.scenes[sceneId].hotSpots[j].id === hotSpotId\r\n            ) {\r\n              // Remove hot spot from configuration\r\n              initialConfig.scenes[sceneId].hotSpots.splice(j, 1);\r\n              return true;\r\n            }\r\n          }\r\n        } else {\r\n          return false;\r\n        }\r\n      }\r\n    };\r\n    /**\r\n     * This method should be called if the viewer's container is resized.\r\n     * @memberof Viewer\r\n     * @instance\r\n     */\r\n\r\n    this.resize = function () {\r\n      if (renderer) onDocumentResize();\r\n    };\r\n    /**\r\n     * Check if a panorama is loaded.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {boolean} True if a panorama is loaded, else false\r\n     */\r\n\r\n    this.isLoaded = function () {\r\n      return loaded;\r\n    };\r\n    /**\r\n     * Check if device orientation control is supported.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {boolean} True if supported, else false\r\n     */\r\n\r\n    this.isOrientationSupported = function () {\r\n      return orientationSupport || false;\r\n    };\r\n    /**\r\n     * Stop using device orientation.\r\n     * @memberof Viewer\r\n     * @instance\r\n     */\r\n\r\n    this.stopOrientation = function () {\r\n      stopOrientation();\r\n    };\r\n    /**\r\n     * Start using device orientation (does nothing if not supported).\r\n     * @memberof Viewer\r\n     * @instance\r\n     */\r\n\r\n    this.startOrientation = function () {\r\n      if (orientationSupport) startOrientation();\r\n    };\r\n    /**\r\n     * Check if device orientation control is currently activated.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @returns {boolean} True if active, else false\r\n     */\r\n\r\n    this.isOrientationActive = function () {\r\n      return Boolean(orientation);\r\n    };\r\n    /**\r\n     * Subscribe listener to specified event.\r\n     * @memberof Viewer\r\n     * @instance\r\n     * @param {string} type - Type of event to subscribe to.\r\n     * @param {Function} listener - Listener function to subscribe to event.\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.on = function (type, listener) {\r\n      externalEventListeners[type] = externalEventListeners[type] || [];\r\n      externalEventListeners[type].push(listener);\r\n      return this;\r\n    };\r\n    /**\r\n     * Remove an event listener (or listeners).\r\n     * @memberof Viewer\r\n     * @param {string} [type] - Type of event to remove listeners from. If not specified, all listeners are removed.\r\n     * @param {Function} [listener] - Listener function to remove. If not specified, all listeners of specified type are removed.\r\n     * @returns {Viewer} `this`\r\n     */\r\n\r\n    this.off = function (type, listener) {\r\n      if (!type) {\r\n        // Remove all listeners if type isn't specified\r\n        externalEventListeners = {};\r\n        return this;\r\n      }\r\n\r\n      if (listener) {\r\n        var i = externalEventListeners[type].indexOf(listener);\r\n\r\n        if (i >= 0) {\r\n          // Remove listener if found\r\n          externalEventListeners[type].splice(i, 1);\r\n        }\r\n\r\n        if (externalEventListeners[type].length === 0) {\r\n          // Remove category if empty\r\n          delete externalEventListeners[type];\r\n        }\r\n      } else {\r\n        // Remove category of listeners if listener isn't specified\r\n        delete externalEventListeners[type];\r\n      }\r\n\r\n      return this;\r\n    };\r\n    /**\r\n     * Fire listeners attached to specified event.\r\n     * @private\r\n     * @param {string} [type] - Type of event to fire listeners for.\r\n     */\r\n\r\n    function fireEvent(type) {\r\n      if (type in externalEventListeners) {\r\n        // Reverse iteration is useful, if event listener is removed inside its definition\r\n        for (var i = externalEventListeners[type].length; i > 0; i--) {\r\n          externalEventListeners[type][\r\n            externalEventListeners[type].length - i\r\n          ].apply(null, [].slice.call(arguments, 1));\r\n        }\r\n      }\r\n    }\r\n    /**\r\n     * Destructor.\r\n     * @instance\r\n     * @memberof Viewer\r\n     */\r\n\r\n    this.destroy = function () {\r\n      destroyed = true;\r\n      clearTimeout(autoRotateStart);\r\n      if (renderer) renderer.destroy();\r\n\r\n      if (listenersAdded) {\r\n        document.removeEventListener(\"mousemove\", onDocumentMouseMove, false);\r\n        document.removeEventListener(\"mouseup\", onDocumentMouseUp, false);\r\n        container.removeEventListener(\r\n          \"mozfullscreenchange\",\r\n          onFullScreenChange,\r\n          false\r\n        );\r\n        container.removeEventListener(\r\n          \"webkitfullscreenchange\",\r\n          onFullScreenChange,\r\n          false\r\n        );\r\n        container.removeEventListener(\r\n          \"msfullscreenchange\",\r\n          onFullScreenChange,\r\n          false\r\n        );\r\n        container.removeEventListener(\r\n          \"fullscreenchange\",\r\n          onFullScreenChange,\r\n          false\r\n        );\r\n        window.removeEventListener(\"resize\", onDocumentResize, false);\r\n        window.removeEventListener(\r\n          \"orientationchange\",\r\n          onDocumentResize,\r\n          false\r\n        );\r\n        container.removeEventListener(\"keydown\", onDocumentKeyPress, false);\r\n        container.removeEventListener(\"keyup\", onDocumentKeyUp, false);\r\n        container.removeEventListener(\"blur\", clearKeys, false);\r\n        document.removeEventListener(\"mouseleave\", onDocumentMouseUp, false);\r\n      }\r\n\r\n      container.innerHTML = \"\";\r\n      container.classList.remove(\"pnlm-container\");\r\n    };\r\n  }\r\n\r\n  return {\r\n    viewer: function viewer(container, config) {\r\n      return new Viewer(container, config);\r\n    },\r\n  };\r\n})(\r\n  typeof window === \"undefined\" ? null : window,\r\n  typeof document === \"undefined\" ? null : document\r\n);\r\n\r\nvar myPromise = function myPromise(condition) {\r\n  for (\r\n    var _len = arguments.length,\r\n      args = new Array(_len > 1 ? _len - 1 : 0),\r\n      _key = 1;\r\n    _key < _len;\r\n    _key++\r\n  ) {\r\n    args[_key - 1] = arguments[_key];\r\n  }\r\n\r\n  var promise = new Promise(function (resolve, reject) {\r\n    if (condition) {\r\n      if (args !== []) {\r\n        resolve.apply(void 0, args);\r\n      } else {\r\n        reject(\"Argruments cannot be empty\");\r\n      }\r\n    } else {\r\n      reject(\"Something when wrong!!!\");\r\n    }\r\n  });\r\n  return promise;\r\n};\r\n\r\nvar configs = {\r\n  uiText: {\r\n    loadButtonLabel: \"Click to<br>Load<br>Panorama\",\r\n    loadingLabel: \"Loading...\",\r\n    bylineLabel: \"by %s\",\r\n    noPanoramaError: \"No panorama image was specified.\",\r\n    fileAccessError: \"The file %s could not be accessed.\",\r\n    malformedURLError: \"There is something wrong with the panorama URL.\",\r\n    iOS8WebGLError:\r\n      \"Due to iOS 8's broken WebGL implementation, only progressive encoded JPEGs work for your device (this panorama uses standard encoding).\",\r\n    genericWebGLError:\r\n      \"Your browser does not have the necessary WebGL support to display this panorama.\",\r\n    textureSizeError:\r\n      \"This panorama is too big for your device! It's %spx wide, but your device only supports images up to %spx wide. Try another device. (If you're the author, try scaling down the image.)\",\r\n    unknownError: \"Unknown error. Check developer console.\",\r\n  },\r\n  styles: {\r\n    width: \"100%\",\r\n    height: \"90%\",\r\n    background: \"#000000\",\r\n  },\r\n  equirectangularOptions: {\r\n    haov: 360,\r\n    vaov: 180,\r\n    vOffset: 0,\r\n    ignoreGPanoXMP: false,\r\n  },\r\n  panoramaConfigs: {\r\n    title: \"\",\r\n    author: \"\",\r\n    description: \"\",\r\n    autoLoad: false,\r\n    autoRotate: 0,\r\n    autoRotateInactivityDelay: 0,\r\n    autoRotateStopDelay: 0,\r\n    preview: \"\",\r\n    showZoomCtrl: true,\r\n    keyboardZoom: true,\r\n    mouseZoom: true,\r\n    doubleClickZoom: false,\r\n    draggable: true,\r\n    friction: 0.15,\r\n    disableKeyboardCtrl: false,\r\n    showFullscreenCtrl: true,\r\n    showControls: true,\r\n    touchPanSpeedCoeffFactor: 1,\r\n    yaw: 0,\r\n    pitch: 0,\r\n    maxPitch: 90,\r\n    minPitch: -90,\r\n    maxYaw: 180,\r\n    minYaw: -180,\r\n    hfov: 100,\r\n    minHfov: 50,\r\n    maxHfov: 120,\r\n    multiResMinHfov: false,\r\n    backgroundColor: [0, 0, 0],\r\n    avoidShowingBackground: false,\r\n    compass: false,\r\n    northOffset: 0,\r\n    hotSpots: [],\r\n    hotSpotDebug: false,\r\n  },\r\n};\r\n\r\nfunction styleInject(css, ref) {\r\n  if (ref === void 0) ref = {};\r\n  var insertAt = ref.insertAt;\r\n\r\n  if (!css || typeof document === \"undefined\") {\r\n    return;\r\n  }\r\n\r\n  var head = document.head || document.getElementsByTagName(\"head\")[0];\r\n  var style = document.createElement(\"style\");\r\n  style.type = \"text/css\";\r\n\r\n  if (insertAt === \"top\") {\r\n    if (head.firstChild) {\r\n      head.insertBefore(style, head.firstChild);\r\n    } else {\r\n      head.appendChild(style);\r\n    }\r\n  } else {\r\n    head.appendChild(style);\r\n  }\r\n\r\n  if (style.styleSheet) {\r\n    style.styleSheet.cssText = css;\r\n  } else {\r\n    style.appendChild(document.createTextNode(css));\r\n  }\r\n}\r\n\r\nvar css_248z = `/* Pannellum 2.4.1, https://github.com/mpetroff/pannellum */\\r\\n\\r\\n.pnlm-container {\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  overflow: hidden;\\r\\n  position: relative;\\r\\n  cursor: default;\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  font-family: Helvetica, \\\"Nimbus Sans L\\\", \\\"Liberation Sans\\\", Arial, sans-serif;\\r\\n  background: #f4f4f4 url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2267%22%20height%3D%22100%22%20viewBox%3D%220%200%2067%20100%22%3E%0A%3Cpath%20stroke%3D%22%23ccc%22%20fill%3D%22none%22%20d%3D%22M33.5%2C50%2C0%2C63%2C33.5%2C75%2C67%2C63%2C33.5%2C50m-33.5-50%2C67%2C25m-0.5%2C0%2C0%2C75m-66.5-75%2C67-25m-33.5%2C75%2C0%2C25m0-100%2C0%2C50%22%2F%3E%0A%3C%2Fsvg%3E%0A') repeat;\\r\\n  -webkit-user-select: none;\\r\\n  -khtml-user-select: none;\\r\\n  -moz-user-select: none;\\r\\n  -o-user-select: none;\\r\\n  -ms-user-select: none;\\r\\n  user-select: none;\\r\\n  outline: 0;\\r\\n  line-height: 1.4;\\r\\n  contain: content;\\r\\n}\\r\\n\\r\\n.pnlm-container * {\\r\\n  box-sizing: content-box;\\r\\n  font-family: source sans pro, ui-sans-serif;\\r\\n}\\r\\n\\r\\n.pnlm-ui {\\r\\n  position: absolute;\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  z-index: 1;\\r\\n}\\r\\n\\r\\n.pnlm-custom {\\r\\n  cursor: url(\"data:image/x-icon;base64,AAACAAEAICAAAAAAAACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAUAAAAFAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAQFBgYGBzc1ND4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAADwAAABEAAAAKAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAQAAAAIAAAACAAAAAwAAAAIAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAcAAAAJAAAABkAAAAMAAAABQAAAAMAAAABAAAAAwAAAAUAAAAHAAAACgAAAAsAAAANAAAACwAAAAkAAAAGAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAB8AAAAvAAAAKQAAAB8AAAASAAAADAAAAAcAAAALAAAAEwAAABoAAAAeAAAAIQAAACIAAAAgAAAAHQAAABYAAAAOAAAABgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFNQTs9TUE7QAAAAFgAAACsAAAAzAAAAMwAAACcAAAAeAAAAGAAAAB8AAAArAAAANQAAADoAAAA8AAAAPQAAADsAAAA4AAAALwAAACMAAAATAAAACAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkI6Mz5COjM9TUE7RAAAAHgAAADEAAAA+AAAAOwAAADUAAAAzAAAAOSSA3/8kgN//JIDf/ySA3/8kgN//AAAATQAAAEsAAABGAAAAOwAAACgAAAAVAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkI6Mz5COjNBTUE7SU1BO1wAAAD4AAABHAAAARyGR5/8jhuX/I4Lg/ySA3v8kgN//JIDf/yWD4/8hkef/IZHn/wAAAFEAAABLAAAAPgAAACcAAAARAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkI6Mz5COjNFTUE7VU1BO2iGR5/8gj+T/IZHn/yGQ5/8gj+b/IYvk/yKI4v8jg+H/JYDf/yWB4P8kf93/IZHn/wAAAFMAAABNAAAAOgAAACAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQjozPkI6M0JCOjNUcmOr/HJ3u/xye7v8cn+//HJ7u/x2b7P8dmOr/H5Tp/yGO5f8iieP/I4Lg/ySA4P8hkef/IZHn/wAAAFMAAABJAAAALgAAABQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQjozRHqf2/xmm8f8YqfP/F6z0/xet9f8XrPX/GKnz/xql8f8boO//HJrr/x+U6f8hjOX/IoTh/yWA3v8jfdv/AAECYQAAAFEAAAA6AAAAHgAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARaZ1uQUsPb/EbT4/xC4+v8Pu/v/D7v7/w+6+/8Rt/r/ErL4/xWs9f8apfH/HJ7v/x6W6v8gjeX/IoXh/ySA3/8hkef/AAAAVAAAAEMAAAAnAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAt1vj/EbP2/w68+/8Mvfz/Db79/w6+/f8Ovv3/Dr7+/w2+/v8Nvvz/D7r6/xOy9/8YqfT/G6Hv/x6W6v8hjeX/I4Th/yGR5/8AAABVAAAASQAAAC0AAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+27fMNvv3/Dr79/w3B/f8Owfz/D8H8/w/B/f8Pwfz/DsD8/w2//f8Ovf3/DLz8/xG0+f8XqvT/G6Dv/x6V6f8hi+T/I4Hf/yGR5/8AAABNAAAAMQAAABUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADbz6/w2//f8Pwfv/D8P9/w/F/f8Pxf3/Ecb9/xHG/f8Pw/z/D8L8/w7B/P8Nvfz/Db38/xK0+P8ZqPL/G53u/yCR6P8ihuL/IZHn/wAAAE4AAAA1AAAAGgAAAAUAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC3W+P8Nv/7/DsH8/xDF/P8Qx/v/Esn7/xLL+/8SzP3/Ecv9/xDI+/8Rxvz/D8P9/w/B/f8Ovf3/Dbz7/xSw9v8bpPD/Hpfq/yGM5P8hkef/AAAAUAAAAD0AAAAmAAAAEgAAAAoAAAAEAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAEs38/w/B/P8PxPz/EMj7/xLL+/8Tz/v/FNH6/xTR+v8U0Pr/Es77/xLK/P8Rx/z/FK7x/yB71v8ZkOP/ELn7/xip8/8dne7/IJDn/yGR5/8AAABSAAAASAAAADoAAAAqAAAAHQAAABEAAAAIAAAAAgAAAAAAAAAAAAAAAAAAAAASzfz/EMP9/xDH+/8RzPv/FND5/xXV+v8Z2fv/Gdr6/xfX+v8U0/r/E9H8/yCN4P8ihtv/I3vW/yVwz/8nYMj/FLD2/xyg7/8elOf/IZHn/wAAAFQAAABRAAAASwAAAEIAAAA2AAAAJwAAABUAAAAIAAAAAQAAAAAAAAAAAAAAABLN/P8Qxfv/Ecr7/xPP+/8V1fr/G9v6/x7h+P8j4vn/Hd/5/xjY+f8XrPH/HJ7r/x6T5P8hid3/In/Y/yVz0f8jf9v/I4vj/yKL4/8kkef/J5j0/iGR5/8AAABUAAAAUAAAAEoAAAA+AAAAKQAAABMAAAAEAAAAAAAAAAAAAAAALdb4/xDF/P8Sy/v/FNH6/xjY+v8d3/n/e+v5/6Hv+v9M5fn/HN75/w+5+v8VrvP/G6Ht/x2W5/8hjOL/Iozk/yyf7P9Cwfz/Qr37/0G8+/9Cuvv/Q7v7/0a69/5Du/r/AAAAUgAAAE0AAAA8AAAAIgAAAAsAAAAAAAAAAAAAAAAAAAAAEMP6/xLL+/8U0fr/GNj6/yHh+f+W7vr/zfb7/2bo+v8c3vr/EMv7/w2+/P8Tsvb/Iovk/yGL4/9Bxfv/QMH7/0DB+/9BwPv/Qb78/0K+/P9CvPv/Q737/0O7+v9Du/r/AAAAUwAAAEoAAAAuAAAAEwAAAAAAAAAAAAAAAAAAAAASzfz/Esv7/xTP+f8W1vr/HN36/zbk+v9a5/n/IOL4/xnZ+v8Y3vn/EdD6/xyb6v8hiuP/Psf7/z/F+v8/w/v/QML7/0HB+/9Awfv/QcD8/0G+/f9Bvvz/Qrz7/0O7+f9Du/r/AAAAUgAAADYAAAAaAAAAAAAAAAAAAAAAAAAAAAAAAAARxO7zE877/xTS+v8X1/r/Gtv6/xzc+v8a2vv/Ftb6/xPP+v8a4vn/IYrk/zzM/P88x/z/Psb6/z7F+v8/xPv/QML6/0DC+v9BwPv/QcD7/0G//P9Bvv3/Qr38/0O7+v8AAABUAAAAOAAAABwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAQt9nfE8/7/y3W+P8V1fv/FdX6/xXU+v8U0Pr/Esv7/xyi7P8vr/D/Osv7/zzK/P88yPz/Pcj7/z7G+/8+xPr/PsT6/0DC+v9Bwvv/QMH7/0HA+/9Bv/z/RMP8/wAAAFMAAAA3AAAAGwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAt1vj/EtD8/y3W+P8Tzvv/Es38/xHK+/8Rx/v/IYvk/zjO+/85zfv/Osv7/zrL+/87yfv/PMf7/z7H/P89xfr/QMX6/0DD+v9Bwvr/QcH7/0HB/P9Bv/n/AAEBVwAAADEAAAAVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALdb4/xLN/P8Szfz/EMPv8w2w3OEjjuX/NtD6/zbO/P85zfv/Ocz6/znL+v87yvv/Osn8/zzH/P8+xvv/PsX6/z/F+v9Aw/v/QMP6/0LH/P8AAABKAAAAJwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAASSX2+000fr/NdH8/zbQ+/84zfv/Oc36/znL+v86y/v/O8n7/zvI+/89x/z/Psb7/z7E+v8/xPv/Pbbi8AAAADQAAAAaAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIYnH3DPT+/8z0vv/NdH8/zbP+/82z/v/OM36/znM+v86y/r/Osr7/zvJ+/88yPz/Pcf7/z7F+v9Du/r/AAAAIQAAAA0AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhicfcMNX5/zPT+/8z0/z/NNH8/zTR/P82z/z/N877/znN+v85y/r/Osv6/zvK+/87yfv/Pcf3/C3W+P8AAAARAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv2vn/L9b7/zLV/P8z1Pz/NNL8/zXR/P820fz/Ns/8/zjO+/86zfv/Ocv6/znJ+f9Du/r/AAAADwAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC3W+P8t1vj/Ltf8/zHW/P8z1Pv/M9T8/zPS/P810fv/NtD8/zbO+/84yvj/Q7v6/wAAAA0AAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEO7+v9Du/r/Ltj7/y/X+/8x1fz/M9T8/zTT+/800vr/NdX3+UO7+v8AAAAHAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDu/r/LNn6/y/Y+/8w1fv/Q7v6/y3W+P8AAAAGAAAABAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////z////8fwf//hwB//8AAP//AAB//4AAf/+AAD//AAA//wAAH/8AAB/+AAAf/gAAH/4AAB/+AAAH/gAAAf8AAAD/AAAAf4AAAH/AAAB/4AAAf/gAAH//wAB//8AAf//AAH//4AD//+AB///wA////A/8=\"), auto;\\r\\n}\\r\\n\\r\\n.pnlm-grab {\\r\\n  cursor: grab;\\r\\n  cursor: ${\"url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%2226%22%20width%3D%2226%22%3E%0A%3Cpath%20stroke%3D%22%23000%22%20stroke-width%3D%221px%22%20fill%3D%22%23fff%22%20d%3D%22m15.3%2020.5s6.38-6.73%204.64-8.24-3.47%201.01-3.47%201.01%203.61-5.72%201.41-6.49c-2.2-0.769-3.33%204.36-3.33%204.36s0.873-5.76-1.06-5.76-1.58%205.39-1.58%205.39-0.574-4.59-2.18-4.12c-1.61%200.468-0.572%205.51-0.572%205.51s-1.58-4.89-2.93-3.79c-1.35%201.11%200.258%205.25%200.572%206.62%200.836%202.43%202.03%202.94%202.17%205.55%22%2F%3E%0A%3C%2Fsvg%3E%0A') 12 8, default\"}\\r\\n}\\r\\n\\r\\n.pnlm-grabbing {\\r\\n  cursor: grabbing;\\r\\n  cursor: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%2226%22%20width%3D%2226%22%3E%0A%3Cpath%20stroke%3D%22%23000%22%20stroke-width%3D%221px%22%20fill%3D%22%23fff%22%20d%3D%22m15.3%2020.5s5.07-5.29%203.77-6.74c-1.31-1.45-2.53%200.14-2.53%200.14s2.74-3.29%200.535-4.06c-2.2-0.769-2.52%201.3-2.52%201.3s0.81-2.13-1.12-2.13-1.52%201.77-1.52%201.77-0.261-1.59-1.87-1.12c-1.61%200.468-0.874%202.17-0.874%202.17s-0.651-1.55-2-0.445c-1.35%201.11-0.68%202.25-0.365%203.62%200.836%202.43%202.03%202.94%202.17%205.55%22%2F%3E%0A%3C%2Fsvg%3E%0A') 12 8, default\\r\\n}\\r\\n\\r\\n.pnlm-sprite {\\r\\n  background-image: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2226%22%20height%3D%22208%22%3E%0A%3Ccircle%20fill-opacity%3D%22.78%22%20cy%3D%22117%22%20cx%3D%2213%22%20r%3D%2211%22%20fill%3D%22%23fff%22%2F%3E%0A%3Ccircle%20fill-opacity%3D%22.78%22%20cy%3D%22143%22%20cx%3D%2213%22%20r%3D%2211%22%20fill%3D%22%23fff%22%2F%3E%0A%3Ccircle%20cy%3D%22169%22%20cx%3D%2213%22%20r%3D%227%22%20fill%3D%22none%22%20stroke%3D%22%23000%22%20stroke-width%3D%222%22%2F%3E%0A%3Ccircle%20cy%3D%22195%22%20cx%3D%2213%22%20r%3D%227%22%20fill%3D%22none%22%20stroke%3D%22%23000%22%20stroke-width%3D%222%22%2F%3E%0A%3Ccircle%20cx%3D%2213%22%20cy%3D%22195%22%20r%3D%222.5%22%2F%3E%0A%3Cpath%20d%3D%22m5%2083v6h2v-4h4v-2zm10%200v2h4v4h2v-6zm-5%205v6h6v-6zm-5%205v6h6v-2h-4v-4zm14%200v4h-4v2h6v-6z%22%2F%3E%0A%3Cpath%20d%3D%22m13%20110a7%207%200%200%200%20-7%207%207%207%200%200%200%207%207%207%207%200%200%200%207%20-7%207%207%200%200%200%20-7%20-7zm-1%203h2v2h-2zm0%203h2v5h-2z%22%2F%3E%0A%3Cpath%20d%3D%22m5%2057v6h2v-4h4v-2zm10%200v2h4v4h2v-6zm-10%2010v6h6v-2h-4v-4zm14%200v4h-4v2h6v-6z%22%2F%3E%0A%3Cpath%20d%3D%22m17%2038v2h-8v-2z%22%2F%3E%0A%3Cpath%20d%3D%22m12%209v3h-3v2h3v3h2v-3h3v-2h-3v-3z%22%2F%3E%0A%3Cpath%20d%3D%22m13%20136-6.125%206.125h4.375v7.875h3.5v-7.875h4.375z%22%2F%3E%0A%3Cpath%20d%3D%22m10.428%20173.33v-5.77l5-2.89v5.77zm1-1.73%203-1.73-3.001-1.74z%22%2F%3E%0A%3C%2Fsvg%3E%0A')\\r\\n}\\r\\n\\r\\n.pnlm-container:-moz-full-screen {\\r\\n  height: 100% !important;\\r\\n  width: 100% !important;\\r\\n  position: static !important;\\r\\n}\\r\\n\\r\\n.pnlm-container:-webkit-full-screen {\\r\\n  height: 100% !important;\\r\\n  width: 100% !important;\\r\\n  position: static !important;\\r\\n}\\r\\n\\r\\n.pnlm-container:-ms-fullscreen {\\r\\n  height: 100% !important;\\r\\n  width: 100% !important;\\r\\n  position: static !important;\\r\\n}\\r\\n\\r\\n.pnlm-container:fullscreen {\\r\\n  height: 100% !important;\\r\\n  width: 100% !important;\\r\\n  position: static !important;\\r\\n}\\r\\n\\r\\n.pnlm-render-container {\\r\\n  cursor: inherit;\\r\\n\\r\\n  /* Fix display bug in Safari 7 */\\r\\n  position: absolute;\\r\\n  height: 100%;\\r\\n  width: 100%;\\r\\n}\\r\\n\\r\\n.pnlm-controls {\\r\\n  margin-top: 4px;\\r\\n  background-color: #fff;\\r\\n  border: 1px solid #999;\\r\\n  border-color: rgba(0, 0, 0, 0.4);\\r\\n  border-radius: 3px;\\r\\n  cursor: pointer;\\r\\n  z-index: 2;\\r\\n  /* Fix Safari fullscreen bug */\\r\\n  -webkit-transform: translateZ(9999px);\\r\\n  transform: translateZ(9999px);\\r\\n}\\r\\n\\r\\n.pnlm-control:hover {\\r\\n  background-color: #f8f8f8;\\r\\n}\\r\\n\\r\\n.pnlm-controls-container {\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  left: 4px;\\r\\n  z-index: 1;\\r\\n}\\r\\n\\r\\n.pnlm-zoom-controls {\\r\\n  width: 26px;\\r\\n  height: 52px;\\r\\n}\\r\\n\\r\\n.pnlm-zoom-in {\\r\\n  width: 100%;\\r\\n  height: 50%;\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  border-radius: 3px 3px 0 0;\\r\\n}\\r\\n\\r\\n.pnlm-zoom-out {\\r\\n  width: 100%;\\r\\n  height: 50%;\\r\\n  position: absolute;\\r\\n  bottom: 0;\\r\\n  background-position: 0 -26px;\\r\\n  border-top: 1px solid #ddd;\\r\\n  border-top-color: rgba(0, 0, 0, 0.10);\\r\\n  border-radius: 0 0 3px 3px;\\r\\n}\\r\\n\\r\\n.pnlm-fullscreen-toggle-button,\\r\\n.pnlm-orientation-button,\\r\\n.pnlm-hot-spot-debug-indicator {\\r\\n  width: 26px;\\r\\n  height: 26px;\\r\\n}\\r\\n\\r\\n.pnlm-hot-spot-debug-indicator {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  width: 26px;\\r\\n  height: 26px;\\r\\n  margin: -13px 0 0 -13px;\\r\\n  background-color: rgba(255, 255, 255, 0.5);\\r\\n  border-radius: 13px;\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n.pnlm-orientation-button-inactive {\\r\\n  background-position: 0 -156px;\\r\\n}\\r\\n\\r\\n.pnlm-orientation-button-active {\\r\\n  background-position: 0 -182px;\\r\\n}\\r\\n\\r\\n.pnlm-fullscreen-toggle-button-inactive {\\r\\n  background-position: 0 -52px;\\r\\n}\\r\\n\\r\\n.pnlm-fullscreen-toggle-button-active {\\r\\n  background-position: 0 -78px;\\r\\n}\\r\\n\\r\\n.pnlm-panorama-info {\\r\\n  position: absolute;\\r\\n  bottom: 4px;\\r\\n  background-color: rgba(0, 0, 0, 0.7);\\r\\n  border-radius: 0 3px 3px 0;\\r\\n  padding-right: 10px;\\r\\n  color: #fff;\\r\\n  text-align: left;\\r\\n  display: none;\\r\\n  z-index: 2;\\r\\n  /* Fix Safari fullscreen bug */\\r\\n  -webkit-transform: translateZ(9999px);\\r\\n  transform: translateZ(9999px);\\r\\n}\\r\\n\\r\\n.pnlm-title-box {\\r\\n  position: relative;\\r\\n  font-size: 20px;\\r\\n  display: table;\\r\\n  padding-left: 5px;\\r\\n  margin-bottom: 3px;\\r\\n}\\r\\n\\r\\n.pnlm-description-box {\\r\\n  position: relative;\\r\\n  font-size: 18px;\\r\\n  display: table;\\r\\n  padding-left: 5px;\\r\\n  margin-bottom: 3px;\\r\\n}\\r\\n\\r\\n.pnlm-author-box {\\r\\n  position: relative;\\r\\n  font-size: 12px;\\r\\n  display: table;\\r\\n  padding-left: 5px;\\r\\n}\\r\\n\\r\\n.pnlm-load-box {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  width: 200px;\\r\\n  height: 150px;\\r\\n  margin: -75px 0 0 -100px;\\r\\n  background-color: rgba(0, 0, 0, 0.7);\\r\\n  border-radius: 3px;\\r\\n  text-align: center;\\r\\n  font-size: 20px;\\r\\n  display: none;\\r\\n  color: #fff;\\r\\n}\\r\\n\\r\\n.pnlm-load-box p {\\r\\n  margin: 20px 0;\\r\\n}\\r\\n\\r\\n.pnlm-lbox {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  width: 20px;\\r\\n  height: 20px;\\r\\n  margin: -10px 0 0 -10px;\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n.pnlm-loading {\\r\\n  animation-duration: 1.5s;\\r\\n  -webkit-animation-duration: 1.5s;\\r\\n  animation-name: pnlm-mv;\\r\\n  -webkit-animation-name: pnlm-mv;\\r\\n  animation-iteration-count: infinite;\\r\\n  -webkit-animation-iteration-count: infinite;\\r\\n  animation-timing-function: linear;\\r\\n  -webkit-animation-timing-function: linear;\\r\\n  height: 10px;\\r\\n  width: 10px;\\r\\n  background-color: #fff;\\r\\n  position: relative;\\r\\n}\\r\\n\\r\\n@keyframes pnlm-mv {\\r\\n  from {\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n  }\\r\\n\\r\\n  25% {\\r\\n    left: 10px;\\r\\n    top: 0;\\r\\n  }\\r\\n\\r\\n  50% {\\r\\n    left: 10px;\\r\\n    top: 10px;\\r\\n  }\\r\\n\\r\\n  75% {\\r\\n    left: 0;\\r\\n    top: 10px;\\r\\n  }\\r\\n\\r\\n  to {\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n  }\\r\\n}\\r\\n\\r\\n@-webkit-keyframes pnlm-mv {\\r\\n  from {\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n  }\\r\\n\\r\\n  25% {\\r\\n    left: 10px;\\r\\n    top: 0;\\r\\n  }\\r\\n\\r\\n  50% {\\r\\n    left: 10px;\\r\\n    top: 10px;\\r\\n  }\\r\\n\\r\\n  75% {\\r\\n    left: 0;\\r\\n    top: 10px;\\r\\n  }\\r\\n\\r\\n  to {\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n  }\\r\\n}\\r\\n\\r\\n.pnlm-load-button {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  width: 200px;\\r\\n  height: 100px;\\r\\n  margin: -50px 0 0 -100px;\\r\\n  background-color: rgba(0, 0, 0, .7);\\r\\n  border-radius: 3px;\\r\\n  text-align: center;\\r\\n  font-size: 20px;\\r\\n  display: table;\\r\\n  color: #fff;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.pnlm-load-button:hover {\\r\\n  background-color: rgba(0, 0, 0, .8);\\r\\n}\\r\\n\\r\\n.pnlm-load-button p {\\r\\n  display: table-cell;\\r\\n  vertical-align: middle;\\r\\n}\\r\\n\\r\\n.pnlm-info-box {\\r\\n  font-size: 15px;\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  width: 200px;\\r\\n  height: 150px;\\r\\n  margin: -75px 0 0 -100px;\\r\\n  background-color: #000;\\r\\n  border-radius: 3px;\\r\\n  display: table;\\r\\n  text-align: center;\\r\\n  color: #fff;\\r\\n  table-layout: fixed;\\r\\n}\\r\\n\\r\\n.pnlm-info-box a,\\r\\n.pnlm-author-box a {\\r\\n  color: #fff;\\r\\n  word-wrap: break-word;\\r\\n  overflow-wrap: break-word;\\r\\n}\\r\\n\\r\\n.pnlm-info-box p {\\r\\n  display: table-cell;\\r\\n  vertical-align: middle;\\r\\n  padding: 0 5px 0 5px;\\r\\n}\\r\\n\\r\\n.pnlm-error-msg {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n.pnlm-about-msg {\\r\\n  font-size: 11px;\\r\\n  line-height: 11px;\\r\\n  color: #fff;\\r\\n  padding: 5px 8px 5px 8px;\\r\\n  background: rgba(0, 0, 0, 0.7);\\r\\n  border-radius: 3px;\\r\\n  position: absolute;\\r\\n  top: 50px;\\r\\n  left: 50px;\\r\\n  display: none;\\r\\n  opacity: 0;\\r\\n  -moz-transition: opacity .3s ease-in-out;\\r\\n  -webkit-transition: opacity .3s ease-in-out;\\r\\n  -o-transition: opacity .3s ease-in-out;\\r\\n  -ms-transition: opacity .3s ease-in-out;\\r\\n  transition: opacity .3s ease-in-out;\\r\\n  z-index: 1;\\r\\n}\\r\\n\\r\\n.pnlm-about-msg a:link,\\r\\n.pnlm-about-msg a:visited {\\r\\n  color: #fff;\\r\\n}\\r\\n\\r\\n.pnlm-about-msg a:hover,\\r\\n.pnlm-about-msg a:active {\\r\\n  color: #eee;\\r\\n}\\r\\n\\r\\n.pnlm-hotspot-base {\\r\\n  position: absolute;\\r\\n  visibility: hidden;\\r\\n  cursor: default;\\r\\n  vertical-align: middle;\\r\\n  top: 0;\\r\\n  z-index: 1;\\r\\n}\\r\\n\\r\\n.pnlm-hotspot {\\r\\n  height: 26px;\\r\\n  width: 26px;\\r\\n  border-radius: 13px;\\r\\n}\\r\\n\\r\\n.pnlm-hotspot:hover {\\r\\n  background-color: rgba(255, 255, 255, 0.2);\\r\\n}\\r\\n\\r\\n.pnlm-hotspot.pnlm-info {\\r\\n  background-position: 0 -104px;\\r\\n}\\r\\n\\r\\n.pnlm-hotspot.pnlm-scene {\\r\\n  background-position: 0 -130px;\\r\\n}\\r\\n\\r\\ndiv.pnlm-tooltip span {\\r\\n  visibility: hidden;\\r\\n  position: absolute;\\r\\n  border-radius: 3px;\\r\\n  background-color: rgba(0, 0, 0, 0.7);\\r\\n  color: #fff;\\r\\n  text-align: center;\\r\\n  max-width: 200px;\\r\\n  padding: 5px 10px;\\r\\n  margin-left: -220px;\\r\\n  cursor: default;\\r\\n}\\r\\n\\r\\ndiv.pnlm-tooltip:hover span {\\r\\n  visibility: visible;\\r\\n}\\r\\n\\r\\ndiv.pnlm-tooltip:hover span:after {\\r\\n  content: '';\\r\\n  position: absolute;\\r\\n  width: 0;\\r\\n  height: 0;\\r\\n  border-width: 10px;\\r\\n  border-style: solid;\\r\\n  border-color: rgba(0, 0, 0, 0.7) transparent transparent transparent;\\r\\n  bottom: -20px;\\r\\n  left: -10px;\\r\\n  margin: 0 50%;\\r\\n}\\r\\n\\r\\n.pnlm-compass {\\r\\n  position: absolute;\\r\\n  width: 50px;\\r\\n  height: 50px;\\r\\n  right: 4px;\\r\\n  bottom: 4px;\\r\\n  border-radius: 25px;\\r\\n  background-image: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%2250%22%20width%3D%2250%22%3E%0A%3Cpath%20d%3D%22m24.5078%206-3.2578%2018h7.5l-3.25781-18h-0.984376zm-3.2578%2020%203.2578%2018h0.9844l3.2578-18h-7.5zm1.19531%200.9941h5.10938l-2.5547%2014.1075-2.5547-14.1075z%22%2F%3E%0A%3C%2Fsvg%3E%0A');\\r\\n  cursor: default;\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n.pnlm-world {\\r\\n  position: absolute;\\r\\n  left: 50%;\\r\\n  top: 50%;\\r\\n}\\r\\n\\r\\n.pnlm-face {\\r\\n  position: absolute;\\r\\n  -webkit-transform-origin: 0 0 0;\\r\\n  transform-origin: 0 0 0;\\r\\n}\\r\\n\\r\\n.pnlm-dragfix,\\r\\n.pnlm-preview-img {\\r\\n  position: absolute;\\r\\n  height: 100%;\\r\\n  width: 100%;\\r\\n}\\r\\n\\r\\n.pnlm-preview-img {\\r\\n  background-size: cover;\\r\\n  background-position: center;\\r\\n}\\r\\n\\r\\n.pnlm-lbar {\\r\\n  width: 150px;\\r\\n  margin: 0 auto;\\r\\n  border: #fff 1px solid;\\r\\n  height: 6px;\\r\\n}\\r\\n\\r\\n.pnlm-lbar-fill {\\r\\n  background: #fff;\\r\\n  height: 100%;\\r\\n  width: 0;\\r\\n}\\r\\n\\r\\n.pnlm-lmsg {\\r\\n  font-size: 12px;\\r\\n}\\r\\n\\r\\n.pnlm-fade-img {\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  left: 0;\\r\\n}\\r\\n\\r\\n.pnlm-pointer {\\r\\n  cursor: pointer;\\r\\n}\\r\\n`;\r\nstyleInject(css_248z);\r\n\r\nvar myPannellum = null;\r\n\r\nvar ReactPannellum = /*#__PURE__*/ (function (_React$Component) {\r\n  _inherits(ReactPannellum, _React$Component);\r\n\r\n  var _super = _createSuper(ReactPannellum);\r\n\r\n  function ReactPannellum() {\r\n    var _this;\r\n\r\n    _classCallCheck(this, ReactPannellum);\r\n\r\n    for (\r\n      var _len = arguments.length, args = new Array(_len), _key = 0;\r\n      _key < _len;\r\n      _key++\r\n    ) {\r\n      args[_key] = arguments[_key];\r\n    }\r\n\r\n    _this = _super.call.apply(_super, [this].concat(args));\r\n    _this.state = {\r\n      imageSource: \"\",\r\n      equirectangularOptions: {},\r\n      cubeMap: [],\r\n      multiRes: {},\r\n    };\r\n\r\n    _this.init = function () {\r\n      var _this$state = _this.state,\r\n        imageSource = _this$state.imageSource,\r\n        equirectangularOptions = _this$state.equirectangularOptions,\r\n        cubeMap = _this$state.cubeMap,\r\n        multiRes = _this$state.multiRes;\r\n      var _this$props = _this.props,\r\n        sceneId = _this$props.sceneId,\r\n        config = _this$props.config,\r\n        type = _this$props.type;\r\n      myPannellum = pannellum.viewer(_this.props.id, {\r\n        default: {\r\n          firstScene: sceneId,\r\n        },\r\n        scenes: _defineProperty(\r\n          {},\r\n          sceneId,\r\n          _objectSpread2(\r\n            _objectSpread2(\r\n              _objectSpread2(\r\n                _objectSpread2(\r\n                  _objectSpread2(\r\n                    _objectSpread2({}, configs.panoramaConfigs),\r\n                    configs.equirectangularOptions\r\n                  ),\r\n                  configs.uiText\r\n                ),\r\n                config\r\n              ),\r\n              {},\r\n              {\r\n                type: type,\r\n                imageSource: imageSource,\r\n              },\r\n              equirectangularOptions\r\n            ),\r\n            {},\r\n            {\r\n              cubeMap: cubeMap,\r\n              multiRes: multiRes,\r\n            }\r\n          )\r\n        ),\r\n      });\r\n\r\n      myPannellum &&\r\n        myPannellum.on(\"mousedown\", function (event) {\r\n          return _this.props.onMouseDown(event);\r\n        });\r\n\r\n      myPannellum &&\r\n        myPannellum.on(\"mouseup\", function (event) {\r\n          return _this.props.onMouseUp(event);\r\n        });\r\n\r\n      myPannellum &&\r\n        myPannellum.on(\"mousemove\", function (event) {\r\n          return _this.props.onMouseMove(event);\r\n        });\r\n\r\n      myPannellum &&\r\n        myPannellum.on(\"load\", function () {\r\n          return myPannellum.sceneLoadListener();\r\n        });\r\n\r\n      // _this.props.onPanoramaLoaded &&\r\n      //   myPannellum.on(\"load\", function () {\r\n      //     return _this.props.onPanoramaLoaded();\r\n      //   });\r\n    };\r\n\r\n    return _this;\r\n  }\r\n\r\n  _createClass(\r\n    ReactPannellum,\r\n    [\r\n      {\r\n        key: \"initPanalleum\",\r\n        value: function initPanalleum() {\r\n          var _this2 = this;\r\n\r\n          var _this$props2 = this.props,\r\n            imageSource = _this$props2.imageSource,\r\n            type = _this$props2.type,\r\n            cubeMap = _this$props2.cubeMap,\r\n            multiRes = _this$props2.multiRes,\r\n            equirectangularOptions = _this$props2.equirectangularOptions;\r\n\r\n          switch (type) {\r\n            case \"equirectangular\":\r\n              this.setState(\r\n                {\r\n                  imageSource: imageSource,\r\n                  equirectangularOptions: equirectangularOptions,\r\n                  cubeMap: [],\r\n                },\r\n                function () {\r\n                  return _this2.init();\r\n                }\r\n              );\r\n              break;\r\n\r\n            case \"cubemap\":\r\n              this.setState(\r\n                {\r\n                  cubeMap: cubeMap,\r\n                  imageSource: \"\",\r\n                },\r\n                function () {\r\n                  return _this2.init();\r\n                }\r\n              );\r\n              break;\r\n\r\n            case \"multires\":\r\n              this.setState(\r\n                {\r\n                  cubeMap: [],\r\n                  imageSource: \"\",\r\n                  multiRes: multiRes,\r\n                },\r\n                function () {\r\n                  return _this2.init();\r\n                }\r\n              );\r\n              break;\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"componentDidMount\",\r\n        value: function componentDidMount() {\r\n          this.initPanalleum();\r\n        },\r\n      },\r\n      {\r\n        key: \"componentWillUnmount\",\r\n        value: function componentWillUnmount() {\r\n          myPannellum &&\r\n            this.props.onPanoramaLoaded &&\r\n            myPannellum.off(\"load\", this.props.onPanoramaLoaded);\r\n        },\r\n      },\r\n      {\r\n        key: \"render\",\r\n        value: function render() {\r\n          var _this$props3 = this.props,\r\n            style = _this$props3.style,\r\n            className = _this$props3.className,\r\n            id = _this$props3.id,\r\n            children = _this$props3.children;\r\n          return /*#__PURE__*/ React__default[\"default\"].createElement(\"div\", {\r\n            id: id,\r\n            style: style,\r\n            className: className,\r\n            children: children,\r\n          });\r\n        },\r\n      },\r\n    ],\r\n    [\r\n      {\r\n        key: \"isLoaded\",\r\n        value: function isLoaded() {\r\n          return myPannellum && myPannellum.isLoaded();\r\n        },\r\n      },\r\n      {\r\n        key: \"getPitch\",\r\n        value: function getPitch() {\r\n          return myPannellum && myPannellum.getPitch();\r\n        },\r\n      },\r\n      {\r\n        key: \"setPitch\",\r\n        value: function setPitch(pitch) {\r\n          var animated =\r\n            arguments.length > 1 && arguments[1] !== undefined\r\n              ? arguments[1]\r\n              : 1000;\r\n          var callback = arguments.length > 2 ? arguments[2] : undefined;\r\n          var callbackArgs = arguments.length > 3 ? arguments[3] : undefined;\r\n\r\n          if (myPannellum) {\r\n            myPannellum.setPitch(pitch, animated, callback, callbackArgs);\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"getPitchBounds\",\r\n        value: function getPitchBounds() {\r\n          return myPannellum && myPannellum.getPitchBounds();\r\n        },\r\n      },\r\n      {\r\n        key: \"setPitchBounds\",\r\n        value: function setPitchBounds(bounds) {\r\n          if (myPannellum) {\r\n            myPannellum.setPitchBounds(bounds);\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"getYaw\",\r\n        value: function getYaw() {\r\n          return myPannellum && myPannellum.getYaw();\r\n        },\r\n      },\r\n      {\r\n        key: \"setYaw\",\r\n        value: function setYaw(yaw) {\r\n          var animated =\r\n            arguments.length > 1 && arguments[1] !== undefined\r\n              ? arguments[1]\r\n              : 1000;\r\n          var callback = arguments.length > 2 ? arguments[2] : undefined;\r\n          var callbackArgs = arguments.length > 3 ? arguments[3] : undefined;\r\n\r\n          if (myPannellum) {\r\n            myPannellum.setYaw(yaw, animated, callback, callbackArgs);\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"getYawBounds\",\r\n        value: function getYawBounds() {\r\n          return myPannellum && myPannellum.getYawBounds();\r\n        },\r\n      },\r\n      {\r\n        key: \"setYawBounds\",\r\n        value: function setYawBounds(bounds) {\r\n          myPromise(myPannellum, {\r\n            bounds: bounds,\r\n          })\r\n            .then(function (_ref) {\r\n              var bounds = _ref.bounds;\r\n              myPannellum.setYawBounds(bounds);\r\n            })\r\n            [\"catch\"](function (err) {\r\n              console.log(err);\r\n            });\r\n        },\r\n      },\r\n      {\r\n        key: \"getHfov\",\r\n        value: function getHfov() {\r\n          return myPannellum && myPannellum.getHfov();\r\n        },\r\n      },\r\n      {\r\n        key: \"setHfov\",\r\n        value: function setHfov(hfov) {\r\n          var animated =\r\n            arguments.length > 1 && arguments[1] !== undefined\r\n              ? arguments[1]\r\n              : 1000;\r\n          var callback = arguments.length > 2 ? arguments[2] : undefined;\r\n          var callbackArgs = arguments.length > 3 ? arguments[3] : undefined;\r\n\r\n          if (myPannellum) {\r\n            myPannellum.setHfov(hfov, animated, callback, callbackArgs);\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"getHfovBounds\",\r\n        value: function getHfovBounds() {\r\n          return myPannellum && myPannellum.getHfovBounds();\r\n        },\r\n      },\r\n      {\r\n        key: \"setHfovBounds\",\r\n        value: function setHfovBounds(bounds) {\r\n          myPromise(myPannellum, {\r\n            bounds: bounds,\r\n          })\r\n            .then(function (_ref2) {\r\n              var bounds = _ref2.bounds;\r\n              myPannellum.setHfovBounds(bounds);\r\n            })\r\n            [\"catch\"](function (err) {\r\n              console.log(err);\r\n            });\r\n        },\r\n      },\r\n      {\r\n        key: \"lookAt\",\r\n        value: function lookAt(pitch, yaw, hfov) {\r\n          var animated =\r\n            arguments.length > 3 && arguments[3] !== undefined\r\n              ? arguments[3]\r\n              : 1000;\r\n          var callback = arguments.length > 4 ? arguments[4] : undefined;\r\n          var callbackArgs = arguments.length > 5 ? arguments[5] : undefined;\r\n\r\n          if (myPannellum) {\r\n            myPannellum.lookAt(\r\n              pitch,\r\n              yaw,\r\n              hfov,\r\n              animated,\r\n              callback,\r\n              callbackArgs\r\n            );\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"getNorthOffset\",\r\n        value: function getNorthOffset() {\r\n          return myPannellum && myPannellum.getNorthOffset();\r\n        },\r\n      },\r\n      {\r\n        key: \"setNorthOffset\",\r\n        value: function setNorthOffset(heading) {\r\n          myPromise(myPannellum, {\r\n            heading: heading,\r\n          })\r\n            .then(function (_ref3) {\r\n              var heading = _ref3.heading;\r\n              myPannellum.setNorthOffset(heading);\r\n            })\r\n            [\"catch\"](function (err) {\r\n              console.log(err);\r\n            });\r\n        },\r\n      },\r\n      {\r\n        key: \"getHorizonRoll\",\r\n        value: function getHorizonRoll() {\r\n          return myPannellum && myPannellum.getHorizonRoll();\r\n        },\r\n      },\r\n      {\r\n        key: \"setHorizonRoll\",\r\n        value: function setHorizonRoll(roll) {\r\n          myPromise(myPannellum, {\r\n            roll: roll,\r\n          })\r\n            .then(function (_ref4) {\r\n              var roll = _ref4.roll;\r\n              myPannellum.setHorizonRoll(roll);\r\n            })\r\n            [\"catch\"](function (err) {\r\n              console.log(err);\r\n            });\r\n        },\r\n      },\r\n      {\r\n        key: \"getHorizonPitch\",\r\n        value: function getHorizonPitch() {\r\n          return myPannellum && myPannellum.getHorizonPitch();\r\n        },\r\n      },\r\n      {\r\n        key: \"setHorizonPitch\",\r\n        value: function setHorizonPitch(pitch) {\r\n          myPromise(myPannellum, {\r\n            pitch: pitch,\r\n          })\r\n            .then(function (_ref5) {\r\n              var pitch = _ref5.pitch;\r\n              myPannellum.setHorizonPitch(pitch);\r\n            })\r\n            [\"catch\"](function (err) {\r\n              console.log(err);\r\n            });\r\n        },\r\n      },\r\n      {\r\n        key: \"startAutoRotate\",\r\n        value: function startAutoRotate(speed, pitch) {\r\n          myPromise(myPannellum, {\r\n            pitch: pitch,\r\n          })\r\n            .then(function (_ref6) {\r\n              var pitch = _ref6.pitch;\r\n              myPannellum.startAutoRotate(speed, pitch);\r\n            })\r\n            [\"catch\"](function (err) {\r\n              console.log(err);\r\n            });\r\n        },\r\n      },\r\n      {\r\n        key: \"stopAutoRotate\",\r\n        value: function stopAutoRotate() {\r\n          if (myPannellum) {\r\n            myPannellum.stopAutoRotate();\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"showCompass\",\r\n        value: function showCompass(value) {\r\n          myPromise(myPannellum, {})\r\n            .then(function () {\r\n              myPannellum.showCompass(value);\r\n            })\r\n            [\"catch\"](function (err) {\r\n              console.log(err);\r\n            });\r\n        },\r\n      },\r\n      {\r\n        key: \"changeMouseCursor\",\r\n        value: function changeMouseCursor(event) {\r\n          return myPannellum && myPannellum.changeMouseCursor(event);\r\n        },\r\n      },\r\n      {\r\n        key: \"mouseEventToCoords\",\r\n        value: function mouseEventToCoords(event) {\r\n          return myPannellum && myPannellum.mouseEventToCoords(event);\r\n        },\r\n      },\r\n      {\r\n        key: \"addScene\",\r\n        value: function addScene(sceneId, config, callback) {\r\n          if (sceneId && sceneId !== \"\" && config && config !== {}) {\r\n            myPromise(myPannellum, {\r\n              sceneId: sceneId,\r\n              config: config,\r\n              callback: callback,\r\n            })\r\n              .then(function (_ref7) {\r\n                var sceneId = _ref7.sceneId,\r\n                  config = _ref7.config,\r\n                  callback = _ref7.callback;\r\n                myPannellum.addScene(sceneId, config);\r\n                callback && callback();\r\n              })\r\n              [\"catch\"](function (err) {\r\n                console.log(err);\r\n              });\r\n          } else {\r\n            console.log(\r\n              \"sceneId cannot be empty and config.imageSource cannot be empty!!\"\r\n            );\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"getCurrentScene\",\r\n        value: function getCurrentScene() {\r\n          return myPannellum && myPannellum.getScene();\r\n        },\r\n      },\r\n      {\r\n        key: \"getAllScenes\",\r\n        value: function getAllScenes() {\r\n          return myPannellum && myPannellum.getAllScenes();\r\n        },\r\n      },\r\n      {\r\n        key: \"removeScene\",\r\n        value: function removeScene(sceneId, callback) {\r\n          if (sceneId && sceneId !== \"\") {\r\n            myPromise(myPannellum, {\r\n              sceneId: sceneId,\r\n            })\r\n              .then(function (_ref8) {\r\n                var sceneId = _ref8.sceneId;\r\n                myPannellum.removeScene(sceneId);\r\n                callback && callback();\r\n              })\r\n              [\"catch\"](function (err) {\r\n                console.log(err);\r\n              });\r\n          } else {\r\n            console.log(\"sceneId cannot be empty\");\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"loadScene\",\r\n        value: function loadScene(\r\n          sceneId,\r\n          targetPitch,\r\n          targetYaw,\r\n          targetHfov,\r\n          fadeDone\r\n        ) {\r\n          if (myPannellum && sceneId && sceneId !== \"\") {\r\n            myPannellum.loadScene(\r\n              sceneId,\r\n              targetPitch,\r\n              targetYaw,\r\n              targetHfov,\r\n              fadeDone\r\n            );\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"toggleFullscreen\",\r\n        value: function toggleFullscreen() {\r\n          return myPannellum && myPannellum.toggleFullscreen();\r\n        },\r\n      },\r\n      {\r\n        key: \"getConfig\",\r\n        value: function getConfig() {\r\n          return myPannellum && myPannellum.getConfig();\r\n        },\r\n      },\r\n      {\r\n        key: \"getContainer\",\r\n        value: function getContainer() {\r\n          return myPannellum && myPannellum.getContainer();\r\n        },\r\n      },\r\n      {\r\n        key: \"addHotSpot\",\r\n        value: function addHotSpot(hotspot, sceneId) {\r\n          if (hotspot !== {}) {\r\n            myPromise(myPannellum, {\r\n              hotspot: hotspot,\r\n              sceneId: sceneId,\r\n            })\r\n              .then(function (_ref9) {\r\n                var hotspot = _ref9.hotspot,\r\n                  sceneId = _ref9.sceneId;\r\n                myPannellum.addHotSpot(hotspot, sceneId);\r\n              })\r\n              [\"catch\"](function (err) {\r\n                console.log(err);\r\n              });\r\n          } else {\r\n            console.log(\r\n              \"hotspot cannot be empty, please check hotspot elements needed in document: config props `hotSpots`.\"\r\n            );\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"removeHotSpot\",\r\n        value: function removeHotSpot(hotSpotId, sceneId) {\r\n          if (hotSpotId !== \"\") {\r\n            myPromise(myPannellum, {\r\n              hotSpotId: hotSpotId,\r\n              sceneId: sceneId,\r\n            })\r\n              .then(function (_ref10) {\r\n                var hotSpotId = _ref10.hotSpotId,\r\n                  sceneId = _ref10.sceneId;\r\n                myPannellum.removeHotSpot(hotSpotId, sceneId);\r\n              })\r\n              [\"catch\"](function (err) {\r\n                console.log(err);\r\n              });\r\n          } else {\r\n            console.log(\"hotspotId cannot be empty!!\");\r\n          }\r\n        },\r\n      },\r\n      {\r\n        key: \"destroy\",\r\n        value: function destroy() {\r\n          return myPannellum && myPannellum.destroy();\r\n        },\r\n      },\r\n      {\r\n        key: \"stopMovement\",\r\n        value: function stopMovement() {\r\n          return myPannellum && myPannellum.stopMovement();\r\n        },\r\n      },\r\n      {\r\n        key: \"resize\",\r\n        value: function resize() {\r\n          return myPannellum && myPannellum.resize();\r\n        },\r\n      },\r\n      {\r\n        key: \"isOrientationSupported\",\r\n        value: function isOrientationSupported() {\r\n          return myPannellum && myPannellum.isOrientationSupported();\r\n        },\r\n      },\r\n      {\r\n        key: \"stopOrientation\",\r\n        value: function stopOrientation() {\r\n          return myPannellum && myPannellum.stopOrientation();\r\n        },\r\n      },\r\n      {\r\n        key: \"startOrientation\",\r\n        value: function startOrientation() {\r\n          return myPannellum && myPannellum.startOrientation();\r\n        },\r\n      },\r\n      {\r\n        key: \"isOrientationActive\",\r\n        value: function isOrientationActive() {\r\n          return myPannellum && myPannellum.isOrientationActive();\r\n        },\r\n      },\r\n      {\r\n        key: \"getViewer\",\r\n        value: function getViewer() {\r\n          return myPannellum;\r\n        },\r\n      },\r\n    ]\r\n  );\r\n\r\n  return ReactPannellum;\r\n})(React__default[\"default\"].Component);\r\n\r\nReactPannellum.propTypes = {\r\n  id: PropTypes__default[\"default\"].string.isRequired,\r\n  sceneId: PropTypes__default[\"default\"].string.isRequired,\r\n  children: PropTypes__default[\"default\"].any,\r\n  type: PropTypes__default[\"default\"].string,\r\n  imageSource: PropTypes__default[\"default\"].string,\r\n  equirectangularOptions: PropTypes__default[\"default\"].shape({}),\r\n  cubeMap: PropTypes__default[\"default\"].arrayOf(\r\n    PropTypes__default[\"default\"].string\r\n  ),\r\n  multiRes: PropTypes__default[\"default\"].shape({\r\n    basePath: PropTypes__default[\"default\"].string,\r\n    path: PropTypes__default[\"default\"].string,\r\n    fallbackPath: PropTypes__default[\"default\"].string,\r\n    extension: PropTypes__default[\"default\"].string,\r\n    tileResolution: PropTypes__default[\"default\"].number,\r\n    maxLevel: PropTypes__default[\"default\"].number,\r\n    cubeResolution: PropTypes__default[\"default\"].number,\r\n  }),\r\n  config: PropTypes__default[\"default\"].shape({}),\r\n  className: PropTypes__default[\"default\"].string,\r\n  style: PropTypes__default[\"default\"].shape({}),\r\n  onPanoramaLoaded: PropTypes__default[\"default\"].func,\r\n  onMouseDown: PropTypes__default[\"default\"].func,\r\n  onMouseUp: PropTypes__default[\"default\"].func,\r\n  onMouseMove: PropTypes__default[\"default\"].func,\r\n};\r\nReactPannellum.defaultProps = {\r\n  type: \"equirectangular\",\r\n  imageSource: \"\",\r\n  equirectangularOptions: {},\r\n  cubeMap: [],\r\n  multiRes: {},\r\n  className: \"\",\r\n  style: configs.styles,\r\n  config: {},\r\n  onMouseDown: () => {},\r\n  onMouseUp: () => {},\r\n  onMouseMove: () => {},\r\n};\r\n\r\nexport const addScene = ReactPannellum.addScene;\r\nexport const getCurrentScene = ReactPannellum.getCurrentScene;\r\nexport const getAllScenes = ReactPannellum.getAllScenes;\r\nexport const removeScene = ReactPannellum.removeScene;\r\nexport const loadScene = ReactPannellum.loadScene;\r\nexport const isLoaded = ReactPannellum.isLoaded;\r\nexport const getPitch = ReactPannellum.getPitch;\r\nexport const setPitch = ReactPannellum.setPitch;\r\nexport const getPitchBounds = ReactPannellum.getPitchBounds;\r\nexport const setPitchBounds = ReactPannellum.setPitchBounds;\r\nexport const getYaw = ReactPannellum.getYaw;\r\nexport const setYaw = ReactPannellum.setYaw;\r\nexport const getYawBounds = ReactPannellum.getYawBounds;\r\nexport const setYawBounds = ReactPannellum.setYawBounds;\r\nexport const getHfov = ReactPannellum.getHfov;\r\nexport const setHfov = ReactPannellum.setHfov;\r\nexport const getHfovBounds = ReactPannellum.getHfovBounds;\r\nexport const setHfovBounds = ReactPannellum.setHfovBounds;\r\nexport const lookAt = ReactPannellum.lookAt;\r\nexport const getNorthOffset = ReactPannellum.getNorthOffset;\r\nexport const setNorthOffset = ReactPannellum.setNorthOffset;\r\nexport const getHorizonRoll = ReactPannellum.getHorizonRoll;\r\nexport const setHorizonRoll = ReactPannellum.setHorizonRoll;\r\nexport const getHorizonPitch = ReactPannellum.getHorizonPitch;\r\nexport const setHorizonPitch = ReactPannellum.setHorizonPitch;\r\nexport const startAutoRotate = ReactPannellum.startAutoRotate;\r\nexport const stopAutoRotate = ReactPannellum.stopAutoRotate;\r\nexport const mouseEventToCoords = ReactPannellum.mouseEventToCoords;\r\nexport const changeMouseCursor = ReactPannellum.changeMouseCursor;\r\nexport const showCompass = ReactPannellum.showCompass;\r\nexport const toggleFullscreen = ReactPannellum.toggleFullscreen;\r\nexport const getConfig = ReactPannellum.getConfig;\r\nexport const getContainer = ReactPannellum.getContainer;\r\nexport const addHotSpot = ReactPannellum.addHotSpot;\r\nexport const removeHotSpot = ReactPannellum.removeHotSpot;\r\nexport const destroy = ReactPannellum.destroy;\r\nexport const stopMovement = ReactPannellum.stopMovement;\r\nexport const resize = ReactPannellum.resize;\r\nexport const isOrientationSupported = ReactPannellum.isOrientationSupported;\r\nexport const stopOrientation = ReactPannellum.stopOrientation;\r\nexport const startOrientation = ReactPannellum.startOrientation;\r\nexport const isOrientationActive = ReactPannellum.isOrientationActive;\r\nexport const getViewer = ReactPannellum.getViewer;\r\nexport default ReactPannellum;\r\n\r\n// exports.addHotSpot = addHotSpot;\r\n// exports.addScene = addScene;\r\n// exports.default = ReactPannellum;\r\n// exports.destroy = destroy;\r\n// exports.getAllScenes = getAllScenes;\r\n// exports.getConfig = getConfig;\r\n// exports.getContainer = getContainer;\r\n// exports.getCurrentScene = getCurrentScene;\r\n// exports.getHfov = getHfov;\r\n// exports.getHfovBounds = getHfovBounds;\r\n// exports.getHorizonPitch = getHorizonPitch;\r\n// exports.getHorizonRoll = getHorizonRoll;\r\n// exports.getNorthOffset = getNorthOffset;\r\n// exports.getPitch = getPitch;\r\n// exports.getPitchBounds = getPitchBounds;\r\n// exports.getViewer = getViewer;\r\n// exports.getYaw = getYaw;\r\n// exports.getYawBounds = getYawBounds;\r\n// exports.isLoaded = isLoaded;\r\n// exports.isOrientationActive = isOrientationActive;\r\n// exports.isOrientationSupported = isOrientationSupported;\r\n// exports.loadScene = loadScene;\r\n// exports.lookAt = lookAt;\r\n// exports.mouseEventToCoords = mouseEventToCoords;\r\n// exports.changeMouseCursor = changeMouseCursor;\r\n// exports.removeHotSpot = removeHotSpot;\r\n// exports.removeScene = removeScene;\r\n// exports.resize = resize;\r\n// exports.setHfov = setHfov;\r\n// exports.setHfovBounds = setHfovBounds;\r\n// exports.setHorizonPitch = setHorizonPitch;\r\n// exports.setHorizonRoll = setHorizonRoll;\r\n// exports.setNorthOffset = setNorthOffset;\r\n// exports.setPitch = setPitch;\r\n// exports.setPitchBounds = setPitchBounds;\r\n// exports.setYaw = setYaw;\r\n// exports.setYawBounds = setYawBounds;\r\n// exports.startAutoRotate = startAutoRotate;\r\n// exports.showCompass = showCompass;\r\n// exports.startOrientation = startOrientation;\r\n// exports.stopAutoRotate = stopAutoRotate;\r\n// exports.stopMovement = stopMovement;\r\n// exports.stopOrientation = stopOrientation;\r\n// exports.toggleFullscreen = toggleFullscreen;\r\n"]},"metadata":{},"sourceType":"module"}